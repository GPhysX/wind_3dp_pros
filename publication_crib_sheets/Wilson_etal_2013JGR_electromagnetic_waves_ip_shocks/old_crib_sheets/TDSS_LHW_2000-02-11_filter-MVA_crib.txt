;-----------------------------------------------------------------------------------------
; -Constants
;-----------------------------------------------------------------------------------------
f      = !VALUES.F_NAN
d      = !VALUES.D_NAN
epo    = 8.854187817d-12   ; -Permittivity of free space (F/m)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
me     = 9.1093897d-31     ; -Electron mass (kg)
mp     = 1.6726231d-27     ; -Proton mass (kg)
ma     = 4d0*(mp + me)     ; -Alpha-Particle mass (kg)
qq     = 1.60217733d-19    ; -Fundamental charge (C)
kB     = 1.380658d-23      ; -Boltzmann Constant (J/K)
K_eV   = 1.160474d4        ; -Conversion = degree Kelvin/eV
c      = 2.99792458d8      ; -Speed of light in vacuum (m/s)
c2     = (c*1d-3)^2        ; -" " squared (km/s)^2
mm     = [-1d0,0d0,1d0]    ; -[Normal Cyclotron, Landau, Anomalous Cyclotron]
mass_e = 0.5109906d6       ; -Electron mass in eV/c^2
mass_p = mp*c^2/qq         ; -Proton mass in eV/c^2
u_mass = mass_e/c2         ; -Electron mass [eV/(km/s)^2]
p_mass = mass_p/c2         ; -Proton mass [eV/(km/s)^2]
pressc = 1.60217646d-13    ; => Conversion from eV/cm^3 to J/m^3 (or Pascals)
picops = pressc*1d12       ; => Conversion from eV/cm^3 to pJ/m^3 (or pPa)
;-----------------------------------------------------------------------------------------
; => Dates and time ranges
;-----------------------------------------------------------------------------------------
date = '021100'
t    = ['2000-02-11/22:33:00','2000-02-12/00:33:00']
tramp = '2000-02-11/23:33:55.319'
tr3   = time_double(t)
tura  = time_double(tramp)

mydate = my_str_date(DATE=date)
sdate  = mydate.S_DATE[0]  ; -('MMDDYY')
ldate  = mydate.DATE[0]    ; -('YYYYMMDD')
tdate  = mydate.TDATE[0]   ; => 'YYYY-MM-DD'
;-----------------------------------------------------------------------------------------
; => Load MFI data
;-----------------------------------------------------------------------------------------
htr_mfi2tplot,DATE=date
get_data,'WIND_B3_HTR(GSE,nT)',DATA=temporary_mfi
magf_htr = temporary_mfi
str_element,magf_htr,'R',REPLICATE(1L,N_ELEMENTS(magf_htr.X)),/ADD_REPLACE
;-----------------------------------------------------------------------------------------
; => Find shock info
;-----------------------------------------------------------------------------------------
gnorm      = [-0.865,-0.452,0.218]   ; => Using RH08 from JCK's site
dgnorm     = [ 0.017, 0.030,0.214]
;-----------------------------------------------------------------------------------------
; => Get TDS data
;-----------------------------------------------------------------------------------------
; => Get TDSS data
my_tdss    = get_wind_tds_data(DATE=date,FIXFILE=1,/TDSS)
x          = LINDGEN(N_ELEMENTS(my_tdss.SCET))
IF (sdate[0] EQ '021100') THEN gels = [x[0L:11L],x[15L:34L]]
; => Get ONLY whistler TDSS
IF (gels[0] NE -1) THEN scetss  = my_tdss.SCET[gels[*]]             ELSE scetss  = ''
IF (gels[0] NE -1) THEN fieldss = REFORM(my_tdss.EFIELD[gels[*],*]) ELSE fieldss = dumbf
IF (gels[0] NE -1) THEN timess  = REFORM(my_tdss.TIME[gels[*],*])   ELSE timess  = dumbd
IF (gels[0] NE -1) THEN evnums  = my_tdss.EVENT_N[gels[*]]          ELSE evnums  = -1
IF (gels[0] NE -1) THEN atypes  = my_tdss.A_TYPE[gels[*]]           ELSE atypes  = ''
IF (gels[0] NE -1) THEN sangss  = my_tdss.S_ANG[gels[*]]            ELSE sangss  = 0.
IF (gels[0] NE -1) THEN eangss  = my_tdss.E_ANG[gels[*]]            ELSE eangss  = 0.

ascets     = scetss
; => STRMID(scet,0,2)+STRMID(scet,3,2)+'-'+STRMID(scet,6,2)+'x'+STRMID(scet,9,3)
ascets2    = string_replace_char(string_replace_char(ascets,'/','-'),' ','_')
ascets2    = STRMID(ascets2[*],0L,23L)  ; => Remove the _UT
fdates     = STRMID(ascets2[*],0L,11L)
fscets     = STRMID(ascets2[*],11L)
fscets     = STRMID(fscets[*],0,2)+STRMID(fscets[*],3,2)+'-'+$
             STRMID(fscets[*],6,2)+'x'+STRMID(fscets[*],9,3)
fn_scets   = fdates[*]+fscets[*]

afields    = fieldss
atimes     = timess
aevnum     = evnums
aatype     = atypes
asangs     = sangss
aeangs     = eangss
; => Eliminate bad elements
bad        = WHERE(ascets EQ '',bd,COMPLEMENT=good,NCOMPLEMENT=gd)
IF (gd GT 0) THEN ascets  = ascets[good]
IF (gd GT 0) THEN afields = afields[good,*]
IF (gd GT 0) THEN atimes  = atimes[good,*]
IF (gd GT 0) THEN aevnum  = aevnum[good]
IF (gd GT 0) THEN aatype  = aatype[good]
IF (gd GT 0) THEN asangs  = asangs[good]
IF (gd GT 0) THEN aeangs  = aeangs[good]
; => sort elements
mts        = my_time_string(ascets,STR=1,FORM=1,PREC=3,/NOMSSG)
ascets     = mts.DATE_TIME
aunix      = mts.UNIX
sp         = SORT(aunix)
ascets     = ascets[sp]
aunix      = aunix[sp]
afields    = afields[sp,*]
atimes     = atimes[sp,*]
aevnum     = aevnum[sp]
aatype     = aatype[sp]
asangs     = asangs[sp]
aeangs     = aeangs[sp]
;-----------------------------------------------------------------------------------------
; => define fields
;-----------------------------------------------------------------------------------------
nsams   = N_ELEMENTS(REFORM(my_tdss.TIME[0,*]))
efxyz   = DBLARR(N_ELEMENTS(UNIQ(ascets,SORT(ascets))),nsams,3L)  ; => Dummy array of E-fields (mV/m)
bfxyz   = DBLARR(N_ELEMENTS(UNIQ(ascets,SORT(ascets))),nsams,3L)  ; => Dummy array of B-fields (nT)
unqel   = UNIQ(aevnum,SORT(aevnum))
n_uq    = N_ELEMENTS(unqel) - 1L
tempevn = aevnum[unqel]
n_avgs  = N_ELEMENTS(aevnum)/N_ELEMENTS(unqel) - 1L

jj      = 0L
FOR j=0L, n_uq DO BEGIN                                                    $
  t_evn   = tempevn[j]                                                   & $
  ggd     = WHERE(t_evn[0] EQ aevnum)                                    & $
  t_types = STRMID(aatype[ggd],0L,2L)                                    & $
  t_field = afields[ggd,*]                                               & $
  FOR k=0L, n_avgs DO BEGIN                                                $
    t_type = STRMID(t_types[k],0L,2L)                                    & $
    IF (t_type EQ 'EX') THEN efxyz[j,*,0] = t_field[k,*]                 & $
    IF (t_type EQ 'EY') THEN efxyz[j,*,1] = t_field[k,*]                 & $
    IF (t_type EQ 'EZ') THEN efxyz[j,*,2] = t_field[k,*]                 & $
    IF (t_type EQ 'BX') THEN bfxyz[j,*,0] = t_field[k,*]                 & $
    IF (t_type EQ 'BY') THEN bfxyz[j,*,1] = t_field[k,*]                 & $
    IF (t_type EQ 'BZ') THEN bfxyz[j,*,2] = t_field[k,*]                 & $
  ENDFOR                                                                 & $
  jj += 1L

FOR j=0L, n_uq DO BEGIN                                                    $
  jstr  = 'T'+STRTRIM(j,2)                                               & $
  str_element,waves_ef,jstr,REFORM(efxyz[j,*,*]),/ADD_REPLACE            & $
  str_element,waves_bf,jstr,REFORM(bfxyz[j,*,*]),/ADD_REPLACE
;-----------------------------------------------------------------------------------------
; => find unique elements of fields
;-----------------------------------------------------------------------------------------
unqel   = UNIQ(ascets,SORT(ascets))
nscets  = REFORM(ascets[unqel])
nunix   = REFORM(aunix[unqel])
nsangs  = REFORM(asangs[unqel])
neangs  = REFORM(aeangs[unqel])
nevnm   = REFORM(aevnum[unqel])
natype  = aatype[unqel]
fn_scet = fn_scets[unqel]
ntimes  = REFORM(atimes[unqel,*],N_ELEMENTS(unqel),nsams)
n_uq    = N_ELEMENTS(unqel) - 1L
;-----------------------------------------------------------------------------------------
; => interpolate angles
;-----------------------------------------------------------------------------------------
nangsi = DBLARR(nsams,n_uq+1L)
FOR k=0L, n_uq DO BEGIN                                              $
  kstr  = 'T'+STRTRIM(k,2)                                         & $
  tt0         = REFORM(ntimes[k,*])*1d-3 + nunix[k]                & $
  tts0        = [MIN(tt0,/NAN),MAX(tt0,/NAN)]                      & $
  temp0       = interp([nsangs[k],neangs[k]],tts0,tt0,/NO_EXTRAP)  & $
  str_element,tds_unx,kstr,tt0,/ADD_REPLACE                        & $
  nangsi[*,k] = temp0

san_str    = STRTRIM(STRING(FORMAT='(f15.1)',nsangs),2)
ean_str    = STRTRIM(STRING(FORMAT='(f15.1)',neangs),2)
ang_str    = san_str[*]+'!Uo!N'+'-'+ean_str[*]+'!Uo!N'
fang_str   = '+E!Dx!N Angle to Sun:  '+ang_str[*]
;-----------------------------------------------------------------------------------------
; => filter fields
;-----------------------------------------------------------------------------------------
lfc1  = [7d0,5d0,6d1,12d1]                   ; => For 2000-02-11/23:33:56.491 UT
hfc1  = [2d1,3d1,2d2, 2d2]                   ; => For 2000-02-11/23:33:56.491 UT
lfc2  = [7d0,5d0,6d1,12d1]                   ; => For 2000-02-11/23:33:58.351 UT
hfc2  = [2d1,3d1,2d2, 2d2]                   ; => For 2000-02-11/23:33:58.351 UT
lfc3  = [3d0,3d0,3d1]                        ; => For 2000-02-11/23:34:00.731 UT
hfc3  = [2d1,3d1,2d2]                        ; => For 2000-02-11/23:34:00.731 UT
lfc4  = [5d1]                                ; => For 2000-02-11/23:34:27.503 UT
hfc4  = [25d1]                               ; => For 2000-02-11/23:34:27.503 UT
lfc5  = [4d1]                                ; => For 2000-02-11/23:34:29.065 UT
hfc5  = [25d1]                               ; => For 2000-02-11/23:34:29.065 UT
lfc6  = [6d1]                                ; => For 2000-02-12/00:14:21.709 UT
hfc6  = [15d1]                               ; => For 2000-02-12/00:14:21.709 UT
lfc7  = [36d0]                               ; => For 2000-02-12/00:26:17.217 UT
hfc7  = [10d1]                               ; => For 2000-02-12/00:26:17.217 UT
lfc8  = [30d0]                               ; => For 2000-02-12/00:27:19.142 UT
hfc8  = [10d1]                               ; => For 2000-02-12/00:27:19.142 UT

tags  = ['t1','t2','t3','t4','t5','t6','t7','t8']

lf_str = CREATE_STRUCT(tags,lfc1,lfc2,lfc3,lfc4,lfc5,lfc6,lfc7,lfc8)
hf_str = CREATE_STRUCT(tags,hfc1,hfc2,hfc3,hfc4,hfc5,hfc6,hfc7,hfc8)

DELVAR,filter_sf0,filter_ef0,filter_bf0,filter_sf,filter_ef,filter_bf
jj     = 0L
FOR j=0L, n_uq DO BEGIN                                                             $
  evln  = (MAX(ntimes[j,*],/NAN) - MIN(ntimes[j,*],/NAN))*1d-3                    & $
  tsam  = (nsams - 1L)/evln                                                       & $
  jstr  = 'T'+STRTRIM(j,2)                                                        & $
  lfc0  = lf_str.(j)                                                              & $
  hfc0  = hf_str.(j)                                                              & $
  n_fr  = N_ELEMENTS(lfc0) - 1L                                                   & $
  t_ef  = REFORM(waves_ef.(j))                                                    & $
  t_bf  = REFORM(waves_bf.(j))                                                    & $
  FOR k=0L, n_fr DO BEGIN                                                           $
    kstr  = 'T'+STRTRIM(k,2)                                                      & $
    flow  = lfc0[k]                                                               & $
    fhigh = hfc0[k]                                                               & $
    filte = vector_bandpass(t_ef,tsam[0],flow[0],fhigh[0],/MIDF)                  & $
    filtb = vector_bandpass(t_bf,tsam[0],flow[0],fhigh[0],/MIDF)                  & $
    str_element,filter_ef0,kstr,filte,/ADD_REPLACE                                & $
    str_element,filter_bf0,kstr,filtb,/ADD_REPLACE                                & $
    vec_ef = REFORM(filte)*1d-3                                                   & $
    vec_bf = REFORM(filtb)*1d-9                                                   & $
    poy_sf = my_crossp_2(vec_ef,vec_bf,/NOM)/muo*1d6                              & $
    str_element,filter_sf0,kstr,poy_sf,/ADD_REPLACE                               & $
  ENDFOR                                                                          & $
  str_element,filter_sf,jstr,filter_sf0,/ADD_REPLACE                              & $
  str_element,filter_ef,jstr,filter_ef0,/ADD_REPLACE                              & $
  str_element,filter_bf,jstr,filter_bf0,/ADD_REPLACE                              & $
  FOR k=0L, n_fr DO BEGIN                                                           $
    kstr  = 'T'+STRTRIM(k,2)                                                      & $
    str_element,filter_ef0,kstr,/DELETE                                           & $
    str_element,filter_bf0,kstr,/DELETE                                           & $
    str_element,filter_sf0,kstr,/DELETE                                           & $
  ENDFOR                                                                          & $
ENDFOR                                                                            & $
jj += 1L

DELVAR,filter_sf0,filter_ef0,filter_bf0,vec_ef,vec_bf,filte,filtb,poy_sf,t_ef,b_ef

; => [erg cm^(-2) s^(-1) = 10^(-3) W m^(-2)]
; => [milliergs cm^(-2) s^(-1) = 10^(-6) W m^(-2)]
;-----------------------------------------------------------------------------------------
; => rotate fields into GSE and FAC Coordinates [use Shock Norm. Vec. as second vector]
;-----------------------------------------------------------------------------------------
unx_t0     = ntimes*1d-3 + (nunix # REPLICATE(1d0,2048L))
t_mag0     = tds_bfield(unx_t0,nsangs,neangs,B3SMAG=magf_3s,HTRMAG=magf_htr,DATE=date,/NOCURR)
b3s_gse    = t_mag0.G3MAG                ; => [# of TDSF, # of points, 3L]
htr_gse    = t_mag0.GHTR
; => Change the following line when HTR MFI is available...
;mag_gse    = b3s_gse
mag_gse    = htr_gse
mag_waves  = t_mag0.ROT_HTR
sun_dir    = gnorm

jj     = 0L
FOR j=0L, n_uq DO BEGIN                                                     $
  jstr    = 'T'+STRTRIM(j,2)                                              & $
  unx0    = REFORM(unx_t0[j,*])                                           & $
  g_magf  = REFORM(mag_gse[j,*,*])                                        & $
  angles  = REFORM(nangsi[*,j])                                           & $
  filter_ef0 = filter_ef.(j)                                              & $
  filter_bf0 = filter_bf.(j)                                              & $
  filter_sf0 = filter_sf.(j)                                              & $
  n_fr       = N_ELEMENTS(lf_str.(j)) - 1L                                & $
  FOR k=0L, n_fr DO BEGIN                                                   $
    kstr    = 'T'+STRTRIM(k,2)                                            & $
    vec_ef  = REFORM(filter_ef0.(k))*1d0                                  & $
    vec_bf  = REFORM(filter_bf0.(k))*1d0                                  & $
    vec_sf  = REFORM(filter_sf0.(k))*1d0                                  & $
    rot_efg = DBLARR(nsams,3L)                                            & $
    rot_bfg = DBLARR(nsams,3L)                                            & $
    rot_sfg = DBLARR(nsams,3L)                                            & $
    rot_ef  = DBLARR(nsams,3L)                                            & $
    rot_bf  = DBLARR(nsams,3L)                                            & $
    rot_sf  = DBLARR(nsams,3L)                                            & $
    FOR i=0L, nsams - 1L DO BEGIN                                           $
      rotm0 = TRANSPOSE(eulermat(0d0,angles[i],180d0,/DEG))               & $
      t_eef = REFORM(rotm0 ## REFORM(vec_ef[i,*]))                        & $
      t_ebf = REFORM(rotm0 ## REFORM(vec_bf[i,*]))                        & $
      t_esf = REFORM(rotm0 ## REFORM(vec_sf[i,*]))                        & $
      rot_efg[i,*] = t_eef                                                & $
      rot_bfg[i,*] = t_ebf                                                & $
      rot_sfg[i,*] = t_esf                                                & $
      magf  = REFORM(g_magf[i,*])                                         & $
      rotm0 = rot_mat(magf,sun_dir)                                       & $
      t_eef = REFORM(rotm0 ## REFORM(vec_ef[i,*]))                        & $
      t_ebf = REFORM(rotm0 ## REFORM(vec_bf[i,*]))                        & $
      t_esf = REFORM(rotm0 ## REFORM(vec_sf[i,*]))                        & $
      rot_ef[i,*] = t_eef                                                 & $
      rot_bf[i,*] = t_ebf                                                 & $
      rot_sf[i,*] = t_esf                                                 & $
    ENDFOR                                                                & $
    str_element,rotated_gse_ef0,kstr,rot_efg,/ADD_REPLACE                 & $
    str_element,rotated_gse_bf0,kstr,rot_bfg,/ADD_REPLACE                 & $
    str_element,rotated_gse_sf0,kstr,rot_sfg,/ADD_REPLACE                 & $
    str_element,rotated_fac_ef0,kstr,rot_ef,/ADD_REPLACE                  & $
    str_element,rotated_fac_bf0,kstr,rot_bf,/ADD_REPLACE                  & $
    str_element,rotated_fac_sf0,kstr,rot_sf,/ADD_REPLACE                  & $
  ENDFOR                                                                  & $
  str_element,rotated_gse_ef,jstr,rotated_gse_ef0,/ADD_REPLACE            & $
  str_element,rotated_gse_bf,jstr,rotated_gse_bf0,/ADD_REPLACE            & $
  str_element,rotated_gse_sf,jstr,rotated_gse_sf0,/ADD_REPLACE            & $
  str_element,rotated_fac_ef,jstr,rotated_fac_ef0,/ADD_REPLACE            & $
  str_element,rotated_fac_bf,jstr,rotated_fac_bf0,/ADD_REPLACE            & $
  str_element,rotated_fac_sf,jstr,rotated_fac_sf0,/ADD_REPLACE            & $
  FOR k=0L, n_fr DO BEGIN                                                   $
    kstr    = 'T'+STRTRIM(k,2)                                            & $
    str_element,rotated_gse_ef0,kstr,/DELETE                              & $
    str_element,rotated_gse_bf0,kstr,/DELETE                              & $
    str_element,rotated_gse_sf0,kstr,/DELETE                              & $
    str_element,rotated_fac_ef0,kstr,/DELETE                              & $
    str_element,rotated_fac_bf0,kstr,/DELETE                              & $
    str_element,rotated_fac_sf0,kstr,/DELETE                              & $
  ENDFOR                                                                  & $
ENDFOR                                                                            & $
jj += 1L

;      rotm0 = eulermat(0d0,angles[i],180d0,/DEG)                          & $
DELVAR,filter_sf0,filter_ef0,filter_bf0
DELVAR,rotated_gse_ef0,rotated_gse_bf0,rotated_gse_sf0,rot_efg,rot_bfg,rot_sfg
DELVAR,rot_ef,rot_bf,rot_sf,vec_ef,vec_bf,vec_sf,t_eef,t_ebf,t_esf

; => *_gse_*  =  fields rotated into GSE Coordinates
; => *_fac_*  =  fields rotated into FACs
;-----------------------------------------------------------------------------------------
; => Plot waveforms in GSE Coordinates
;-----------------------------------------------------------------------------------------
wi,1
!P.MULTI = [0,1,3]

yttlsws   = ['S!Dx!N (!7l!3'+'W/m!U2!N'+')','S!Dy!N (!7l!3'+'W/m!U2!N'+')',$
             'S!Dz!N (!7l!3'+'W/m!U2!N'+')']
yttlbws   = ['B!Dx!N (nT)','B!Dy!N (nT)','B!Dz!N (nT)']
yttlews   = ['E!Dx!N (mV/m)','E!Dy!N (mV/m)','E!Dz!N (mV/m)']

xtntm     = ['0','200','400','600','800','1000']
xtvtm     = [0e0,2e2,4e2,6e2,8e2,1e3]
xtstm     = N_ELEMENTS(xtvtm) - 1L
xtt1      = 'Time (ms)'
exstr_s   = {XSTYLE:1,YSTYLE:1,NODATA:1,XTICKNAME:xtntm,XTICKV:xtvtm,$
             XTICKS:xtstm,XTITLE:xtt1,XMINOR:10,XTICKLEN:0.04}

ffw_prefx = 'FIXED_WAVES-Coords_filtered_'
colors    = [250,150,50]
!P.CHARSIZE = 1.5
!P.MULTI    = [0,1,3]



; => Plot Filtered fields 
jj = 0
FOR i=0L, n_uq DO BEGIN                                                         $
  lfc0       = lf_str.(i)                                                     & $
  hfc0       = hf_str.(i)                                                     & $
  fwl_str    = STRTRIM(STRING(FORMAT='(f15.1)',lfc0),2)                       & $
  fwh_str    = STRTRIM(STRING(FORMAT='(f15.1)',hfc0),2)                       & $
  fil_str    = fwl_str[*]+'-'+fwh_str[*]+'Hz_'                                & $
  fil_st2    = STRARR(N_ELEMENTS(fil_str))                                    & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                          & $
  FOR j=0L, n_fr DO fil_st2[j] = STRMID(fil_str[j],0L,STRLEN(fil_str[j])-1L)  & $
  FOR k=0L, n_fr DO BEGIN                                                       $
    ms_times = REFORM(ntimes[i,*])                                        & $
    sw_field = filter_sf.(i).(k)                                          & $
    ew_field = filter_ef.(i).(k)                                          & $
    bw_field = filter_bf.(i).(k)                                          & $
    yra_sw   = [-1e0*MAX(ABS(sw_field),/NAN),MAX(ABS(sw_field),/NAN)]     & $
    yra_bw   = [-1e0*MAX(ABS(bw_field),/NAN),MAX(ABS(bw_field),/NAN)]     & $
    yra_ew   = [-1e0*MAX(ABS(ew_field),/NAN),MAX(ABS(ew_field),/NAN)]     & $
    fname0   = ffw_prefx[0]+fil_str[k]+fn_scet[i]+'_Sxyz'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Poynting Flux [WAVES-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,sw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlsws[j],YRANGE=yra_sw,TITLE=ttle  & $
          OPLOT,ms_times,sw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffw_prefx[0]+fil_str[k]+fn_scet[i]+'_Bxyz'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Magnetic Field [WAVES-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,bw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlbws[j],YRANGE=yra_bw,TITLE=ttle  & $
          OPLOT,ms_times,bw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffw_prefx[0]+fil_str[k]+fn_scet[i]+'_Exyz'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Electric Field [WAVES-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,ew_field[*,j],_EXTRA=exstr_s,YTITLE=yttlews[j],YRANGE=yra_ew,TITLE=ttle  & $
          OPLOT,ms_times,ew_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
  ENDFOR                                                                  & $
  jj += 1L


ffr_prefx = 'FIXED_rotated_filtered_'
; => Plot rotated and filtered fields 
FOR i=0L, n_uq DO BEGIN                                                         $
  lfc0       = lf_str.(i)                                                     & $
  hfc0       = hf_str.(i)                                                     & $
  fwl_str    = STRTRIM(STRING(FORMAT='(f15.1)',lfc0),2)                       & $
  fwh_str    = STRTRIM(STRING(FORMAT='(f15.1)',hfc0),2)                       & $
  fil_str    = fwl_str[*]+'-'+fwh_str[*]+'Hz_'                                & $
  fil_st2    = STRARR(N_ELEMENTS(fil_str))                                    & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                          & $
  FOR j=0L, n_fr DO fil_st2[j] = STRMID(fil_str[j],0L,STRLEN(fil_str[j])-1L)  & $
  FOR k=0L, n_fr DO BEGIN                                                   $
    ms_times = REFORM(ntimes[i,*])                                        & $
    sw_field = rotated_gse_sf.(i).(k)                                     & $
    ew_field = rotated_gse_ef.(i).(k)                                     & $
    bw_field = rotated_gse_bf.(i).(k)                                     & $
    yra_sw   = [-1e0*MAX(ABS(sw_field),/NAN),MAX(ABS(sw_field),/NAN)]     & $
    yra_bw   = [-1e0*MAX(ABS(bw_field),/NAN),MAX(ABS(bw_field),/NAN)]     & $
    yra_ew   = [-1e0*MAX(ABS(ew_field),/NAN),MAX(ABS(ew_field),/NAN)]     & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_S-GSE'                & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Poynting Flux [GSE-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,sw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlsws[j],YRANGE=yra_sw,TITLE=ttle  & $
          OPLOT,ms_times,sw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_B-GSE'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Magnetic Field [GSE-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,bw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlbws[j],YRANGE=yra_bw,TITLE=ttle  & $
          OPLOT,ms_times,bw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_E-GSE'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Electric Field [GSE-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,ew_field[*,j],_EXTRA=exstr_s,YTITLE=yttlews[j],YRANGE=yra_ew,TITLE=ttle  & $
          OPLOT,ms_times,ew_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
  ENDFOR                                                                  & $
  jj += 1L


yttlsrs   = ['S!D!9x!3'+',1!N (!7l!3'+'W/m!U2!N'+')',$
             'S!D!9x!3'+',2!N (!7l!3'+'W/m!U2!N'+')',$
             'S!D!9#!3'+'!N (!7l!3'+'W/m!U2!N'+')']
yttlbrs   = ['B!D!9x!3'+',1!N (nT)','B!D!9x!3'+',2!N (nT)',$
             'B!D!9#!3'+'!N (nT)']
yttlers   = ['E!D!9x!3'+',1!N (mV/m)','E!D!9x!3'+',2!N (mV/m)',$
             'E!D!9#!3'+'!N (mV/m)']
ffr_prefx = 'FIXED_rotated_filtered_'
FOR i=0L, n_uq DO BEGIN                                                         $
  lfc0       = lf_str.(i)                                                     & $
  hfc0       = hf_str.(i)                                                     & $
  fwl_str    = STRTRIM(STRING(FORMAT='(f15.1)',lfc0),2)                       & $
  fwh_str    = STRTRIM(STRING(FORMAT='(f15.1)',hfc0),2)                       & $
  fil_str    = fwl_str[*]+'-'+fwh_str[*]+'Hz_'                                & $
  fil_st2    = STRARR(N_ELEMENTS(fil_str))                                    & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                          & $
  FOR j=0L, n_fr DO fil_st2[j] = STRMID(fil_str[j],0L,STRLEN(fil_str[j])-1L)  & $
  FOR k=0L, n_fr DO BEGIN                                                   $
    ms_times = REFORM(ntimes[i,*])                                        & $
    sw_field = rotated_fac_sf.(i).(k)                                     & $
    ew_field = rotated_fac_ef.(i).(k)                                     & $
    bw_field = rotated_fac_bf.(i).(k)                                     & $
    yra_sw   = [-1e0*MAX(ABS(sw_field),/NAN),MAX(ABS(sw_field),/NAN)]     & $
    yra_bw   = [-1e0*MAX(ABS(bw_field),/NAN),MAX(ABS(bw_field),/NAN)]     & $
    yra_ew   = [-1e0*MAX(ABS(ew_field),/NAN),MAX(ABS(ew_field),/NAN)]     & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_S-FACs'                & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Poynting Flux [FACs] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,sw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlsrs[j],YRANGE=yra_sw,TITLE=ttle  & $
          OPLOT,ms_times,sw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_B-FACs'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Magnetic Field [FACs] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,bw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlbrs[j],YRANGE=yra_bw,TITLE=ttle  & $
          OPLOT,ms_times,bw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_E-FACs'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Electric Field [FACs] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,ew_field[*,j],_EXTRA=exstr_s,YTITLE=yttlers[j],YRANGE=yra_ew,TITLE=ttle  & $
          OPLOT,ms_times,ew_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
  ENDFOR                                                                  & $
  jj += 1L

!P.MULTI = 0
;---------------------------------------------------------------------------------------------------
;      Date        Time                Ni          Ti            Vx              Vy             Vz
;===================================================================================================
;    2000/02/11 23:33:56.491 UT      14.821      22.904       -528.007        -53.383          3.184
;    2000/02/11 23:33:58.351 UT      15.463      27.846       -563.033        -75.287          7.363
;    2000/02/11 23:34:00.731 UT      16.053      31.459       -576.773        -86.503          3.938
;    2000/02/11 23:34:27.503 UT      16.849      41.461       -616.468        -88.752         24.278
;    2000/02/11 23:34:29.065 UT      16.895      42.224       -614.831        -87.347         26.389
;    2000/02/12 00:14:21.709 UT      24.601      27.713       -545.068       -104.704         71.029
;    2000/02/12 00:26:17.217 UT      20.398      25.645       -544.911       -108.653         50.280
;    2000/02/12 00:27:19.142 UT      19.291      26.395       -543.505       -117.934         36.899
;---------------------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
; => Perform MVA
;-----------------------------------------------------------------------------------------
dumbmag = magf_htr
jj      = 0L
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

spref = 'bvec'
ssuff = '   = ['
mfor0 = '(a11,f8.5,",",f8.5,",",f8.5,"]")'
mfor1 = '(a12,f8.5,",",f8.5,",",f8.5,"]")'
FOR j=0L, N_TAGS(tr_str) - 1L DO BEGIN                                $
  jstr   = STRTRIM(j,2L)                                            & $
  IF (j LT 10L) THEN mform = mfor0 ELSE mform = mfor1               & $
  strg   = spref[0]+jstr[0]+ssuff[0]                                & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  PRINT,FORMAT=mform,strg[0],avbvec

spref = 'bmag'
ssuff = '   = ['
mfor0 = '(a11,f8.5,"]")'
mfor1 = '(a12,f8.5,"]")'
FOR j=0L, N_TAGS(tr_str) - 1L DO BEGIN                                $
  jstr   = STRTRIM(j,2L)                                            & $
  IF (j LT 10L) THEN mform = mfor0 ELSE mform = mfor1               & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  strg   = spref[0]+jstr[0]+ssuff[0]                                & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  PRINT,FORMAT=mform,strg[0],avgbm

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}
dummy1  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(1)}
dummy2  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(2)}
dummy3  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(3)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;       7.0       5.0      60.0     120.0
print, hfc0, format='(";",8f10.1)'
;      20.0      30.0     200.0     200.0


vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

vector_mv_plot,DATE=date,MYMAG=dummy1,FCUTOFF=[lfc0[1],hfc0[1]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

vector_mv_plot,DATE=date,MYMAG=dummy2,FCUTOFF=[lfc0[2],hfc0[2]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

vector_mv_plot,DATE=date,MYMAG=dummy3,FCUTOFF=[lfc0[3],hfc0[3]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi


;-----------------------------------------------------------------------------------------
; => For  7 Hz < f < 20 Hz  at  2000-02-11/23:33:56.4910
;-----------------------------------------------------------------------------------------
;Plot Index Range: 340-799
;Plot Range: 23:33:56.6723-23:33:56.9171
;The angle between DC-Field and the k-vector is :
;       58.641 +/- 1.729 degrees
;The eigenvalues ratios are:
;       4.1574278       1.8331762
;The Minimum Variance eigenvector is:
;<-0.47142,-0.86624, 0.16553> +/- < 0.13347,-0.05329, 0.10126>
;
;Plot Index Range: 1319-1534
;Plot Range: 23:33:57.1945-23:33:57.3091
;The angle between DC-Field and the k-vector is :
;       79.089 +/- 0.968 degrees
;The eigenvalues ratios are:
;       18.300543       1.5197602
;The Minimum Variance eigenvector is:
;< 0.25824, 0.25999,-0.93044> +/- <-0.05620, 0.07745, 0.00604>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:33:57.1945',prefd[0]+'23:33:57.3091'])
kvec0   = [ 0.25824, 0.25999,-0.93044]
dkvec0  = ABS([-0.05620, 0.07745, 0.00604])
elam0   = [18.300543,1.5197602]
bvec0   = [ 0.47839,-0.87323, 0.09219]
bmag0   = [16.01923]

tags    = ['t0']
tr_str  = CREATE_STRUCT(tags,tr0)
kv_str  = CREATE_STRUCT(tags,kvec0)
dkv_str = CREATE_STRUCT(tags,dkvec0)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  7 Hz < f < 20 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:57.1945-23:33:57.3091      0.258      0.260     -0.930      0.478     -0.873      0.092     16.019

vswu   = [-528.007,-53.383,3.184]         ; => My 3DP estimates (km/s) For 2000-02-11/23:33:56.4910
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  7 Hz < f < 20 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:57.1945-23:33:57.3091    100.910     79.090    122.938     57.062    106.778     73.222

theta_kb0211_07_20   = DBLARR(nn)
theta_kn0211_07_20   = DBLARR(nn)
theta_kv0211_07_20   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_07_20[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_07_20[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_07_20[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_07_20[j]),  $
                     REFORM(theta_kn0211_07_20[j]),$
                     REFORM(theta_kv0211_07_20[j])
;
; => For  7 Hz < f < 20 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:57.1945-23:33:57.3091     79.090     57.062     73.222

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_07_20
PRINT,FORMAT=tkbf,theta_kn0211_07_20
PRINT,FORMAT=tkbf,theta_kv0211_07_20

theta_kb0211_07_20 = [79.09]
theta_kn0211_07_20 = [57.06]
theta_kv0211_07_20 = [73.22]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For  5 Hz < f < 30 Hz  at  2000-02-11/23:33:56.4910
;-----------------------------------------------------------------------------------------
;Plot Index Range: 470-731
;Plot Range: 23:33:56.7417-23:33:56.8809
;The angle between DC-Field and the k-vector is :
;       44.522 +/- 0.781 degrees
;The eigenvalues ratios are:
;       22.678361       1.9369928
;The Minimum Variance eigenvector is:
;<-0.24222,-0.97005, 0.01833> +/- <-0.06477, 0.01693, 0.04009>
;
;Plot Index Range: 1560-1812
;Plot Range: 23:33:57.3230-23:33:57.4574
;The angle between DC-Field and the k-vector is :
;       5.809 +/- 0.835 degrees
;The eigenvalues ratios are:
;       20.717787       2.1567536
;The Minimum Variance eigenvector is:
;<-0.48803, 0.84713,-0.21023> +/- < 0.06356, 0.02592,-0.04312>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:33:56.7417',prefd[0]+'23:33:56.8809'])
tr1     = time_double([prefd[0]+'23:33:57.3230',prefd[0]+'23:33:57.4574'])

kvec0   = [-0.24222,-0.97005, 0.01833]
kvec1   = [-0.48803, 0.84713,-0.21023]

dkvec0  = ABS([-0.06477, 0.01693, 0.04009])
dkvec1  = ABS([ 0.06356, 0.02592,-0.04312])

elam0   = [22.678361,1.9369928]
elam1   = [20.717787,2.1567536]

bvec0   = [ 0.50215,-0.85842, 0.10389]
bvec1   = [ 0.49012,-0.86459, 0.11043]
bmag0   = [15.89010]
bmag1   = [16.36391]

tags    = ['t0','t1']
tr_str  = CREATE_STRUCT(tags,tr0,tr1)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1)
nn      = N_TAGS(tr_str)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  5 Hz < f < 30 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:56.7417-23:33:56.8809     -0.242     -0.970      0.018      0.502     -0.858      0.104     15.890
;   23:33:57.3230-23:33:57.4574     -0.488      0.847     -0.210      0.490     -0.865      0.110     16.364

vswu   = [-528.007,-53.383,3.184]         ; => My 3DP estimates (km/s) For 2000-02-11/23:33:56.4910
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  5 Hz < f < 30 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:56.7417-23:33:56.8809     44.522    135.478     49.309    130.691     70.204    109.796
;   23:33:57.3230-23:33:57.4574    174.170      5.830     90.377     89.623     66.480    113.520

theta_kb0211_05_30   = DBLARR(nn)
theta_kn0211_05_30   = DBLARR(nn)
theta_kv0211_05_30   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_05_30[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_05_30[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_05_30[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_05_30[j]),  $
                     REFORM(theta_kn0211_05_30[j]),$
                     REFORM(theta_kv0211_05_30[j])
;
; => For  5 Hz < f < 30 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:56.7417-23:33:56.8809     44.522     49.309     70.204
;   23:33:57.3230-23:33:57.4574      5.830     89.623     66.480

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_05_30
PRINT,FORMAT=tkbf,theta_kn0211_05_30
PRINT,FORMAT=tkbf,theta_kv0211_05_30

theta_kb0211_05_30 = [44.52, 5.83]
theta_kn0211_05_30 = [49.31,89.62]
theta_kv0211_05_30 = [70.20,66.48]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For  60 Hz < f < 200 Hz  at  2000-02-11/23:33:56.4910
;-----------------------------------------------------------------------------------------
;Plot Index Range: 674-1226
;Plot Range: 23:33:56.8505-23:33:57.1449
;The angle between DC-Field and the k-vector is :
;       10.125 +/- 2.651 degrees
;The eigenvalues ratios are:
;       2.4378552       1.9049696
;The Minimum Variance eigenvector is:
;< 0.62766,-0.77834, 0.01541> +/- <-0.13634,-0.11320,-0.16441>
;
;Plot Index Range: 774-879
;Plot Range: 23:33:56.9038-23:33:56.9598
;The angle between DC-Field and the k-vector is :
;       87.757 +/- 1.804 degrees
;The eigenvalues ratios are:
;       11.616526       1.2926927
;The Minimum Variance eigenvector is:
;< 0.87950, 0.42115,-0.22159> +/- <-0.05850, 0.05444,-0.12872>
;
;Plot Index Range: 774-849
;Plot Range: 23:33:56.9038-23:33:56.9438
;The angle between DC-Field and the k-vector is :
;       81.114 +/- 1.528 degrees
;The eigenvalues ratios are:
;       20.958997       1.2709385
;The Minimum Variance eigenvector is:
;<-0.93012,-0.31953, 0.18107> +/- < 0.03821,-0.11468,-0.00611>
;
;Plot Index Range: 924-999
;Plot Range: 23:33:56.9838-23:33:57.0238
;The angle between DC-Field and the k-vector is :
;       81.079 +/- 1.424 degrees
;The eigenvalues ratios are:
;       23.848992       3.4184175
;The Minimum Variance eigenvector is:
;<-0.05634, 0.03255,-0.99788> +/- <-0.08093, 0.05146, 0.00625>
;
;Plot Index Range: 1120-1192
;Plot Range: 23:33:57.0883-23:33:57.1267
;The angle between DC-Field and the k-vector is :
;       24.359 +/- 2.247 degrees
;The eigenvalues ratios are:
;       11.064843       1.9726236
;The Minimum Variance eigenvector is:
;< 0.80946,-0.58706, 0.01178> +/- <-0.09166,-0.12595, 0.02162>
;
;Plot Index Range: 1138-1192
;Plot Range: 23:33:57.0979-23:33:57.1267
;The angle between DC-Field and the k-vector is :
;       23.004 +/- 1.735 degrees
;The eigenvalues ratios are:
;       22.530403       1.9510260
;The Minimum Variance eigenvector is:
;< 0.79120,-0.61141,-0.01346> +/- <-0.06964,-0.09060, 0.02204>
;
;Plot Index Range: 1251-1308
;Plot Range: 23:33:57.1582-23:33:57.1886
;The angle between DC-Field and the k-vector is :
;       87.789 +/- 1.425 degrees
;The eigenvalues ratios are:
;       30.835012       1.9016011
;The Minimum Variance eigenvector is:
;< 0.52006,-0.82175, 0.23295> +/- <-0.07314,-0.05587,-0.03380>
;
;Plot Index Range: 1567-1629
;Plot Range: 23:33:57.3267-23:33:57.3598
;The angle between DC-Field and the k-vector is :
;       57.298 +/- 2.265 degrees
;The eigenvalues ratios are:
;       12.407574       3.0307718
;The Minimum Variance eigenvector is:
;< 0.74656,-0.60278, 0.28161> +/- <-0.08466,-0.11486,-0.02144>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:33:56.9038',prefd[0]+'23:33:56.9438'])
tr1     = time_double([prefd[0]+'23:33:56.9838',prefd[0]+'23:33:57.0238'])
tr2     = time_double([prefd[0]+'23:33:57.0979',prefd[0]+'23:33:57.1267'])
tr3     = time_double([prefd[0]+'23:33:57.1582',prefd[0]+'23:33:57.1886'])
tr4     = time_double([prefd[0]+'23:33:57.3267',prefd[0]+'23:33:57.3598'])

kvec0   = [-0.93012,-0.31953, 0.18107]
kvec1   = [-0.05634, 0.03255,-0.99788]
kvec2   = [ 0.79120,-0.61141,-0.01346]
kvec3   = [ 0.52006,-0.82175, 0.23295]
kvec4   = [ 0.74656,-0.60278, 0.28161]

dkvec0  = ABS([ 0.03821,-0.11468,-0.00611])
dkvec1  = ABS([-0.08093, 0.05146, 0.00625])
dkvec2  = ABS([-0.06964,-0.09060, 0.02204])
dkvec3  = ABS([-0.07314,-0.05587,-0.03380])
dkvec4  = ABS([-0.08466,-0.11486,-0.02144])

elam0   = [20.958997,1.2709385]
elam1   = [23.848992,3.4184175]
elam2   = [22.530403,1.9510260]
elam3   = [30.835012,1.9016011]
elam4   = [12.407574,3.0307718]

bvec0   = [ 0.48246,-0.87155, 0.08731]
bvec1   = [ 0.50117,-0.85965, 0.09906]
bvec2   = [ 0.49845,-0.86243, 0.08810]
bvec3   = [ 0.49350,-0.86575, 0.08321]
bvec4   = [ 0.48063,-0.87036, 0.10700]
bmag0   = [15.00932]
bmag1   = [15.01967]
bmag2   = [14.34922]
bmag3   = [13.98559]
bmag4   = [17.17220]

tags    = ['t0','t1','t2','t3','t4']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4)
nn      = N_TAGS(tr_str)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  60 Hz < f < 200 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:56.9038-23:33:56.9438     -0.930     -0.320      0.181      0.482     -0.872      0.087     15.009
;   23:33:56.9838-23:33:57.0238     -0.056      0.033     -0.998      0.501     -0.860      0.099     15.020
;   23:33:57.0979-23:33:57.1267      0.791     -0.611     -0.013      0.498     -0.862      0.088     14.349
;   23:33:57.1582-23:33:57.1886      0.520     -0.822      0.233      0.494     -0.866      0.083     13.986
;   23:33:57.3267-23:33:57.3598      0.747     -0.603      0.282      0.481     -0.870      0.107     17.172

vswu   = [-528.007,-53.383,3.184]         ; => My 3DP estimates (km/s) For 2000-02-11/23:33:56.4910
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  60 Hz < f < 200 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:56.9038-23:33:56.9438     98.885     81.115      8.715    171.285     16.542    163.458
;   23:33:56.9838-23:33:57.0238     98.921     81.079    100.575     79.425     87.318     92.682
;   23:33:57.0979-23:33:57.1267     23.003    156.997    114.265     65.735    136.532     43.468
;   23:33:57.1582-23:33:57.1886      9.080    170.920     91.584     88.416    115.681     64.319
;   23:33:57.3267-23:33:57.3598     23.994    156.006    108.175     71.825    132.878     47.122

theta_kb0211_60_200   = DBLARR(nn)
theta_kn0211_60_200   = DBLARR(nn)
theta_kv0211_60_200   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_60_200[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_60_200[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_60_200[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_60_200[j]),  $
                     REFORM(theta_kn0211_60_200[j]),$
                     REFORM(theta_kv0211_60_200[j])
;
; => For  60 Hz < f < 200 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:56.9038-23:33:56.9438     81.115      8.715     16.542
;   23:33:56.9838-23:33:57.0238     81.079     79.425     87.318
;   23:33:57.0979-23:33:57.1267     23.003     65.735     43.468
;   23:33:57.1582-23:33:57.1886      9.080     88.416     64.319
;   23:33:57.3267-23:33:57.3598     23.994     71.825     47.122

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_60_200
PRINT,FORMAT=tkbf,theta_kn0211_60_200
PRINT,FORMAT=tkbf,theta_kv0211_60_200

theta_kb0211_60_200 = [81.12,81.08,23.00, 9.08,23.99]
theta_kn0211_60_200 = [ 8.71,79.43,65.73,88.42,71.82]
theta_kv0211_60_200 = [16.54,87.32,43.47,64.32,47.12]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For  120 Hz < f < 200 Hz  at  2000-02-11/23:33:56.4910
;-----------------------------------------------------------------------------------------
;Plot Index Range: 985-1063
;Plot Range: 23:33:57.0163-23:33:57.0579
;The angle between DC-Field and the k-vector is :
;       24.107 +/- 11.524 degrees
;The eigenvalues ratios are:
;       1.7494309       4.3638811
;The Minimum Variance eigenvector is:
;< 0.28598,-0.92547,-0.24845> +/- <-0.36045,-0.02279,-0.33000>
;
;Plot Index Range: 994-1018
;Plot Range: 23:33:57.0211-23:33:57.0339
;The angle between DC-Field and the k-vector is :
;       85.918 +/- 5.143 degrees
;The eigenvalues ratios are:
;       7.2592971       5.1590881
;The Minimum Variance eigenvector is:
;< 0.00859, 0.20491, 0.97874> +/- <-0.14052, 0.18455,-0.03740>
;
;Plot Index Range: 1056-1096
;Plot Range: 23:33:57.0542-23:33:57.0755
;The angle between DC-Field and the k-vector is :
;       80.591 +/- 2.909 degrees
;The eigenvalues ratios are:
;       11.860285       3.9235154
;The Minimum Variance eigenvector is:
;< 0.60726,-0.79446,-0.00831> +/- <-0.12768,-0.09759,-0.00016>
;
;Plot Index Range: 1241-1276
;Plot Range: 23:33:57.1529-23:33:57.1715
;The angle between DC-Field and the k-vector is :
;       56.661 +/- 2.153 degrees
;The eigenvalues ratios are:
;       22.780190       2.3577605
;The Minimum Variance eigenvector is:
;< 0.46846,-0.66102, 0.58618> +/- <-0.01944, 0.07423, 0.09924>
;
;Plot Index Range: 1313-1394
;Plot Range: 23:33:57.1913-23:33:57.2345
;The angle between DC-Field and the k-vector is :
;       17.443 +/- 1.678 degrees
;The eigenvalues ratios are:
;       16.505698       2.5696005
;The Minimum Variance eigenvector is:
;< 0.32450,-0.93156,-0.16402> +/- <-0.10978,-0.03304,-0.02954>
;
;Plot Index Range: 1343-1394
;Plot Range: 23:33:57.2073-23:33:57.2345
;The angle between DC-Field and the k-vector is :
;       17.385 +/- 1.274 degrees
;The eigenvalues ratios are:
;       42.398469       2.2102617
;The Minimum Variance eigenvector is:
;< 0.38544,-0.90111,-0.19859> +/- <-0.07587,-0.02771,-0.02153>
;
;Plot Index Range: 1435-1463
;Plot Range: 23:33:57.2563-23:33:57.2713
;The angle between DC-Field and the k-vector is :
;       79.544 +/- 1.395 degrees
;The eigenvalues ratios are:
;       64.419407       2.9166148
;The Minimum Variance eigenvector is:
;< 0.41348,-0.90874,-0.05678> +/- <-0.06507,-0.02791,-0.02710>
;
;Plot Index Range: 1559-1641
;Plot Range: 23:33:57.3225-23:33:57.3662
;The angle between DC-Field and the k-vector is :
;       85.095 +/- 1.989 degrees
;The eigenvalues ratios are:
;       12.165603       3.0211635
;The Minimum Variance eigenvector is:
;< 0.74710,-0.61454, 0.25333> +/- <-0.07771,-0.10716,-0.03077>
;
;Plot Index Range: 1599-1641
;Plot Range: 23:33:57.3438-23:33:57.3662
;The angle between DC-Field and the k-vector is :
;       89.886 +/- 1.239 degrees
;The eigenvalues ratios are:
;       54.159185       2.9471408
;The Minimum Variance eigenvector is:
;< 0.73419,-0.59849, 0.32058> +/- <-0.04318,-0.05946,-0.01213>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:33:57.0542',prefd[0]+'23:33:57.0755'])
tr1     = time_double([prefd[0]+'23:33:57.1529',prefd[0]+'23:33:57.1715'])
tr2     = time_double([prefd[0]+'23:33:57.2073',prefd[0]+'23:33:57.2345'])
tr3     = time_double([prefd[0]+'23:33:57.2563',prefd[0]+'23:33:57.2713'])
tr4     = time_double([prefd[0]+'23:33:57.3438',prefd[0]+'23:33:57.3662'])

kvec0   = [ 0.60726,-0.79446,-0.00831]
kvec1   = [ 0.46846,-0.66102, 0.58618]
kvec2   = [ 0.38544,-0.90111,-0.19859]
kvec3   = [ 0.41348,-0.90874,-0.05678]
kvec4   = [ 0.73419,-0.59849, 0.32058]

dkvec0  = ABS([-0.12768,-0.09759,-0.00016])
dkvec1  = ABS([-0.01944, 0.07423, 0.09924])
dkvec2  = ABS([-0.07587,-0.02771,-0.02153])
dkvec3  = ABS([-0.06507,-0.02791,-0.02710])
dkvec4  = ABS([-0.04318,-0.05946,-0.01213])

elam0   = [11.860285,3.9235154]
elam1   = [22.780190,2.3577605]
elam2   = [42.398469,2.2102617]
elam3   = [64.419407,2.9166148]
elam4   = [54.159185,2.9471408]

bvec0   = [ 0.50294,-0.85896, 0.09608]
bvec1   = [ 0.49439,-0.86517, 0.08400]
bvec2   = [ 0.48648,-0.86958, 0.08456]
bvec3   = [ 0.47552,-0.87460, 0.09458]
bvec4   = [ 0.48426,-0.86814, 0.10871]
bmag0   = [14.71856]
bmag1   = [14.04857]
bmag2   = [14.47077]
bmag3   = [16.61083]
bmag4   = [16.84065]

tags    = ['t0','t1','t2','t3','t4']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4)
nn      = N_TAGS(tr_str)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  120 Hz < f < 200 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:57.0542-23:33:57.0755      0.607     -0.794     -0.008      0.503     -0.859      0.096     14.719
;   23:33:57.1529-23:33:57.1715      0.468     -0.661      0.586      0.494     -0.865      0.084     14.049
;   23:33:57.2073-23:33:57.2345      0.385     -0.901     -0.199      0.486     -0.870      0.085     14.471
;   23:33:57.2563-23:33:57.2713      0.413     -0.909     -0.057      0.476     -0.875      0.095     16.611
;   23:33:57.3438-23:33:57.3662      0.734     -0.598      0.321      0.484     -0.868      0.109     16.841

vswu   = [-528.007,-53.383,3.184]         ; => My 3DP estimates (km/s) For 2000-02-11/23:33:56.4910
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  120 Hz < f < 200 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:57.0542-23:33:57.0755      9.238    170.762     99.671     80.329    121.622     58.378
;   23:33:57.1529-23:33:57.1715     31.490    148.510     88.777     91.223    113.333     66.667
;   23:33:57.2073-23:33:57.2345     17.387    162.613     88.246     91.754    107.099     72.901
;   23:33:57.2563-23:33:57.2713      9.586    170.414     87.667     92.333    108.682     71.318
;   23:33:57.3438-23:33:57.3662     24.499    155.501    107.138     72.862    131.938     48.062

theta_kb0211_120_200   = DBLARR(nn)
theta_kn0211_120_200   = DBLARR(nn)
theta_kv0211_120_200   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_120_200[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_120_200[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_120_200[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_120_200[j]),  $
                     REFORM(theta_kn0211_120_200[j]),$
                     REFORM(theta_kv0211_120_200[j])
;
; => For  120 Hz < f < 200 Hz  at  2000-02-11/23:33:56.4910
;
;   23:33:57.0542-23:33:57.0755      9.238     80.329     58.378
;   23:33:57.1529-23:33:57.1715     31.490     88.777     66.667
;   23:33:57.2073-23:33:57.2345     17.387     88.246     72.901
;   23:33:57.2563-23:33:57.2713      9.586     87.667     71.318
;   23:33:57.3438-23:33:57.3662     24.499     72.862     48.062

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_120_200
PRINT,FORMAT=tkbf,theta_kn0211_120_200
PRINT,FORMAT=tkbf,theta_kv0211_120_200

theta_kb0211_120_200 = [ 9.24,31.49,17.39, 9.59,24.50]
theta_kn0211_120_200 = [80.33,88.78,88.25,87.67,72.86]
theta_kv0211_120_200 = [58.38,66.67,72.90,71.32,48.06]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------

jj      = 1L
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}
dummy1  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(1)}
dummy2  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(2)}
dummy3  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(3)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;       7.0       5.0      60.0     120.0
print, hfc0, format='(";",8f10.1)'
;      20.0      30.0     200.0     200.0


vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

vector_mv_plot,DATE=date,MYMAG=dummy1,FCUTOFF=[lfc0[1],hfc0[1]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

vector_mv_plot,DATE=date,MYMAG=dummy2,FCUTOFF=[lfc0[2],hfc0[2]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

vector_mv_plot,DATE=date,MYMAG=dummy3,FCUTOFF=[lfc0[3],hfc0[3]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

;-----------------------------------------------------------------------------------------
; => For  7 Hz < f < 20 Hz  at  2000-02-11/23:33:58.3510
;-----------------------------------------------------------------------------------------
;Plot Index Range: 0-841
;Plot Range: 23:33:58.3510-23:33:58.7995
;The angle between DC-Field and the k-vector is :
;       84.229 +/- 0.426 degrees
;The eigenvalues ratios are:
;       23.480970       1.9075689
;The Minimum Variance eigenvector is:
;<-0.72774,-0.46936, 0.50010> +/- < 0.00982, 0.03334, 0.04558>
;
;Plot Index Range: 1302-1779
;Plot Range: 23:33:59.0454-23:33:59.2998
;The angle between DC-Field and the k-vector is :
;       35.922 +/- 0.597 degrees
;The eigenvalues ratios are:
;       21.317289       1.0233540
;The Minimum Variance eigenvector is:
;<-0.67979, 0.59794, 0.42468> +/- <-0.04189, 0.00028,-0.06745>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:33:58.3510',prefd[0]+'23:33:58.7995'])
tr1     = time_double([prefd[0]+'23:33:59.0454',prefd[0]+'23:33:59.2998'])

kvec0   = [-0.72774,-0.46936, 0.50010]
kvec1   = [-0.67979, 0.59794, 0.42468]

dkvec0  = ABS([ 0.00982, 0.03334, 0.04558])
dkvec1  = ABS([-0.04189, 0.00028,-0.06745])

elam0   = [23.480970,1.9075689]
elam1   = [21.317289,1.0233540]

bvec0   = [ 0.49487,-0.86162, 0.11254]
bvec1   = [ 0.48708,-0.86813, 0.09514]
bmag0   = [14.70694]
bmag1   = [15.88742]

tags    = ['t0','t1']
tr_str  = CREATE_STRUCT(tags,tr0,tr1)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1)
nn      = N_TAGS(tr_str)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  7 Hz < f < 20 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.3510-23:33:58.7995     -0.728     -0.469      0.500      0.495     -0.862      0.113     14.707
;   23:33:59.0454-23:33:59.2998     -0.680      0.598      0.425      0.487     -0.868      0.095     15.887

vswu   = [-563.033,-75.287,7.363]         ; => My 3DP estimates (km/s) For 2000-02-11/23:33:58.3510
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  7 Hz < f < 20 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.3510-23:33:58.7995     84.229     95.771     18.072    161.928     37.820    142.180
;   23:33:59.0454-23:33:59.2998    144.076     35.924     65.774    114.226     53.130    126.870

theta_kb0211_07_20_2   = DBLARR(nn)
theta_kn0211_07_20_2   = DBLARR(nn)
theta_kv0211_07_20_2   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_07_20_2[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_07_20_2[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_07_20_2[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_07_20_2[j]),  $
                     REFORM(theta_kn0211_07_20_2[j]),$
                     REFORM(theta_kv0211_07_20_2[j])
;
; => For  7 Hz < f < 20 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.3510-23:33:58.7995     84.229     18.072     37.820
;   23:33:59.0454-23:33:59.2998     35.924     65.774     53.130

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_07_20_2
PRINT,FORMAT=tkbf,theta_kn0211_07_20_2
PRINT,FORMAT=tkbf,theta_kv0211_07_20_2

theta_kb0211_07_20_2 = [84.23,35.92]
theta_kn0211_07_20_2 = [18.07,65.77]
theta_kv0211_07_20_2 = [37.82,53.13]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For  5 Hz < f < 30 Hz  at  2000-02-11/23:33:58.3510
;-----------------------------------------------------------------------------------------
;Plot Index Range: 255-765
;Plot Range: 23:33:58.4870-23:33:58.7590
;The angle between DC-Field and the k-vector is :
;       86.188 +/- 0.459 degrees
;The eigenvalues ratios are:
;       32.628216       2.2558137
;The Minimum Variance eigenvector is:
;< 0.76785, 0.46050,-0.44536> +/- <-0.03356, 0.02193,-0.03519>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:33:58.4870',prefd[0]+'23:33:58.7590'])
kvec0   = [ 0.76785, 0.46050,-0.44536]
dkvec0  = ABS([-0.03356, 0.02193,-0.03519])
elam0   = [32.628216,2.2558137]
bvec0   = [ 0.49510,-0.86154, 0.11205]
bmag0   = [14.22236]

tags    = ['t0']
tr_str  = CREATE_STRUCT(tags,tr0)
kv_str  = CREATE_STRUCT(tags,kvec0)
dkv_str = CREATE_STRUCT(tags,dkvec0)
nn      = N_TAGS(tr_str)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  5 Hz < f < 30 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.4870-23:33:58.7590      0.768      0.461     -0.445      0.495     -0.862      0.112     14.222

vswu   = [-563.033,-75.287,7.363]         ; => My 3DP estimates (km/s) For 2000-02-11/23:33:58.3510
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  5 Hz < f < 30 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.4870-23:33:58.7590     93.812     86.188    165.795     14.205    145.875     34.125

theta_kb0211_05_30_2   = DBLARR(nn)
theta_kn0211_05_30_2   = DBLARR(nn)
theta_kv0211_05_30_2   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_05_30_2[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_05_30_2[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_05_30_2[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_05_30_2[j]),  $
                     REFORM(theta_kn0211_05_30_2[j]),$
                     REFORM(theta_kv0211_05_30_2[j])
;
; => For  5 Hz < f < 30 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.4870-23:33:58.7590     86.188     14.205     34.125

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_05_30_2
PRINT,FORMAT=tkbf,theta_kn0211_05_30_2
PRINT,FORMAT=tkbf,theta_kv0211_05_30_2

theta_kb0211_05_30_2 = [86.19]
theta_kn0211_05_30_2 = [14.20]
theta_kv0211_05_30_2 = [34.13]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
; => For  60 Hz < f < 200 Hz  at  2000-02-11/23:33:58.3510
;-----------------------------------------------------------------------------------------
;Plot Index Range: 140-245
;Plot Range: 23:33:58.4257-23:33:58.4817
;The angle between DC-Field and the k-vector is :
;       6.202 +/- 1.531 degrees
;The eigenvalues ratios are:
;       15.408872       1.8986598
;The Minimum Variance eigenvector is:
;< 0.59626,-0.78229, 0.18025> +/- <-0.09580,-0.07317,-0.00067>
;
;Plot Index Range: 185-243
;Plot Range: 23:33:58.4497-23:33:58.4806
;The angle between DC-Field and the k-vector is :
;       85.693 +/- 1.663 degrees
;The eigenvalues ratios are:
;       22.771399       1.6280719
;The Minimum Variance eigenvector is:
;< 0.63228,-0.75146, 0.18851> +/- <-0.09047,-0.07470, 0.00568>
;
;Plot Index Range: 694-1594
;Plot Range: 23:33:58.7211-23:33:59.2011
;The angle between DC-Field and the k-vector is :
;       7.434 +/- 0.505 degrees
;The eigenvalues ratios are:
;       16.245287       1.8497493
;The Minimum Variance eigenvector is:
;< 0.58076,-0.81360, 0.02775> +/- <-0.05526,-0.03976,-0.00913>
;
;Plot Index Range: 992-1061
;Plot Range: 23:33:58.8801-23:33:58.9169
;The angle between DC-Field and the k-vector is :
;       88.648 +/- 1.071 degrees
;The eigenvalues ratios are:
;       44.036298       1.8230859
;The Minimum Variance eigenvector is:
;< 0.57048,-0.82100,-0.02238> +/- <-0.06390,-0.04410,-0.01097>
;
;Plot Index Range: 1067-1187
;Plot Range: 23:33:58.9201-23:33:58.9841
;The angle between DC-Field and the k-vector is :
;       10.751 +/- 1.100 degrees
;The eigenvalues ratios are:
;       24.742561       2.0503321
;The Minimum Variance eigenvector is:
;< 0.63156,-0.77411, 0.04344> +/- <-0.06840,-0.05657,-0.01372>
;
;Plot Index Range: 1213-1291
;Plot Range: 23:33:58.9979-23:33:59.0395
;The angle between DC-Field and the k-vector is :
;       85.514 +/- 1.529 degrees
;The eigenvalues ratios are:
;       20.190239       1.8138823
;The Minimum Variance eigenvector is:
;< 0.61795,-0.78239, 0.07747> +/- <-0.08892,-0.07068,-0.00447>
;
;Plot Index Range: 1349-1490
;Plot Range: 23:33:59.0705-23:33:59.1457
;The angle between DC-Field and the k-vector is :
;       3.233 +/- 0.911 degrees
;The eigenvalues ratios are:
;       30.241171       1.9715918
;The Minimum Variance eigenvector is:
;< 0.43778,-0.89217, 0.11129> +/- <-0.06908,-0.03523,-0.01065>
;
;Plot Index Range: 1355-1467
;Plot Range: 23:33:59.0737-23:33:59.1334
;The angle between DC-Field and the k-vector is :
;       86.247 +/- 0.888 degrees
;The eigenvalues ratios are:
;       39.462053       1.9879186
;The Minimum Variance eigenvector is:
;< 0.42935,-0.89678, 0.10700> +/- <-0.06414,-0.03186,-0.00967>
;
;Plot Index Range: 1917-1983
;Plot Range: 23:33:59.3734-23:33:59.4086
;The angle between DC-Field and the k-vector is :
;       45.169 +/- 1.247 degrees
;The eigenvalues ratios are:
;       34.424645       2.4125351
;The Minimum Variance eigenvector is:
;< 0.77918,-0.62678, 0.00592> +/- <-0.05381,-0.06693,-0.00329>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:33:58.4497',prefd[0]+'23:33:58.4806'])
tr1     = time_double([prefd[0]+'23:33:58.8801',prefd[0]+'23:33:58.9169'])
tr2     = time_double([prefd[0]+'23:33:58.9201',prefd[0]+'23:33:58.9841'])
tr3     = time_double([prefd[0]+'23:33:58.9979',prefd[0]+'23:33:59.0395'])
tr4     = time_double([prefd[0]+'23:33:59.0737',prefd[0]+'23:33:59.1334'])
tr5     = time_double([prefd[0]+'23:33:59.3734',prefd[0]+'23:33:59.4086'])

kvec0   = [ 0.63228,-0.75146, 0.18851]
kvec1   = [ 0.57048,-0.82100,-0.02238]
kvec2   = [ 0.63156,-0.77411, 0.04344]
kvec3   = [ 0.61795,-0.78239, 0.07747]
kvec4   = [ 0.42935,-0.89678, 0.10700]
kvec5   = [ 0.77918,-0.62678, 0.00592]

dkvec0  = ABS([-0.09047,-0.07470, 0.00568])
dkvec1  = ABS([-0.06390,-0.04410,-0.01097])
dkvec2  = ABS([-0.06840,-0.05657,-0.01372])
dkvec3  = ABS([-0.08892,-0.07068,-0.00447])
dkvec4  = ABS([-0.06414,-0.03186,-0.00967])
dkvec5  = ABS([-0.05381,-0.06693,-0.00329])

elam0   = [22.771399,1.6280719]
elam1   = [44.036298,1.8230859]
elam2   = [24.742561,2.0503321]
elam3   = [20.190239,1.8138823]
elam4   = [39.462053,1.9879186]
elam5   = [34.424645,2.4125351]

bvec0   = [ 0.49410,-0.86199, 0.11329]
bvec1   = [ 0.49085,-0.86483, 0.10546]
bvec2   = [ 0.48431,-0.86772, 0.11180]
bvec3   = [ 0.48698,-0.86727, 0.10335]
bvec4   = [ 0.48762,-0.86707, 0.10205]
bvec5   = [ 0.48872,-0.86976, 0.06830]
bmag0   = [15.02517]
bmag1   = [15.85908]
bmag2   = [15.64792]
bmag3   = [15.81611]
bmag4   = [16.21382]
bmag5   = [15.02834]

tags    = ['t0','t1','t2','t3','t4','t5']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5)
nn      = N_TAGS(tr_str)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  60 Hz < f < 200 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.4497-23:33:58.4806      0.632     -0.751      0.189      0.494     -0.862      0.113     15.025
;   23:33:58.8801-23:33:58.9169      0.570     -0.821     -0.022      0.491     -0.865      0.105     15.859
;   23:33:58.9201-23:33:58.9841      0.632     -0.774      0.043      0.484     -0.868      0.112     15.648
;   23:33:58.9979-23:33:59.0395      0.618     -0.782      0.077      0.487     -0.867      0.103     15.816
;   23:33:59.0737-23:33:59.1334      0.429     -0.897      0.107      0.488     -0.867      0.102     16.214
;   23:33:59.3734-23:33:59.4086      0.779     -0.627      0.006      0.489     -0.870      0.068     15.028

vswu   = [-563.033,-75.287,7.363]         ; => My 3DP estimates (km/s) For 2000-02-11/23:33:58.3510
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  60 Hz < f < 200 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.4497-23:33:58.4806     11.033    168.967     99.565     80.435    121.643     58.357
;   23:33:58.8801-23:33:58.9169      9.000    171.000     97.311     82.689    117.186     62.814
;   23:33:58.9201-23:33:58.9841     10.753    169.247    100.774     79.226    121.519     58.481
;   23:33:58.9979-23:33:59.0395      9.075    170.925     99.439     80.561    120.514     59.486
;   23:33:59.0737-23:33:59.1334      3.757    176.243     86.716     93.284    107.776     72.224
;   23:33:59.3734-23:33:59.4086     22.126    157.874    112.917     67.083    133.559     46.441

theta_kb0211_60_200_2   = DBLARR(nn)
theta_kn0211_60_200_2   = DBLARR(nn)
theta_kv0211_60_200_2   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_60_200_2[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_60_200_2[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_60_200_2[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_60_200_2[j]),  $
                     REFORM(theta_kn0211_60_200_2[j]),$
                     REFORM(theta_kv0211_60_200_2[j])
;
; => For  60 Hz < f < 200 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.4497-23:33:58.4806     11.033     80.435     58.357
;   23:33:58.8801-23:33:58.9169      9.000     82.689     62.814
;   23:33:58.9201-23:33:58.9841     10.753     79.226     58.481
;   23:33:58.9979-23:33:59.0395      9.075     80.561     59.486
;   23:33:59.0737-23:33:59.1334      3.757     86.716     72.224
;   23:33:59.3734-23:33:59.4086     22.126     67.083     46.441

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_60_200_2
PRINT,FORMAT=tkbf,theta_kn0211_60_200_2
PRINT,FORMAT=tkbf,theta_kv0211_60_200_2

theta_kb0211_60_200_2 = [11.03, 9.00,10.75, 9.08, 3.76,22.13]
theta_kn0211_60_200_2 = [80.43,82.69,79.23,80.56,86.72,67.08]
theta_kv0211_60_200_2 = [58.36,62.81,58.48,59.49,72.22,46.44]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
; => For  120 Hz < f < 200 Hz  at  2000-02-11/23:33:58.3510
;-----------------------------------------------------------------------------------------
;Plot Index Range: 99-288
;Plot Range: 23:33:58.4038-23:33:58.5046
;The angle between DC-Field and the k-vector is :
;       25.626 +/- 0.964 degrees
;The eigenvalues ratios are:
;       20.761596       1.3629859
;The Minimum Variance eigenvector is:
;<-0.29655, 0.80886,-0.50775> +/- <-0.01246,-0.05323,-0.07752>
;
;Plot Index Range: 864-1216
;Plot Range: 23:33:58.8118-23:33:58.9995
;The angle between DC-Field and the k-vector is :
;       25.366 +/- 0.611 degrees
;The eigenvalues ratios are:
;       27.032917       2.4277397
;The Minimum Variance eigenvector is:
;< 0.81619,-0.57349, 0.07028> +/- <-0.03552,-0.05187,-0.01075>
;
;Plot Index Range: 908-1040
;Plot Range: 23:33:58.8353-23:33:58.9057
;The angle between DC-Field and the k-vector is :
;       30.344 +/- 0.304 degrees
;The eigenvalues ratios are:
;       273.51188       2.2635453
;The Minimum Variance eigenvector is:
;< 0.86567,-0.49669, 0.06263> +/- <-0.01240,-0.02206,-0.00358>
;
;Plot Index Range: 912-1039
;Plot Range: 23:33:58.8374-23:33:58.9051
;The angle between DC-Field and the k-vector is :
;       30.321 +/- 0.305 degrees
;The eigenvalues ratios are:
;       281.90511       2.2548164
;The Minimum Variance eigenvector is:
;< 0.86545,-0.49705, 0.06280> +/- <-0.01236,-0.02196,-0.00346>
;
;Plot Index Range: 1039-1131
;Plot Range: 23:33:58.9051-23:33:58.9542
;The angle between DC-Field and the k-vector is :
;       81.692 +/- 0.924 degrees
;The eigenvalues ratios are:
;       44.230854       2.7014728
;The Minimum Variance eigenvector is:
;< 0.76346,-0.64276, 0.06318> +/- <-0.04235,-0.05173,-0.01454>
;
;Plot Index Range: 1154-1191
;Plot Range: 23:33:58.9665-23:33:58.9862
;The angle between DC-Field and the k-vector is :
;       71.051 +/- 1.909 degrees
;The eigenvalues ratios are:
;       26.978841       2.6210763
;The Minimum Variance eigenvector is:
;< 0.74219,-0.66109, 0.11006> +/- <-0.07062,-0.08318,-0.02341>
;
;Plot Index Range: 1208-1273
;Plot Range: 23:33:58.9953-23:33:59.0299
;The angle between DC-Field and the k-vector is :
;       50.182 +/- 1.179 degrees
;The eigenvalues ratios are:
;       38.892673       2.5036579
;The Minimum Variance eigenvector is:
;< 0.76159,-0.61944, 0.19046> +/- <-0.04837,-0.06329,-0.01242>
;
;Plot Index Range: 1313-1660
;Plot Range: 23:33:59.0513-23:33:59.2363
;The angle between DC-Field and the k-vector is :
;       7.107 +/- 0.527 degrees
;The eigenvalues ratios are:
;       36.137017       2.4460774
;The Minimum Variance eigenvector is:
;< 0.37581,-0.92145, 0.09843> +/- <-0.05028,-0.02128,-0.00727>
;
;Plot Index Range: 1313-1571
;Plot Range: 23:33:59.0513-23:33:59.1889
;The angle between DC-Field and the k-vector is :
;       6.995 +/- 0.417 degrees
;The eigenvalues ratios are:
;       75.333808       2.4502042
;The Minimum Variance eigenvector is:
;< 0.37755,-0.91972, 0.10761> +/- <-0.03720,-0.01591,-0.00552>
;
;Plot Index Range: 1352-1571
;Plot Range: 23:33:59.0721-23:33:59.1889
;The angle between DC-Field and the k-vector is :
;       7.472 +/- 0.385 degrees
;The eigenvalues ratios are:
;       103.67217       2.3045400
;The Minimum Variance eigenvector is:
;< 0.37032,-0.92083, 0.12220> +/- <-0.03358,-0.01398,-0.00356>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:33:58.4038',prefd[0]+'23:33:58.5046'])
tr1     = time_double([prefd[0]+'23:33:58.8374',prefd[0]+'23:33:58.9051'])
tr2     = time_double([prefd[0]+'23:33:58.9051',prefd[0]+'23:33:58.9542'])
tr3     = time_double([prefd[0]+'23:33:58.9665',prefd[0]+'23:33:58.9862'])
tr4     = time_double([prefd[0]+'23:33:58.9953',prefd[0]+'23:33:59.0299'])
tr5     = time_double([prefd[0]+'23:33:59.0721',prefd[0]+'23:33:59.1889'])

kvec0   = [-0.29655, 0.80886,-0.50775]
kvec1   = [ 0.86545,-0.49705, 0.06280]
kvec2   = [ 0.76346,-0.64276, 0.06318]
kvec3   = [ 0.74219,-0.66109, 0.11006]
kvec4   = [ 0.76159,-0.61944, 0.19046]
kvec5   = [ 0.37032,-0.92083, 0.12220]

dkvec0  = ABS([-0.01246,-0.05323,-0.07752])
dkvec1  = ABS([-0.01236,-0.02196,-0.00346])
dkvec2  = ABS([-0.04235,-0.05173,-0.01454])
dkvec3  = ABS([-0.07062,-0.08318,-0.02341])
dkvec4  = ABS([-0.04837,-0.06329,-0.01242])
dkvec5  = ABS([-0.03358,-0.01398,-0.00356])

elam0   = [20.761596,1.3629859]
elam1   = [281.90511,2.2548164]
elam2   = [44.230854,2.7014728]
elam3   = [26.978841,2.6210763]
elam4   = [38.892673,2.5036579]
elam5   = [103.67217,2.3045400]

bvec0   = [ 0.49370,-0.86212, 0.11402]
bvec1   = [ 0.49419,-0.86332, 0.10223]
bvec2   = [ 0.48627,-0.86681, 0.11036]
bvec3   = [ 0.48393,-0.86807, 0.11075]
bvec4   = [ 0.48656,-0.86739, 0.10438]
bvec5   = [ 0.48729,-0.86734, 0.10129]
bmag0   = [15.17707]
bmag1   = [15.91070]
bmag2   = [15.70396]
bmag3   = [15.65546]
bmag4   = [15.79353]
bmag5   = [16.20729]

tags    = ['t0','t1','t2','t3','t4','t5']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5)
nn      = N_TAGS(tr_str)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  120 Hz < f < 200 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.4038-23:33:58.5046     -0.297      0.809     -0.508      0.494     -0.862      0.114     15.177
;   23:33:58.8374-23:33:58.9051      0.865     -0.497      0.063      0.494     -0.863      0.102     15.911
;   23:33:58.9051-23:33:58.9542      0.763     -0.643      0.063      0.486     -0.867      0.110     15.704
;   23:33:58.9665-23:33:58.9862      0.742     -0.661      0.110      0.484     -0.868      0.111     15.655
;   23:33:58.9953-23:33:59.0299      0.762     -0.619      0.190      0.487     -0.867      0.104     15.794
;   23:33:59.0721-23:33:59.1889      0.370     -0.921      0.122      0.487     -0.867      0.101     16.207

vswu   = [-563.033,-75.287,7.363]         ; => My 3DP estimates (km/s) For 2000-02-11/23:33:58.3510
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  120 Hz < f < 200 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.4038-23:33:58.5046    154.374     25.626    102.696     77.304     79.622    100.378
;   23:33:58.8374-23:33:58.9051     30.319    149.681    120.681     59.319    142.284     37.716
;   23:33:58.9051-23:33:58.9542     20.712    159.288    110.860     69.140    132.118     47.882
;   23:33:58.9665-23:33:58.9862     19.051    160.949    108.614     71.386    130.281     49.719
;   23:33:58.9953-23:33:59.0299     21.916    158.084    109.711     70.289    132.086     47.914
;   23:33:59.0721-23:33:59.1889      7.473    172.527     82.962     97.038    104.088     75.912

theta_kb0211_120_200_2   = DBLARR(nn)
theta_kn0211_120_200_2   = DBLARR(nn)
theta_kv0211_120_200_2   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_120_200_2[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_120_200_2[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_120_200_2[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_120_200_2[j]),  $
                     REFORM(theta_kn0211_120_200_2[j]),$
                     REFORM(theta_kv0211_120_200_2[j])
;
; => For  120 Hz < f < 200 Hz  at  2000-02-11/23:33:58.3510
;
;   23:33:58.4038-23:33:58.5046     25.626     77.304     79.622
;   23:33:58.8374-23:33:58.9051     30.319     59.319     37.716
;   23:33:58.9051-23:33:58.9542     20.712     69.140     47.882
;   23:33:58.9665-23:33:58.9862     19.051     71.386     49.719
;   23:33:58.9953-23:33:59.0299     21.916     70.289     47.914
;   23:33:59.0721-23:33:59.1889      7.473     82.962     75.912

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_120_200_2
PRINT,FORMAT=tkbf,theta_kn0211_120_200_2
PRINT,FORMAT=tkbf,theta_kv0211_120_200_2

theta_kb0211_120_200_2 = [25.63,30.32,20.71,19.05,21.92, 7.47]
theta_kn0211_120_200_2 = [77.30,59.32,69.14,71.39,70.29,82.96]
theta_kv0211_120_200_2 = [79.62,37.72,47.88,49.72,47.91,75.91]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------

jj      = 2L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}
dummy1  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(1)}
dummy2  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(2)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;       3.0       3.0      30.0
print, hfc0, format='(";",8f10.1)'
;      20.0      30.0     200.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

vector_mv_plot,DATE=date,MYMAG=dummy1,FCUTOFF=[lfc0[1],hfc0[1]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

vector_mv_plot,DATE=date,MYMAG=dummy2,FCUTOFF=[lfc0[2],hfc0[2]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi


;-----------------------------------------------------------------------------------------
; => For  3 Hz < f < 20 Hz  at  2000-02-11/23:34:00.731 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 1511-1877
;Plot Range: 23:34:01.5369-23:34:01.7321
;The angle between DC-Field and the k-vector is :
;       84.121 +/- 0.827 degrees
;The eigenvalues ratios are:
;       15.080181       1.9596324
;The Minimum Variance eigenvector is:
;< 0.54918,-0.06113, 0.83347> +/- <-0.05886,-0.05643, 0.03465>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:34:01.5369',prefd[0]+'23:34:01.7321'])
kvec0   = [ 0.54918,-0.06113, 0.83347]
dkvec0  = ABS([-0.05886,-0.05643, 0.03465])
elam0   = [15.080181,1.9596324]
bvec0   = [ 0.48760,-0.87141, 0.05363]
bmag0   = [16.05295]

tags    = ['t0']
tr_str  = CREATE_STRUCT(tags,tr0)
kv_str  = CREATE_STRUCT(tags,kvec0)
dkv_str = CREATE_STRUCT(tags,dkvec0)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  3 Hz < f < 20 Hz  at  2000-02-11/23:34:00.731 UT
;
;   23:34:01.5369-23:34:01.7321      0.549     -0.061      0.833      0.488     -0.871      0.054     16.053

vswu   = [-576.773,-86.503,3.938]         ; => My 3DP estimates (km/s) For 2000-02-11/23:34:00.731 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  3 Hz < f < 20 Hz  at  2000-02-11/23:34:00.731 UT
;
;   23:34:01.5369-23:34:01.7321     68.546    111.454    105.409     74.591    121.897     58.103

theta_kb0211_03_20   = DBLARR(nn)
theta_kn0211_03_20   = DBLARR(nn)
theta_kv0211_03_20   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_03_20[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_03_20[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_03_20[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_03_20[j]),  $
                     REFORM(theta_kn0211_03_20[j]),$
                     REFORM(theta_kv0211_03_20[j])
;
; => For  3 Hz < f < 20 Hz  at  2000-02-11/23:34:00.731 UT
;
;   23:34:01.5369-23:34:01.7321     68.546     74.591     58.103

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_03_20
PRINT,FORMAT=tkbf,theta_kn0211_03_20
PRINT,FORMAT=tkbf,theta_kv0211_03_20

theta_kb0211_03_20 = [68.55]
theta_kn0211_03_20 = [74.59]
theta_kv0211_03_20 = [58.10]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For  3 Hz < f < 30 Hz  at  2000-02-11/23:34:00.731 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 174-315
;Plot Range: 23:34:00.8238-23:34:00.8990
;The angle between DC-Field and the k-vector is :
;       70.915 +/- 1.520 degrees
;The eigenvalues ratios are:
;       12.069603       1.9974408
;The Minimum Variance eigenvector is:
;< 0.33514,-0.90311,-0.26847> +/- <-0.10803,-0.02169,-0.06188>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:34:00.8238',prefd[0]+'23:34:00.8990'])
kvec0   = [ 0.33514,-0.90311,-0.26847]
dkvec0  = ABS([-0.10803,-0.02169,-0.06188])
elam0   = [12.069603,1.9974408]
bvec0   = [ 0.49938,-0.86576, 0.03284]
bmag0   = [15.01168]

tags    = ['t0']
tr_str  = CREATE_STRUCT(tags,tr0)
kv_str  = CREATE_STRUCT(tags,kvec0)
dkv_str = CREATE_STRUCT(tags,dkvec0)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  3 Hz < f < 30 Hz  at  2000-02-11/23:34:00.731 UT
;
;   23:34:00.8238-23:34:00.8990      0.335     -0.903     -0.268      0.499     -0.866      0.033     15.012

vswu   = [-576.773,-86.503,3.938]         ; => My 3DP estimates (km/s) For 2000-02-11/23:34:00.731 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  3 Hz < f < 30 Hz  at  2000-02-11/23:34:00.731 UT
;
;   23:34:00.8238-23:34:00.8990     19.877    160.123     86.573     93.427    101.496     78.504

theta_kb0211_03_30   = DBLARR(nn)
theta_kn0211_03_30   = DBLARR(nn)
theta_kv0211_03_30   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_03_30[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_03_30[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_03_30[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_03_30[j]),  $
                     REFORM(theta_kn0211_03_30[j]),$
                     REFORM(theta_kv0211_03_30[j])
;
; => For  3 Hz < f < 30 Hz  at  2000-02-11/23:34:00.731 UT
;
;   23:34:00.8238-23:34:00.8990     19.877     86.573     78.504

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_03_30
PRINT,FORMAT=tkbf,theta_kn0211_03_30
PRINT,FORMAT=tkbf,theta_kv0211_03_30

theta_kb0211_03_30 = [19.88]
theta_kn0211_03_30 = [86.57]
theta_kv0211_03_30 = [78.50]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For  30 Hz < f < 200 Hz  at  2000-02-11/23:34:00.731 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 114-153
;Plot Range: 23:34:00.7918-23:34:00.8126
;The angle between DC-Field and the k-vector is :
;       40.399 +/- 2.046 degrees
;The eigenvalues ratios are:
;       22.600782       1.7488921
;The Minimum Variance eigenvector is:
;<-0.70834, 0.61539,-0.34575> +/- <-0.00722,-0.06918,-0.10834>
;
;Plot Index Range: 241-306
;Plot Range: 23:34:00.8595-23:34:00.8942
;The angle between DC-Field and the k-vector is :
;       19.088 +/- 1.698 degrees
;The eigenvalues ratios are:
;       19.744919       2.4429481
;The Minimum Variance eigenvector is:
;< 0.11876,-0.97744, 0.17468> +/- <-0.11059,-0.01789,-0.02494>
;
;Plot Index Range: 593-647
;Plot Range: 23:34:01.0473-23:34:01.0761
;The angle between DC-Field and the k-vector is :
;       86.836 +/- 2.056 degrees
;The eigenvalues ratios are:
;       16.592032       1.8967459
;The Minimum Variance eigenvector is:
;< 0.46183,-0.87804, 0.12556> +/- < 0.09911, 0.06236, 0.07156>
;
;Plot Index Range: 676-714
;Plot Range: 23:34:01.0915-23:34:01.1118
;The angle between DC-Field and the k-vector is :
;       76.988 +/- 0.847 degrees
;The eigenvalues ratios are:
;       125.55275       1.6937316
;The Minimum Variance eigenvector is:
;< 0.90899,-0.40131, 0.11263> +/- <-0.01784,-0.04656,-0.02189>
;
;Plot Index Range: 741-890
;Plot Range: 23:34:01.1262-23:34:01.2057
;The angle between DC-Field and the k-vector is :
;       71.085 +/- 1.550 degrees
;The eigenvalues ratios are:
;       11.141487       1.6787355
;The Minimum Variance eigenvector is:
;< 0.75726,-0.63184, 0.16534> +/- <-0.08552,-0.10345,-0.00365>
;
;Plot Index Range: 749-797
;Plot Range: 23:34:01.1305-23:34:01.1561
;The angle between DC-Field and the k-vector is :
;       59.972 +/- 2.611 degrees
;The eigenvalues ratios are:
;       12.162099       1.5284284
;The Minimum Variance eigenvector is:
;<-0.77296, 0.58990,-0.23357> +/- <-0.02177,-0.08738,-0.14866>
;
;Plot Index Range: 840-890
;Plot Range: 23:34:01.1790-23:34:01.2057
;The angle between DC-Field and the k-vector is :
;       38.894 +/- 1.130 degrees
;The eigenvalues ratios are:
;       54.453218       1.8698458
;The Minimum Variance eigenvector is:
;< 0.76557,-0.64197, 0.04222> +/- <-0.04740,-0.05752,-0.01508>
;
;Plot Index Range: 891-1071
;Plot Range: 23:34:01.2062-23:34:01.3022
;The angle between DC-Field and the k-vector is :
;       12.638 +/- 1.201 degrees
;The eigenvalues ratios are:
;       14.643517       1.5213648
;The Minimum Variance eigenvector is:
;< 0.66992,-0.73774, 0.08332> +/- <-0.08144,-0.07595,-0.01770>
;
;Plot Index Range: 954-997
;Plot Range: 23:34:01.2398-23:34:01.2627
;The angle between DC-Field and the k-vector is :
;       65.640 +/- 1.510 degrees
;The eigenvalues ratios are:
;       36.250598       1.6938960
;The Minimum Variance eigenvector is:
;< 0.72589,-0.68247, 0.08560> +/- <-0.06522,-0.07184,-0.01969>
;
;Plot Index Range: 1015-1071
;Plot Range: 23:34:01.2723-23:34:01.3022
;The angle between DC-Field and the k-vector is :
;       8.952 +/- 0.986 degrees
;The eigenvalues ratios are:
;       63.370075       1.7081549
;The Minimum Variance eigenvector is:
;< 0.62306,-0.77973, 0.06172> +/- <-0.05342,-0.04345,-0.00965>
;
;Plot Index Range: 1117-1254
;Plot Range: 23:34:01.3267-23:34:01.3998
;The angle between DC-Field and the k-vector is :
;       79.920 +/- 0.840 degrees
;The eigenvalues ratios are:
;       36.176798       1.3240004
;The Minimum Variance eigenvector is:
;< 0.32217,-0.94657,-0.01432> +/- <-0.06608,-0.02300, 0.03373>
;
;Plot Index Range: 1440-1521
;Plot Range: 23:34:01.4990-23:34:01.5422
;The angle between DC-Field and the k-vector is :
;       82.497 +/- 1.527 degrees
;The eigenvalues ratios are:
;       19.542167       2.1510341
;The Minimum Variance eigenvector is:
;< 0.39724,-0.91761, 0.01399> +/- <-0.09808,-0.04292,-0.03030>
;
;Plot Index Range: 1722-1812
;Plot Range: 23:34:01.6494-23:34:01.6974
;The angle between DC-Field and the k-vector is :
;       88.735 +/- 0.817 degrees
;The eigenvalues ratios are:
;       57.267304       1.4969081
;The Minimum Variance eigenvector is:
;< 0.80866,-0.58632,-0.04783> +/- <-0.03902,-0.05297,-0.01026>
;
;Plot Index Range: 1813-2047
;Plot Range: 23:34:01.6979-23:34:01.8227
;The angle between DC-Field and the k-vector is :
;       10.660 +/- 0.832 degrees
;The eigenvalues ratios are:
;       22.305311       1.4018413
;The Minimum Variance eigenvector is:
;< 0.64576,-0.76064, 0.06642> +/- <-0.06553,-0.05579,-0.00182>
;
;Plot Index Range: 1858-1901
;Plot Range: 23:34:01.7219-23:34:01.7449
;The angle between DC-Field and the k-vector is :
;       87.164 +/- 1.489 degrees
;The eigenvalues ratios are:
;       37.250279       1.6292370
;The Minimum Variance eigenvector is:
;< 0.75081,-0.65524, 0.08334> +/- <-0.06407,-0.07018, 0.02542>
;
;Plot Index Range: 1920-1974
;Plot Range: 23:34:01.7550-23:34:01.7838
;The angle between DC-Field and the k-vector is :
;       88.394 +/- 1.389 degrees
;The eigenvalues ratios are:
;       34.073367       1.2064880
;The Minimum Variance eigenvector is:
;< 0.65239,-0.75258, 0.08950> +/- <-0.07846,-0.06702, 0.00831>
;
;Plot Index Range: 1982-2038
;Plot Range: 23:34:01.7881-23:34:01.8179
;The angle between DC-Field and the k-vector is :
;       87.196 +/- 1.109 degrees
;The eigenvalues ratios are:
;       50.481153       1.4267496
;The Minimum Variance eigenvector is:
;< 0.63026,-0.77478, 0.04997> +/- <-0.06186,-0.05100,-0.01051>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:34:00.7918',prefd[0]+'23:34:00.8126'])
tr1     = time_double([prefd[0]+'23:34:00.8595',prefd[0]+'23:34:00.8942'])
tr2     = time_double([prefd[0]+'23:34:01.0473',prefd[0]+'23:34:01.0761'])
tr3     = time_double([prefd[0]+'23:34:01.0915',prefd[0]+'23:34:01.1118'])
tr4     = time_double([prefd[0]+'23:34:01.1305',prefd[0]+'23:34:01.1561'])
tr5     = time_double([prefd[0]+'23:34:01.1790',prefd[0]+'23:34:01.2057'])
tr6     = time_double([prefd[0]+'23:34:01.2398',prefd[0]+'23:34:01.2627'])
tr7     = time_double([prefd[0]+'23:34:01.2723',prefd[0]+'23:34:01.3022'])
tr8     = time_double([prefd[0]+'23:34:01.3267',prefd[0]+'23:34:01.3998'])
tr9     = time_double([prefd[0]+'23:34:01.4990',prefd[0]+'23:34:01.5422'])
tr10    = time_double([prefd[0]+'23:34:01.6494',prefd[0]+'23:34:01.6974'])
tr11    = time_double([prefd[0]+'23:34:01.7219',prefd[0]+'23:34:01.7449'])
tr12    = time_double([prefd[0]+'23:34:01.7550',prefd[0]+'23:34:01.7838'])
tr13    = time_double([prefd[0]+'23:34:01.7881',prefd[0]+'23:34:01.8179'])

kvec0   = [-0.70834, 0.61539,-0.34575]
kvec1   = [ 0.11876,-0.97744, 0.17468]
kvec2   = [ 0.46183,-0.87804, 0.12556]
kvec3   = [ 0.90899,-0.40131, 0.11263]
kvec4   = [-0.77296, 0.58990,-0.23357]
kvec5   = [ 0.76557,-0.64197, 0.04222]
kvec6   = [ 0.72589,-0.68247, 0.08560]
kvec7   = [ 0.62306,-0.77973, 0.06172]
kvec8   = [ 0.32217,-0.94657,-0.01432]
kvec9   = [ 0.39724,-0.91761, 0.01399]
kvec10  = [ 0.80866,-0.58632,-0.04783]
kvec11  = [ 0.75081,-0.65524, 0.08334]
kvec12  = [ 0.65239,-0.75258, 0.08950]
kvec13  = [ 0.63026,-0.77478, 0.04997]

dkvec0  = ABS([-0.00722,-0.06918,-0.10834])
dkvec1  = ABS([-0.11059,-0.01789,-0.02494])
dkvec2  = ABS([ 0.09911, 0.06236, 0.07156])
dkvec3  = ABS([-0.01784,-0.04656,-0.02189])
dkvec4  = ABS([-0.02177,-0.08738,-0.14866])
dkvec5  = ABS([-0.04740,-0.05752,-0.01508])
dkvec6  = ABS([-0.06522,-0.07184,-0.01969])
dkvec7  = ABS([-0.05342,-0.04345,-0.00965])
dkvec8  = ABS([-0.06608,-0.02300, 0.03373])
dkvec9  = ABS([-0.09808,-0.04292,-0.03030])
dkvec10 = ABS([-0.03902,-0.05297,-0.01026])
dkvec11 = ABS([-0.06407,-0.07018, 0.02542])
dkvec12 = ABS([-0.07846,-0.06702, 0.00831])
dkvec13 = ABS([-0.06186,-0.05100,-0.01051])

elam0   = [22.600782,1.7488921]
elam1   = [19.744919,2.4429481]
elam2   = [16.592032,1.8967459]
elam3   = [125.55275,1.6937316]
elam4   = [12.162099,1.5284284]
elam5   = [54.453218,1.8698458]
elam6   = [36.250598,1.6938960]
elam7   = [63.370075,1.7081549]
elam8   = [36.176798,1.3240004]
elam9   = [19.542167,2.1510341]
elam10  = [57.267304,1.4969081]
elam11  = [37.250279,1.6292370]
elam12  = [34.073367,1.2064880]
elam13  = [50.481153,1.4267496]

bvec0   = [ 0.49803,-0.86629, 0.03887]
bvec1   = [ 0.49972,-0.86562, 0.03114]
bvec2   = [ 0.50366,-0.86324, 0.03364]
bvec3   = [ 0.50177,-0.86442, 0.03166]
bvec4   = [ 0.49915,-0.86600, 0.02999]
bvec5   = [ 0.49817,-0.86669, 0.02617]
bvec6   = [ 0.49860,-0.86660, 0.02009]
bvec7   = [ 0.49755,-0.86714, 0.02270]
bvec8   = [ 0.49435,-0.86882, 0.02778]
bvec9   = [ 0.48732,-0.87194, 0.04732]
bvec10  = [ 0.48825,-0.87093, 0.05568]
bvec11  = [ 0.49074,-0.86919, 0.06073]
bvec12  = [ 0.49233,-0.86823, 0.06160]
bvec13  = [ 0.49348,-0.86752, 0.06242]
bmag0   = [15.08172]
bmag1   = [14.99005]
bmag2   = [15.91296]
bmag3   = [16.14093]
bmag4   = [16.39577]
bmag5   = [16.33807]
bmag6   = [15.98144]
bmag7   = [15.83867]
bmag8   = [15.64186]
bmag9   = [15.82107]
bmag10  = [16.09575]
bmag11  = [16.14354]
bmag12  = [16.29521]
bmag13  = [16.43432]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,$
                        tr13)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9,kvec10,kvec11,kvec12,kvec13)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  30 Hz < f < 200 Hz  at  2000-02-11/23:34:00.731 UT
;
;   23:34:00.7918-23:34:00.8126     -0.708      0.615     -0.346      0.498     -0.866      0.039     15.082
;   23:34:00.8595-23:34:00.8942      0.119     -0.977      0.175      0.500     -0.866      0.031     14.990
;   23:34:01.0473-23:34:01.0761      0.462     -0.878      0.126      0.504     -0.863      0.034     15.913
;   23:34:01.0915-23:34:01.1118      0.909     -0.401      0.113      0.502     -0.864      0.032     16.141
;   23:34:01.1305-23:34:01.1561     -0.773      0.590     -0.234      0.499     -0.866      0.030     16.396
;   23:34:01.1790-23:34:01.2057      0.766     -0.642      0.042      0.498     -0.867      0.026     16.338
;   23:34:01.2398-23:34:01.2627      0.726     -0.682      0.086      0.499     -0.867      0.020     15.981
;   23:34:01.2723-23:34:01.3022      0.623     -0.780      0.062      0.498     -0.867      0.023     15.839
;   23:34:01.3267-23:34:01.3998      0.322     -0.947     -0.014      0.494     -0.869      0.028     15.642
;   23:34:01.4990-23:34:01.5422      0.397     -0.918      0.014      0.487     -0.872      0.047     15.821
;   23:34:01.6494-23:34:01.6974      0.809     -0.586     -0.048      0.488     -0.871      0.056     16.096
;   23:34:01.7219-23:34:01.7449      0.751     -0.655      0.083      0.491     -0.869      0.061     16.144
;   23:34:01.7550-23:34:01.7838      0.652     -0.753      0.090      0.492     -0.868      0.062     16.295
;   23:34:01.7881-23:34:01.8179      0.630     -0.775      0.050      0.493     -0.868      0.062     16.434

vswu   = [-576.773,-86.503,3.938]         ; => My 3DP estimates (km/s) For 2000-02-11/23:34:00.731 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  30 Hz < f < 200 Hz  at  2000-02-11/23:34:00.731 UT
;
;   23:34:00.7918-23:34:00.8126    154.068     25.932     74.978    105.022     52.636    127.364
;   23:34:00.8595-23:34:00.8942     24.372    155.628     67.842    112.158     88.355     91.645
;   23:34:01.0473-23:34:01.0761      5.849    174.151     88.581     91.419    109.004     70.996
;   23:34:01.0915-23:34:01.1118     36.238    143.762    125.474     54.526    146.996     33.004
;   23:34:01.1305-23:34:01.1561    154.646     25.354     69.448    110.552     47.521    132.479
;   23:34:01.1790-23:34:01.2057     20.137    159.863    111.275     68.725    131.421     48.579
;   23:34:01.2398-23:34:01.2627     17.239    162.761    107.503     72.497    128.028     51.972
;   23:34:01.2723-23:34:01.3022      9.055    170.945     99.965     80.035    120.006     59.994
;   23:34:01.3267-23:34:01.3998     11.109    168.891     81.602     98.398    100.271     79.729
;   23:34:01.4990-23:34:01.5422      6.098    173.902     85.745     94.255    104.871     75.129
;   23:34:01.6494-23:34:01.6974     25.471    154.529    116.417     63.583    135.484     44.516
;   23:34:01.7219-23:34:01.7449     19.431    160.569    109.579     70.421    130.146     49.854
;   23:34:01.7550-23:34:01.7838     11.446    168.554    101.808     78.192    122.204     57.796
;   23:34:01.7881-23:34:01.8179      9.505    170.495    100.608     79.392    120.532     59.468

theta_kb0211_30_200   = DBLARR(nn)
theta_kn0211_30_200   = DBLARR(nn)
theta_kv0211_30_200   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_30_200[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_30_200[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_30_200[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_30_200[j]),  $
                     REFORM(theta_kn0211_30_200[j]),$
                     REFORM(theta_kv0211_30_200[j])
;
; => For  30 Hz < f < 200 Hz  at  2000-02-11/23:34:00.731 UT
;
;   23:34:00.7918-23:34:00.8126     25.932     74.978     52.636
;   23:34:00.8595-23:34:00.8942     24.372     67.842     88.355
;   23:34:01.0473-23:34:01.0761      5.849     88.581     70.996
;   23:34:01.0915-23:34:01.1118     36.238     54.526     33.004
;   23:34:01.1305-23:34:01.1561     25.354     69.448     47.521
;   23:34:01.1790-23:34:01.2057     20.137     68.725     48.579
;   23:34:01.2398-23:34:01.2627     17.239     72.497     51.972
;   23:34:01.2723-23:34:01.3022      9.055     80.035     59.994
;   23:34:01.3267-23:34:01.3998     11.109     81.602     79.729
;   23:34:01.4990-23:34:01.5422      6.098     85.745     75.129
;   23:34:01.6494-23:34:01.6974     25.471     63.583     44.516
;   23:34:01.7219-23:34:01.7449     19.431     70.421     49.854
;   23:34:01.7550-23:34:01.7838     11.446     78.192     57.796
;   23:34:01.7881-23:34:01.8179      9.505     79.392     59.468

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_30_200
PRINT,FORMAT=tkbf,theta_kn0211_30_200
PRINT,FORMAT=tkbf,theta_kv0211_30_200

theta_kb0211_30_200 = [25.93,24.37, 5.85,36.24,25.35,20.14,17.24, 9.05,11.11, 6.10,25.47,19.43,11.45, 9.50]
theta_kn0211_30_200 = [74.98,67.84,88.58,54.53,69.45,68.73,72.50,80.03,81.60,85.74,63.58,70.42,78.19,79.39]
theta_kv0211_30_200 = [52.64,88.36,71.00,33.00,47.52,48.58,51.97,59.99,79.73,75.13,44.52,49.85,57.80,59.47]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------

jj      = 3L
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      50.0
print, hfc0, format='(";",8f10.1)'
;     250.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

;-----------------------------------------------------------------------------------------
; => For  50 Hz < f < 250 Hz  at  2000-02-11/23:34:27.503 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 15-138
;Plot Range: 23:34:27.5110-23:34:27.5766
;The angle between DC-Field and the k-vector is :
;       65.471 +/- 0.265 degrees
;The eigenvalues ratios are:
;       383.75770       1.9485149
;The Minimum Variance eigenvector is:
;< 0.33220,-0.94269, 0.03140> +/- <-0.02089,-0.00748,-0.00368>
;
;Plot Index Range: 231-300
;Plot Range: 23:34:27.6262-23:34:27.6630
;The angle between DC-Field and the k-vector is :
;       60.354 +/- 1.273 degrees
;The eigenvalues ratios are:
;       31.780225       2.1409611
;The Minimum Variance eigenvector is:
;< 0.45654,-0.87262,-0.17348> +/- <-0.07994,-0.03878,-0.01534>
;
;Plot Index Range: 405-480
;Plot Range: 23:34:27.7190-23:34:27.7590
;The angle between DC-Field and the k-vector is :
;       73.117 +/- 1.848 degrees
;The eigenvalues ratios are:
;       14.929398       2.2364995
;The Minimum Variance eigenvector is:
;< 0.43569,-0.89740, 0.06960> +/- <-0.11241,-0.05702,-0.03148>
;
;Plot Index Range: 493-534
;Plot Range: 23:34:27.7659-23:34:27.7878
;The angle between DC-Field and the k-vector is :
;       66.755 +/- 1.826 degrees
;The eigenvalues ratios are:
;       26.588156       2.4096190
;The Minimum Variance eigenvector is:
;< 0.32246,-0.92819,-0.18569> +/- <-0.10421,-0.03230,-0.01953>
;
;Plot Index Range: 535-648
;Plot Range: 23:34:27.7883-23:34:27.8486
;The angle between DC-Field and the k-vector is :
;       58.729 +/- 0.937 degrees
;The eigenvalues ratios are:
;       35.372196       1.9203771
;The Minimum Variance eigenvector is:
;< 0.22994,-0.96522,-0.12438> +/- <-0.07349,-0.01550,-0.01558>
;
;Plot Index Range: 718-762
;Plot Range: 23:34:27.8859-23:34:27.9094
;The angle between DC-Field and the k-vector is :
;       89.485 +/- 0.955 degrees
;The eigenvalues ratios are:
;       85.772000       2.0837473
;The Minimum Variance eigenvector is:
;< 0.29927,-0.95417,-0.00134> +/- <-0.05690,-0.01783,-0.01422>
;
;Plot Index Range: 762-956
;Plot Range: 23:34:27.9094-23:34:28.0129
;The angle between DC-Field and the k-vector is :
;       73.125 +/- 1.343 degrees
;The eigenvalues ratios are:
;       11.347353       2.2281681
;The Minimum Variance eigenvector is:
;< 0.39974,-0.91414,-0.06746> +/- <-0.09641,-0.03792,-0.05741>
;
;Plot Index Range: 793-858
;Plot Range: 23:34:27.9259-23:34:27.9606
;The angle between DC-Field and the k-vector is :
;       76.455 +/- 1.187 degrees
;The eigenvalues ratios are:
;       38.353109       1.8715915
;The Minimum Variance eigenvector is:
;< 0.27569,-0.94758,-0.16149> +/- <-0.08127,-0.02146,-0.01284>
;
;Plot Index Range: 858-915
;Plot Range: 23:34:27.9606-23:34:27.9910
;The angle between DC-Field and the k-vector is :
;       77.081 +/- 1.865 degrees
;The eigenvalues ratios are:
;       18.797737       2.6274099
;The Minimum Variance eigenvector is:
;< 0.42468,-0.90183,-0.07963> +/- <-0.10504,-0.04621,-0.03682>
;
;Plot Index Range: 1047-1115
;Plot Range: 23:34:28.0614-23:34:28.0977
;The angle between DC-Field and the k-vector is :
;       59.749 +/- 1.604 degrees
;The eigenvalues ratios are:
;       20.987883       2.0629566
;The Minimum Variance eigenvector is:
;< 0.22803,-0.97241, 0.04921> +/- <-0.10742,-0.02632,-0.02229>
;
;Plot Index Range: 1158-1286
;Plot Range: 23:34:28.1206-23:34:28.1889
;The angle between DC-Field and the k-vector is :
;       46.106 +/- 1.383 degrees
;The eigenvalues ratios are:
;       15.440948       1.8376898
;The Minimum Variance eigenvector is:
;< 0.50005,-0.86546,-0.03033> +/- <-0.09778,-0.05562,-0.02489>
;
;Plot Index Range: 1173-1221
;Plot Range: 23:34:28.1286-23:34:28.1542
;The angle between DC-Field and the k-vector is :
;       77.806 +/- 1.060 degrees
;The eigenvalues ratios are:
;       64.190022       1.8835398
;The Minimum Variance eigenvector is:
;< 0.48400,-0.87106,-0.08366> +/- <-0.06070,-0.03216,-0.01630>
;
;Plot Index Range: 1239-1286
;Plot Range: 23:34:28.1638-23:34:28.1889
;The angle between DC-Field and the k-vector is :
;       63.914 +/- 1.195 degrees
;The eigenvalues ratios are:
;       51.940124       1.7325599
;The Minimum Variance eigenvector is:
;< 0.44546,-0.89509,-0.01945> +/- <-0.07049,-0.03473,-0.01616>
;
;Plot Index Range: 1287-1409
;Plot Range: 23:34:28.1894-23:34:28.2545
;The angle between DC-Field and the k-vector is :
;       80.976 +/- 0.572 degrees
;The eigenvalues ratios are:
;       85.031825       1.7938918
;The Minimum Variance eigenvector is:
;< 0.17214,-0.97554,-0.13674> +/- <-0.04753,-0.00724,-0.00818>
;
;Plot Index Range: 1424-1488
;Plot Range: 23:34:28.2625-23:34:28.2966
;The angle between DC-Field and the k-vector is :
;       63.854 +/- 0.742 degrees
;The eigenvalues ratios are:
;       96.641774       1.7700938
;The Minimum Variance eigenvector is:
;< 0.43512,-0.89979,-0.03244> +/- <-0.04818,-0.02302,-0.00766>
;
;Plot Index Range: 1559-1641
;Plot Range: 23:34:28.3345-23:34:28.3782
;The angle between DC-Field and the k-vector is :
;       63.125 +/- 0.529 degrees
;The eigenvalues ratios are:
;       146.93492       2.1287779
;The Minimum Variance eigenvector is:
;< 0.41351,-0.91049,-0.00353> +/- <-0.03548,-0.01609,-0.00793>
;
;Plot Index Range: 1663-1783
;Plot Range: 23:34:28.3899-23:34:28.4539
;The angle between DC-Field and the k-vector is :
;       60.769 +/- 1.144 degrees
;The eigenvalues ratios are:
;       23.046290       1.9178027
;The Minimum Variance eigenvector is:
;< 0.37564,-0.92509, 0.05570> +/- <-0.08689,-0.03573,-0.00746>
;
;Plot Index Range: 1663-1704
;Plot Range: 23:34:28.3899-23:34:28.4118
;The angle between DC-Field and the k-vector is :
;       32.608 +/- 1.204 degrees
;The eigenvalues ratios are:
;       58.557998       1.7800443
;The Minimum Variance eigenvector is:
;< 0.40647,-0.90804, 0.10123> +/- <-0.07077,-0.03208,-0.00361>
;
;Plot Index Range: 1705-1761
;Plot Range: 23:34:28.4123-23:34:28.4422
;The angle between DC-Field and the k-vector is :
;       82.702 +/- 1.037 degrees
;The eigenvalues ratios are:
;       57.466750       2.0760051
;The Minimum Variance eigenvector is:
;< 0.45496,-0.88716, 0.07725> +/- <-0.06217,-0.03257,-0.00792>
;
;Plot Index Range: 1766-1826
;Plot Range: 23:34:28.4449-23:34:28.4769
;The angle between DC-Field and the k-vector is :
;       87.930 +/- 0.875 degrees
;The eigenvalues ratios are:
;       74.696496       1.8213916
;The Minimum Variance eigenvector is:
;< 0.05041,-0.98574,-0.16055> +/- <-0.06173,-0.00205,-0.00680>
;
;Plot Index Range: 1836-1897
;Plot Range: 23:34:28.4822-23:34:28.5147
;The angle between DC-Field and the k-vector is :
;       62.681 +/- 1.174 degrees
;The eigenvalues ratios are:
;       41.665379       1.8602669
;The Minimum Variance eigenvector is:
;< 0.36917,-0.92936, 0.00026> +/- <-0.07684,-0.03053,-0.00626>
;
;Plot Index Range: 1898-1935
;Plot Range: 23:34:28.5153-23:34:28.5350
;The angle between DC-Field and the k-vector is :
;       88.579 +/- 1.028 degrees
;The eigenvalues ratios are:
;       88.277541       1.8124191
;The Minimum Variance eigenvector is:
;< 0.04421,-0.95154,-0.30433> +/- <-0.06372, 0.00059,-0.01109>
;
;Plot Index Range: 1956-1998
;Plot Range: 23:34:28.5462-23:34:28.5686
;The angle between DC-Field and the k-vector is :
;       80.365 +/- 0.954 degrees
;The eigenvalues ratios are:
;       89.956328       1.4816868
;The Minimum Variance eigenvector is:
;< 0.29852,-0.94742,-0.11524> +/- <-0.06091,-0.01784,-0.01113>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:34:27.5110',prefd[0]+'23:34:27.5766'])
tr1     = time_double([prefd[0]+'23:34:27.6262',prefd[0]+'23:34:27.6630'])
tr2     = time_double([prefd[0]+'23:34:27.7190',prefd[0]+'23:34:27.7590'])
tr3     = time_double([prefd[0]+'23:34:27.7659',prefd[0]+'23:34:27.7878'])
tr4     = time_double([prefd[0]+'23:34:27.7883',prefd[0]+'23:34:27.8486'])
tr5     = time_double([prefd[0]+'23:34:27.8859',prefd[0]+'23:34:27.9094'])
tr6     = time_double([prefd[0]+'23:34:27.9259',prefd[0]+'23:34:27.9606'])
tr7     = time_double([prefd[0]+'23:34:27.9606',prefd[0]+'23:34:27.9910'])
tr8     = time_double([prefd[0]+'23:34:28.0614',prefd[0]+'23:34:28.0977'])
tr9     = time_double([prefd[0]+'23:34:28.1286',prefd[0]+'23:34:28.1542'])
tr10    = time_double([prefd[0]+'23:34:28.1638',prefd[0]+'23:34:28.1889'])
tr11    = time_double([prefd[0]+'23:34:28.1894',prefd[0]+'23:34:28.2545'])
tr12    = time_double([prefd[0]+'23:34:28.2625',prefd[0]+'23:34:28.2966'])
tr13    = time_double([prefd[0]+'23:34:28.3345',prefd[0]+'23:34:28.3782'])
tr14    = time_double([prefd[0]+'23:34:28.3899',prefd[0]+'23:34:28.4118'])
tr15    = time_double([prefd[0]+'23:34:28.4123',prefd[0]+'23:34:28.4422'])
tr16    = time_double([prefd[0]+'23:34:28.4449',prefd[0]+'23:34:28.4769'])
tr17    = time_double([prefd[0]+'23:34:28.4822',prefd[0]+'23:34:28.5147'])
tr18    = time_double([prefd[0]+'23:34:28.5153',prefd[0]+'23:34:28.5350'])
tr19    = time_double([prefd[0]+'23:34:28.5462',prefd[0]+'23:34:28.5686'])

kvec0   = [ 0.33220,-0.94269, 0.03140]
kvec1   = [ 0.45654,-0.87262,-0.17348]
kvec2   = [ 0.43569,-0.89740, 0.06960]
kvec3   = [ 0.32246,-0.92819,-0.18569]
kvec4   = [ 0.22994,-0.96522,-0.12438]
kvec5   = [ 0.29927,-0.95417,-0.00134]
kvec6   = [ 0.27569,-0.94758,-0.16149]
kvec7   = [ 0.42468,-0.90183,-0.07963]
kvec8   = [ 0.22803,-0.97241, 0.04921]
kvec9   = [ 0.48400,-0.87106,-0.08366]
kvec10  = [ 0.44546,-0.89509,-0.01945]
kvec11  = [ 0.17214,-0.97554,-0.13674]
kvec12  = [ 0.43512,-0.89979,-0.03244]
kvec13  = [ 0.41351,-0.91049,-0.00353]
kvec14  = [ 0.40647,-0.90804, 0.10123]
kvec15  = [ 0.45496,-0.88716, 0.07725]
kvec16  = [ 0.05041,-0.98574,-0.16055]
kvec17  = [ 0.36917,-0.92936, 0.00026]
kvec18  = [ 0.04421,-0.95154,-0.30433]
kvec19  = [ 0.29852,-0.94742,-0.11524]

dkvec0  = ABS([-0.02089,-0.00748,-0.00368])
dkvec1  = ABS([-0.07994,-0.03878,-0.01534])
dkvec2  = ABS([-0.11241,-0.05702,-0.03148])
dkvec3  = ABS([-0.10421,-0.03230,-0.01953])
dkvec4  = ABS([-0.07349,-0.01550,-0.01558])
dkvec5  = ABS([-0.05690,-0.01783,-0.01422])
dkvec6  = ABS([-0.08127,-0.02146,-0.01284])
dkvec7  = ABS([-0.10504,-0.04621,-0.03682])
dkvec8  = ABS([-0.10742,-0.02632,-0.02229])
dkvec9  = ABS([-0.06070,-0.03216,-0.01630])
dkvec10 = ABS([-0.07049,-0.03473,-0.01616])
dkvec11 = ABS([-0.04753,-0.00724,-0.00818])
dkvec12 = ABS([-0.04818,-0.02302,-0.00766])
dkvec13 = ABS([-0.03548,-0.01609,-0.00793])
dkvec14 = ABS([-0.07077,-0.03208,-0.00361])
dkvec15 = ABS([-0.06217,-0.03257,-0.00792])
dkvec16 = ABS([-0.06173,-0.00205,-0.00680])
dkvec17 = ABS([-0.07684,-0.03053,-0.00626])
dkvec18 = ABS([-0.06372, 0.00059,-0.01109])
dkvec19 = ABS([-0.06091,-0.01784,-0.01113])

elam0   = [383.75770,1.9485149]
elam1   = [31.780225,2.1409611]
elam2   = [14.929398,2.2364995]
elam3   = [26.588156,2.4096190]
elam4   = [35.372196,1.9203771]
elam5   = [85.772000,2.0837473]
elam6   = [38.353109,1.8715915]
elam7   = [18.797737,2.6274099]
elam8   = [20.987883,2.0629566]
elam9   = [64.190022,1.8835398]
elam10  = [51.940124,1.7325599]
elam11  = [85.031825,1.7938918]
elam12  = [96.641774,1.7700938]
elam13  = [146.93492,2.1287779]
elam14  = [58.557998,1.7800443]
elam15  = [57.466750,2.0760051]
elam16  = [74.696496,1.8213916]
elam17  = [41.665379,1.8602669]
elam18  = [88.277541,1.8124191]
elam19  = [89.956328,1.4816868]

bvec0   = [ 0.39680,-0.91710,-0.03833]
bvec1   = [ 0.39481,-0.91830,-0.02910]
bvec2   = [ 0.39622,-0.91774,-0.02764]
bvec3   = [ 0.39742,-0.91724,-0.02712]
bvec4   = [ 0.39888,-0.91663,-0.02620]
bvec5   = [ 0.40173,-0.91546,-0.02336]
bvec6   = [ 0.40272,-0.91507,-0.02141]
bvec7   = [ 0.40165,-0.91557,-0.01999]
bvec8   = [ 0.39940,-0.91663,-0.01617]
bvec9   = [ 0.39808,-0.91722,-0.01568]
bvec10  = [ 0.39642,-0.91792,-0.01683]
bvec11  = [ 0.39565,-0.91823,-0.01789]
bvec12  = [ 0.39814,-0.91714,-0.01812]
bvec13  = [ 0.40231,-0.91535,-0.01679]
bvec14  = [ 0.40437,-0.91446,-0.01596]
bvec15  = [ 0.40401,-0.91460,-0.01661]
bvec16  = [ 0.40348,-0.91482,-0.01751]
bvec17  = [ 0.40247,-0.91525,-0.01820]
bvec18  = [ 0.40102,-0.91589,-0.01822]
bvec19  = [ 0.39930,-0.91664,-0.01824]
bmag0   = [22.58476]
bmag1   = [22.49612]
bmag2   = [22.33491]
bmag3   = [22.32055]
bmag4   = [22.33803]
bmag5   = [22.39163]
bmag6   = [22.42861]
bmag7   = [22.45613]
bmag8   = [22.52032]
bmag9   = [22.55793]
bmag10  = [22.59392]
bmag11  = [22.62184]
bmag12  = [22.60983]
bmag13  = [22.59909]
bmag14  = [22.59879]
bmag15  = [22.60821]
bmag16  = [22.62098]
bmag17  = [22.64233]
bmag18  = [22.67037]
bmag19  = [22.70382]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13',$
           't14','t15','t16','t17','t18','t19']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,$
                        tr13,tr14,tr15,tr16,tr17,tr18,tr19)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,$
                        kvec18,kvec19)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,$
                        dkvec16,dkvec17,dkvec18,dkvec19)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  50 Hz < f < 250 Hz  at  2000-02-11/23:34:27.503 UT
;
;   23:34:27.5110-23:34:27.5766      0.332     -0.943      0.031      0.397     -0.917     -0.038     22.585
;   23:34:27.6262-23:34:27.6630      0.457     -0.873     -0.173      0.395     -0.918     -0.029     22.496
;   23:34:27.7190-23:34:27.7590      0.436     -0.897      0.070      0.396     -0.918     -0.028     22.335
;   23:34:27.7659-23:34:27.7878      0.322     -0.928     -0.186      0.397     -0.917     -0.027     22.321
;   23:34:27.7883-23:34:27.8486      0.230     -0.965     -0.124      0.399     -0.917     -0.026     22.338
;   23:34:27.8859-23:34:27.9094      0.299     -0.954     -0.001      0.402     -0.915     -0.023     22.392
;   23:34:27.9259-23:34:27.9606      0.276     -0.948     -0.161      0.403     -0.915     -0.021     22.429
;   23:34:27.9606-23:34:27.9910      0.425     -0.902     -0.080      0.402     -0.916     -0.020     22.456
;   23:34:28.0614-23:34:28.0977      0.228     -0.972      0.049      0.399     -0.917     -0.016     22.520
;   23:34:28.1286-23:34:28.1542      0.484     -0.871     -0.084      0.398     -0.917     -0.016     22.558
;   23:34:28.1638-23:34:28.1889      0.445     -0.895     -0.019      0.396     -0.918     -0.017     22.594
;   23:34:28.1894-23:34:28.2545      0.172     -0.976     -0.137      0.396     -0.918     -0.018     22.622
;   23:34:28.2625-23:34:28.2966      0.435     -0.900     -0.032      0.398     -0.917     -0.018     22.610
;   23:34:28.3345-23:34:28.3782      0.414     -0.910     -0.004      0.402     -0.915     -0.017     22.599
;   23:34:28.3899-23:34:28.4118      0.406     -0.908      0.101      0.404     -0.914     -0.016     22.599
;   23:34:28.4123-23:34:28.4422      0.455     -0.887      0.077      0.404     -0.915     -0.017     22.608
;   23:34:28.4449-23:34:28.4769      0.050     -0.986     -0.161      0.403     -0.915     -0.018     22.621
;   23:34:28.4822-23:34:28.5147      0.369     -0.929      0.000      0.402     -0.915     -0.018     22.642
;   23:34:28.5153-23:34:28.5350      0.044     -0.952     -0.304      0.401     -0.916     -0.018     22.670
;   23:34:28.5462-23:34:28.5686      0.299     -0.947     -0.115      0.399     -0.917     -0.018     22.704

vswu   = [-616.468,-88.752,24.278]         ; => My 3DP estimates (km/s) For 2000-02-11/23:34:27.503 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  50 Hz < f < 250 Hz  at  2000-02-11/23:34:27.503 UT
;
;   23:34:27.5110-23:34:27.5766      5.641    174.359     81.629     98.371    101.134     78.866
;   23:34:27.6262-23:34:27.6630      9.382    170.618     92.195     87.805    109.514     70.486
;   23:34:27.7190-23:34:27.7590      6.129    173.871     87.482     92.518    107.483     72.517
;   23:34:27.7659-23:34:27.7878     10.082    169.918     84.253     95.747    101.186     78.814
;   23:34:27.7883-23:34:27.8486     11.557    168.443     77.862    102.138     95.441     84.559
;   23:34:27.8859-23:34:27.9094      6.403    173.597     80.089     99.911     99.217     80.783
;   23:34:27.9259-23:34:27.9606     11.012    168.988     81.105     98.895     98.281     81.719
;   23:34:27.9606-23:34:27.9910      3.751    176.249     88.687     91.313    107.141     72.859
;   23:34:28.0614-23:34:28.0977     11.001    168.999     75.344    104.656     94.885     85.115
;   23:34:28.1286-23:34:28.1542      6.816    173.184     92.475     87.525    110.973     69.027
;   23:34:28.1638-23:34:28.1889      3.104    176.896     89.140     90.860    108.293     71.707
;   23:34:28.1894-23:34:28.2545     14.912    165.088     74.797    105.203     92.102     87.898
;   23:34:28.2625-23:34:28.2966      2.478    177.522     88.668     91.332    107.668     72.332
;   23:34:28.3345-23:34:28.3782      1.042    178.958     86.957     93.043    106.229     73.771
;   23:34:28.3899-23:34:28.4118      6.729    173.271     85.359     94.641    105.591     74.409
;   23:34:28.4123-23:34:28.4422      6.318    173.682     88.608     91.392    108.702     71.298
;   23:34:28.4449-23:34:28.4769     22.343    157.657     68.472    111.528     85.167     94.833
;   23:34:28.4822-23:34:28.5147      2.329    177.671     84.215     95.785    103.461     76.539
;   23:34:28.5153-23:34:28.5350     26.520    153.480     71.003    108.997     85.417     94.583
;   23:34:28.5462-23:34:28.5686      8.213    171.787     81.669     98.331     99.488     80.512

theta_kb0211_50_250   = DBLARR(nn)
theta_kn0211_50_250   = DBLARR(nn)
theta_kv0211_50_250   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_50_250[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_50_250[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_50_250[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_50_250[j]),  $
                     REFORM(theta_kn0211_50_250[j]),$
                     REFORM(theta_kv0211_50_250[j])
;
; => For  50 Hz < f < 250 Hz  at  2000-02-11/23:34:27.503 UT
;
;   23:34:27.5110-23:34:27.5766      5.641     81.629     78.866
;   23:34:27.6262-23:34:27.6630      9.382     87.805     70.486
;   23:34:27.7190-23:34:27.7590      6.129     87.482     72.517
;   23:34:27.7659-23:34:27.7878     10.082     84.253     78.814
;   23:34:27.7883-23:34:27.8486     11.557     77.862     84.559
;   23:34:27.8859-23:34:27.9094      6.403     80.089     80.783
;   23:34:27.9259-23:34:27.9606     11.012     81.105     81.719
;   23:34:27.9606-23:34:27.9910      3.751     88.687     72.859
;   23:34:28.0614-23:34:28.0977     11.001     75.344     85.115
;   23:34:28.1286-23:34:28.1542      6.816     87.525     69.027
;   23:34:28.1638-23:34:28.1889      3.104     89.140     71.707
;   23:34:28.1894-23:34:28.2545     14.912     74.797     87.898
;   23:34:28.2625-23:34:28.2966      2.478     88.668     72.332
;   23:34:28.3345-23:34:28.3782      1.042     86.957     73.771
;   23:34:28.3899-23:34:28.4118      6.729     85.359     74.409
;   23:34:28.4123-23:34:28.4422      6.318     88.608     71.298
;   23:34:28.4449-23:34:28.4769     22.343     68.472     85.167
;   23:34:28.4822-23:34:28.5147      2.329     84.215     76.539
;   23:34:28.5153-23:34:28.5350     26.520     71.003     85.417
;   23:34:28.5462-23:34:28.5686      8.213     81.669     80.512

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_50_250
PRINT,FORMAT=tkbf,theta_kn0211_50_250
PRINT,FORMAT=tkbf,theta_kv0211_50_250

theta_kb0211_50_250 = [ 5.64, 9.38, 6.13,10.08,11.56, 6.40,11.01, 3.75,11.00, 6.82,$
                        3.10,14.91, 2.48, 1.04, 6.73, 6.32,22.34, 2.33,26.52, 8.21]
theta_kn0211_50_250 = [81.63,87.80,87.48,84.25,77.86,80.09,81.10,88.69,75.34,87.53,$
                        89.14,74.80,88.67,86.96,85.36,88.61,68.47,84.22,71.00,81.67]
theta_kv0211_50_250 = [78.87,70.49,72.52,78.81,84.56,80.78,81.72,72.86,85.12,69.03,$
                        71.71,87.90,72.33,73.77,74.41,71.30,85.17,76.54,85.42,80.51]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------

jj      = 4L
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      40.0
print, hfc0, format='(";",8f10.1)'
;     250.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

;-----------------------------------------------------------------------------------------
; => For  40 Hz < f < 250 Hz  at  2000-02-11/23:34:29.065 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 165-381
;Plot Range: 23:34:29.1530-23:34:29.2682
;The angle between DC-Field and the k-vector is :
;       86.994 +/- 0.575 degrees
;The eigenvalues ratios are:
;       48.199470       1.9828951
;The Minimum Variance eigenvector is:
;< 0.29357,-0.95551, 0.02846> +/- <-0.05203,-0.01627,-0.00956>
;
;Plot Index Range: 165-285
;Plot Range: 23:34:29.1530-23:34:29.2170
;The angle between DC-Field and the k-vector is :
;       89.717 +/- 0.757 degrees
;The eigenvalues ratios are:
;       50.063278       2.0020758
;The Minimum Variance eigenvector is:
;< 0.25646,-0.96585,-0.03706> +/- <-0.06010,-0.01559,-0.00970>
;
;Plot Index Range: 285-381
;Plot Range: 23:34:29.2170-23:34:29.2682
;The angle between DC-Field and the k-vector is :
;       89.774 +/- 0.562 degrees
;The eigenvalues ratios are:
;       111.52470       1.9444146
;The Minimum Variance eigenvector is:
;< 0.32790,-0.93987, 0.09558> +/- <-0.04111,-0.01516,-0.00806>
;
;Plot Index Range: 381-522
;Plot Range: 23:34:29.2682-23:34:29.3434
;The angle between DC-Field and the k-vector is :
;       75.074 +/- 0.742 degrees
;The eigenvalues ratios are:
;       44.573428       1.7245797
;The Minimum Variance eigenvector is:
;< 0.20398,-0.97896,-0.00621> +/- <-0.06421,-0.01335,-0.00422>
;
;Plot Index Range: 560-711
;Plot Range: 23:34:29.3637-23:34:29.4442
;The angle between DC-Field and the k-vector is :
;       85.602 +/- 0.671 degrees
;The eigenvalues ratios are:
;       50.619485       1.8549344
;The Minimum Variance eigenvector is:
;< 0.24202,-0.96944,-0.04009> +/- <-0.05712,-0.01382,-0.01077>
;
;Plot Index Range: 747-852
;Plot Range: 23:34:29.4634-23:34:29.5194
;The angle between DC-Field and the k-vector is :
;       77.146 +/- 1.078 degrees
;The eigenvalues ratios are:
;       29.135429       1.9612188
;The Minimum Variance eigenvector is:
;< 0.28675,-0.95617,-0.05921> +/- <-0.08114,-0.02331,-0.01652>
;
;Plot Index Range: 854-1153
;Plot Range: 23:34:29.5205-23:34:29.6799
;The angle between DC-Field and the k-vector is :
;       6.737 +/- 0.460 degrees
;The eigenvalues ratios are:
;       53.985637       1.8934814
;The Minimum Variance eigenvector is:
;< 0.28011,-0.95977, 0.01928> +/- <-0.04595,-0.01357,-0.00773>
;
;Plot Index Range: 891-978
;Plot Range: 23:34:29.5402-23:34:29.5866
;The angle between DC-Field and the k-vector is :
;       89.253 +/- 0.541 degrees
;The eigenvalues ratios are:
;       132.58086       1.9663781
;The Minimum Variance eigenvector is:
;< 0.18981,-0.98114,-0.03655> +/- <-0.04051,-0.00758,-0.00693>
;
;Plot Index Range: 998-1106
;Plot Range: 23:34:29.5973-23:34:29.6549
;The angle between DC-Field and the k-vector is :
;       4.182 +/- 0.655 degrees
;The eigenvalues ratios are:
;       73.517730       1.8301229
;The Minimum Variance eigenvector is:
;< 0.32919,-0.94306, 0.04765> +/- <-0.05024,-0.01794,-0.00792>
;
;Plot Index Range: 1107-1193
;Plot Range: 23:34:29.6554-23:34:29.7013
;The angle between DC-Field and the k-vector is :
;       85.089 +/- 0.581 degrees
;The eigenvalues ratios are:
;       116.21488       1.8807890
;The Minimum Variance eigenvector is:
;< 0.32692,-0.94460, 0.02923> +/- <-0.04202,-0.01477,-0.00725>
;
;Plot Index Range: 1274-1337
;Plot Range: 23:34:29.7445-23:34:29.7781
;The angle between DC-Field and the k-vector is :
;       39.009 +/- 1.326 degrees
;The eigenvalues ratios are:
;       32.072602       1.8140486
;The Minimum Variance eigenvector is:
;< 0.33162,-0.93816,-0.09946> +/- <-0.08852,-0.02981,-0.01401>
;
;Plot Index Range: 1371-1460
;Plot Range: 23:34:29.7962-23:34:29.8437
;The angle between DC-Field and the k-vector is :
;       87.857 +/- 1.590 degrees
;The eigenvalues ratios are:
;       16.703635       1.8142964
;The Minimum Variance eigenvector is:
;< 0.40251,-0.91086,-0.09127> +/- <-0.10986,-0.04622,-0.02322>
;
;Plot Index Range: 1461-1632
;Plot Range: 23:34:29.8442-23:34:29.9354
;The angle between DC-Field and the k-vector is :
;       82.802 +/- 0.893 degrees
;The eigenvalues ratios are:
;       26.188622       1.7883974
;The Minimum Variance eigenvector is:
;< 0.26876,-0.96082, 0.06773> +/- <-0.07763,-0.02254,-0.01174>
;
;Plot Index Range: 1470-1545
;Plot Range: 23:34:29.8490-23:34:29.8890
;The angle between DC-Field and the k-vector is :
;       72.135 +/- 0.789 degrees
;The eigenvalues ratios are:
;       73.217856       1.7869554
;The Minimum Variance eigenvector is:
;< 0.32735,-0.94211, 0.07266> +/- <-0.05567,-0.01988,-0.00697>
;
;Plot Index Range: 1545-1625
;Plot Range: 23:34:29.8890-23:34:29.9317
;The angle between DC-Field and the k-vector is :
;       88.817 +/- 1.625 degrees
;The eigenvalues ratios are:
;       17.676595       1.8439619
;The Minimum Variance eigenvector is:
;< 0.17978,-0.98198, 0.05825> +/- <-0.11714,-0.02255,-0.01862>
;
;Plot Index Range: 1680-1732
;Plot Range: 23:34:29.9610-23:34:29.9887
;The angle between DC-Field and the k-vector is :
;       56.567 +/- 1.445 degrees
;The eigenvalues ratios are:
;       32.780140       2.0652437
;The Minimum Variance eigenvector is:
;< 0.35121,-0.93619, 0.01420> +/- <-0.08887,-0.03354,-0.01335>
;
;Plot Index Range: 1800-1852
;Plot Range: 23:34:30.0250-23:34:30.0527
;The angle between DC-Field and the k-vector is :
;       80.111 +/- 1.645 degrees
;The eigenvalues ratios are:
;       25.749164       1.9445251
;The Minimum Variance eigenvector is:
;< 0.27969,-0.95770, 0.06774> +/- <-0.10515,-0.03101,-0.00427>
;
;Plot Index Range: 1878-1949
;Plot Range: 23:34:30.0666-23:34:30.1045
;The angle between DC-Field and the k-vector is :
;       81.248 +/- 0.762 degrees
;The eigenvalues ratios are:
;       82.832377       1.8202052
;The Minimum Variance eigenvector is:
;< 0.30919,-0.95065, 0.02569> +/- <-0.05350,-0.01753,-0.00493>
;
;Plot Index Range: 1960-2041
;Plot Range: 23:34:30.1103-23:34:30.1535
;The angle between DC-Field and the k-vector is :
;       89.608 +/- 0.743 degrees
;The eigenvalues ratios are:
;       76.314016       1.8230944
;The Minimum Variance eigenvector is:
;< 0.24364,-0.96776, 0.06385> +/- <-0.05386,-0.01433,-0.01172>
;

prefd   = '2000-02-11/'
tr0     = time_double([prefd[0]+'23:34:29.1530',prefd[0]+'23:34:29.2170'])
tr1     = time_double([prefd[0]+'23:34:29.2170',prefd[0]+'23:34:29.2682'])
tr2     = time_double([prefd[0]+'23:34:29.2682',prefd[0]+'23:34:29.3434'])
tr3     = time_double([prefd[0]+'23:34:29.3637',prefd[0]+'23:34:29.4442'])
tr4     = time_double([prefd[0]+'23:34:29.4634',prefd[0]+'23:34:29.5194'])
tr5     = time_double([prefd[0]+'23:34:29.5402',prefd[0]+'23:34:29.5866'])
tr6     = time_double([prefd[0]+'23:34:29.5973',prefd[0]+'23:34:29.6549'])
tr7     = time_double([prefd[0]+'23:34:29.6554',prefd[0]+'23:34:29.7013'])
tr8     = time_double([prefd[0]+'23:34:29.7445',prefd[0]+'23:34:29.7781'])
tr9     = time_double([prefd[0]+'23:34:29.7962',prefd[0]+'23:34:29.8437'])
tr10    = time_double([prefd[0]+'23:34:29.8490',prefd[0]+'23:34:29.8890'])
tr11    = time_double([prefd[0]+'23:34:29.8890',prefd[0]+'23:34:29.9317'])
tr12    = time_double([prefd[0]+'23:34:29.9610',prefd[0]+'23:34:29.9887'])
tr13    = time_double([prefd[0]+'23:34:30.0250',prefd[0]+'23:34:30.0527'])
tr14    = time_double([prefd[0]+'23:34:30.0666',prefd[0]+'23:34:30.1045'])
tr15    = time_double([prefd[0]+'23:34:30.1103',prefd[0]+'23:34:30.1535'])

kvec0   = [ 0.25646,-0.96585,-0.03706]
kvec1   = [ 0.32790,-0.93987, 0.09558]
kvec2   = [ 0.20398,-0.97896,-0.00621]
kvec3   = [ 0.24202,-0.96944,-0.04009]
kvec4   = [ 0.28675,-0.95617,-0.05921]
kvec5   = [ 0.18981,-0.98114,-0.03655]
kvec6   = [ 0.32919,-0.94306, 0.04765]
kvec7   = [ 0.32692,-0.94460, 0.02923]
kvec8   = [ 0.33162,-0.93816,-0.09946]
kvec9   = [ 0.40251,-0.91086,-0.09127]
kvec10  = [ 0.32735,-0.94211, 0.07266]
kvec11  = [ 0.17978,-0.98198, 0.05825]
kvec12  = [ 0.35121,-0.93619, 0.01420]
kvec13  = [ 0.27969,-0.95770, 0.06774]
kvec14  = [ 0.30919,-0.95065, 0.02569]
kvec15  = [ 0.24364,-0.96776, 0.06385]

dkvec0  = ABS([-0.06010,-0.01559,-0.00970])
dkvec1  = ABS([-0.04111,-0.01516,-0.00806])
dkvec2  = ABS([-0.06421,-0.01335,-0.00422])
dkvec3  = ABS([-0.05712,-0.01382,-0.01077])
dkvec4  = ABS([-0.08114,-0.02331,-0.01652])
dkvec5  = ABS([-0.04051,-0.00758,-0.00693])
dkvec6  = ABS([-0.05024,-0.01794,-0.00792])
dkvec7  = ABS([-0.04202,-0.01477,-0.00725])
dkvec8  = ABS([-0.08852,-0.02981,-0.01401])
dkvec9  = ABS([-0.10986,-0.04622,-0.02322])
dkvec10 = ABS([-0.05567,-0.01988,-0.00697])
dkvec11 = ABS([-0.11714,-0.02255,-0.01862])
dkvec12 = ABS([-0.08887,-0.03354,-0.01335])
dkvec13 = ABS([-0.10515,-0.03101,-0.00427])
dkvec14 = ABS([-0.05350,-0.01753,-0.00493])
dkvec15 = ABS([-0.05386,-0.01433,-0.01172])

elam0   = [50.063278,2.0020758]
elam1   = [111.52470,1.9444146]
elam2   = [44.573428,1.7245797]
elam3   = [50.619485,1.8549344]
elam4   = [29.135429,1.9612188]
elam5   = [132.58086,1.9663781]
elam6   = [73.517730,1.8301229]
elam7   = [116.21488,1.8807890]
elam8   = [32.072602,1.8140486]
elam9   = [16.703635,1.8142964]
elam10  = [73.217856,1.7869554]
elam11  = [17.676595,1.8439619]
elam12  = [32.780140,2.0652437]
elam13  = [25.749164,1.9445251]
elam14  = [82.832377,1.8202052]
elam15  = [76.314016,1.8230944]

bvec0   = [ 0.37139,-0.92835,-0.01530]
bvec1   = [ 0.37165,-0.92830,-0.01083]
bvec2   = [ 0.37608,-0.92658, 0.00026]
bvec3   = [ 0.37882,-0.92541, 0.01055]
bvec4   = [ 0.38282,-0.92358, 0.02122]
bvec5   = [ 0.38775,-0.92118, 0.03275]
bvec6   = [ 0.39034,-0.91972, 0.04182]
bvec7   = [ 0.39116,-0.91907, 0.04793]
bvec8   = [ 0.39259,-0.91834, 0.05027]
bvec9   = [ 0.39369,-0.91774, 0.05258]
bvec10  = [ 0.39466,-0.91721, 0.05444]
bvec11  = [ 0.39555,-0.91687, 0.05367]
bvec12  = [ 0.39720,-0.91622, 0.05275]
bvec13  = [ 0.39961,-0.91507, 0.05436]
bvec14  = [ 0.40177,-0.91419, 0.05321]
bvec15  = [ 0.40405,-0.91331, 0.05117]
bmag0   = [22.73225]
bmag1   = [22.74712]
bmag2   = [22.80674]
bmag3   = [22.85485]
bmag4   = [22.96912]
bmag5   = [23.01516]
bmag6   = [22.98980]
bmag7   = [22.93417]
bmag8   = [22.89778]
bmag9   = [22.92235]
bmag10  = [22.95454]
bmag11  = [22.97751]
bmag12  = [23.00664]
bmag13  = [23.01699]
bmag14  = [23.00386]
bmag15  = [22.98312]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13',$
           't14','t15']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,$
                        tr13,tr14,tr15)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  40 Hz < f < 250 Hz  at  2000-02-11/23:34:29.065 UT
;
;   23:34:29.1530-23:34:29.2170      0.256     -0.966     -0.037      0.371     -0.928     -0.015     22.732
;   23:34:29.2170-23:34:29.2682      0.328     -0.940      0.096      0.372     -0.928     -0.011     22.747
;   23:34:29.2682-23:34:29.3434      0.204     -0.979     -0.006      0.376     -0.927      0.000     22.807
;   23:34:29.3637-23:34:29.4442      0.242     -0.969     -0.040      0.379     -0.925      0.011     22.855
;   23:34:29.4634-23:34:29.5194      0.287     -0.956     -0.059      0.383     -0.924      0.021     22.969
;   23:34:29.5402-23:34:29.5866      0.190     -0.981     -0.037      0.388     -0.921      0.033     23.015
;   23:34:29.5973-23:34:29.6549      0.329     -0.943      0.048      0.390     -0.920      0.042     22.990
;   23:34:29.6554-23:34:29.7013      0.327     -0.945      0.029      0.391     -0.919      0.048     22.934
;   23:34:29.7445-23:34:29.7781      0.332     -0.938     -0.099      0.393     -0.918      0.050     22.898
;   23:34:29.7962-23:34:29.8437      0.403     -0.911     -0.091      0.394     -0.918      0.053     22.922
;   23:34:29.8490-23:34:29.8890      0.327     -0.942      0.073      0.395     -0.917      0.054     22.955
;   23:34:29.8890-23:34:29.9317      0.180     -0.982      0.058      0.396     -0.917      0.054     22.978
;   23:34:29.9610-23:34:29.9887      0.351     -0.936      0.014      0.397     -0.916      0.053     23.007
;   23:34:30.0250-23:34:30.0527      0.280     -0.958      0.068      0.400     -0.915      0.054     23.017
;   23:34:30.0666-23:34:30.1045      0.309     -0.951      0.026      0.402     -0.914      0.053     23.004
;   23:34:30.1103-23:34:30.1535      0.244     -0.968      0.064      0.404     -0.913      0.051     22.983

vswu   = [-614.831,-87.347,26.389]         ; => My 3DP estimates (km/s) For 2000-02-11/23:34:29.065 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  40 Hz < f < 250 Hz  at  2000-02-11/23:34:29.065 UT
;
;   23:34:29.1530-23:34:29.2170      7.040    172.960     78.074    101.926     96.865     83.135
;   23:34:29.2170-23:34:29.2682      6.629    173.371     80.676     99.324    100.848     79.152
;   23:34:29.2682-23:34:29.3434     10.328    169.672     74.651    105.349     93.696     86.304
;   23:34:29.3637-23:34:29.4442      8.741    171.259     77.285    102.715     96.020     83.980
;   23:34:29.4634-23:34:29.5194      7.426    172.574     80.140     99.860     98.731     81.269
;   23:34:29.5402-23:34:29.5866     12.523    167.477     74.257    105.743     92.948     87.052
;   23:34:29.5973-23:34:29.6549      3.768    176.232     81.263     98.737    101.016     78.984
;   23:34:29.6554-23:34:29.7013      4.104    175.896     81.341     98.659    100.917     79.083
;   23:34:29.7445-23:34:29.7781      9.341    170.659     83.367     96.633    101.561     78.439
;   23:34:29.7962-23:34:29.8437      8.272    171.728     87.499     92.501    105.904     74.096
;   23:34:29.8490-23:34:29.8890      4.240    175.760     80.879     99.121    100.855     79.145
;   23:34:29.8890-23:34:29.9317     12.944    167.056     72.480    107.520     92.141     87.859
;   23:34:29.9610-23:34:29.9887      3.624    176.376     82.966     97.034    102.430     77.570
;   23:34:30.0250-23:34:30.0527      7.336    172.664     78.129    101.871     98.002     81.998
;   23:34:30.0666-23:34:30.1045      5.920    174.080     80.337     99.663     99.855     80.145
;   23:34:30.1103-23:34:30.1535      9.745    170.255     76.078    103.922     95.871     84.129

theta_kb0211_40_250   = DBLARR(nn)
theta_kn0211_40_250   = DBLARR(nn)
theta_kv0211_40_250   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_40_250[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_40_250[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_40_250[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_40_250[j]),  $
                     REFORM(theta_kn0211_40_250[j]),$
                     REFORM(theta_kv0211_40_250[j])
;
; => For  40 Hz < f < 250 Hz  at  2000-02-11/23:34:29.065 UT
;
;   23:34:29.1530-23:34:29.2170      7.040     78.074     83.135
;   23:34:29.2170-23:34:29.2682      6.629     80.676     79.152
;   23:34:29.2682-23:34:29.3434     10.328     74.651     86.304
;   23:34:29.3637-23:34:29.4442      8.741     77.285     83.980
;   23:34:29.4634-23:34:29.5194      7.426     80.140     81.269
;   23:34:29.5402-23:34:29.5866     12.523     74.257     87.052
;   23:34:29.5973-23:34:29.6549      3.768     81.263     78.984
;   23:34:29.6554-23:34:29.7013      4.104     81.341     79.083
;   23:34:29.7445-23:34:29.7781      9.341     83.367     78.439
;   23:34:29.7962-23:34:29.8437      8.272     87.499     74.096
;   23:34:29.8490-23:34:29.8890      4.240     80.879     79.145
;   23:34:29.8890-23:34:29.9317     12.944     72.480     87.859
;   23:34:29.9610-23:34:29.9887      3.624     82.966     77.570
;   23:34:30.0250-23:34:30.0527      7.336     78.129     81.998
;   23:34:30.0666-23:34:30.1045      5.920     80.337     80.145
;   23:34:30.1103-23:34:30.1535      9.745     76.078     84.129

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_40_250
PRINT,FORMAT=tkbf,theta_kn0211_40_250
PRINT,FORMAT=tkbf,theta_kv0211_40_250

theta_kb0211_40_250 = [ 7.04, 6.63,10.33, 8.74, 7.43,12.52, 3.77, 4.10, 9.34, 8.27, 4.24,12.94, 3.62, 7.34, 5.92, 9.75]
theta_kn0211_40_250 = [78.07,80.68,74.65,77.29,80.14,74.26,81.26,81.34,83.37,87.50,80.88,72.48,82.97,78.13,80.34,76.08]
theta_kv0211_40_250 = [83.14,79.15,86.30,83.98,81.27,87.05,78.98,79.08,78.44,74.10,79.14,87.86,77.57,82.00,80.14,84.13]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------

jj      = 5L
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      60.0
print, hfc0, format='(";",8f10.1)'
;     150.0

date = '021200'
vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

;-----------------------------------------------------------------------------------------
; => For  60 Hz < f < 150 Hz  at  2000-02-12/00:14:21.709 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 0-69
;Plot Range: 00:14:21.7090-00:14:21.7458
;The angle between DC-Field and the k-vector is :
;       14.293 +/- 0.425 degrees
;The eigenvalues ratios are:
;       269.53718       1.0422235
;The Minimum Variance eigenvector is:
;< 0.10187, 0.43505, 0.89462> +/- <-0.01449, 0.02964,-0.01276>
;
;Plot Index Range: 69-399
;Plot Range: 00:14:21.7458-00:14:21.9218
;The angle between DC-Field and the k-vector is :
;       73.020 +/- 0.665 degrees
;The eigenvalues ratios are:
;       24.490657       1.3189562
;The Minimum Variance eigenvector is:
;<-0.17217,-0.57240,-0.80169> +/- < 0.07501,-0.01044,-0.00865>
;
;Plot Index Range: 99-192
;Plot Range: 00:14:21.7618-00:14:21.8114
;The angle between DC-Field and the k-vector is :
;       87.087 +/- 0.914 degrees
;The eigenvalues ratios are:
;       44.663497       1.3722606
;The Minimum Variance eigenvector is:
;<-0.25856,-0.57156,-0.77876> +/- < 0.07286,-0.02083,-0.00890>
;
;Plot Index Range: 214-399
;Plot Range: 00:14:21.8231-00:14:21.9218
;The angle between DC-Field and the k-vector is :
;       84.899 +/- 0.437 degrees
;The eigenvalues ratios are:
;       95.480294       1.3104090
;The Minimum Variance eigenvector is:
;<-0.05983,-0.56854,-0.82048> +/- < 0.04400,-0.00216,-0.00171>
;
;Plot Index Range: 399-705
;Plot Range: 00:14:21.9218-00:14:22.0850
;The angle between DC-Field and the k-vector is :
;       75.443 +/- 0.518 degrees
;The eigenvalues ratios are:
;       42.023247       1.2913375
;The Minimum Variance eigenvector is:
;<-0.18953,-0.49878,-0.84575> +/- < 0.05804,-0.00549,-0.00977>
;
;Plot Index Range: 399-525
;Plot Range: 00:14:21.9218-00:14:21.9890
;The angle between DC-Field and the k-vector is :
;       89.503 +/- 0.473 degrees
;The eigenvalues ratios are:
;       119.20714       1.3523514
;The Minimum Variance eigenvector is:
;< 0.21329, 0.46489, 0.85930> +/- <-0.00897, 0.03799,-0.01833>
;
;Plot Index Range: 525-604
;Plot Range: 00:14:21.9890-00:14:22.0311
;The angle between DC-Field and the k-vector is :
;       89.688 +/- 0.371 degrees
;The eigenvalues ratios are:
;       308.25739       1.1614168
;The Minimum Variance eigenvector is:
;<-0.08805,-0.60891,-0.78833> +/- < 0.03046, 0.00302,-0.00574>
;
;Plot Index Range: 630-705
;Plot Range: 00:14:22.0450-00:14:22.0850
;The angle between DC-Field and the k-vector is :
;       73.007 +/- 0.903 degrees
;The eigenvalues ratios are:
;       56.335323       1.2956218
;The Minimum Variance eigenvector is:
;<-0.25167,-0.40920,-0.87705> +/- < 0.06767,-0.02478,-0.00785>
;
;Plot Index Range: 766-903
;Plot Range: 00:14:22.1175-00:14:22.1906
;The angle between DC-Field and the k-vector is :
;       87.171 +/- 0.513 degrees
;The eigenvalues ratios are:
;       93.725799       1.2762985
;The Minimum Variance eigenvector is:
;<-0.13029,-0.69964,-0.70252> +/- < 0.00664, 0.03326,-0.03435>
;
;Plot Index Range: 1068-1324
;Plot Range: 00:14:22.2786-00:14:22.4151
;The angle between DC-Field and the k-vector is :
;       89.660 +/- 0.316 degrees
;The eigenvalues ratios are:
;       130.63958       1.3616905
;The Minimum Variance eigenvector is:
;<-0.27544,-0.59295,-0.75666> +/- < 0.03069,-0.01552, 0.00099>
;
;Plot Index Range: 1068-1196
;Plot Range: 00:14:22.2786-00:14:22.3469
;The angle between DC-Field and the k-vector is :
;       86.624 +/- 0.316 degrees
;The eigenvalues ratios are:
;       260.75304       1.3882296
;The Minimum Variance eigenvector is:
;<-0.30807,-0.59580,-0.74170> +/- < 0.02528,-0.01383, 0.00061>
;
;Plot Index Range: 1197-1323
;Plot Range: 00:14:22.3474-00:14:22.4146
;The angle between DC-Field and the k-vector is :
;       77.753 +/- 0.351 degrees
;The eigenvalues ratios are:
;       215.42307       1.3188908
;The Minimum Variance eigenvector is:
;<-0.20963,-0.58495,-0.78351> +/- < 0.00686, 0.02430,-0.01998>
;
;Plot Index Range: 1324-1561
;Plot Range: 00:14:22.4151-00:14:22.5415
;The angle between DC-Field and the k-vector is :
;       67.572 +/- 0.786 degrees
;The eigenvalues ratios are:
;       24.467416       1.4838013
;The Minimum Variance eigenvector is:
;<-0.30521,-0.65550,-0.69077> +/- < 0.02197, 0.05133,-0.05842>
;
;Plot Index Range: 1324-1383
;Plot Range: 00:14:22.4151-00:14:22.4466
;The angle between DC-Field and the k-vector is :
;       80.893 +/- 1.555 degrees
;The eigenvalues ratios are:
;       25.374810       1.2933339
;The Minimum Variance eigenvector is:
;<-0.29483,-0.57041,-0.76662> +/- < 0.05459, 0.07094,-0.07377>
;
;Plot Index Range: 1407-1472
;Plot Range: 00:14:22.4594-00:14:22.4941
;The angle between DC-Field and the k-vector is :
;       51.025 +/- 0.879 degrees
;The eigenvalues ratios are:
;       68.332710       1.6128089
;The Minimum Variance eigenvector is:
;<-0.35694,-0.65196,-0.66899> +/- < 0.01818, 0.03968,-0.04837>
;
;Plot Index Range: 1473-1560
;Plot Range: 00:14:22.4946-00:14:22.5410
;The angle between DC-Field and the k-vector is :
;       56.210 +/- 0.806 degrees
;The eigenvalues ratios are:
;       60.799266       1.5014990
;The Minimum Variance eigenvector is:
;<-0.26743,-0.68807,-0.67457> +/- < 0.01422, 0.04157,-0.04805>
;
;Plot Index Range: 1561-1923
;Plot Range: 00:14:22.5415-00:14:22.7346
;The angle between DC-Field and the k-vector is :
;       86.999 +/- 0.215 degrees
;The eigenvalues ratios are:
;       197.92116       1.2906666
;The Minimum Variance eigenvector is:
;<-0.28716,-0.64272,-0.71025> +/- < 0.00710, 0.01697,-0.01823>
;
;Plot Index Range: 1584-1773
;Plot Range: 00:14:22.5538-00:14:22.6546
;The angle between DC-Field and the k-vector is :
;       81.520 +/- 0.562 degrees
;The eigenvalues ratios are:
;       57.327302       1.4324975
;The Minimum Variance eigenvector is:
;<-0.34462,-0.66908,-0.65846> +/- < 0.01364, 0.03415,-0.04184>
;
;Plot Index Range: 1789-1923
;Plot Range: 00:14:22.6631-00:14:22.7346
;The angle between DC-Field and the k-vector is :
;       86.582 +/- 0.198 degrees
;The eigenvalues ratios are:
;       630.20445       1.2769111
;The Minimum Variance eigenvector is:
;<-0.27741,-0.63913,-0.71733> +/- < 0.00512, 0.01235,-0.01299>
;

prefd   = '2000-02-12/'
tr0     = time_double([prefd[0]+'00:14:21.7090',prefd[0]+'00:14:21.7458'])
tr1     = time_double([prefd[0]+'00:14:21.7618',prefd[0]+'00:14:21.8114'])
tr2     = time_double([prefd[0]+'00:14:21.8231',prefd[0]+'00:14:21.9218'])
tr3     = time_double([prefd[0]+'00:14:21.9218',prefd[0]+'00:14:21.9890'])
tr4     = time_double([prefd[0]+'00:14:21.9890',prefd[0]+'00:14:22.0311'])
tr5     = time_double([prefd[0]+'00:14:22.0450',prefd[0]+'00:14:22.0850'])
tr6     = time_double([prefd[0]+'00:14:22.1175',prefd[0]+'00:14:22.1906'])
tr7     = time_double([prefd[0]+'00:14:22.2786',prefd[0]+'00:14:22.3469'])
tr8     = time_double([prefd[0]+'00:14:22.3474',prefd[0]+'00:14:22.4146'])
tr9     = time_double([prefd[0]+'00:14:22.4151',prefd[0]+'00:14:22.4466'])
tr10    = time_double([prefd[0]+'00:14:22.4594',prefd[0]+'00:14:22.4941'])
tr11    = time_double([prefd[0]+'00:14:22.4946',prefd[0]+'00:14:22.5410'])
tr12    = time_double([prefd[0]+'00:14:22.5538',prefd[0]+'00:14:22.6546'])
tr13    = time_double([prefd[0]+'00:14:22.6631',prefd[0]+'00:14:22.7346'])

kvec0   = [ 0.10187, 0.43505, 0.89462]
kvec1   = [-0.25856,-0.57156,-0.77876]
kvec2   = [-0.05983,-0.56854,-0.82048]
kvec3   = [ 0.21329, 0.46489, 0.85930]
kvec4   = [-0.08805,-0.60891,-0.78833]
kvec5   = [-0.25167,-0.40920,-0.87705]
kvec6   = [-0.13029,-0.69964,-0.70252]
kvec7   = [-0.30807,-0.59580,-0.74170]
kvec8   = [-0.20963,-0.58495,-0.78351]
kvec9   = [-0.29483,-0.57041,-0.76662]
kvec10  = [-0.35694,-0.65196,-0.66899]
kvec11  = [-0.26743,-0.68807,-0.67457]
kvec12  = [-0.34462,-0.66908,-0.65846]
kvec13  = [-0.27741,-0.63913,-0.71733]

dkvec0  = ABS([-0.01449, 0.02964,-0.01276])
dkvec1  = ABS([ 0.07286,-0.02083,-0.00890])
dkvec2  = ABS([ 0.04400,-0.00216,-0.00171])
dkvec3  = ABS([-0.00897, 0.03799,-0.01833])
dkvec4  = ABS([ 0.03046, 0.00302,-0.00574])
dkvec5  = ABS([ 0.06767,-0.02478,-0.00785])
dkvec6  = ABS([ 0.00664, 0.03326,-0.03435])
dkvec7  = ABS([ 0.02528,-0.01383, 0.00061])
dkvec8  = ABS([ 0.00686, 0.02430,-0.01998])
dkvec9  = ABS([ 0.05459, 0.07094,-0.07377])
dkvec10 = ABS([ 0.01818, 0.03968,-0.04837])
dkvec11 = ABS([ 0.01422, 0.04157,-0.04805])
dkvec12 = ABS([ 0.01364, 0.03415,-0.04184])
dkvec13 = ABS([ 0.00512, 0.01235,-0.01299])

elam0   = [269.53718,1.0422235]
elam1   = [44.663497,1.3722606]
elam2   = [95.480294,1.3104090]
elam3   = [119.20714,1.3523514]
elam4   = [308.25739,1.1614168]
elam5   = [56.335323,1.2956218]
elam6   = [93.725799,1.2762985]
elam7   = [260.75304,1.3882296]
elam8   = [215.42307,1.3188908]
elam9   = [25.374810,1.2933339]
elam10  = [68.332710,1.6128089]
elam11  = [60.799266,1.5014990]
elam12  = [57.327302,1.4324975]
elam13  = [630.20445,1.2769111]

bvec0   = [-0.12224,-0.64825,-0.75155]
bvec1   = [-0.12241,-0.64658,-0.75296]
bvec2   = [-0.12379,-0.64289,-0.75589]
bvec3   = [-0.12343,-0.64047,-0.75800]
bvec4   = [-0.12263,-0.64003,-0.75850]
bvec5   = [-0.12179,-0.63960,-0.75900]
bvec6   = [-0.12024,-0.63791,-0.76067]
bvec7   = [-0.11694,-0.63645,-0.76240]
bvec8   = [-0.11547,-0.63607,-0.76294]
bvec9   = [-0.11456,-0.63585,-0.76326]
bvec10  = [-0.11558,-0.63558,-0.76334]
bvec11  = [-0.11608,-0.63540,-0.76341]
bvec12  = [-0.11444,-0.63520,-0.76383]
bvec13  = [-0.11292,-0.63378,-0.76522]
bmag0   = [18.10956]
bmag1   = [18.07622]
bmag2   = [18.08044]
bmag3   = [18.06561]
bmag4   = [18.04972]
bmag5   = [18.03890]
bmag6   = [18.05876]
bmag7   = [18.12547]
bmag8   = [18.13595]
bmag9   = [18.14374]
bmag10  = [18.15516]
bmag11  = [18.16480]
bmag12  = [18.18088]
bmag13  = [18.19254]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,$
                        tr13)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9,kvec10,kvec11,kvec12,kvec13)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  60 Hz < f < 150 Hz  at  2000-02-12/00:14:21.709 UT
;
;   00:14:21.7090-00:14:21.7458      0.102      0.435      0.895     -0.122     -0.648     -0.752     18.110
;   00:14:21.7618-00:14:21.8114     -0.259     -0.572     -0.779     -0.122     -0.647     -0.753     18.076
;   00:14:21.8231-00:14:21.9218     -0.060     -0.569     -0.820     -0.124     -0.643     -0.756     18.080
;   00:14:21.9218-00:14:21.9890      0.213      0.465      0.859     -0.123     -0.640     -0.758     18.066
;   00:14:21.9890-00:14:22.0311     -0.088     -0.609     -0.788     -0.123     -0.640     -0.758     18.050
;   00:14:22.0450-00:14:22.0850     -0.252     -0.409     -0.877     -0.122     -0.640     -0.759     18.039
;   00:14:22.1175-00:14:22.1906     -0.130     -0.700     -0.703     -0.120     -0.638     -0.761     18.059
;   00:14:22.2786-00:14:22.3469     -0.308     -0.596     -0.742     -0.117     -0.636     -0.762     18.125
;   00:14:22.3474-00:14:22.4146     -0.210     -0.585     -0.784     -0.115     -0.636     -0.763     18.136
;   00:14:22.4151-00:14:22.4466     -0.295     -0.570     -0.767     -0.115     -0.636     -0.763     18.144
;   00:14:22.4594-00:14:22.4941     -0.357     -0.652     -0.669     -0.116     -0.636     -0.763     18.155
;   00:14:22.4946-00:14:22.5410     -0.267     -0.688     -0.675     -0.116     -0.635     -0.763     18.165
;   00:14:22.5538-00:14:22.6546     -0.345     -0.669     -0.658     -0.114     -0.635     -0.764     18.181
;   00:14:22.6631-00:14:22.7346     -0.277     -0.639     -0.717     -0.113     -0.634     -0.765     18.193

vswu   = [-545.068,-104.704,71.029]         ; => My 3DP estimates (km/s) For 2000-02-12/00:14:21.709 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  60 Hz < f < 150 Hz  at  2000-02-12/00:14:21.709 UT
;
;   00:14:21.7090-00:14:21.7458    165.201     14.799     95.148     84.852     93.846     86.154
;   00:14:21.7618-00:14:21.8114      9.038    170.962     71.806    108.194     74.932    105.068
;   00:14:21.8231-00:14:21.9218      6.731    173.269     82.538     97.462     86.531     93.469
;   00:14:21.9218-00:14:21.9890    167.271     12.729    101.964     78.036    100.701     79.299
;   00:14:21.9890-00:14:22.0311      3.173    176.827     79.657    100.343     84.282     95.718
;   00:14:22.0450-00:14:22.0850     16.654    163.346     77.792    102.208     77.855    102.145
;   00:14:22.1175-00:14:22.1906      4.893    175.107     73.991    106.009     80.290     99.710
;   00:14:22.2786-00:14:22.3469     11.276    168.724     68.032    111.968     71.493    108.507
;   00:14:22.3474-00:14:22.4146      6.254    173.746     74.043    105.957     77.631    102.369
;   00:14:22.4151-00:14:22.4466     11.007    168.993     69.774    110.226     72.746    107.254
;   00:14:22.4594-00:14:22.4941     14.919    165.081     62.768    117.232     67.371    112.629
;   00:14:22.4946-00:14:22.5410     10.512    169.488     66.717    113.283     72.324    107.676
;   00:14:22.5538-00:14:22.6546     14.674    165.326     62.808    117.192     67.833    112.167
;   00:14:22.6631-00:14:22.7346      9.832    170.168     68.132    111.868     72.617    107.383

theta_kb0211_60_150   = DBLARR(nn)
theta_kn0211_60_150   = DBLARR(nn)
theta_kv0211_60_150   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_60_150[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_60_150[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_60_150[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_60_150[j]),  $
                     REFORM(theta_kn0211_60_150[j]),$
                     REFORM(theta_kv0211_60_150[j])
;
; => For  60 Hz < f < 150 Hz  at  2000-02-12/00:14:21.709 UT
;
;   00:14:21.7090-00:14:21.7458     14.799     84.852     86.154
;   00:14:21.7618-00:14:21.8114      9.038     71.806     74.932
;   00:14:21.8231-00:14:21.9218      6.731     82.538     86.531
;   00:14:21.9218-00:14:21.9890     12.729     78.036     79.299
;   00:14:21.9890-00:14:22.0311      3.173     79.657     84.282
;   00:14:22.0450-00:14:22.0850     16.654     77.792     77.855
;   00:14:22.1175-00:14:22.1906      4.893     73.991     80.290
;   00:14:22.2786-00:14:22.3469     11.276     68.032     71.493
;   00:14:22.3474-00:14:22.4146      6.254     74.043     77.631
;   00:14:22.4151-00:14:22.4466     11.007     69.774     72.746
;   00:14:22.4594-00:14:22.4941     14.919     62.768     67.371
;   00:14:22.4946-00:14:22.5410     10.512     66.717     72.324
;   00:14:22.5538-00:14:22.6546     14.674     62.808     67.833
;   00:14:22.6631-00:14:22.7346      9.832     68.132     72.617

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_60_150
PRINT,FORMAT=tkbf,theta_kn0211_60_150
PRINT,FORMAT=tkbf,theta_kv0211_60_150

theta_kb0211_60_150 = [14.80, 9.04, 6.73,12.73, 3.17,16.65, 4.89,11.28, 6.25,11.01,14.92,10.51,14.67, 9.83]
theta_kn0211_60_150 = [84.85,71.81,82.54,78.04,79.66,77.79,73.99,68.03,74.04,69.77,62.77,66.72,62.81,68.13]
theta_kv0211_60_150 = [86.15,74.93,86.53,79.30,84.28,77.85,80.29,71.49,77.63,72.75,67.37,72.32,67.83,72.62]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------

jj      = 6L
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      36.0
print, hfc0, format='(";",8f10.1)'
;     100.0

date = '021200'
vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

;-----------------------------------------------------------------------------------------
; => For  36 Hz < f < 100 Hz  at  2000-02-12/00:26:17.217 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 29-150
;Plot Range: 00:26:17.2325-00:26:17.2970
;The angle between DC-Field and the k-vector is :
;       74.265 +/- 0.539 degrees
;The eigenvalues ratios are:
;       96.128769       1.1319358
;The Minimum Variance eigenvector is:
;< 0.19279,-0.97200,-0.13433> +/- < 0.01944, 0.01015,-0.04554>
;
;Plot Index Range: 843-1419
;Plot Range: 00:26:17.6666-00:26:17.9738
;The angle between DC-Field and the k-vector is :
;       6.562 +/- 0.269 degrees
;The eigenvalues ratios are:
;       80.885307       2.3037649
;The Minimum Variance eigenvector is:
;< 0.34774,-0.92732,-0.13841> +/- <-0.02071,-0.00408,-0.02471>
;
;Plot Index Range: 1074-1280
;Plot Range: 00:26:17.7898-00:26:17.8997
;The angle between DC-Field and the k-vector is :
;       86.834 +/- 0.265 degrees
;The eigenvalues ratios are:
;       229.59134       1.4799352
;The Minimum Variance eigenvector is:
;< 0.33187,-0.93231,-0.14377> +/- <-0.02535,-0.00863,-0.00257>
;
;Plot Index Range: 1074-1335
;Plot Range: 00:26:17.7898-00:26:17.9290
;The angle between DC-Field and the k-vector is :
;       88.431 +/- 0.247 degrees
;The eigenvalues ratios are:
;       209.63348       1.4610494
;The Minimum Variance eigenvector is:
;< 0.32998,-0.93230,-0.14808> +/- <-0.02509,-0.00849,-0.00244>
;
;Plot Index Range: 1074-1203
;Plot Range: 00:26:17.7898-00:26:17.8586
;The angle between DC-Field and the k-vector is :
;       87.996 +/- 0.224 degrees
;The eigenvalues ratios are:
;       511.51227       1.4964371
;The Minimum Variance eigenvector is:
;< 0.34941,-0.92664,-0.13873> +/- <-0.01888,-0.00673,-0.00257>
;
;Plot Index Range: 1204-1335
;Plot Range: 00:26:17.8591-00:26:17.9290
;The angle between DC-Field and the k-vector is :
;       82.341 +/- 0.378 degrees
;The eigenvalues ratios are:
;       178.53006       1.3377061
;The Minimum Variance eigenvector is:
;<-0.25181, 0.95126, 0.17801> +/- <-0.00917, 0.00384,-0.03349>
;

prefd   = '2000-02-12/'
tr0     = time_double([prefd[0]+'00:26:17.2325',prefd[0]+'00:26:17.2970'])
tr1     = time_double([prefd[0]+'00:26:17.7898',prefd[0]+'00:26:17.8586'])
tr2     = time_double([prefd[0]+'00:26:17.8591',prefd[0]+'00:26:17.9290'])

kvec0   = [ 0.19279,-0.97200,-0.13433]
kvec1   = [ 0.34941,-0.92664,-0.13873]
kvec2   = [-0.25181, 0.95126, 0.17801]

dkvec0  = ABS([ 0.01944, 0.01015,-0.04554])
dkvec1  = ABS([-0.01888,-0.00673,-0.00257])
dkvec2  = ABS([-0.00917, 0.00384,-0.03349])

elam0   = [96.128769,1.1319358]
elam1   = [511.51227,1.4964371]
elam2   = [178.53006,1.3377061]

bvec0   = [ 0.42626,-0.90204,-0.06793]
bvec1   = [ 0.43669,-0.89770,-0.05870]
bvec2   = [ 0.43886,-0.89663,-0.05875]
bmag0   = [15.04594]
bmag1   = [15.14061]
bmag2   = [15.12228]

tags    = ['t0','t1','t2']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  36 Hz < f < 100 Hz  at  2000-02-12/00:26:17.217 UT
;
;   00:26:17.2325-00:26:17.2970      0.193     -0.972     -0.134      0.426     -0.902     -0.068     15.046
;   00:26:17.7898-00:26:17.8586      0.349     -0.927     -0.139      0.437     -0.898     -0.059     15.141
;   00:26:17.8591-00:26:17.9290     -0.252      0.951      0.178      0.439     -0.897     -0.059     15.122

vswu   = [-544.911,-108.653,50.280]         ; => My 3DP estimates (km/s) For 2000-02-12/00:26:17.217 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  36 Hz < f < 100 Hz  at  2000-02-12/00:26:17.217 UT
;
;   00:26:17.2325-00:26:17.2970     14.513    165.487     75.919    104.081     90.636     89.364
;   00:26:17.7898-00:26:17.8586      6.990    173.010     85.046     94.954     99.980     80.020
;   00:26:17.8591-00:26:17.9290    166.880     13.120     99.983     80.017     85.599     94.401

theta_kb0211_36_100   = DBLARR(nn)
theta_kn0211_36_100   = DBLARR(nn)
theta_kv0211_36_100   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_36_100[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_36_100[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_36_100[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_36_100[j]),  $
                     REFORM(theta_kn0211_36_100[j]),$
                     REFORM(theta_kv0211_36_100[j])
;
; => For  36 Hz < f < 100 Hz  at  2000-02-12/00:26:17.217 UT
;
;   00:26:17.2325-00:26:17.2970     14.513     75.919     89.364
;   00:26:17.7898-00:26:17.8586      6.990     85.046     80.020
;   00:26:17.8591-00:26:17.9290     13.120     80.017     85.599

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_36_100
PRINT,FORMAT=tkbf,theta_kn0211_36_100
PRINT,FORMAT=tkbf,theta_kv0211_36_100

theta_kb0211_36_100 = [14.51, 6.99,13.12]
theta_kn0211_36_100 = [75.92,85.05,80.02]
theta_kv0211_36_100 = [89.36,80.02,85.60]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------

jj      = 7L
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      30.0
print, hfc0, format='(";",8f10.1)'
;     100.0

date = '021200'
vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi

;-----------------------------------------------------------------------------------------
; => For  30 Hz < f < 100 Hz  at  2000-02-12/00:27:19.142 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 105-381
;Plot Range: 00:27:19.1980-00:27:19.3452
;The angle between DC-Field and the k-vector is :
;       87.222 +/- 0.352 degrees
;The eigenvalues ratios are:
;       98.259220       1.3890636
;The Minimum Variance eigenvector is:
;< 0.41509,-0.90863,-0.04562> +/- <-0.03527,-0.01598,-0.00261>
;
;Plot Index Range: 105-207
;Plot Range: 00:27:19.1980-00:27:19.2524
;The angle between DC-Field and the k-vector is :
;       86.568 +/- 0.390 degrees
;The eigenvalues ratios are:
;       215.67397       1.3824462
;The Minimum Variance eigenvector is:
;< 0.45898,-0.88673,-0.05524> +/- <-0.02971,-0.01511,-0.00423>
;
;Plot Index Range: 243-381
;Plot Range: 00:27:19.2716-00:27:19.3452
;The angle between DC-Field and the k-vector is :
;       86.044 +/- 0.333 degrees
;The eigenvalues ratios are:
;       218.11937       1.4130172
;The Minimum Variance eigenvector is:
;< 0.36747,-0.92973,-0.02390> +/- <-0.02863,-0.01127,-0.00169>
;
;Plot Index Range: 589-666
;Plot Range: 00:27:19.4561-00:27:19.4972
;The angle between DC-Field and the k-vector is :
;       64.350 +/- 0.237 degrees
;The eigenvalues ratios are:
;       769.25053       1.4416568
;The Minimum Variance eigenvector is:
;< 0.50717,-0.86183, 0.00551> +/- <-0.01616,-0.00953,-0.00238>
;
;Plot Index Range: 693-797
;Plot Range: 00:27:19.5116-00:27:19.5671
;The angle between DC-Field and the k-vector is :
;       85.666 +/- 0.604 degrees
;The eigenvalues ratios are:
;       89.469035       1.4648732
;The Minimum Variance eigenvector is:
;< 0.52313,-0.84176,-0.13336> +/- <-0.04375,-0.02705,-0.00089>
;
;Plot Index Range: 798-924
;Plot Range: 00:27:19.5676-00:27:19.6348
;The angle between DC-Field and the k-vector is :
;       79.037 +/- 0.667 degrees
;The eigenvalues ratios are:
;       60.978005       1.6127469
;The Minimum Variance eigenvector is:
;< 0.40270,-0.90921,-0.10570> +/- <-0.05241,-0.02158,-0.01400>
;
;Plot Index Range: 1110-1330
;Plot Range: 00:27:19.7340-00:27:19.8513
;The angle between DC-Field and the k-vector is :
;       89.790 +/- 0.358 degrees
;The eigenvalues ratios are:
;       118.84870       1.6363366
;The Minimum Variance eigenvector is:
;< 0.46709,-0.88280,-0.04984> +/- <-0.03168,-0.01645,-0.00550>
;
;Plot Index Range: 1345-1695
;Plot Range: 00:27:19.8593-00:27:20.0460
;The angle between DC-Field and the k-vector is :
;       85.049 +/- 0.310 degrees
;The eigenvalues ratios are:
;       99.597603       1.5074495
;The Minimum Variance eigenvector is:
;< 0.37829,-0.92327,-0.06681> +/- <-0.03303,-0.01335,-0.00248>
;
;Plot Index Range: 1347-1473
;Plot Range: 00:27:19.8604-00:27:19.9276
;The angle between DC-Field and the k-vector is :
;       46.876 +/- 0.287 degrees
;The eigenvalues ratios are:
;       320.26853       1.4897381
;The Minimum Variance eigenvector is:
;< 0.38243,-0.92297,-0.04322> +/- <-0.02372,-0.00973,-0.00211>
;
;Plot Index Range: 1474-1638
;Plot Range: 00:27:19.9281-00:27:20.0156
;The angle between DC-Field and the k-vector is :
;       81.742 +/- 0.529 degrees
;The eigenvalues ratios are:
;       74.011701       1.5091619
;The Minimum Variance eigenvector is:
;< 0.37606,-0.92293,-0.08233> +/- <-0.04649,-0.01878,-0.00189>
;
;Plot Index Range: 1695-1827
;Plot Range: 00:27:20.0460-00:27:20.1164
;The angle between DC-Field and the k-vector is :
;       83.373 +/- 0.335 degrees
;The eigenvalues ratios are:
;       225.48382       1.4897473
;The Minimum Variance eigenvector is:
;< 0.46029,-0.88747,-0.02275> +/- <-0.02679,-0.01381,-0.00335>
;
;Plot Index Range: 1838-1908
;Plot Range: 00:27:20.1223-00:27:20.1596
;The angle between DC-Field and the k-vector is :
;       60.657 +/- 0.854 degrees
;The eigenvalues ratios are:
;       67.240799       1.3189971
;The Minimum Variance eigenvector is:
;< 0.43724,-0.89920,-0.01594> +/- <-0.05895,-0.02892, 0.01414>
;
;Plot Index Range: 1978-2047
;Plot Range: 00:27:20.1969-00:27:20.2337
;The angle between DC-Field and the k-vector is :
;       3.774 +/- 0.771 degrees
;The eigenvalues ratios are:
;       83.110468       1.5730526
;The Minimum Variance eigenvector is:
;< 0.36780,-0.92975,-0.01704> +/- <-0.05379,-0.02113,-0.00841>
;

prefd   = '2000-02-12/'
tr0     = time_double([prefd[0]+'00:27:19.1980',prefd[0]+'00:27:19.2524'])
tr1     = time_double([prefd[0]+'00:27:19.2716',prefd[0]+'00:27:19.3452'])
tr2     = time_double([prefd[0]+'00:27:19.4561',prefd[0]+'00:27:19.4972'])
tr3     = time_double([prefd[0]+'00:27:19.5116',prefd[0]+'00:27:19.5671'])
tr4     = time_double([prefd[0]+'00:27:19.5676',prefd[0]+'00:27:19.6348'])
tr5     = time_double([prefd[0]+'00:27:19.7340',prefd[0]+'00:27:19.8513'])
tr6     = time_double([prefd[0]+'00:27:19.8604',prefd[0]+'00:27:19.9276'])
tr7     = time_double([prefd[0]+'00:27:19.9281',prefd[0]+'00:27:20.0156'])
tr8     = time_double([prefd[0]+'00:27:20.0460',prefd[0]+'00:27:20.1164'])
tr9     = time_double([prefd[0]+'00:27:20.1223',prefd[0]+'00:27:20.1596'])
tr10    = time_double([prefd[0]+'00:27:20.1969',prefd[0]+'00:27:20.2337'])

kvec0   = [ 0.45898,-0.88673,-0.05524]
kvec1   = [ 0.36747,-0.92973,-0.02390]
kvec2   = [ 0.50717,-0.86183, 0.00551]
kvec3   = [ 0.52313,-0.84176,-0.13336]
kvec4   = [ 0.40270,-0.90921,-0.10570]
kvec5   = [ 0.46709,-0.88280,-0.04984]
kvec6   = [ 0.38243,-0.92297,-0.04322]
kvec7   = [ 0.37606,-0.92293,-0.08233]
kvec8   = [ 0.46029,-0.88747,-0.02275]
kvec9   = [ 0.43724,-0.89920,-0.01594]
kvec10  = [ 0.36780,-0.92975,-0.01704]

dkvec0  = ABS([-0.02971,-0.01511,-0.00423])
dkvec1  = ABS([-0.02863,-0.01127,-0.00169])
dkvec2  = ABS([-0.01616,-0.00953,-0.00238])
dkvec3  = ABS([-0.04375,-0.02705,-0.00089])
dkvec4  = ABS([-0.05241,-0.02158,-0.01400])
dkvec5  = ABS([-0.03168,-0.01645,-0.00550])
dkvec6  = ABS([-0.02372,-0.00973,-0.00211])
dkvec7  = ABS([-0.04649,-0.01878,-0.00189])
dkvec8  = ABS([-0.02679,-0.01381,-0.00335])
dkvec9  = ABS([-0.05895,-0.02892, 0.01414])
dkvec10 = ABS([-0.05379,-0.02113,-0.00841])

elam0   = [215.67397,1.3824462]
elam1   = [218.11937,1.4130172]
elam2   = [769.25053,1.4416568]
elam3   = [89.469035,1.4648732]
elam4   = [60.978005,1.6127469]
elam5   = [118.84870,1.6363366]
elam6   = [320.26853,1.4897381]
elam7   = [74.011701,1.5091619]
elam8   = [225.48382,1.4897473]
elam9   = [67.240799,1.3189971]
elam10  = [83.110468,1.5730526]

bvec0   = [ 0.43186,-0.90162,-0.02392]
bvec1   = [ 0.43281,-0.90108,-0.02683]
bvec2   = [ 0.43025,-0.90215,-0.03165]
bvec3   = [ 0.43041,-0.90201,-0.03360]
bvec4   = [ 0.43204,-0.90116,-0.03529]
bvec5   = [ 0.42572,-0.90426,-0.03234]
bvec6   = [ 0.42739,-0.90383,-0.02086]
bvec7   = [ 0.42488,-0.90512,-0.01547]
bvec8   = [ 0.42272,-0.90615,-0.01394]
bvec9   = [ 0.42342,-0.90583,-0.01359]
bvec10  = [ 0.42420,-0.90547,-0.01352]
bmag0   = [15.27725]
bmag1   = [15.27566]
bmag2   = [15.27873]
bmag3   = [15.24836]
bmag4   = [15.23861]
bmag5   = [15.40943]
bmag6   = [15.50949]
bmag7   = [15.49808]
bmag8   = [15.46496]
bmag9   = [15.46719]
bmag10  = [15.50073]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9,kvec10)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9,dkvec10)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  30 Hz < f < 100 Hz  at  2000-02-12/00:27:19.142 UT
;
;   00:27:19.1980-00:27:19.2524      0.459     -0.887     -0.055      0.432     -0.902     -0.024     15.277
;   00:27:19.2716-00:27:19.3452      0.367     -0.930     -0.024      0.433     -0.901     -0.027     15.276
;   00:27:19.4561-00:27:19.4972      0.507     -0.862      0.006      0.430     -0.902     -0.032     15.279
;   00:27:19.5116-00:27:19.5671      0.523     -0.842     -0.133      0.430     -0.902     -0.034     15.248
;   00:27:19.5676-00:27:19.6348      0.403     -0.909     -0.106      0.432     -0.901     -0.035     15.239
;   00:27:19.7340-00:27:19.8513      0.467     -0.883     -0.050      0.426     -0.904     -0.032     15.409
;   00:27:19.8604-00:27:19.9276      0.382     -0.923     -0.043      0.427     -0.904     -0.021     15.509
;   00:27:19.9281-00:27:20.0156      0.376     -0.923     -0.082      0.425     -0.905     -0.015     15.498
;   00:27:20.0460-00:27:20.1164      0.460     -0.887     -0.023      0.423     -0.906     -0.014     15.465
;   00:27:20.1223-00:27:20.1596      0.437     -0.899     -0.016      0.423     -0.906     -0.014     15.467
;   00:27:20.1969-00:27:20.2337      0.368     -0.930     -0.017      0.424     -0.905     -0.014     15.501

vswu   = [-543.505,-117.934,36.899]         ; => My 3DP estimates (km/s) For 2000-02-12/00:27:19.142 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,6f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j))
;
; => For  30 Hz < f < 100 Hz  at  2000-02-12/00:27:19.142 UT
;
;   00:27:19.1980-00:27:19.2524      2.521    177.479     90.473     89.527    105.283     74.717
;   00:27:19.2716-00:27:19.3452      4.091    175.909     84.424     95.576     99.392     80.608
;   00:27:19.4561-00:27:19.4972      5.414    174.586     92.749     87.251    108.170     71.830
;   00:27:19.5116-00:27:19.5671      8.539    171.461     95.803     84.197    109.928     70.072
;   00:27:19.5676-00:27:19.6348      4.395    175.605     87.731     92.269    101.964     78.036
;   00:27:19.7340-00:27:19.8513      2.872    177.128     90.909     89.091    105.782     74.218
;   00:27:19.8604-00:27:19.9276      3.084    176.916     85.586     94.414    100.398     79.602
;   00:27:19.9281-00:27:20.0156      4.855    175.145     85.761     94.239    100.188     79.812
;   00:27:20.0460-00:27:20.1164      2.465    177.535     90.113     89.887    105.222     74.778
;   00:27:20.1223-00:27:20.1596      0.900    179.100     88.582     91.418    103.719     76.281
;   00:27:20.1969-00:27:20.2337      3.523    176.477     84.354     95.646     99.384     80.616

theta_kb0211_30_100   = DBLARR(nn)
theta_kn0211_30_100   = DBLARR(nn)
theta_kv0211_30_100   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                         $
  theta_kb0211_30_100[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0211_30_100[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kv0211_30_100[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,3f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0211_30_100[j]),  $
                     REFORM(theta_kn0211_30_100[j]),$
                     REFORM(theta_kv0211_30_100[j])
;
; => For  30 Hz < f < 100 Hz  at  2000-02-12/00:27:19.142 UT
;
;   00:27:19.1980-00:27:19.2524      2.521     89.527     74.717
;   00:27:19.2716-00:27:19.3452      4.091     84.424     80.608
;   00:27:19.4561-00:27:19.4972      5.414     87.251     71.830
;   00:27:19.5116-00:27:19.5671      8.539     84.197     70.072
;   00:27:19.5676-00:27:19.6348      4.395     87.731     78.036
;   00:27:19.7340-00:27:19.8513      2.872     89.091     74.218
;   00:27:19.8604-00:27:19.9276      3.084     85.586     79.602
;   00:27:19.9281-00:27:20.0156      4.855     85.761     79.812
;   00:27:20.0460-00:27:20.1164      2.465     89.887     74.778
;   00:27:20.1223-00:27:20.1596      0.900     88.582     76.281
;   00:27:20.1969-00:27:20.2337      3.523     84.354     80.616

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0211_30_100
PRINT,FORMAT=tkbf,theta_kn0211_30_100
PRINT,FORMAT=tkbf,theta_kv0211_30_100

theta_kb0211_30_100 = [ 2.52, 4.09, 5.41, 8.54, 4.39, 2.87, 3.08, 4.86, 2.46, 0.90, 3.52]
theta_kn0211_30_100 = [89.53,84.42,87.25,84.20,87.73,89.09,85.59,85.76,89.89,88.58,84.35]
theta_kv0211_30_100 = [74.72,80.61,71.83,70.07,78.04,74.22,79.60,79.81,74.78,76.28,80.62]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24













