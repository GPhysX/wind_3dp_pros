; Test 0 = (beta > 0.6 AND Tanis > 0.75) OR  (beta > 0.6 AND Tpar,hc > 7.5)
; Test 1 = (beta > 0.6 AND Tanis > 0.75) AND (beta > 0.6 AND Tpar,hc > 7.5)
; Test 2 = (beta > 0.6 AND Tanis > 0.75)
; Test 3 = (beta AND Tanis)   > (line in Figure 8 of Gary et al., [1994])
; Test 4 = (beta AND Tpar,hc) > (line in Figure 7 of Gary et al., [1994])

; Test 3 = 1 => Whistler heat flux instability
; Test 4 = 1 => Whistler heat flux instability


'----------------------------------------------------------------------------------------------'
' => Whistler Only'
'----------------------------------------------------------------------------------------------'
;----------------------------------------------------------------------------------------------
;          Date        Time             Test 0      Test 1      Test 2      Test 3      Test 4
;            [Start TDSS]
;==============================================================================================
; => For 1998-08-26/06:41:37.623 UT          1          0          1          1          0
; => For 1998-08-26/06:41:44.013 UT          1          0          1          1          0
; => For 1998-08-26/06:41:53.249 UT          1          0          1          1          0
; => For 1998-08-26/06:41:56.315 UT          1          0          1          1          0
; => For 1998-08-26/06:41:57.909 UT          1          0          1          1          0
; => For 1998-08-26/06:41:59.233 UT          1          0          1          1          0
; => For 1998-08-26/06:42:05.763 UT          1          0          1          1          0
; => For 1998-08-26/06:42:09.131 UT          1          0          1          1          0
; => For 2000-02-11/23:34:27.503 UT          0          0          0          1          0
; => For 2000-02-11/23:34:29.065 UT          0          0          0          1          0
; => For 2000-02-12/00:14:21.709 UT          1          1          1          1          1
; => For 2000-02-12/00:26:17.217 UT          1          1          1          1          1
; => For 2000-02-12/00:27:19.142 UT          1          0          1          1          1
;----------------------------------------------------------------------------------------------
;          Date        Time             Test 0      Test 1      Test 2      Test 3      Test 4
;             [End TDSS]
;==============================================================================================
; => For 1998-08-26/06:41:38.714 UT          1          0          1          1          0
; => For 1998-08-26/06:41:45.104 UT          1          0          1          1          0
; => For 1998-08-26/06:41:54.340 UT          1          0          1          1          0
; => For 1998-08-26/06:41:57.406 UT          1          0          1          1          0
; => For 1998-08-26/06:41:59.000 UT          1          0          1          1          0
; => For 1998-08-26/06:42:00.324 UT          1          0          1          1          0
; => For 1998-08-26/06:42:06.854 UT          1          0          1          1          0
; => For 1998-08-26/06:42:10.222 UT          1          0          1          1          0
; => For 2000-02-11/23:34:28.594 UT          0          0          0          1          0
; => For 2000-02-11/23:34:30.156 UT          0          0          0          1          0
; => For 2000-02-12/00:14:22.800 UT          1          1          1          1          1
; => For 2000-02-12/00:26:18.308 UT          1          1          1          1          1
; => For 2000-02-12/00:27:20.233 UT          1          0          1          1          1
;----------------------------------------------------------------------------------------------

'----------------------------------------------------------------------------------------------'
' => Lower Hybrid Only'
'----------------------------------------------------------------------------------------------'
;----------------------------------------------------------------------------------------------
;          Date        Time             Test 0      Test 1      Test 2      Test 3      Test 4
;            [Start TDSS]
;==============================================================================================
; => For 1998-08-26/06:40:54.941 UT          1          0          1          1          0
; => For 1998-08-26/06:41:10.001 UT          1          0          1          1          0
; => For 1998-09-24/23:30:00.465 UT          0          0          0          1          0
; => For 1998-09-24/23:43:18.951 UT          0          0          0          1          0
; => For 1998-09-24/23:48:39.020 UT          0          0          0          1          0
; => For 1998-09-24/23:48:51.622 UT          0          0          0          0          0
; => For 1998-09-25/00:04:04.545 UT          1          0          1          1          0
; => For 1998-09-25/00:14:50.603 UT          0          0          0          1          0
;----------------------------------------------------------------------------------------------
;          Date        Time             Test 0      Test 1      Test 2      Test 3      Test 4
;             [End TDSS]
;==============================================================================================
; => For 1998-08-26/06:40:56.032 UT          1          0          1          1          0
; => For 1998-08-26/06:41:11.092 UT          1          0          1          1          0
; => For 1998-09-24/23:30:01.556 UT          0          0          0          1          0
; => For 1998-09-24/23:43:20.042 UT          0          0          0          1          0
; => For 1998-09-24/23:48:40.111 UT          0          0          0          1          0
; => For 1998-09-24/23:48:52.713 UT          0          0          0          0          0
; => For 1998-09-25/00:04:05.636 UT          1          0          1          1          0
; => For 1998-09-25/00:14:51.694 UT          0          0          0          1          0
;----------------------------------------------------------------------------------------------

'----------------------------------------------------------------------------------------------'
' => Lower Hybrid Whistler Mix Only'
'----------------------------------------------------------------------------------------------'
;----------------------------------------------------------------------------------------------
;          Date        Time             Test 0      Test 1      Test 2      Test 3      Test 4
;            [Start TDSS]
;==============================================================================================
; => For 1997-12-10/04:33:15.605 UT          1          1          1          1          1
; => For 1998-08-26/06:40:26.120 UT          1          0          1          1          1
; => For 1998-09-24/23:20:38.842 UT          0          0          0          0          0
; => For 1998-09-24/23:22:26.632 UT          0          0          0          0          0
; => For 1998-09-24/23:22:48.150 UT          0          0          0          0          0
; => For 1998-09-24/23:30:48.542 UT          0          0          0          1          0
; => For 1998-09-24/23:45:52.184 UT          0          0          0          1          0
; => For 1998-09-24/23:45:53.379 UT          0          0          0          1          0
; => For 1998-09-24/23:48:42.131 UT          0          0          0          1          0
; => For 1998-09-25/00:05:23.432 UT          1          0          1          1          0
; => For 2000-02-11/23:33:56.491 UT          1          0          1          1          1
; => For 2000-02-11/23:33:58.351 UT          1          0          1          1          1
; => For 2000-02-11/23:34:00.731 UT          1          0          1          1          1
;----------------------------------------------------------------------------------------------
;          Date        Time             Test 0      Test 1      Test 2      Test 3      Test 4
;             [End TDSS]
;==============================================================================================
; => For 1997-12-10/04:33:16.696 UT          0          0          0          1          1
; => For 1998-08-26/06:40:27.211 UT          1          0          1          1          1
; => For 1998-09-24/23:20:39.933 UT          0          0          0          0          0
; => For 1998-09-24/23:22:27.723 UT          0          0          0          0          0
; => For 1998-09-24/23:22:49.241 UT          0          0          0          0          0
; => For 1998-09-24/23:30:49.633 UT          0          0          0          0          0
; => For 1998-09-24/23:45:53.275 UT          0          0          0          1          0
; => For 1998-09-24/23:45:54.470 UT          0          0          0          1          0
; => For 1998-09-24/23:48:43.222 UT          0          0          0          1          0
; => For 1998-09-25/00:05:24.523 UT          1          0          1          1          0
; => For 2000-02-11/23:33:57.582 UT          1          0          1          1          1
; => For 2000-02-11/23:33:59.442 UT          1          0          1          1          1
; => For 2000-02-11/23:34:01.822 UT          1          0          1          1          1
;----------------------------------------------------------------------------------------------



; => Lower Hybrid Only
lhw_only_amp   = [3.967,4.835,0.870,4.094,2.916,1.572,0.288]
bmago_lhw_only = [23.537,23.125,35.242,36.225,36.095,23.915,23.574]
dB_Bo_lhw_only = lhw_only_amp/(2d0*bmago_lhw_only)
beta_par_s_lhw = [0.809,0.841,0.361,0.362,0.388,0.740,0.434]
beta_par_e_lhw = [0.973,0.746,0.350,0.359,0.374,0.795,0.462]
beta_par_a_lhw = (beta_par_s_lhw + beta_par_e_lhw)/2d0

tani_halo_slhw = [1.296,1.196,0.984,0.816,0.780,1.016,1.143]
tani_halo_elhw = [1.397,1.270,0.980,0.813,0.778,1.016,1.144]
tani_halo_alhw = (tani_halo_slhw + tani_halo_elhw)/2d0
tpar_hc_s_lhw  = [4.952,5.154,3.778,4.172,4.264,3.626,3.758]
tpar_hc_e_lhw  = [4.650,5.139,3.783,4.180,4.268,3.626,3.757]
tpar_hc_a_lhw  = (tpar_hc_s_lhw + tpar_hc_e_lhw)/2d0

; => Whistler Only
whi_only_amp   = [1.666,1.286,1.952,2.226,3.539,1.259,2.574,1.960,1.174,0.994,0.269,0.920,0.610]
bmago_whi_only = [20.737,21.830,22.725,22.606,22.951,23.296,22.147,20.148,22.576,22.703,18.123,15.039,15.308]
dB_Bo_whi_only = whi_only_amp/(2d0*bmago_whi_only)
beta_par_s_whi = [1.003,0.894,0.772,0.774,0.747,0.723,0.778,0.938,0.398,0.390,0.749,1.013,1.031]
beta_par_e_whi = [0.903,0.859,0.787,0.822,0.724,0.769,0.842,1.114,0.390,0.378,0.744,1.001,1.000]
beta_par_a_whi = (beta_par_s_whi + beta_par_e_whi)/2d0

tani_halo_swhi = [1.305,1.298,1.297,1.306,1.305,1.300,1.219,1.092,1.645,1.627,0.842,0.760,0.777]
tani_halo_ewhi = [1.317,1.291,1.305,1.307,1.301,1.296,1.205,1.069,1.632,1.617,0.842,0.760,0.779]
tani_halo_awhi = (tani_halo_swhi + tani_halo_ewhi)/2d0
tpar_hc_s_whi  = [4.651,4.501,4.463,4.324,4.280,4.259,4.405,4.846,5.052,5.180,8.771,8.297,7.267]
tpar_hc_e_whi  = [4.576,4.531,4.389,4.289,4.262,4.241,4.483,4.907,5.141,5.267,8.773,8.276,7.256]
tpar_hc_a_whi  = (tpar_hc_s_whi + tpar_hc_e_whi)/2d0

; => Lower Hybrid Whistler Mix
mix_only_amp   = [7.592,18.750,30.000,1.718,1.606,1.187,3.074,3.349,6.20,7.36,4.57,3.06,1.77]
bmago_mix_only = [11.378,17.279,31.786,42.112,42.351,40.631,36.222,37.328,36.608,22.070,16.570,16.261,15.251]
dB_Bo_mix_only = mix_only_amp/(2d0*bmago_mix_only)
beta_par_s_mix = [0.711,0.736,0.147,0.205,0.205,0.259,0.290,0.283,0.346,0.851,0.823,0.865,0.957]
beta_par_e_mix = [0.321,0.841,0.195,0.205,0.205,0.250,0.273,0.298,0.361,0.868,0.905,1.035,0.790]
beta_par_a_mix = (beta_par_s_mix + beta_par_e_mix)/2d0

tani_halo_smix = [0.828,1.073,0.880,1.753,1.725,1.455,1.013,1.015,0.807,1.013,0.930,1.023,1.105]
tani_halo_emix = [0.873,1.027,0.892,1.752,1.723,1.454,1.015,1.018,0.804,1.013,0.983,1.074,1.133]
tani_halo_amix = (tani_halo_smix + tani_halo_emix)/2d0
tpar_hc_s_mix  = [8.408,7.209,4.879,2.741,2.795,3.062,3.456,3.455,4.195,3.637,7.214,6.872,6.742]
tpar_hc_e_mix  = [8.634,6.930,4.830,2.744,2.797,3.063,3.455,3.455,4.203,3.637,7.016,6.727,6.756]
tpar_hc_a_mix  = (tpar_hc_s_mix + tpar_hc_e_mix)/2d0

nlhw  = N_ELEMENTS(beta_par_s_lhw)*1d0
nwhi  = N_ELEMENTS(beta_par_s_whi)*1d0
nmix  = N_ELEMENTS(beta_par_s_mix)*1d0
;-----------------------------------------------------------------------------------------
; => Gary et al., [1999] found the whistler heat flux instability (WHFI) to ALWAYS be 
;      unstable if Thperp/Thpara > 1.01 and ALWAYS stable for beta_para,c < 0.25.  
;      Also, Gary et al., [1994] suggested that even when Thpara/Tcpara is small but 
;      Thperp/Thpara > 1.01, the WAI can still be unstable even in the absence of a
;      relative drift between halo and core.
;-----------------------------------------------------------------------------------------


lim0  = 0.25
pref  = '  => For Tanis,he GT '
for j=0L, 20 do begin $
  lim0 += 0.05  & $
  suff  = pref[0]+STRTRIM(STRING(FORMAT='(f15.2)',lim0[0]),2L)  & $
  PRINT,';', (TOTAL(WHERE(tani_halo_swhi GT lim0[0]) GE 0)*1d0/nwhi[0]*1d2) > 0.0, $
             (TOTAL(WHERE(tani_halo_ewhi GT lim0[0]) GE 0)*1d0/nwhi[0]*1d2) > 0.0, $
             (TOTAL(WHERE(tani_halo_awhi GT lim0[0]) GE 0)*1d0/nwhi[0]*1d2) > 0.0, suff[0]
;------------------------------------------------------------------------------
; => Whistler Only
;------------------------------------------------------------------------------
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.30
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.35
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.40
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.45
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.50
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.55
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.60
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.65
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.70
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.75
;       84.615385       84.615385       84.615385  => For Tanis,he GT 0.80
;       76.923077       76.923077       76.923077  => For Tanis,he GT 0.85
;       76.923077       76.923077       76.923077  => For Tanis,he GT 0.90
;       76.923077       76.923077       76.923077  => For Tanis,he GT 0.95
;       76.923077       76.923077       76.923077  => For Tanis,he GT 1.00
;
;       76.923077       76.923077       76.923077  => For Tanis,he GT 1.01
;
;       76.923077       76.923077       76.923077  => For Tanis,he GT 1.05
;       69.230769       69.230769       69.230769  => For Tanis,he GT 1.10
;       69.230769       69.230769       69.230769  => For Tanis,he GT 1.15
;       69.230769       69.230769       69.230769  => For Tanis,he GT 1.20
;       61.538462       61.538462       61.538462  => For Tanis,he GT 1.25
;       46.153846       46.153846       46.153846  => For Tanis,he GT 1.30
;------------------------------------------------------------------------------

lim0  = 0.25
pref  = '  => For Tanis,he GT '
for j=0L, 20 do begin $
  lim0 += 0.05  & $
  suff  = pref[0]+STRTRIM(STRING(FORMAT='(f15.2)',lim0[0]),2L)  & $
  PRINT,';', (TOTAL(WHERE(tani_halo_slhw GT lim0[0]) GE 0)*1d0/nlhw[0]*1d2) > 0.0, $
             (TOTAL(WHERE(tani_halo_elhw GT lim0[0]) GE 0)*1d0/nlhw[0]*1d2) > 0.0, $
             (TOTAL(WHERE(tani_halo_alhw GT lim0[0]) GE 0)*1d0/nlhw[0]*1d2) > 0.0, suff[0]
;------------------------------------------------------------------------------
; => Lower Hybrid Only
;------------------------------------------------------------------------------
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.30
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.35
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.40
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.45
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.50
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.55
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.60
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.65
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.70
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.75
;       85.714286       85.714286       85.714286  => For Tanis,he GT 0.80
;       71.428571       71.428571       71.428571  => For Tanis,he GT 0.85
;       71.428571       71.428571       71.428571  => For Tanis,he GT 0.90
;       71.428571       71.428571       71.428571  => For Tanis,he GT 0.95
;       57.142857       57.142857       57.142857  => For Tanis,he GT 1.00
;
;       57.142857       57.142857       57.142857  => For Tanis,he GT 1.01
;
;       42.857143       42.857143       42.857143  => For Tanis,he GT 1.05
;       42.857143       42.857143       42.857143  => For Tanis,he GT 1.10
;       28.571429       28.571429       28.571429  => For Tanis,he GT 1.15
;       14.285714       28.571429       28.571429  => For Tanis,he GT 1.20
;       14.285714       28.571429       14.285714  => For Tanis,he GT 1.25
;       0.0000000       14.285714       14.285714  => For Tanis,he GT 1.30
;------------------------------------------------------------------------------

lim0  = 0.25
pref  = '  => For Tanis,he GT '
for j=0L, 20 do begin $
  lim0 += 0.05  & $
  suff  = pref[0]+STRTRIM(STRING(FORMAT='(f15.2)',lim0[0]),2L)  & $
  PRINT,';', (TOTAL(WHERE(tani_halo_smix GT lim0[0]) GE 0)*1d0/nmix[0]*1d2) > 0.0, $
             (TOTAL(WHERE(tani_halo_emix GT lim0[0]) GE 0)*1d0/nmix[0]*1d2) > 0.0, $
             (TOTAL(WHERE(tani_halo_amix GT lim0[0]) GE 0)*1d0/nmix[0]*1d2) > 0.0, suff[0]
;------------------------------------------------------------------------------
; => Lower Hybrid Whistler Mix Only
;------------------------------------------------------------------------------
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.30
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.35
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.40
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.45
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.50
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.55
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.60
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.65
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.70
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.75
;       100.00000       100.00000       100.00000  => For Tanis,he GT 0.80
;       84.615385       92.307692       92.307692  => For Tanis,he GT 0.85
;       76.923077       76.923077       76.923077  => For Tanis,he GT 0.90
;       69.230769       76.923077       76.923077  => For Tanis,he GT 0.95
;       69.230769       69.230769       69.230769  => For Tanis,he GT 1.00
;
;       69.230769       69.230769       69.230769  => For Tanis,he GT 1.01
;
;       38.461538       38.461538       30.769231  => For Tanis,he GT 1.05
;       30.769231       30.769231       30.769231  => For Tanis,he GT 1.10
;       23.076923       23.076923       23.076923  => For Tanis,he GT 1.15
;       23.076923       23.076923       23.076923  => For Tanis,he GT 1.20
;       23.076923       23.076923       23.076923  => For Tanis,he GT 1.25
;       23.076923       23.076923       23.076923  => For Tanis,he GT 1.30
;------------------------------------------------------------------------------




lim0  = 0.05
pref  = '  => For beta_par,ce LE '
for j=0L, 20 do begin $
  lim0 += 0.05  & $
  suff  = pref[0]+STRTRIM(STRING(FORMAT='(f15.2)',lim0[0]),2L)  & $
  PRINT,';', (TOTAL(WHERE(beta_par_s_whi LE lim0[0]) GE 0)*1d0/nwhi[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_e_whi LE lim0[0]) GE 0)*1d0/nwhi[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_a_whi LE lim0[0]) GE 0)*1d0/nwhi[0]*1d2) > 0.0, suff[0]
;------------------------------------------------------------------------------
; => Whistler Only
;------------------------------------------------------------------------------
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.10
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.15
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.20
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.25
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.30
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.35
;       15.384615       15.384615       15.384615  => For beta_par,ce LE 0.40
;       15.384615       15.384615       15.384615  => For beta_par,ce LE 0.45
;       15.384615       15.384615       15.384615  => For beta_par,ce LE 0.50
;       15.384615       15.384615       15.384615  => For beta_par,ce LE 0.55
;       15.384615       15.384615       15.384615  => For beta_par,ce LE 0.60
;       15.384615       15.384615       15.384615  => For beta_par,ce LE 0.65
;       15.384615       15.384615       15.384615  => For beta_par,ce LE 0.70
;       38.461538       30.769231       38.461538  => For beta_par,ce LE 0.75
;       61.538462       46.153846       53.846154  => For beta_par,ce LE 0.80
;       61.538462       61.538462       61.538462  => For beta_par,ce LE 0.85
;       69.230769       69.230769       69.230769  => For beta_par,ce LE 0.90
;       76.923077       76.923077       69.230769  => For beta_par,ce LE 0.95
;       76.923077       84.615385       76.923077  => For beta_par,ce LE 1.00
;       100.00000       92.307692       100.00000  => For beta_par,ce LE 1.05
;       100.00000       92.307692       100.00000  => For beta_par,ce LE 1.10
;------------------------------------------------------------------------------

lim0  = 0.05
pref  = '  => For beta_par,ce LE '
for j=0L, 20 do begin $
  lim0 += 0.05  & $
  suff  = pref[0]+STRTRIM(STRING(FORMAT='(f15.2)',lim0[0]),2L)  & $
  PRINT,';', (TOTAL(WHERE(beta_par_s_lhw LE lim0[0]) GE 0)*1d0/nlhw[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_e_lhw LE lim0[0]) GE 0)*1d0/nlhw[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_a_lhw LE lim0[0]) GE 0)*1d0/nlhw[0]*1d2) > 0.0, suff[0]
;------------------------------------------------------------------------------
; => Lower Hybrid Only
;------------------------------------------------------------------------------
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.10
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.15
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.20
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.25
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.30
;       0.0000000       14.285714       0.0000000  => For beta_par,ce LE 0.35
;       42.857143       42.857143       42.857143  => For beta_par,ce LE 0.40
;       57.142857       42.857143       57.142857  => For beta_par,ce LE 0.45
;       57.142857       57.142857       57.142857  => For beta_par,ce LE 0.50
;       57.142857       57.142857       57.142857  => For beta_par,ce LE 0.55
;       57.142857       57.142857       57.142857  => For beta_par,ce LE 0.60
;       57.142857       57.142857       57.142857  => For beta_par,ce LE 0.65
;       57.142857       57.142857       57.142857  => For beta_par,ce LE 0.70
;       71.428571       71.428571       57.142857  => For beta_par,ce LE 0.75
;       71.428571       85.714286       85.714286  => For beta_par,ce LE 0.80
;       100.00000       85.714286       85.714286  => For beta_par,ce LE 0.85
;       100.00000       85.714286       100.00000  => For beta_par,ce LE 0.90
;       100.00000       85.714286       100.00000  => For beta_par,ce LE 0.95
;       100.00000       100.00000       100.00000  => For beta_par,ce LE 1.00
;       100.00000       100.00000       100.00000  => For beta_par,ce LE 1.05
;       100.00000       100.00000       100.00000  => For beta_par,ce LE 1.10
;------------------------------------------------------------------------------

lim0  = 0.05
pref  = '  => For beta_par,ce LE '
for j=0L, 20 do begin $
  lim0 += 0.05  & $
  suff  = pref[0]+STRTRIM(STRING(FORMAT='(f15.2)',lim0[0]),2L)  & $
  PRINT,';', (TOTAL(WHERE(beta_par_s_mix LE lim0[0]) GE 0)*1d0/nmix[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_e_mix LE lim0[0]) GE 0)*1d0/nmix[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_a_mix LE lim0[0]) GE 0)*1d0/nmix[0]*1d2) > 0.0, suff[0]
;------------------------------------------------------------------------------
; => Lower Hybrid Whistler Mix Only
;------------------------------------------------------------------------------
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce LE 0.10
;       7.6923077       0.0000000       0.0000000  => For beta_par,ce LE 0.15
;       7.6923077       7.6923077       7.6923077  => For beta_par,ce LE 0.20
;       23.076923       30.769231       23.076923  => For beta_par,ce LE 0.25
;       46.153846       46.153846       46.153846  => For beta_par,ce LE 0.30
;       53.846154       53.846154       46.153846  => For beta_par,ce LE 0.35
;       53.846154       61.538462       53.846154  => For beta_par,ce LE 0.40
;       53.846154       61.538462       53.846154  => For beta_par,ce LE 0.45
;       53.846154       61.538462       53.846154  => For beta_par,ce LE 0.50
;       53.846154       61.538462       61.538462  => For beta_par,ce LE 0.55
;       53.846154       61.538462       61.538462  => For beta_par,ce LE 0.60
;       53.846154       61.538462       61.538462  => For beta_par,ce LE 0.65
;       53.846154       61.538462       61.538462  => For beta_par,ce LE 0.70
;       69.230769       61.538462       61.538462  => For beta_par,ce LE 0.75
;       69.230769       69.230769       69.230769  => For beta_par,ce LE 0.80
;       76.923077       76.923077       69.230769  => For beta_par,ce LE 0.85
;       92.307692       84.615385       92.307692  => For beta_par,ce LE 0.90
;       92.307692       92.307692       100.00000  => For beta_par,ce LE 0.95
;       100.00000       92.307692       100.00000  => For beta_par,ce LE 1.00
;       100.00000       100.00000       100.00000  => For beta_par,ce LE 1.05
;       100.00000       100.00000       100.00000  => For beta_par,ce LE 1.10
;------------------------------------------------------------------------------


lim0  = 0.05
pref  = '  => For beta_par,ce GT '
for j=0L, 20 do begin $
  lim0 += 0.05  & $
  suff  = pref[0]+STRTRIM(STRING(FORMAT='(f15.2)',lim0[0]),2L)  & $
  PRINT,';', (TOTAL(WHERE(beta_par_s_whi GT lim0[0]) GE 0)*1d0/nwhi[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_e_whi GT lim0[0]) GE 0)*1d0/nwhi[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_a_whi GT lim0[0]) GE 0)*1d0/nwhi[0]*1d2) > 0.0, suff[0]
;------------------------------------------------------------------------------
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.10
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.15
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.20
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.25
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.30
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.35
;       84.615385       84.615385       84.615385  => For beta_par,ce GT 0.40
;       84.615385       84.615385       84.615385  => For beta_par,ce GT 0.45
;       84.615385       84.615385       84.615385  => For beta_par,ce GT 0.50
;       84.615385       84.615385       84.615385  => For beta_par,ce GT 0.55
;       84.615385       84.615385       84.615385  => For beta_par,ce GT 0.60
;       84.615385       84.615385       84.615385  => For beta_par,ce GT 0.65
;       84.615385       84.615385       84.615385  => For beta_par,ce GT 0.70
;       61.538462       69.230769       61.538462  => For beta_par,ce GT 0.75
;       38.461538       53.846154       46.153846  => For beta_par,ce GT 0.80
;       38.461538       38.461538       38.461538  => For beta_par,ce GT 0.85
;       30.769231       30.769231       30.769231  => For beta_par,ce GT 0.90
;       23.076923       23.076923       30.769231  => For beta_par,ce GT 0.95
;       23.076923       15.384615       23.076923  => For beta_par,ce GT 1.00
;       0.0000000       7.6923077       0.0000000  => For beta_par,ce GT 1.05
;       0.0000000       7.6923077       0.0000000  => For beta_par,ce GT 1.10
;------------------------------------------------------------------------------

lim0  = 0.05
pref  = '  => For beta_par,ce GT '
for j=0L, 20 do begin $
  lim0 += 0.05  & $
  suff  = pref[0]+STRTRIM(STRING(FORMAT='(f15.2)',lim0[0]),2L)  & $
  PRINT,';', (TOTAL(WHERE(beta_par_s_lhw GT lim0[0]) GE 0)*1d0/nlhw[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_e_lhw GT lim0[0]) GE 0)*1d0/nlhw[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_a_lhw GT lim0[0]) GE 0)*1d0/nlhw[0]*1d2) > 0.0, suff[0]
;------------------------------------------------------------------------------
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.10
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.15
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.20
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.25
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.30
;       100.00000       85.714286       100.00000  => For beta_par,ce GT 0.35
;       57.142857       57.142857       57.142857  => For beta_par,ce GT 0.40
;       42.857143       57.142857       42.857143  => For beta_par,ce GT 0.45
;       42.857143       42.857143       42.857143  => For beta_par,ce GT 0.50
;       42.857143       42.857143       42.857143  => For beta_par,ce GT 0.55
;       42.857143       42.857143       42.857143  => For beta_par,ce GT 0.60
;       42.857143       42.857143       42.857143  => For beta_par,ce GT 0.65
;       42.857143       42.857143       42.857143  => For beta_par,ce GT 0.70
;       28.571429       28.571429       42.857143  => For beta_par,ce GT 0.75
;       28.571429       14.285714       14.285714  => For beta_par,ce GT 0.80
;       0.0000000       14.285714       14.285714  => For beta_par,ce GT 0.85
;       0.0000000       14.285714       0.0000000  => For beta_par,ce GT 0.90
;       0.0000000       14.285714       0.0000000  => For beta_par,ce GT 0.95
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce GT 1.00
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce GT 1.05
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce GT 1.10
;------------------------------------------------------------------------------

lim0  = 0.05
pref  = '  => For beta_par,ce GT '
for j=0L, 20 do begin $
  lim0 += 0.05  & $
  suff  = pref[0]+STRTRIM(STRING(FORMAT='(f15.2)',lim0[0]),2L)  & $
  PRINT,';', (TOTAL(WHERE(beta_par_s_mix GT lim0[0]) GE 0)*1d0/nmix[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_e_mix GT lim0[0]) GE 0)*1d0/nmix[0]*1d2) > 0.0, $
             (TOTAL(WHERE(beta_par_a_mix GT lim0[0]) GE 0)*1d0/nmix[0]*1d2) > 0.0, suff[0]
;------------------------------------------------------------------------------
;       100.00000       100.00000       100.00000  => For beta_par,ce GT 0.10
;       92.307692       100.00000       100.00000  => For beta_par,ce GT 0.15
;       92.307692       92.307692       92.307692  => For beta_par,ce GT 0.20
;       76.923077       69.230769       76.923077  => For beta_par,ce GT 0.25
;       53.846154       53.846154       53.846154  => For beta_par,ce GT 0.30
;       46.153846       46.153846       53.846154  => For beta_par,ce GT 0.35
;       46.153846       38.461538       46.153846  => For beta_par,ce GT 0.40
;       46.153846       38.461538       46.153846  => For beta_par,ce GT 0.45
;       46.153846       38.461538       46.153846  => For beta_par,ce GT 0.50
;       46.153846       38.461538       38.461538  => For beta_par,ce GT 0.55
;       46.153846       38.461538       38.461538  => For beta_par,ce GT 0.60
;       46.153846       38.461538       38.461538  => For beta_par,ce GT 0.65
;       46.153846       38.461538       38.461538  => For beta_par,ce GT 0.70
;       30.769231       38.461538       38.461538  => For beta_par,ce GT 0.75
;       30.769231       30.769231       30.769231  => For beta_par,ce GT 0.80
;       23.076923       23.076923       30.769231  => For beta_par,ce GT 0.85
;       7.6923077       15.384615       7.6923077  => For beta_par,ce GT 0.90
;       7.6923077       7.6923077       0.0000000  => For beta_par,ce GT 0.95
;       0.0000000       7.6923077       0.0000000  => For beta_par,ce GT 1.00
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce GT 1.05
;       0.0000000       0.0000000       0.0000000  => For beta_par,ce GT 1.10
;------------------------------------------------------------------------------







'----------------------------------------------------------------------------------------------'
'Histograms'
'----------------------------------------------------------------------------------------------'

; => Lower Hybrid Only
lhw_only_amp   = [3.967,4.835,0.870,4.094,2.916,1.572,0.288]
bmago_lhw_only = [23.537,23.125,35.242,36.225,36.095,23.915,23.574]
dB_Bo_lhw_only = lhw_only_amp/(2d0*bmago_lhw_only)
beta_par_s_lhw = [0.809,0.841,0.361,0.362,0.388,0.740,0.434]
beta_par_e_lhw = [0.973,0.746,0.350,0.359,0.374,0.795,0.462]
beta_par_a_lhw = (beta_par_s_lhw + beta_par_e_lhw)/2d0

tani_halo_slhw = [1.296,1.196,0.984,0.816,0.780,1.016,1.143]
tani_halo_elhw = [1.397,1.270,0.980,0.813,0.778,1.016,1.144]
tani_halo_alhw = (tani_halo_slhw + tani_halo_elhw)/2d0
tpar_hc_s_lhw  = [4.952,5.154,3.778,4.172,4.264,3.626,3.758]
tpar_hc_e_lhw  = [4.650,5.139,3.783,4.180,4.268,3.626,3.757]
tpar_hc_a_lhw  = (tpar_hc_s_lhw + tpar_hc_e_lhw)/2d0


; => Whistler Only
whi_only_amp   = [1.666,1.286,1.952,2.226,3.539,1.259,2.574,1.960,1.174,0.994,0.269,0.920,0.610]
bmago_whi_only = [20.737,21.830,22.725,22.606,22.951,23.296,22.147,20.148,22.576,22.703,18.123,15.039,15.308]
dB_Bo_whi_only = whi_only_amp/(2d0*bmago_whi_only)
beta_par_s_whi = [1.003,0.894,0.772,0.774,0.747,0.723,0.778,0.938,0.398,0.390,0.749,1.013,1.031]
beta_par_e_whi = [0.903,0.859,0.787,0.822,0.724,0.769,0.842,1.114,0.390,0.378,0.744,1.001,1.000]
beta_par_a_whi = (beta_par_s_whi + beta_par_e_whi)/2d0

tani_halo_swhi = [1.305,1.298,1.297,1.306,1.305,1.300,1.219,1.092,1.645,1.627,0.842,0.760,0.777]
tani_halo_ewhi = [1.317,1.291,1.305,1.307,1.301,1.296,1.205,1.069,1.632,1.617,0.842,0.760,0.779]
tani_halo_awhi = (tani_halo_swhi + tani_halo_ewhi)/2d0
tpar_hc_s_whi  = [4.651,4.501,4.463,4.324,4.280,4.259,4.405,4.846,5.052,5.180,8.771,8.297,7.267]
tpar_hc_e_whi  = [4.576,4.531,4.389,4.289,4.262,4.241,4.483,4.907,5.141,5.267,8.773,8.276,7.256]
tpar_hc_a_whi  = (tpar_hc_s_whi + tpar_hc_e_whi)/2d0

; => Lower Hybrid Whistler Mix
mix_only_amp   = [7.592,18.750,30.000,1.718,1.606,1.187,3.074,3.349,6.20,7.36,4.57,3.06,1.77]
bmago_mix_only = [11.378,17.279,31.786,42.112,42.351,40.631,36.222,37.328,36.608,22.070,16.570,16.261,15.251]
dB_Bo_mix_only = mix_only_amp/(2d0*bmago_mix_only)
beta_par_s_mix = [0.711,0.736,0.147,0.205,0.205,0.259,0.290,0.283,0.346,0.851,0.823,0.865,0.957]
beta_par_e_mix = [0.321,0.841,0.195,0.205,0.205,0.250,0.273,0.298,0.361,0.868,0.905,1.035,0.790]
beta_par_a_mix = (beta_par_s_mix + beta_par_e_mix)/2d0

tani_halo_smix = [0.828,1.073,0.880,1.753,1.725,1.455,1.013,1.015,0.807,1.013,0.930,1.023,1.105]
tani_halo_emix = [0.873,1.027,0.892,1.752,1.723,1.454,1.015,1.018,0.804,1.013,0.983,1.074,1.133]
tani_halo_amix = (tani_halo_smix + tani_halo_emix)/2d0
tpar_hc_s_mix  = [8.408,7.209,4.879,2.741,2.795,3.062,3.456,3.455,4.195,3.637,7.214,6.872,6.742]
tpar_hc_e_mix  = [8.634,6.930,4.830,2.744,2.797,3.063,3.455,3.455,4.203,3.637,7.016,6.727,6.756]
tpar_hc_a_mix  = (tpar_hc_s_mix + tpar_hc_e_mix)/2d0


PRINT,';',dB_Bo_lhw_only[SORT(dB_Bo_lhw_only)],FORMAT='(a1,7f10.5)'
;   0.00611   0.01234   0.03287   0.04039   0.05651   0.08427   0.10454

PRINT,';',dB_Bo_whi_only[SORT(dB_Bo_whi_only)],FORMAT='(a1,13f10.5)'
;   0.00742   0.01992   0.02189   0.02600   0.02702   0.02945   0.03059   0.04017   0.04295   0.04864   0.04923   0.05811   0.07710

PRINT,';',dB_Bo_mix_only[SORT(dB_Bo_mix_only)],FORMAT='(a1,13f10.5)'
;   0.01461   0.01896   0.02040   0.04243   0.04486   0.05803   0.08468   0.09409   0.13790   0.16674   0.33363   0.47191   0.54257


whisf = '(Whistlers Only)'
whipr = 'TDSS_Whistlers-Only_IP-shocks_'
lhwsf = '(Lower-Hybrid Only)'
lhwpr = 'TDSS_Lower-Hybrid-Only_IP-shocks_'
mixsf = '(Mixed Modes Only)'
mixpr = 'TDSS_Mixed-Modes_IP-shocks_'
suffx = '_histogram_2nd'

;-------------------------------------
; => Look at histograms of Beta_par,ec
;-------------------------------------
nbins = 9L
dran  = [0.00,1.20]
xttl  = '!7b!3'+'!D!9#!3'+',ce!N'

;   Lower-Hybrid
tttl  = xttl[0]+' [start] for '+lhwsf[0]
fname = lhwpr[0]+'Beta-parce_s'+suffx[0]
xdat  = beta_par_s_lhw
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
pclose

tttl  = xttl[0]+' [end] for '+lhwsf[0]
fname = lhwpr[0]+'Beta-parce_e'+suffx[0]
xdat  = beta_par_e_lhw
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
pclose

tttl  = xttl[0]+' [Avg.] for '+lhwsf[0]
fname = lhwpr[0]+'Beta-parce_avg'+suffx[0]
xdat  = beta_par_a_lhw
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
pclose

;   Whistlers
tttl  = xttl[0]+' [start] for '+whisf[0]
fname = whipr[0]+'Beta-parce_s'+suffx[0]
xdat  = beta_par_s_whi
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
pclose

tttl  = xttl[0]+' [end] for '+whisf[0]
fname = whipr[0]+'Beta-parce_e'+suffx[0]
xdat  = beta_par_e_whi
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
pclose

tttl  = xttl[0]+' [Avg.] for '+whisf[0]
fname = whipr[0]+'Beta-parce_avg'+suffx[0]
xdat  = beta_par_a_whi
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
pclose

;   Mixed Modes
tttl  = xttl[0]+' [start] for '+mixsf[0]
fname = mixpr[0]+'Beta-parce_s'+suffx[0]
xdat  = beta_par_s_mix
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
pclose

tttl  = xttl[0]+' [end] for '+mixsf[0]
fname = mixpr[0]+'Beta-parce_e'+suffx[0]
xdat  = beta_par_e_mix
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
pclose

tttl  = xttl[0]+' [Avg.] for '+mixsf[0]
fname = mixpr[0]+'Beta-parce_avg'+suffx[0]
xdat  = beta_par_a_mix
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran,PREC=2
pclose

;-------------------------------------
; => Look at histograms of dB/Bo
;-------------------------------------
nbins = 8L
dran  = [0.00,0.20]
xttl  = '!7d!3'+'B/B!Do!N'

;   Lower-Hybrid
tttl  = xttl[0]+' for '+lhwsf[0]
fname = lhwpr[0]+'dB_Bo'+suffx[0]
xdat  = dB_Bo_lhw_only
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

;   Whistlers
tttl  = '!7d!3'+'B/B!Do!N for '+whisf[0]
fname = whipr[0]+'dB_Bo'+suffx[0]
xdat  = dB_Bo_whi_only
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

;   Mixed Modes
tttl  = '!7d!3'+'B/B!Do!N for '+mixsf[0]
fname = mixpr[0]+'dB_Bo'+suffx[0]
xdat  = dB_Bo_mix_only
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,xdat,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose



'----------------------------------------------------------------------------------------------'
'Drift velocity and drift velocity current with wave amplitudes'
'----------------------------------------------------------------------------------------------'
; => For 1997-12-10
vdrift_s = [225.683]
jdrift_s = [498.64217]
vdrift_e = [116.340]
jdrift_e = [258.38465]

; => For 1998-08-26
vdrift_s = [798.952,112.287, 70.208, 41.682, 49.195, 53.065, 52.007, 56.87, 64.003, 64.698, 75.681, 93.652, 78.338]
jdrift_s = [1391.56451,412.68235,245.42634,138.4282,155.51167,157.3129,151.67521,164.15859,182.67097,182.6089,203.4589,251.06884,201.76992]
vdrift_e = [338.778,107.657, 62.913, 50.028, 53.754, 50.872, 56.452, 61.956, 64.444, 66.61, 80.974, 99.715, 78.99]
jdrift_e = [644.48163,392.42968,219.44491,164.55195,168.31703,149.41049,163.07612,177.41998,182.25427,186.31806,216.59929,267.72151,203.26866]

; => For 1998-09-24
vdrift_s = [177.612, 75.472, 77.272, 81.187, 74.299, 87.382, 78.570,100.624, 99.945, 99.295, 85.941, 86.079, 87.144,123.53, 89.874,133.864, 79.416]
jdrift_s = [444.70122,254.90965,266.1425,314.56235,286.53391,373.86351,310.73003,329.91343,327.08174,324.3692,337.87356,341.71994,355.5173,426.58058,321.89989,467.39047,185.22072]
vdrift_e = [175.073, 75.539, 77.389, 81.295, 73.457, 87.428, 78.289,100.028, 99.351, 98.702, 85.978, 86.152, 87.898,123.138, 90.269,134.363, 78.657]
jdrift_e = [440.23702,255.39721,266.79969,314.94688,283.25027,373.97000,309.63803,327.43004,324.6034,321.89582,339.18362,343.15149,359.39612,425.06338,323.16301,468.99933,183.04021]

; => For 2000-02-11
vdrift_s = [379.809,129.528,100.103,148.72,122.408,121.102,64.474,96.801,88.553]
jdrift_s = [892.47676,308.32385,256.78241,383.81448,330.36692,327.7414,254.04037,317.53012,274.79753]
vdrift_e = [230.911, 61.466,136.688,145.197,121.46,120.903, 64.567, 96.666, 88.112]
jdrift_e = [544.29793,155.68654,352.14254,375.46056,328.43793,327.84588,254.32662,316.78077,272.9296]



; => Lower Hybrid Only
lhw_only_amp   = [3.967,4.835,0.870,4.094,2.916,1.572,0.288]
vd_s_lhw       = [112.287,70.208,78.57,85.941,87.144,89.874,79.416]
vd_e_lhw       = [107.657,62.913,78.289,85.978,87.898,90.269,78.657]
jd_s_lhw       = [412.68235,245.42634,310.73003,337.87356,355.5173,321.89989,185.22072]
jd_e_lhw       = [392.42968,219.44491,309.63803,339.18362,359.39612,323.16301,183.04021]
beta_par_s_lhw = [0.809,0.841,0.361,0.362,0.388,0.740,0.434]
beta_par_e_lhw = [0.973,0.746,0.350,0.359,0.374,0.795,0.462]

; => Lower Hybrid Whistler Mix
mix_only_amp   = [7.592,18.750,30.000,1.718,1.606,1.187,3.074,3.349,6.20,7.36,4.57,3.06,1.77]
vd_s_mix       = [225.683,798.952,177.612,75.472,77.272,74.299,99.945,99.295,86.079,133.864,379.809,129.528,100.103]
vd_e_mix       = [116.34,338.778,175.073,75.539,77.389,73.457,99.351,98.702,86.152,134.363,230.911,61.466,136.688]
jd_s_mix       = [498.64217,1391.56451,444.70122,254.90965,266.1425,286.53391,327.08174,324.3692,341.71994,467.39047,892.47676,308.32385,256.78241]
jd_e_mix       = [258.38465,644.48163,440.23702,255.39721,266.79969,283.25027,324.6034,321.89582,343.15149,468.99933,544.29793,155.68654,352.14254]
hflux_mix_only = [34283.380,599120.450,151272.910,503830.140,496106.730,520586.100,395867.030,397469.170,298941.980,364357.260,80912.160,121466.010,170952.940]*1d-3
tavge_mix_only = [18.782,51.970,24.752,50.450,50.215,50.290,45.391,49.329,45.323,57.823,59.755,54.980,50.937]
tavgi_mix_only = [9.837,48.250,33.823,86.049,83.873,75.068,86.598,78.886,86.363,125.535,22.904,27.846,31.459]
te_ti_mix_only = tavge_mix_only/tavgi_mix_only
tparc_mix_only = [16.316,38.562,22.318,42.747,42.561,44.234,47.296,48.395,47.189,47.220,37.846,36.719,34.440]
tperc_mix_only = [16.728,43.227,18.650,39.874,39.716,39.922,34.887,36.521,34.860,44.266,35.257,33.700,33.413]
tparh_mix_only = [137.176,278.001,108.888,117.178,118.940,135.459,163.465,203.014,163.059,171.751,273.023,252.325,232.196]
tperh_mix_only = [113.518,298.253,95.875,205.461,205.120,197.093,165.597,163.813,165.577,174.005,253.926,258.140,256.529]
tanic_mix_only = tperc_mix_only/tparc_mix_only
tanih_mix_only = tperh_mix_only/tparh_mix_only
tpahc_mix_only = tparh_mix_only/tparc_mix_only
tpehc_mix_only = tperh_mix_only/tperc_mix_only
beta_par_s_mix = [0.711,0.736,0.147,0.205,0.205,0.259,0.290,0.283,0.346,0.851,0.823,0.865,0.957]
beta_par_e_mix = [0.321,0.841,0.195,0.205,0.205,0.250,0.273,0.298,0.361,0.868,0.905,1.035,0.790]

; => Whistler Only
whi_only_amp   = [1.666,1.286,1.952,2.226,3.539,1.259,2.574,1.960,1.174,0.994,0.269,0.920,0.610]
vd_s_whi       = [41.682,49.195,53.065,56.87,64.003,64.698,75.681,93.652,122.408,121.102,64.474,96.801,88.553]
vd_e_whi       = [50.028,53.754,50.872,61.956,64.444,66.61,80.974,99.715,121.46,120.903,64.567,96.666,88.112]
jd_s_whi       = [138.4282,155.51167,157.3129,164.15859,182.67097,182.6089,203.4589,251.06884,330.36692,327.7414,254.04037,317.53012,274.79753]
jd_e_whi       = [164.55195,168.31703,149.41049,177.41998,182.25427,186.31806,216.59929,267.72151,328.43793,327.84588,254.32662,316.78077,272.9296]
beta_par_s_whi = [1.003,0.894,0.772,0.774,0.747,0.723,0.778,0.938,0.398,0.390,0.749,1.013,1.031]
beta_par_e_whi = [0.903,0.859,0.787,0.822,0.724,0.769,0.842,1.114,0.390,0.378,0.744,1.001,1.000]


; => Look at correlation plots
!P.MULTI = 0

yttl  = 'Wave Amplitude'+'!C'+'[Peak-to-Peak, nT]'
ttpr  = 'Wave Amplitude vs. '
whisf = '(Whistlers Only)'
whipr = 'TDSS_Whistlers-Only_IP-shocks_Amp-vs-'
lhwsf = '(Lower-Hybrid Only)'
lhwpr = 'TDSS_Lower-Hybrid-Only_IP-shocks_Amp-vs-'
mixsf = '(Mixed Modes Only)'
mixpr = 'TDSS_Mixed-Modes_IP-shocks_Amp-vs-'

;---------------------
; => Beta_par,ec plots
;---------------------
xttl  = '!7b!3'+'!D!9#!3'+',ce!N'
xran  = [0.10,1.20]
;   Whistlers
xdat  = beta_par_s_whi
ydat  = whi_only_amp
tttl  = ttpr[0]+'Parallel Electron Core Beta [start]'+'!C'+whisf[0]
fpref = whipr[0]+'Beta-parce_s'

xdat  = beta_par_e_whi
ydat  = whi_only_amp
tttl  = ttpr[0]+'Parallel Electron Core Beta [end]'+'!C'+whisf[0]
fpref = whipr[0]+'Beta-parce_e'

xdat  = (beta_par_s_whi + beta_par_e_whi)/2d0
ydat  = whi_only_amp
tttl  = ttpr[0]+'Parallel Electron Core Beta [Avg.]'+'!C'+whisf[0]
fpref = whipr[0]+'Beta-parce_avg'

;   Lower-Hybrid
xdat  = beta_par_s_lhw
ydat  = lhw_only_amp
tttl  = ttpr[0]+'Parallel Electron Core Beta [start]'+'!C'+lhwsf[0]
fpref = lhwpr[0]+'Beta-parce_s'

xdat  = beta_par_e_lhw
ydat  = lhw_only_amp
tttl  = ttpr[0]+'Parallel Electron Core Beta [end]'+'!C'+lhwsf[0]
fpref = lhwpr[0]+'Beta-parce_e'

xdat  = (beta_par_s_lhw + beta_par_e_lhw)/2d0
ydat  = lhw_only_amp
tttl  = ttpr[0]+'Parallel Electron Core Beta [Avg.]'+'!C'+lhwsf[0]
fpref = lhwpr[0]+'Beta-parce_avg'

;   Mixed Modes
xdat  = beta_par_s_mix
ydat  = mix_only_amp
tttl  = ttpr[0]+'Parallel Electron Core Beta [start]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Beta-parce_s'

xdat  = beta_par_e_mix
ydat  = mix_only_amp
tttl  = ttpr[0]+'Parallel Electron Core Beta [end]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Beta-parce_e'

xdat  = (beta_par_s_mix + beta_par_e_mix)/2d0
ydat  = mix_only_amp
tttl  = ttpr[0]+'Parallel Electron Core Beta [Avg.]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Beta-parce_avg'

;---------------------
; => |Vd| plots
;---------------------
xttl  = '|V!Dd!N'+'| [km/s]'
;   Whistlers
xdat  = vd_s_whi
ydat  = whi_only_amp
tttl  = ttpr[0]+'Electron Drift Speed [start]'+'!C'+whisf[0]
fpref = whipr[0]+'Vdrift_s'

xdat  = vd_e_whi
ydat  = whi_only_amp
tttl  = ttpr[0]+'Electron Drift Speed [end]'+'!C'+whisf[0]
fpref = whipr[0]+'Vdrift_e'

xdat  = (vd_s_whi + vd_e_whi)/2d0
ydat  = whi_only_amp
tttl  = ttpr[0]+'Electron Drift Speed [Avg.]'+'!C'+whisf[0]
fpref = whipr[0]+'Vdrift_avg'

;   Lower-Hybrid
xdat  = vd_s_lhw
ydat  = lhw_only_amp
tttl  = ttpr[0]+'Electron Drift Speed [start]'+'!C'+lhwsf[0]
fpref = lhwpr[0]+'Vdrift_s'

xdat  = vd_e_lhw
ydat  = lhw_only_amp
tttl  = ttpr[0]+'Electron Drift Speed [end]'+'!C'+lhwsf[0]
fpref = lhwpr[0]+'Vdrift_e'

xdat  = (vd_s_lhw + vd_e_lhw)/2d0
ydat  = lhw_only_amp
tttl  = ttpr[0]+'Electron Drift Speed [Avg.]'+'!C'+lhwsf[0]
fpref = lhwpr[0]+'Vdrift_avg'

;   Mixed Modes
xdat  = vd_s_mix
ydat  = mix_only_amp
tttl  = ttpr[0]+'Electron Drift Speed [start]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Vdrift_s'

xdat  = vd_e_mix
ydat  = mix_only_amp
tttl  = ttpr[0]+'Electron Drift Speed [end]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Vdrift_e'

xdat  = (vd_s_mix + vd_e_mix)/2d0
ydat  = mix_only_amp
tttl  = ttpr[0]+'Electron Drift Speed [Avg.]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Vdrift_avg'


;---------------------
; => |jd| plots
;---------------------
xttl  = '|j!Dd!N'+'| [nA m!U-2!N]'
;   Whistlers
xdat  = jd_s_whi
ydat  = whi_only_amp
tttl  = ttpr[0]+'Electron-Ion Drift Current [start]'+'!C'+whisf[0]
fpref = whipr[0]+'jdrift_s'

xdat  = jd_e_whi
ydat  = whi_only_amp
tttl  = ttpr[0]+'Electron-Ion Drift Current [end]'+'!C'+whisf[0]
fpref = whipr[0]+'jdrift_e'

xdat  = (jd_s_whi + jd_e_whi)/2d0
ydat  = whi_only_amp
tttl  = ttpr[0]+'Electron-Ion Drift Current [Avg.]'+'!C'+whisf[0]
fpref = whipr[0]+'jdrift_avg'

;   Lower-Hybrid
xdat  = jd_s_lhw
ydat  = lhw_only_amp
tttl  = ttpr[0]+'Electron-Ion Drift Current [start]'+'!C'+lhwsf[0]
fpref = lhwpr[0]+'jdrift_s'

xdat  = jd_e_lhw
ydat  = lhw_only_amp
tttl  = ttpr[0]+'Electron-Ion Drift Current [end]'+'!C'+lhwsf[0]
fpref = lhwpr[0]+'jdrift_e'

xdat  = (jd_s_lhw + jd_e_lhw)/2d0
ydat  = lhw_only_amp
tttl  = ttpr[0]+'Electron-Ion Drift Current [Avg.]'+'!C'+lhwsf[0]
fpref = lhwpr[0]+'jdrift_avg'

;   Mixed Modes
xdat  = jd_s_mix
ydat  = mix_only_amp
tttl  = ttpr[0]+'Electron-Ion Drift Current [start]'+'!C'+mixsf[0]
fpref = mixpr[0]+'jdrift_s'

xdat  = jd_e_mix
ydat  = mix_only_amp
tttl  = ttpr[0]+'Electron-Ion Drift Current [end]'+'!C'+mixsf[0]
fpref = mixpr[0]+'jdrift_e'

xdat  = (jd_s_mix + jd_e_mix)/2d0
ydat  = mix_only_amp
tttl  = ttpr[0]+'Electron-Ion Drift Current [Avg.]'+'!C'+mixsf[0]
fpref = mixpr[0]+'jdrift_avg'

;---------------------
;   All
;---------------------
allpr = 'TDSS_All-Modes_IP-shocks_Amp-vs-'
allsf = '(ALL Modes)'
xdat  = [jd_s_whi,jd_s_lhw,jd_s_mix]
ydat  = [whi_only_amp,lhw_only_amp,mix_only_amp]
tttl  = ttpr[0]+'Electron-Ion Drift Current [start]'+'!C'+allsf[0]
fpref = allpr[0]+'jdrift_s'

xdat  = [jd_e_whi,jd_e_lhw,jd_e_mix]
ydat  = [whi_only_amp,lhw_only_amp,mix_only_amp]
tttl  = ttpr[0]+'Electron-Ion Drift Current [end]'+'!C'+allsf[0]
fpref = allpr[0]+'jdrift_e'

xdat0 = [jd_s_whi,jd_s_lhw,jd_s_mix]
xdat1 = [jd_e_whi,jd_e_lhw,jd_e_mix]
xdat  = (xdat0 + xdat1)/2d0
ydat  = [whi_only_amp,lhw_only_amp,mix_only_amp]
tttl  = ttpr[0]+'Electron-Ion Drift Current [Avg.]'+'!C'+allsf[0]
fpref = allpr[0]+'jdrift_avg'


xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

;-----------------------------------------------------------------------------------------
; => Separate out the first Mixed mode on 1998-09-24
;-----------------------------------------------------------------------------------------
ydat  = mix_only_amp
bad   = WHERE(ydat GT 25.,bd)
ydat[bad] = !VALUES.F_NAN

;---------------------
; => Beta_par,ec plots
;---------------------
xttl  = '!7b!3'+'!D!9#!3'+',ce!N'
xran  = [0.10,1.20]
xdat  = beta_par_s_mix
tttl  = ttpr[0]+'Parallel Electron Core Beta [start]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Beta-parce_s_2nd'

xdat  = beta_par_e_mix
tttl  = ttpr[0]+'Parallel Electron Core Beta [end]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Beta-parce_e_2nd'

xdat  = (beta_par_s_mix + beta_par_e_mix)/2d0
tttl  = ttpr[0]+'Parallel Electron Core Beta [Avg.]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Beta-parce_avg_2nd'

;---------------------
; => |Vd| plots
;---------------------
xttl  = '|V!Dd!N'+'| [km/s]'
xdat  = vd_s_mix
tttl  = ttpr[0]+'Electron Drift Speed [start]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Vdrift_s_2nd'

xdat  = vd_e_mix
tttl  = ttpr[0]+'Electron Drift Speed [end]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Vdrift_e_2nd'

xdat  = (vd_s_mix + vd_e_mix)/2d0
tttl  = ttpr[0]+'Electron Drift Speed [Avg.]'+'!C'+mixsf[0]
fpref = mixpr[0]+'Vdrift_avg_2nd'

;---------------------
; => |jd| plots
;---------------------
xttl  = '|j!Dd!N'+'| [nA m!U-2!N]'
xdat  = jd_s_mix
tttl  = ttpr[0]+'Electron-Ion Drift Current [start]'+'!C'+mixsf[0]
fpref = mixpr[0]+'jdrift_s_2nd'

xdat  = jd_e_mix
tttl  = ttpr[0]+'Electron-Ion Drift Current [end]'+'!C'+mixsf[0]
fpref = mixpr[0]+'jdrift_e_2nd'

xdat  = (jd_s_mix + jd_e_mix)/2d0
tttl  = ttpr[0]+'Electron-Ion Drift Current [Avg.]'+'!C'+mixsf[0]
fpref = mixpr[0]+'jdrift_avg_2nd'

;---------------------
; => |Qe| plots
;---------------------
xdat  = hflux_mix_only
xttl  = '|Q!De!N'+'| [keV km/s cm!U-3!N'+']'
tttl  = ttpr[0]+'Electron Heat Flux'+'!C'+mixsf[0]
fpref = mixpr[0]+'Qe_2nd'

;---------------------
; => <Te>/<Ti> plots
;---------------------
xdat  = te_ti_mix_only
xttl  = 'T!De!N'+'/T!Di!N'
tttl  = ttpr[0]+'Electron-to-Ion Temp Ratio'+'!C'+mixsf[0]
fpref = mixpr[0]+'Te-Ti_2nd'

;---------------------
; => Teh_para/Tec_para plots
;---------------------
xdat  = tpahc_mix_only
xttl  = 'T!D!9#!3'+',h!N/T!D!9#!3'+',c!N'
tttl  = ttpr[0]+'Halo-to-Core Electron Para-Temp Ratio'+'!C'+mixsf[0]
fpref = mixpr[0]+'Thpara-Tcpara_2nd'

;---------------------
; => Tec_perp/Tec_para plots
;---------------------
xdat  = tanic_mix_only
xttl  = 'T!D!9x!3'+',c!N/T!D!9#!3'+',c!N'
tttl  = ttpr[0]+'Core Electron Temp Anisotropy'+'!C'+mixsf[0]
fpref = mixpr[0]+'Tcperp-Tcpara_2nd'


;---------------------
; => Teh_perp/Teh_para plots
;---------------------
xdat  = tanih_mix_only
xttl  = 'T!D!9x!3'+',h!N/T!D!9#!3'+',h!N'
tttl  = ttpr[0]+'Halo Electron Temp Anisotropy'+'!C'+mixsf[0]
fpref = mixpr[0]+'Thperp-Thpara_2nd'



xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose



'----------------------------------------------------------------------------------------------'
'Plot some plasma parameters with wave amplitudes'
'----------------------------------------------------------------------------------------------'

lhw_only_amp   = [3.967,4.835,0.870,4.094,2.916,1.572,0.288]
bmago_lhw_only = [23.537,23.125,35.242,36.225,36.095,23.915,23.574]
edens_lhw_only = [22.911,21.810,24.699,24.534,25.467,22.313,14.165]
dB_Bo_lhw_only = lhw_only_amp/(2d0*bmago_lhw_only)
hflux_lhw_only = [497348.830,773195.960,489787.490,369173.430,349664.150,318400.890,252050.890]*1d-3
tavge_lhw_only = [58.057,57.458,44.660,49.034,50.228,58.013,55.925]
tavgi_lhw_only = [100.266,75.230,77.193,79.111,78.199,107.649,116.449]
te_ti_lhw_only = tavge_lhw_only/tavgi_lhw_only
tavce_lhw_only = [50.001,48.693,38.452,40.304,41.014,45.497,43.148]
tavhe_lhw_only = [288.052,298.257,168.478,176.119,179.200,172.731,173.947]
th_tc_lhw_only = tavhe_lhw_only/tavce_lhw_only
tparc_lhw_only = [48.575,51.181,45.075,48.110,49.264,47.125,42.264]
tperc_lhw_only = [50.713,47.449,35.140,36.401,36.888,44.683,43.590]
tparh_lhw_only = [240.556,263.808,170.277,200.700,210.073,170.862,158.818]
tperh_lhw_only = [311.799,315.482,167.579,163.829,163.763,173.665,181.5120]
tanic_lhw_only = tperc_lhw_only/tparc_lhw_only
tanih_lhw_only = tperh_lhw_only/tparh_lhw_only
tpahc_lhw_only = tparh_lhw_only/tparc_lhw_only
tpehc_lhw_only = tperh_lhw_only/tperc_lhw_only

whi_only_amp   = [1.666,1.286,1.952,2.226,3.539,1.259,2.574,1.960,1.174,0.994,0.269,0.920,0.610]
bmago_whi_only = [20.737,21.830,22.725,22.606,22.951,23.296,22.147,20.148,22.576,22.703,18.123,15.039,15.308]
edens_whi_only = [20.740,19.820,18.489,18.048,17.818,17.628,16.687,16.734,16.849,16.895,24.601,20.398,19.291]
dB_Bo_whi_only = whi_only_amp/(2d0*bmago_whi_only)
hflux_whi_only = [674745.180,623354.270,567722.970,580733.590,581392.730,576869.510,507781.360,527052.630,208457.750,198412.850,93534.420,97236.650,97477.990]*1d-3
tavge_whi_only = [62.881,62.914,63.259,63.186,62.886,62.304,60.529,58.293,43.983,43.839,26.423,28.604,31.017]
tavgi_whi_only = [97.926,94.920,90.192,90.428,92.303,90.878,89.882,89.497,41.461,42.224,27.713,25.645,26.395]
te_ti_whi_only = tavge_whi_only/tavgi_whi_only
tavce_whi_only = [53.114,53.526,53.911,54.358,54.331,53.897,52.595,50.297,34.655,34.538,23.993,25.398,27.627]
tavhe_whi_only = [289.095,287.960,286.186,283.417,282.535,282.555,286.687,290.786,215.973,216.939,194.920,194.393,192.301]
th_tc_whi_only = tavhe_whi_only/tavce_whi_only
tparc_whi_only = [51.652,53.375,53.529,54.432,54.851,55.289,56.804,56.523,29.902,29.537,24.837,27.893,31.092]
tperc_whi_only = [53.846,53.601,54.101,54.321,54.071,53.201,50.491,47.184,37.032,37.038,23.571,24.150,25.894]
tparh_whi_only = [240.255,240.234,238.922,235.363,234.747,235.454,250.231,273.927,151.058,153.010,217.855,231.439,225.931]
tperh_whi_only = [313.515,311.823,309.819,307.444,306.429,306.106,304.914,299.216,248.430,248.903,183.453,175.870,175.486]
tanic_whi_only = tperc_whi_only/tparc_whi_only
tanih_whi_only = tperh_whi_only/tparh_whi_only
tpahc_whi_only = tparh_whi_only/tparc_whi_only
tpehc_whi_only = tperh_whi_only/tperc_whi_only

mix_only_amp   = [7.592,18.750,30.000,1.718,1.606,1.187,3.074,3.349,6.20,7.36,4.57,3.06,1.77]
bmago_mix_only = [11.378,17.279,31.786,42.112,42.351,40.631,36.222,37.328,36.608,22.070,16.570,16.261,15.251]
edens_mix_only = [14.002,14.147,16.586,21.087,21.499,24.016,20.004,24.764,19.946,21.804,14.821,15.463,16.053]
dB_Bo_mix_only = mix_only_amp/(2d0*bmago_mix_only)
hflux_mix_only = [34283.380,599120.450,151272.910,503830.140,496106.730,520586.100,395867.030,397469.170,298941.980,364357.260,80912.160,121466.010,170952.940]*1d-3
tavge_mix_only = [18.782,51.970,24.752,50.450,50.215,50.290,45.391,49.329,45.323,57.823,59.755,54.980,50.937]
tavgi_mix_only = [9.837,48.250,33.823,86.049,83.873,75.068,86.598,78.886,86.363,125.535,22.904,27.846,31.459]
te_ti_mix_only = tavge_mix_only/tavgi_mix_only
tavce_mix_only = [16.590,41.672,19.873,40.832,40.664,41.359,39.023,40.479,38.970,45.251,36.120,34.706,33.755]
tavhe_mix_only = [121.404,291.502,100.213,176.033,176.393,176.549,164.886,176.880,164.738,173.254,260.292,256.202,248.418]
th_tc_mix_only = tavhe_mix_only/tavce_mix_only
tparc_mix_only = [16.316,38.562,22.318,42.747,42.561,44.234,47.296,48.395,47.189,47.220,37.846,36.719,34.440]
tperc_mix_only = [16.728,43.227,18.650,39.874,39.716,39.922,34.887,36.521,34.860,44.266,35.257,33.700,33.413]
tparh_mix_only = [137.176,278.001,108.888,117.178,118.940,135.459,163.465,203.014,163.059,171.751,273.023,252.325,232.196]
tperh_mix_only = [113.518,298.253,95.875,205.461,205.120,197.093,165.597,163.813,165.577,174.005,253.926,258.140,256.529]
tanic_mix_only = tperc_mix_only/tparc_mix_only
tanih_mix_only = tperh_mix_only/tparh_mix_only
tpahc_mix_only = tparh_mix_only/tparc_mix_only
tpehc_mix_only = tperh_mix_only/tperc_mix_only

; => Look at histograms of dB/Bo
nbins = 7L
dran  = [0.005,0.55]
tttl  = '!7d!3'+'B/B!Do!N for (Lower-Hybrid Only)'
xttl  = '!7d!3'+'B/B!Do!N'
fname = 'TDSS_Lower-Hybrid-Only_IP-shocks_dB_Bo_histogram'
  my_histogram_plot,dB_Bo_lhw_only,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,dB_Bo_lhw_only,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B/B!Do!N for (Whistlers Only)'
xttl  = '!7d!3'+'B/B!Do!N'
fname = 'TDSS_Whistlers-Only_IP-shocks_dB_Bo_histogram'
  my_histogram_plot,dB_Bo_whi_only,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,dB_Bo_whi_only,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B/B!Do!N for (Mixed Modes Only)'
xttl  = '!7d!3'+'B/B!Do!N'
fname = 'TDSS_Mixed-Modes_IP-shocks_dB_Bo_histogram'
  my_histogram_plot,dB_Bo_mix_only,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,dB_Bo_mix_only,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

; => Look at histograms of dB (nT)
nbins = 7L
dran  = [0.25,30.00]
tttl  = '!7d!3'+'B for (Lower-Hybrid Only, ALL Amps)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Lower-Hybrid-Only_IP-shocks_dB_histogram_ALL'
  my_histogram_plot,lhw_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,lhw_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B for (Whistlers Only, ALL Amps)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Whistlers-Only_IP-shocks_dB_histogram_ALL'
  my_histogram_plot,whi_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,whi_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B for (Mixed Modes Only, ALL Amps)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname  = 'TDSS_Mixed-Modes-Only_IP-shocks_dB_histogram_ALL'
  my_histogram_plot,mix_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,mix_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose


; => Look at histograms of dB (nT) Below 10nT
nbins = 7L
dran  = [0.25,10.00]
tttl  = '!7d!3'+'B for (Lower-Hybrid Only, Below 10 nT)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Lower-Hybrid_IP-shocks_dB_histogram_Below-10nT'
  my_histogram_plot,lhw_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,lhw_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B for (Whistlers Only, Below 10 nT)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Whistlers_IP-shocks_dB_histogram_Below-10nT'
  my_histogram_plot,whi_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,whi_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B for (Mixed Modes Only, Below 10 nT)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Mixed-Modes_IP-shocks_dB_histogram_Below-10nT'
  my_histogram_plot,mix_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,mix_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

; => Look at histograms of dB (nT) Below 8nT
nbins = 7L
dran  = [0.25,8.00]
tttl  = '!7d!3'+'B for (Lower-Hybrid Only, Below 8 nT)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Lower-Hybrid_IP-shocks_dB_histogram_Below-8nT'
  my_histogram_plot,lhw_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,lhw_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B for (Whistlers Only, Below 8 nT)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Whistlers_IP-shocks_dB_histogram_Below-8nT'
  my_histogram_plot,whi_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,whi_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B for (Mixed Modes Only, Below 8 nT)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Mixed-Modes_IP-shocks_dB_histogram_Below-8nT'
  my_histogram_plot,mix_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,mix_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

; => Look at histograms of dB (nT) Below 9nT
nbins = 9L
dran  = [0.0,8.00]
tttl  = '!7d!3'+'B for (Lower-Hybrid Only, Below 8 nT)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Lower-Hybrid_IP-shocks_dB_histogram_Below-8nT_2'
  my_histogram_plot,lhw_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,lhw_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B for (Whistlers Only, Below 8 nT)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Whistlers_IP-shocks_dB_histogram_Below-8nT_2'
  my_histogram_plot,whi_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,whi_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose

tttl  = '!7d!3'+'B for (Mixed Modes Only, Below 8 nT)'
xttl  = '!7d!3'+'B [peak-to-peak, nT]'
fname = 'TDSS_Mixed-Modes_IP-shocks_dB_histogram_Below-8nT_2'
  my_histogram_plot,mix_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
popen,fname[0],/LAND
  my_histogram_plot,mix_only_amp,NBINS=nbins,XTTL=xttl,TTLE=tttl,DRANGE=dran
pclose




; => Look at correlation plots
!P.MULTI = 0

yttl  = 'Wave Amplitude'+'!C'+'[Peak-to-Peak, nT]'
ttpr  = 'Wave Amplitude vs. '
whisf = '(Whistlers Only)'
whipr = 'TDSS_Whistlers-Only_IP-shocks_Amp-vs-'
lhwsf = '(Lower-Hybrid Only)'
lhwpr = 'TDSS_Lower-Hybrid-Only_IP-shocks_Amp-vs-'
mixsf = '(Mixed Modes Only)'
mixpr = 'TDSS_Mixed-Modes_IP-shocks_Amp-vs-'


; => |Qe| plots
xdat  = hflux_whi_only
ydat  = whi_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
xttl  = '|Q!De!N'+'| [keV km/s cm!U-3!N'+']'
tttl  = ttpr[0]+'Electron Heat Flux'+'!C'+whisf[0]
fpref  = whipr[0]+'Qe'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = hflux_lhw_only
ydat  = lhw_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
xttl  = '|Q!De!N'+'| [keV km/s cm!U-3!N'+']'
tttl  = ttpr[0]+'Electron Heat Flux'+'!C'+lhwsf[0]
fpref  = lhwpr[0]+'Qe'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = hflux_mix_only
ydat  = mix_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
xttl  = '|Q!De!N'+'| [keV km/s cm!U-3!N'+']'
tttl  = ttpr[0]+'Electron Heat Flux'+'!C'+mixsf[0]
fpref  = mixpr[0]+'Qe'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

; => <Teh>/<Tec> plots
xdat  = th_tc_whi_only
ydat  = whi_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
xttl  = 'T!Deh!N'+'/T!Dec!N'
tttl  = ttpr[0]+'Halo-to-Core Temp Ratio'+'!C'+whisf[0]
fpref  = whipr[0]+'Teh-Tec'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = th_tc_lhw_only
ydat  = lhw_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Halo-to-Core Temp Ratio'+'!C'+lhwsf[0]
fpref  = lhwpr[0]+'Teh-Tec'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = th_tc_mix_only
ydat  = mix_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Halo-to-Core Temp Ratio'+'!C'+mixsf[0]
fpref  = mixpr[0]+'Teh-Tec'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose


; => <Te>/<Ti> plots
xdat  = te_ti_whi_only
ydat  = whi_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
xttl  = 'T!De!N'+'/T!Di!N'
tttl  = ttpr[0]+'Electron-to-Ion Temp Ratio'+'!C'+whisf[0]
fpref  = whipr[0]+'Te-Ti'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = te_ti_lhw_only
ydat  = lhw_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Electron-to-Ion Temp Ratio'+'!C'+lhwsf[0]
fpref  = lhwpr[0]+'Te-Ti'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = te_ti_mix_only
ydat  = mix_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Electron-to-Ion Temp Ratio'+'!C'+mixsf[0]
fpref  = mixpr[0]+'Te-Ti'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose


; => Tec_perp/Tec_para plots
xdat  = tanic_whi_only
ydat  = whi_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
xttl  = 'T!D!9x!3'+',c!N/T!D!9#!3'+',c!N'
tttl  = ttpr[0]+'Core Electron Temp Anisotropy'+'!C'+whisf[0]
fpref  = whipr[0]+'Tcperp-Tcpara'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = tanic_lhw_only
ydat  = lhw_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Core Electron Temp Anisotropy'+'!C'+lhwsf[0]
fpref  = lhwpr[0]+'Tcperp-Tcpara'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = tanic_mix_only
ydat  = mix_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Core Electron Temp Anisotropy'+'!C'+mixsf[0]
fpref  = mixpr[0]+'Tcperp-Tcpara'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose


; => Teh_perp/Teh_para plots
xdat  = tanih_whi_only
ydat  = whi_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
xttl  = 'T!D!9x!3'+',h!N/T!D!9#!3'+',h!N'
tttl  = ttpr[0]+'Halo Electron Temp Anisotropy'+'!C'+whisf[0]
fpref  = whipr[0]+'Thperp-Thpara'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = tanih_lhw_only
ydat  = lhw_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Halo Electron Temp Anisotropy'+'!C'+lhwsf[0]
fpref  = lhwpr[0]+'Thperp-Thpara'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = tanih_mix_only
ydat  = mix_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Halo Electron Temp Anisotropy'+'!C'+mixsf[0]
fpref  = mixpr[0]+'Thperp-Thpara'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

; => Teh_perp/Tec_perp plots
xdat  = tpehc_whi_only
ydat  = whi_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
xttl  = 'T!D!9x!3'+',h!N/T!D!9x!3'+',c!N'
tttl  = ttpr[0]+'Halo-to-Core Electron Perp-Temp Ratio'+'!C'+whisf[0]
fpref  = whipr[0]+'Thperp-Tcperp'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = tpehc_lhw_only
ydat  = lhw_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Halo-to-Core Electron Perp-Temp Ratio'+'!C'+lhwsf[0]
fpref  = lhwpr[0]+'Thperp-Tcperp'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = tpehc_mix_only
ydat  = mix_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Halo-to-Core Electron Perp-Temp Ratio'+'!C'+mixsf[0]
fpref  = mixpr[0]+'Thperp-Tcperp'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

; => Teh_para/Tec_para plots
xdat  = tpahc_whi_only
ydat  = whi_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
xttl  = 'T!D!9#!3'+',h!N/T!D!9#!3'+',c!N'
tttl  = ttpr[0]+'Halo-to-Core Electron Para-Temp Ratio'+'!C'+whisf[0]
fpref  = whipr[0]+'Thpara-Tcpara'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = tpahc_lhw_only
ydat  = lhw_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Halo-to-Core Electron Para-Temp Ratio'+'!C'+lhwsf[0]
fpref  = lhwpr[0]+'Thpara-Tcpara'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose

xdat  = tpahc_mix_only
ydat  = mix_only_amp
xran  = [MIN(ABS(xdat),/NAN)/1.1,MAX(ABS(xdat),/NAN)*1.1]
yran  = [MIN(ABS(ydat),/NAN)/1.1,MAX(ABS(ydat),/NAN)*1.1]
tttl  = ttpr[0]+'Halo-to-Core Electron Para-Temp Ratio'+'!C'+mixsf[0]
fpref  = mixpr[0]+'Thpara-Tcpara'
pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xran,YRANGE:yran}
popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50
pclose
'----------------------------------------------------------------------------------------------'
'Plot fits of some plasma parameters with wave amplitudes'
'----------------------------------------------------------------------------------------------'

lhw_only_amp   = [3.967,4.835,0.870,4.094,2.916,1.572,0.288]
bmago_lhw_only = [23.537,23.125,35.242,36.225,36.095,23.915,23.574]
edens_lhw_only = [22.911,21.810,24.699,24.534,25.467,22.313,14.165]
dB_Bo_lhw_only = lhw_only_amp/(2d0*bmago_lhw_only)
hflux_lhw_only = [497348.830,773195.960,489787.490,369173.430,349664.150,318400.890,252050.890]*1d-3
tavge_lhw_only = [58.057,57.458,44.660,49.034,50.228,58.013,55.925]
tavgi_lhw_only = [100.266,75.230,77.193,79.111,78.199,107.649,116.449]
te_ti_lhw_only = tavge_lhw_only/tavgi_lhw_only
tavce_lhw_only = [50.001,48.693,38.452,40.304,41.014,45.497,43.148]
tavhe_lhw_only = [288.052,298.257,168.478,176.119,179.200,172.731,173.947]
th_tc_lhw_only = tavhe_lhw_only/tavce_lhw_only
tparc_lhw_only = [48.575,51.181,45.075,48.110,49.264,47.125,42.264]
tperc_lhw_only = [50.713,47.449,35.140,36.401,36.888,44.683,43.590]
tparh_lhw_only = [240.556,263.808,170.277,200.700,210.073,170.862,158.818]
tperh_lhw_only = [311.799,315.482,167.579,163.829,163.763,173.665,181.5120]
tanic_lhw_only = tperc_lhw_only/tparc_lhw_only
tanih_lhw_only = tperh_lhw_only/tparh_lhw_only
tpahc_lhw_only = tparh_lhw_only/tparc_lhw_only
tpehc_lhw_only = tperh_lhw_only/tperc_lhw_only

whi_only_amp   = [1.666,1.286,1.952,2.226,3.539,1.259,2.574,1.960,1.174,0.994,0.269,0.920,0.610]
bmago_whi_only = [20.737,21.830,22.725,22.606,22.951,23.296,22.147,20.148,22.576,22.703,18.123,15.039,15.308]
edens_whi_only = [20.740,19.820,18.489,18.048,17.818,17.628,16.687,16.734,16.849,16.895,24.601,20.398,19.291]
dB_Bo_whi_only = whi_only_amp/(2d0*bmago_whi_only)
hflux_whi_only = [674745.180,623354.270,567722.970,580733.590,581392.730,576869.510,507781.360,527052.630,208457.750,198412.850,93534.420,97236.650,97477.990]*1d-3
tavge_whi_only = [62.881,62.914,63.259,63.186,62.886,62.304,60.529,58.293,43.983,43.839,26.423,28.604,31.017]
tavgi_whi_only = [97.926,94.920,90.192,90.428,92.303,90.878,89.882,89.497,41.461,42.224,27.713,25.645,26.395]
te_ti_whi_only = tavge_whi_only/tavgi_whi_only
tavce_whi_only = [53.114,53.526,53.911,54.358,54.331,53.897,52.595,50.297,34.655,34.538,23.993,25.398,27.627]
tavhe_whi_only = [289.095,287.960,286.186,283.417,282.535,282.555,286.687,290.786,215.973,216.939,194.920,194.393,192.301]
th_tc_whi_only = tavhe_whi_only/tavce_whi_only
tparc_whi_only = [51.652,53.375,53.529,54.432,54.851,55.289,56.804,56.523,29.902,29.537,24.837,27.893,31.092]
tperc_whi_only = [53.846,53.601,54.101,54.321,54.071,53.201,50.491,47.184,37.032,37.038,23.571,24.150,25.894]
tparh_whi_only = [240.255,240.234,238.922,235.363,234.747,235.454,250.231,273.927,151.058,153.010,217.855,231.439,225.931]
tperh_whi_only = [313.515,311.823,309.819,307.444,306.429,306.106,304.914,299.216,248.430,248.903,183.453,175.870,175.486]
tanic_whi_only = tperc_whi_only/tparc_whi_only
tanih_whi_only = tperh_whi_only/tparh_whi_only
tpahc_whi_only = tparh_whi_only/tparc_whi_only
tpehc_whi_only = tperh_whi_only/tperc_whi_only


;-----------------------------------------------------------------------------------------
; => Look at correlation plots with fit-lines overplotted
;-----------------------------------------------------------------------------------------
!P.MULTI = 0
; => XYOUTS in upper left-hand corner
xo_ul = 0.15
yo_ul = [0.90,0.85,0.80,0.75,0.70]
; => XYOUTS in upper right-hand corner
xo_ur = 0.60
yo_ur = [0.90,0.85,0.80,0.75,0.70]
; => XYOUTS in lower right-hand corner
xo_lr = 0.60
yo_lr = [0.35,0.30,0.25,0.20,0.15]


yttl  = 'Wave Amplitude'+'!C'+'[Peak-to-Peak, nT]'
ttpr  = 'Wave Amplitude vs. '
fitsx = '_Fits'

;------------------------------------------------------------------
; => Whistler Only
;------------------------------------------------------------------
whisf = '(Whistlers Only)'
whipr = 'TDSS_Whistlers-Only_IP-shocks_Amp-vs-'
ydat  = whi_only_amp

'----------------------------------------------'
' => |Qe| plots'
'----------------------------------------------'
xos            = xo_ul[0]
yos            = yo_ul
xttl           = '|Q!De!N'+'| [keV km/s cm!U-3!N'+']'
tttl           = ttpr[0]+'Electron Heat Flux'+'!C'+whisf[0]
fpref          = whipr[0]+'Qe'+fitsx[0]

xdat           = hflux_whi_only
;----------------------------------------------
; => 'Fit Line:  F(z) = A + B z'
;  A =       0.48137288
;  B =     0.0025903956
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B z'
;  Ln|A| =      -0.64636783
;  B     =     0.0022512770
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|'
;  Ln|A| =       -3.7151143
;  B     =       0.69020067
;----------------------------------------------

'----------------------------------------------'
' => <Teh>/<Tec> plots'
'----------------------------------------------'
xos            = xo_ur[0]
yos            = yo_ur
xttl           = 'T!Deh!N'+'/T!Dec!N'
tttl           = ttpr[0]+'Halo-to-Core Temp Ratio'+'!C'+whisf[0]
fpref          = whipr[0]+'Teh-Tec'+fitsx[0]

xdat           = th_tc_whi_only
;----------------------------------------------
; => 'Fit Line:  F(z) = A + B z'
;  A =        5.1271981
;  B =      -0.59813580
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B z'
;  Ln|A| =        3.8045600
;  B     =      -0.58580447
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|'
;  Ln|A| =        6.9785790
;  B     =       -3.7563666
;----------------------------------------------

'----------------------------------------------'
' => <Te>/<Ti> plots'
'----------------------------------------------'
xos            = xo_ur[0]
yos            = yo_ur
xttl           = 'T!De!N'+'/T!Di!N'
tttl           = ttpr[0]+'Electron-to-Ion Temp Ratio'+'!C'+whisf[0]
fpref          = whipr[0]+'Te-Ti'+fitsx[0]

xdat           = te_ti_whi_only
;----------------------------------------------
; => 'Fit Line:  F(z) = A + B z'
;  A =        3.5837573
;  B =       -2.4929478
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B z'
;  Ln|A| =        2.1049885
;  B     =       -2.2121211
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|'
;  Ln|A| =      -0.14693495
;  B     =       -1.9473654
;----------------------------------------------

'----------------------------------------------'
' => Teh_perp/Teh_para plots'
'----------------------------------------------'
xos            = xo_ul[0]
yos            = yo_ul
xttl           = 'T!D!9x!3'+',h!N/T!D!9#!3'+',h!N'
tttl           = ttpr[0]+'Halo Electron Temp Anisotropy'+'!C'+whisf[0]
fpref          = whipr[0]+'Thperp-Thpara'+fitsx[0]

xdat           = tanih_whi_only
;----------------------------------------------
; => 'Fit Line:  F(z) = A + B z'
;  A =      -0.11901007
;  B =        1.3673024
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B z'
;  Ln|A| =       -1.0800475
;  B     =        1.1189227
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|'
;  Ln|A| =      0.041114691
;  B     =        1.4266959
;----------------------------------------------


;------------------------------------------------------------------
; => Lower Hybrid Only
;------------------------------------------------------------------
lhwsf = '(Lower-Hybrid Only)'
lhwpr = 'TDSS_Lower-Hybrid-Only_IP-shocks_Amp-vs-'
ydat  = lhw_only_amp

'----------------------------------------------'
' => |Qe| plots'
'----------------------------------------------'
xos            = xo_lr[0]
yos            = yo_lr
xttl           = '|Q!De!N'+'| [keV km/s cm!U-3!N'+']'
tttl           = ttpr[0]+'Electron Heat Flux'+'!C'+lhwsf[0]
fpref          = lhwpr[0]+'Qe'+fitsx[0]

xdat           = hflux_lhw_only
;----------------------------------------------
; => 'Fit Line:  F(z) = A + B z'
;  A =      -0.71351825
;  B =     0.0071781156
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B z'
;  Ln|A| =      -0.80746935
;  B     =     0.0033296602
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|'
;  Ln|A| =       -9.8732310
;  B     =        1.7479419
;----------------------------------------------

'----------------------------------------------'
' => <Teh>/<Tec> plots'
'----------------------------------------------'
xos            = xo_lr[0]
yos            = yo_lr
xttl           = 'T!Deh!N'+'/T!Dec!N'
tttl           = ttpr[0]+'Halo-to-Core Temp Ratio'+'!C'+lhwsf[0]
fpref          = lhwpr[0]+'Teh-Tec'+fitsx[0]

xdat           = th_tc_lhw_only
;----------------------------------------------
; => 'Fit Line:  F(z) = A + B z'
;  A =       -3.7501565
;  B =        1.4016002
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B z'
;  Ln|A| =       -2.7203909
;  B     =       0.71706758
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|'
;  Ln|A| =       -4.8313078
;  B     =        3.5752557
;----------------------------------------------

'----------------------------------------------'
' => <Te>/<Ti> plots'
'----------------------------------------------'
xos            = xo_lr[0]
yos            = yo_lr
xttl           = 'T!De!N'+'/T!Di!N'
tttl           = ttpr[0]+'Electron-to-Ion Temp Ratio'+'!C'+lhwsf[0]
fpref          = lhwpr[0]+'Te-Ti'+fitsx[0]

xdat           = te_ti_lhw_only
;----------------------------------------------
; => 'Fit Line:  F(z) = A + B z'
;  A =       -7.2358316
;  B =        15.805189
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B z'
;  Ln|A| =       -4.6771421
;  B     =        8.8615756
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|'
;  Ln|A| =        3.5943765
;  B     =        5.6820270
;----------------------------------------------

'----------------------------------------------'
' => Teh_para/Tec_para plots'
'----------------------------------------------'
xos            = xo_lr[0]
yos            = yo_lr
xttl           = 'T!D!9#!3'+',h!N/T!D!9#!3'+',c!N'
tttl           = ttpr[0]+'Halo-to-Core Electron Para-Temp Ratio'+'!C'+lhwsf[0]
fpref          = lhwpr[0]+'Thpara-Tcpara'+fitsx[0]

xdat           = tpahc_lhw_only
;----------------------------------------------
; => 'Fit Line:  F(z) = A + B z'
;  A =       -6.2881761
;  B =        2.1579908
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B z'
;  Ln|A| =       -4.6773602
;  B     =        1.2538313
;----------------------------------------------
; => 'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|'
;  Ln|A| =       -7.3150708
;  B     =        5.5379267
;----------------------------------------------


fit_stats      = stats_tds_fit_lines(xdat,ydat)
test0          = LADFIT(xdat,ydat,ABSDEV=devexpo,/DOUBLE)
;test0          = LINFIT(xdat,ydat,CHISQR=chiexp,/DOUBLE,YFIT=y_fit)

xr = [MIN(xdat,/NAN),MAX(xdat,/NAN)] + [-1d-1*MIN(xdat,/NAN),1d-1*MAX(xdat,/NAN)]
yr = [MIN(ydat,/NAN),MAX(ydat,/NAN)] + [-1d-1*MIN(ydat,/NAN),1d-1*MAX(ydat,/NAN)]
x0 = DINDGEN(100)*(xr[1] - xr[0])/99L +  xr[0]
y0 = test0[0] + test0[1]*x0
PRINT, ';  A = ', test0[0]
PRINT, ';  B = ', test0[1]

a1e = fit_stats.EXPO_AB[0,1]
b1e = fit_stats.EXPO_AB[1,1]
x1e = x0
y1e = EXP(a1e + b1e*x1e)
PRINT, ';  Ln|A| = ', a1e[0]
PRINT, ';  B     = ', b1e[0]

a1p = fit_stats.POW_AB[0,1]
b1p = fit_stats.POW_AB[1,1]
x1p = ALOG(x0)
y1p = EXP(a1p + b1p*x1p)
PRINT, ';  Ln|A| = ', a1p[0]
PRINT, ';  B     = ', b1p[0]

str00 = STRTRIM(STRING(FORMAT='(e15.2)',test0),2)
str01 = STRTRIM(STRING(FORMAT='(e15.2)',[EXP(a1e),b1e]),2)
str02 = STRTRIM(STRING(FORMAT='(e15.2)',[EXP(a1p),b1p]),2)
aout  = 'A = '+str00[0]+', '+str01[0]+', '+str02[0]
bout  = 'B = '+str00[1]+', '+str01[1]+', '+str02[1]


pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xr,YRANGE:yr}
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50,SYMSIZE=2.0
    OPLOT,x0,y0,LINESTYLE=2,COLOR=50
    OPLOT,x1e,y1e,LINESTYLE=2,COLOR=150
    OPLOT,EXP(x1p),y1p,LINESTYLE=2,COLOR=250
    XYOUTS,xos[0],yos[0],'Fit Line:  F(z) = A + B z',COLOR=50,/NORMAL
    XYOUTS,xos[0],yos[1],'Fit Line:  Ln|F(z)| = Ln|A| + B z',COLOR=150,/NORMAL
    XYOUTS,xos[0],yos[2],'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|',COLOR=250,/NORMAL
    XYOUTS,xos[0],yos[3],aout,/NORMAL
    XYOUTS,xos[0],yos[4],bout,/NORMAL

popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50,SYMSIZE=2.0
    OPLOT,x0,y0,LINESTYLE=2,COLOR=50
    OPLOT,x1e,y1e,LINESTYLE=2,COLOR=150
    OPLOT,EXP(x1p),y1p,LINESTYLE=2,COLOR=250
    XYOUTS,xos[0],yos[0],'Fit Line:  F(z) = A + B z',COLOR=50,/NORMAL
    XYOUTS,xos[0],yos[1],'Fit Line:  Ln|F(z)| = Ln|A| + B z',COLOR=150,/NORMAL
    XYOUTS,xos[0],yos[2],'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|',COLOR=250,/NORMAL
    XYOUTS,xos[0],yos[3],aout,/NORMAL
    XYOUTS,xos[0],yos[4],bout,/NORMAL
pclose


; => Special case for Whistler Only => <Teh>/<Tec> plots
xos   = 0.55
yos   = [0.90,0.85,0.80,0.75,0.70]
fpref = whipr[0]+'Teh-Tec'+fitsx[0]+'_Extra-Power-Law-Fit'
a2p   = 9.5d0
b2p   = -5.2d0
str03 = STRTRIM(STRING(FORMAT='(e15.2)',[EXP(a2p),b2p]),2)
y2p   = EXP(a2p + b2p*x1p)                
aout  = 'A = '+str00[0]+', '+str01[0]+', '+str02[0]+', '+str03[0]
bout  = 'B = '+str00[1]+', '+str01[1]+', '+str02[1]+', '+str03[1]

pstr  = {XSTYLE:1,YSTYLE:1,NODATA:1,XTITLE:xttl,YTITLE:yttl,TITLE:tttl,XMINOR:10,XTICKLEN:0.04,$
         XRANGE:xr,YRANGE:yr}
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50,SYMSIZE=2.0
    OPLOT,x0,y0,LINESTYLE=2,COLOR=50
    OPLOT,x1e,y1e,LINESTYLE=2,COLOR=150
    OPLOT,EXP(x1p),y1p,LINESTYLE=2,COLOR=250
    OPLOT,EXP(x1p),y2p,LINESTYLE=2,COLOR=200
    XYOUTS,xos[0],yos[0],'Fit Line:  F(z) = A + B z',COLOR=50,/NORMAL
    XYOUTS,xos[0],yos[1],'Fit Line:  Ln|F(z)| = Ln|A| + B z',COLOR=150,/NORMAL
    XYOUTS,xos[0],yos[2],'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|',COLOR=250,/NORMAL
    XYOUTS,xos[0],yos[3],aout,/NORMAL
    XYOUTS,xos[0],yos[4],bout,/NORMAL

popen,fpref[0],/LAND
  PLOT,xdat,ydat,_EXTRA=pstr
    OPLOT,xdat,ydat,PSYM=2,COLOR=50,SYMSIZE=2.0
    OPLOT,x0,y0,LINESTYLE=2,COLOR=50
    OPLOT,x1e,y1e,LINESTYLE=2,COLOR=150
    OPLOT,EXP(x1p),y1p,LINESTYLE=2,COLOR=250
    OPLOT,EXP(x1p),y2p,LINESTYLE=2,COLOR=200
    XYOUTS,xos[0],yos[0],'Fit Line:  F(z) = A + B z',COLOR=50,/NORMAL
    XYOUTS,xos[0],yos[1],'Fit Line:  Ln|F(z)| = Ln|A| + B z',COLOR=150,/NORMAL
    XYOUTS,xos[0],yos[2],'Fit Line:  Ln|F(z)| = Ln|A| + B Ln|z|',COLOR=250,/NORMAL
    XYOUTS,xos[0],yos[3],aout,/NORMAL
    XYOUTS,xos[0],yos[4],bout,/NORMAL
pclose


'----------------------------------------------------------------------------------------------'
'HTR MFI Plots for TDSS Locations                                                              '
'----------------------------------------------------------------------------------------------'
; => Constants and dummy variables
f      = !VALUES.F_NAN
d      = !VALUES.D_NAN
kB     = 1.380658d-23      ; -Boltzmann Constant (J/K)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
K_eV   = 1.160474d4        ; -Conversion = degree Kelvin/eV
epo    = 8.854187817d-12   ; -Permittivity of free space (F/m)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
me     = 9.1093897d-31     ; -Electron mass (kg)
mp     = 1.6726231d-27     ; -Proton mass (kg)
qq     = 1.60217733d-19    ; -Fundamental charge (C)
c      = 2.99792458d8      ; -Speed of light in vacuum (m/s)
c2     = (c*1d-3)^2        ; -" " squared (km/s)^2
me_ev  = 0.5109906d6       ; -Electron mass in eV/c^2
me_3dp = me_ev/c2          ; -Electron mass [eV/(km/s)^2]
mp_ev  = 938.27231d6       ; -Proton mass in eV/c^2
mp_3dp = mp_ev/c2          ; -Proton mass [eV/(km/s)^2]
beta_fac = 1d6*(kB*K_eV)*(2d0*muo)
wpefac = SQRT(1d6*qq^2/me/epo)
wppfac = SQRT(1d6*qq^2/mp/epo)

; => Check date 
date    = '121097'
t       = ['1997-12-10/03:33:00','1997-12-10/05:33:00']
tramp   = '1997-12-10/04:33:14.664'
gnorm   = [-0.903, 0.168,-0.397]   ; => Using RH08 from JCK's site
dgnorm  = [ 0.015, 0.032, 0.374]
gnorm2  = [-0.971, 0.094,-0.218]   ; => Using RH08 from JCK's site
dgnorm2 = [ 0.016, 0.071, 0.214]
ushn    = [132.3, 54.3]           ; => Up/Downstream normal flow speed [shock frame] RHO8
ushn2   = [124.0, 50.4]           ; => Up/Downstream normal flow speed [shock frame] RHO9
vshn    = 391.2                   ; => Up/Downstream normal flow speed [SC frame] RHO8
vshn2   = 403.9                   ; => Up/Downstream normal flow speed [SC frame] RHO9
ni_up   = 11.18    ; => Avg. upstream density [cm^(-3)]

date    = '082698'
t       = ['1998-08-26/05:40:00','1998-08-26/07:40:00']  ; -For moment writing
tramp   = '1998-08-26/06:40:24.972'
gnorm   = [-0.655,0.040,-0.754]   ; => Using RH08 from JCK's site
dgnorm  = [0.010,0.009,0.561]
gnorm2  = [-0.822,0.138,-0.553]   ; => Using RH09 from JCK's site
dgnorm2 = [0.040,0.070,0.488]
ushn    = [401.3,142.3]           ; => Up/Downstream normal flow speed [shock frame] RHO8
ushn2   = [379.6,135.6]           ; => Up/Downstream normal flow speed [shock frame] RHO9
vshn    = 687.4                   ; => Up/Downstream normal flow speed [SC frame] RHO8
vshn2   = 747.2                   ; => Up/Downstream normal flow speed [SC frame] RHO9
ni_up   = 6.68     ; => Avg. upstream density [cm^(-3)]

date    = '092498'
t       = ['1998-09-24/22:20:00','1998-09-25/00:30:00']
tramp   = '1998-09-24/23:20:37.374'
gnorm   = [-0.914,-0.220,-0.341]   ; => Using RH08 from JCK's site
dgnorm  = [ 0.004, 0.009, 0.327]
gnorm2  = [-0.939,-0.175,-0.296]   ; => Using RH09 from JCK's site
dgnorm2 = [ 0.024, 0.070, 0.287]
ushn    = [386.3,174.6]           ; => Up/Downstream normal flow speed [shock frame] RHO8
ushn2   = [381.2,171.3]           ; => Up/Downstream normal flow speed [shock frame] RHO9
vshn    = 772.4                   ; => Up/Downstream normal flow speed [SC frame] RHO8
vshn2   = 780.0                   ; => Up/Downstream normal flow speed [SC frame] RHO9
ni_up   = 8.40     ; => Avg. upstream density [cm^(-3)]

date    = '021100'
t       = ['2000-02-11/22:33:00','2000-02-12/00:33:00']
tramp   = '2000-02-11/23:33:55.319'
gnorm   = [-0.865,-0.452,0.218]   ; => Using RH08 from JCK's site
dgnorm  = [ 0.017, 0.030,0.214]
gnorm2  = [-0.930,-0.367,-0.028]   ; => Using RH09 from JCK's site
dgnorm2 = [ 0.025, 0.063, 0.028]
ushn    = [263.6, 81.7]           ; => Up/Downstream normal flow speed [shock frame] RHO8
ushn2   = [255.3, 79.3]           ; => Up/Downstream normal flow speed [shock frame] RHO9
vshn    = 641.4                   ; => Up/Downstream normal flow speed [SC frame] RHO8
vshn2   = 661.1                   ; => Up/Downstream normal flow speed [SC frame] RHO9
ni_up   = 5.31     ; => Avg. upstream density [cm^(-3)]

; => Load MFI data
tr3    = time_double(t)
tura   = time_double(tramp)

mydate = my_str_date(DATE=date)
sdate  = mydate.S_DATE[0]  ; -('MMDDYY')
ldate  = mydate.DATE[0]    ; -('YYYYMMDD')
tdate  = mydate.TDATE[0]   ; => 'YYYY-MM-DD'

mag3  = read_wind_mfi(TRANGE=tr3)
t3x   = mag3.MAG.X
bmag4 = mag3.MAG.Y
magf4 = mag3.BGSE.Y
nt    = N_ELEMENTS(t3x) 
store_data,'wi_B3_MAG(GSE)',DATA={X:mag3.MAG.X,Y:bmag4}
store_data,'wi_B3(GSE)',DATA={X:mag3.MAG.X,Y:magf4}
nn0 =['wi_B3_MAG(GSE)','wi_B3(GSE)']
options,'wi_B3_MAG(GSE)',"YTITLE","|B| (nT)!C[GSE,3s]"
options,'wi_B3(GSE)',"YTITLE","B (nT)!C[GSE,3s]"
options,'wi_B3(GSE)','COLORS',[250,150,50]
tplot_options,'xmargin',[18,12]
tplot_options,'ymargin',[5,5]
tplot,nn0,TRANGE=tr3

htr_mfi2tplot,DATE=date
nn0     = ['WIND_MAG_HTR(GSE,nT)','WIND_B3_HTR(GSE,nT)']
tplot,nn0,TRANGE=tr3

; => Find shock info
sh_mit     = read_shocks_jck_database()
mit_dates  = sh_mit.SDATES                 ; => 'MMDDYY'
shocks     = sh_mit.SHOCK
header     = sh_mit.HEADER
ymdb_ra    = header.DATE_TIME              ; => ['YYYY-MM-DD/HH:MM:SS.sss']
mts        = my_time_string(ymdb_ra,STR=1,FORM=1)
unix_ra    = mts.UNIX

a_ushn     = shocks.USH_N                  ; => Shock normal velocity (Shock-Frame) [km/s]
a_compr    = shocks.COMPRESSION            ; => Shock compression ratio

gshock     = WHERE(mit_dates EQ date,gsh)

IF (sdate[0] EQ '021100') THEN kk = 1 ELSE kk = 0

midra = tura
gushn = ushn[0]  ; => Use RH08 [shock frame]
gvshn = vshn[0]  ; => Use RH08 [SC frame]
;gushn = (REFORM(a_ushn[gshock[kk]]))[0]
gcomp = (REFORM(a_compr[gshock[kk]]))[0]

; => Determine normal distance to ramp
get_data,'WIND_MAG_HTR(GSE,nT)',DATA=htr_bmag
htr_t  = htr_bmag.X
nhtr_t = htr_t - tura[0]   ; => normalize to zero
ndist  = gvshn[0]*nhtr_t   ; => km [SC frame]
;ndist  = gushn[0]*nhtr_t   ; => km
IF (FINITE(ni_up[0])) THEN einert = c/(wpefac[0]*SQRT(ni_up[0])) ELSE einert = f
IF (FINITE(ni_up[0])) THEN iinert = c/(wppfac[0]*SQRT(ni_up[0])) ELSE iinert = f
einert *= 1d-3  ; => Convert to km
iinert *= 1d-3  ; => Convert to km
store_data,'normal_distance',DATA={X:htr_t,Y:ndist}
options,'normal_distance','YTITLE','Dist. [Normal, km]'
store_data,'normal_distance_c-wpe',DATA={X:htr_t,Y:ndist/einert}
options,'normal_distance_c-wpe','YTITLE','Dist. [Normal, c/'+'!7x!3'+'!Dpe!N'+']'
store_data,'normal_distance_c-wpi',DATA={X:htr_t,Y:ndist/iinert}
options,'normal_distance_c-wpi','YTITLE','Dist. [Normal, c/'+'!7x!3'+'!Dpi!N'+']'

tplot_options, var_label=['normal_distance','normal_distance_c-wpe','normal_distance_c-wpi']
nnw = tnames()
options,nnw,'YSTYLE',1
options,nnw,'PANEL_SIZE',2.
options,nnw,'XMINOR',5
options,nnw,'XTICKLEN',0.04

;-----------------------------------------------------------------------------------------
; => Get TDS Times
;-----------------------------------------------------------------------------------------
dumbt  = '1970-01-01/00:00:00.000'

test   = tdss_sort_relevant(DATE=date,FIXFILE=1)
scets  = test.SCETS       ; => e.g. '2000-10-03/00:01:11.598'
ntds   = N_ELEMENTS(scets)
tdsst  = test.TIMES*1d-3  ; => convert to seconds
tdssen = test.EVENT_N     ; => Event #
tsunix = time_double(scets)  ; => Unix start time of TDSS samples
tdsevl = DBLARR(ntds)
FOR j=0L, ntds - 1L DO tdsevl[j] = MAX(tdsst[j,*],/NAN) - MIN(tdsst[j,*],/NAN)
teunix = tsunix + tdsevl
scete  = time_string(teunix,PREC=3)

; => Get TDSS SCETs
; => Lower Hybrid Only
scets_lhw  = ['1998-08-26/06:40:54.9410','1998-08-26/06:41:10.0010',$
              '1998-09-24/23:43:18.9510','1998-09-24/23:48:39.0200',$
              '1998-09-24/23:48:51.6220','1998-09-25/00:04:04.5450',$
              '1998-09-25/00:14:50.6030']
; => Lower Hybrid Whistler Mix
scets_mix  = ['1997-12-10/04:33:15.6050','1998-08-26/06:40:26.1200',$
              '1998-09-24/23:20:38.8420','1998-09-24/23:22:26.6320',$
              '1998-09-24/23:22:48.1500','1998-09-24/23:30:48.5420',$
              '1998-09-24/23:45:52.1840','1998-09-24/23:45:53.3790',$
              '1998-09-24/23:48:42.1310','1998-09-25/00:05:23.4320',$
              '2000-02-11/23:33:56.4910','2000-02-11/23:33:58.3510',$
              '2000-02-11/23:34:00.7310']
; => Whistler Only
scets_whi  = ['1998-08-26/06:41:37.6230','1998-08-26/06:41:44.0130',$
              '1998-08-26/06:41:53.2490','1998-08-26/06:41:56.3150',$
              '1998-08-26/06:41:57.9090','1998-08-26/06:41:59.2330',$
              '1998-08-26/06:42:05.7630','1998-08-26/06:42:09.1310',$
              '2000-02-11/23:34:27.5030','2000-02-11/23:34:29.0650',$
              '2000-02-12/00:14:21.7090','2000-02-12/00:26:17.2170',$
              '2000-02-12/00:27:19.1420']

good_lhw   = array_where(scets,STRMID(scets_lhw[*],0L,23L),/N_UNIQ)
good_mix   = array_where(scets,STRMID(scets_mix[*],0L,23L),/N_UNIQ)
good_whi   = array_where(scets,STRMID(scets_whi[*],0L,23L),/N_UNIQ)
PRINT,';  ',good_lhw[0],good_mix[0],good_whi[0],'  => For '+tdate[0]
;            -1           5          -1  => For 1997-12-10
;             5           4           7  => For 1998-08-26
;            12           6          -1  => For 1998-09-24
;            -1           0           4  => For 2000-02-11
IF (good_lhw[0] GE 0) THEN gscets_lhw = scets[good_lhw[*,0]] ELSE gscets_lhw = dumbt[0]
IF (good_lhw[0] GE 0) THEN gscete_lhw = scete[good_lhw[*,0]] ELSE gscete_lhw = dumbt[0]
IF (good_mix[0] GE 0) THEN gscets_mix = scets[good_mix[*,0]] ELSE gscets_mix = dumbt[0]
IF (good_mix[0] GE 0) THEN gscete_mix = scete[good_mix[*,0]] ELSE gscete_mix = dumbt[0]
IF (good_whi[0] GE 0) THEN gscets_whi = scets[good_whi[*,0]] ELSE gscets_whi = dumbt[0]
IF (good_whi[0] GE 0) THEN gscete_whi = scete[good_whi[*,0]] ELSE gscete_whi = dumbt[0]

; => get event numbers
PRINT, tdssen[good_lhw[*,0]],FORMAT='(I8.8)'
PRINT, tdssen[good_mix[*,0]],FORMAT='(I8.8)'
PRINT, tdssen[good_whi[*,0]],FORMAT='(I8.8)'

;evns_lhw   = [00010618L,00010684L,02014864L,02015635L,02015691L,02017428L,$
;              02018091L]
;evns_mix   = [03408599L,00010488L,02011249L,02011723L,02011820L,02013165L,$
;              02015299L,02015304L,02015650L,02017555L,23145465L,23145474L,$
;              23145484L]
;evns_whi   = [00010807L,00010832L,00010868L,00010881L,00010888L,00010895L,$
;              00010923L,00010937L,23145603L,23145610L,23153276L,23154909L,$
;              23155087L]

; => Define start Unix times
unix0_lhws = time_double(gscets_lhw)
unix0_mixs = time_double(gscets_mix)
unix0_whis = time_double(gscets_whi)
; => Sort times
spu        = SORT(unix0_lhws)
unix_lhws  = unix0_lhws[spu]
spu        = SORT(unix0_mixs)
unix_mixs  = unix0_mixs[spu]
spu        = SORT(unix0_whis)
unix_whis  = unix0_whis[spu]
; => Define end Unix times
unix0_lhwe = time_double(gscete_lhw)
unix0_mixe = time_double(gscete_mix)
unix0_whie = time_double(gscete_whi)
; => Sort times
spu        = SORT(unix0_lhwe)
unix_lhwe  = unix0_lhwe[spu]
spu        = SORT(unix0_mixe)
unix_mixe  = unix0_mixe[spu]
spu        = SORT(unix0_whie)
unix_whie  = unix0_whie[spu]

; => Plot +/-6 sec region around ramp with start/end TDSS Locations on HTR MFI data
nn0        = ['WIND_MAG_HTR(GSE,nT)','WIND_B3_HTR(GSE,nT)']
tr_o       = tura[0] + [-1d0,1d0]*6d0
fntime     = file_name_times(tr_o,FORMFN=2,PREC=3)
fnscet     = fntime.F_TIME   ; => e.g. 2000-10-03_0001-11x598
sfname     = fnscet[0]+'_'+fnscet[1]
suffx      = '_Ramp-Green_TDSS-Start-Red_End-Blue_RH08_SC-Frame'
prefx      = 'HTR-MFI_Ramp-Labeled_'
unix_s     = [unix0_lhws,unix0_mixs,unix0_whis]
unix_e     = [unix0_lhwe,unix0_mixe,unix0_whie]
sp         = SORT(unix_s)
unix_s     = unix_s[sp]
ep         = SORT(unix_e)
unix_e     = unix_e[ep]

  tplot,nn0,TRANGE=tr_o
  time_bar,tura[0],VARNAME=nn0,COLOR=150L     ; => Middle of ramp            = Green
  time_bar,unix_s ,VARNAME=nn0,COLOR=250L     ; => Start of TDSS sample      = Red
  time_bar,unix_e ,VARNAME=nn0,COLOR= 50L     ; => End   of TDSS sample      = Blue
fname   = prefx[0]+sfname[0]+suffx[0]
popen,fname[0],/LAND
  tplot,nn0,TRANGE=tr_o
  time_bar,tura[0],VARNAME=nn0,COLOR=150L     ; => Middle of ramp            = Green
  time_bar,unix_s ,VARNAME=nn0,COLOR=250L     ; => Start of TDSS sample      = Red
  time_bar,unix_e ,VARNAME=nn0,COLOR= 50L     ; => End   of TDSS sample      = Blue
pclose


; => Plot TDSS Locations on HTR MFI data
nn0     = ['WIND_MAG_HTR(GSE,nT)','WIND_B3_HTR(GSE,nT)']
IF (sdate[0] EQ '121097') THEN tr_o = midra[0] - [2d0*5d0,-2d0*5d0]
IF (sdate[0] EQ '082698') THEN tr_o = midra[0] - [2d0*6d1,-2d0*6d1]
IF (sdate[0] EQ '092498') THEN tr_o = tr3
IF (sdate[0] EQ '021100') THEN tr_o = tr3

t_o     = time_string(tr_o,PREC=3)

stime   = STRMID(t_o[*],0,10)+'_'+STRMID(t_o[*],11,2)+STRMID(t_o[*],14,2)+$
          'x'+STRMID(t_o[*],17,2)
sfname  = stime[0]+'_'+stime[1]
  tplot,nn0,TRANGE=tr_o
  time_bar,midra,VARNAME=nn0,COLOR=250L     ; => Middle of ramp            = Red
  time_bar,unix_lhws,VARNAME=nn0,COLOR= 50L  ; => Lower Hybrid Only         = Blue
  time_bar,unix_mixs,VARNAME=nn0,COLOR=150L  ; => Lower Hybrid Whistler Mix = Green
  time_bar,unix_whis,VARNAME=nn0,COLOR=210L  ; => Whistler Only             = Orange

suffx   = '_TDSS-Labeled_LH-Blue_Mix-Green_Whistler-Orange_RH08_SC-Frame'
prefx   = 'HTR-MFI_Ramp-Labeled_'

fname   = prefx[0]+sfname[0]+suffx[0]
popen,fname[0],/LAND
  tplot,nn0,TRANGE=tr_o
  time_bar,midra,VARNAME=nn0,COLOR=250L     ; => Middle of ramp            = Red
  time_bar,unix_lhws,VARNAME=nn0,COLOR= 50L  ; => Lower Hybrid Only         = Blue
  time_bar,unix_mixs,VARNAME=nn0,COLOR=150L  ; => Lower Hybrid Whistler Mix = Green
  time_bar,unix_whis,VARNAME=nn0,COLOR=210L  ; => Whistler Only             = Orange
pclose

; => 2nd Time Range
IF (sdate[0] EQ '092498') THEN tr_o = midra[0] - [2d0*6d1,-2d0*6d1]
IF (sdate[0] EQ '021100') THEN tr_o = midra[0] - [2d0*2d1,-2d0*2d1]

t_o     = time_string(tr_o,PREC=3)

stime   = STRMID(t_o[*],0,10)+'_'+STRMID(t_o[*],11,2)+STRMID(t_o[*],14,2)+$
          'x'+STRMID(t_o[*],17,2)
sfname  = stime[0]+'_'+stime[1]
  tplot,nn0,TRANGE=tr_o
  time_bar,midra,VARNAME=nn0,COLOR=250L     ; => Middle of ramp            = Red
  time_bar,unix_lhws,VARNAME=nn0,COLOR= 50L  ; => Lower Hybrid Only         = Blue
  time_bar,unix_mixs,VARNAME=nn0,COLOR=150L  ; => Lower Hybrid Whistler Mix = Green
  time_bar,unix_whis,VARNAME=nn0,COLOR=210L  ; => Whistler Only             = Orange

fname   = prefx[0]+sfname[0]+suffx[0]
popen,fname[0],/LAND
  tplot,nn0,TRANGE=tr_o
  time_bar,midra,VARNAME=nn0,COLOR=250L     ; => Middle of ramp            = Red
  time_bar,unix_lhws,VARNAME=nn0,COLOR= 50L  ; => Lower Hybrid Only         = Blue
  time_bar,unix_mixs,VARNAME=nn0,COLOR=150L  ; => Lower Hybrid Whistler Mix = Green
  time_bar,unix_whis,VARNAME=nn0,COLOR=210L  ; => Whistler Only             = Orange
pclose

; => 3rd Time Range
IF (sdate[0] EQ '092498') THEN tr_o = midra[0] - [2d0*6d1,-2d0*6d2]

t_o     = time_string(tr_o,PREC=3)

stime   = STRMID(t_o[*],0,10)+'_'+STRMID(t_o[*],11,2)+STRMID(t_o[*],14,2)+$
          'x'+STRMID(t_o[*],17,2)
sfname  = stime[0]+'_'+stime[1]
  tplot,nn0,TRANGE=tr_o
  time_bar,midra,VARNAME=nn0,COLOR=250L     ; => Middle of ramp            = Red
  time_bar,unix_lhws,VARNAME=nn0,COLOR= 50L  ; => Lower Hybrid Only         = Blue
  time_bar,unix_mixs,VARNAME=nn0,COLOR=150L  ; => Lower Hybrid Whistler Mix = Green
  time_bar,unix_whis,VARNAME=nn0,COLOR=210L  ; => Whistler Only             = Orange

fname   = prefx[0]+sfname[0]+suffx[0]
popen,fname[0],/LAND
  tplot,nn0,TRANGE=tr_o
  time_bar,midra,VARNAME=nn0,COLOR=250L     ; => Middle of ramp            = Red
  time_bar,unix_lhws,VARNAME=nn0,COLOR= 50L  ; => Lower Hybrid Only         = Blue
  time_bar,unix_mixs,VARNAME=nn0,COLOR=150L  ; => Lower Hybrid Whistler Mix = Green
  time_bar,unix_whis,VARNAME=nn0,COLOR=210L  ; => Whistler Only             = Orange
pclose

; => 4th Time Range
IF (sdate[0] EQ '092498') THEN tr_o = time_double(['1998-09-24/23:59:49.000','1998-09-25/00:20:28.000'])

t_o     = time_string(tr_o,PREC=3)

stime   = STRMID(t_o[*],0,10)+'_'+STRMID(t_o[*],11,2)+STRMID(t_o[*],14,2)+$
          'x'+STRMID(t_o[*],17,2)
sfname  = stime[0]+'_'+stime[1]
  tplot,nn0,TRANGE=tr_o
  time_bar,midra,VARNAME=nn0,COLOR=250L     ; => Middle of ramp            = Red
  time_bar,unix_lhws,VARNAME=nn0,COLOR= 50L  ; => Lower Hybrid Only         = Blue
  time_bar,unix_mixs,VARNAME=nn0,COLOR=150L  ; => Lower Hybrid Whistler Mix = Green
  time_bar,unix_whis,VARNAME=nn0,COLOR=210L  ; => Whistler Only             = Orange

fname   = prefx[0]+sfname[0]+suffx[0]
popen,fname[0],/LAND
  tplot,nn0,TRANGE=tr_o
  time_bar,midra,VARNAME=nn0,COLOR=250L     ; => Middle of ramp            = Red
  time_bar,unix_lhws,VARNAME=nn0,COLOR= 50L  ; => Lower Hybrid Only         = Blue
  time_bar,unix_mixs,VARNAME=nn0,COLOR=150L  ; => Lower Hybrid Whistler Mix = Green
  time_bar,unix_whis,VARNAME=nn0,COLOR=210L  ; => Whistler Only             = Orange
pclose

