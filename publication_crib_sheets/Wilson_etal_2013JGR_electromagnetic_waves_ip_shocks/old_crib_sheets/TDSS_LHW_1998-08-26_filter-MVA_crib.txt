;-----------------------------------------------------------------------------------------
; => Constants and dummy variables
;-----------------------------------------------------------------------------------------
f      = !VALUES.F_NAN
d      = !VALUES.D_NAN
kB     = 1.380658d-23      ; -Boltzmann Constant (J/K)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
K_eV   = 1.160474d4        ; -Conversion = degree Kelvin/eV
epo    = 8.854187817d-12   ; -Permittivity of free space (F/m)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
me     = 9.1093897d-31     ; -Electron mass (kg)
mp     = 1.6726231d-27     ; -Proton mass (kg)
qq     = 1.60217733d-19    ; -Fundamental charge (C)
c      = 2.99792458d8      ; -Speed of light in vacuum (m/s)
c2     = (c*1d-3)^2        ; -" " squared (km/s)^2
me_ev  = 0.5109906d6       ; -Electron mass in eV/c^2
me_3dp = me_ev/c2          ; -Electron mass [eV/(km/s)^2]
mp_ev  = 938.27231d6       ; -Proton mass in eV/c^2
mp_3dp = mp_ev/c2          ; -Proton mass [eV/(km/s)^2]
beta_fac = 1d6*(kB*K_eV)*(2d0*muo)
;-----------------------------------------------------------------------------------------
; => Check date 
;-----------------------------------------------------------------------------------------
date   = '082698'
t      = ['1998-08-26/05:40:00','1998-08-26/07:40:00']  ; -For moment writing
tramp  = '1998-08-26/06:40:24.972'

tr3   = time_double(t)
tura  = time_double(tramp)

mydate = my_str_date(DATE=date)
sdate  = mydate.S_DATE[0]  ; -('MMDDYY')
ldate  = mydate.DATE[0]    ; -('YYYYMMDD')
tdate  = mydate.TDATE[0]   ; => 'YYYY-MM-DD'
;-----------------------------------------------------------------------------------------
; => Load MFI data
;-----------------------------------------------------------------------------------------
htr_mfi2tplot,DATE=date
get_data,'WIND_B3_HTR(GSE,nT)',DATA=temporary_mfi
magf_htr = temporary_mfi
str_element,magf_htr,'R',REPLICATE(1L,N_ELEMENTS(magf_htr.X)),/ADD_REPLACE
;-----------------------------------------------------------------------------------------
; => Find shock info
;-----------------------------------------------------------------------------------------
gnorm      = [-0.655,0.040,-0.754]   ; => Using RH08 from JCK's site
dgnorm     = [0.010,0.009,0.561]

gnorm2     = [-0.822,0.138,-0.553]   ; => Using RH09 from JCK's site
dgnorm2    = [0.040,0.070,0.488]
;-----------------------------------------------------------------------------------------
; => Get TDS data
;-----------------------------------------------------------------------------------------
; => Get TDSS data
my_tdss    = get_wind_tds_data(DATE=date,FIXFILE=1,/TDSS)
x          = LINDGEN(N_ELEMENTS(my_tdss.SCET))
IF (sdate[0] EQ '082698') THEN gels = [x[14L:37L],x[41L:60L]]
; => Get ONLY whistler TDSS
IF (gels[0] NE -1) THEN scetss  = my_tdss.SCET[gels[*]]             ELSE scetss  = ''
IF (gels[0] NE -1) THEN fieldss = REFORM(my_tdss.EFIELD[gels[*],*]) ELSE fieldss = dumbf
IF (gels[0] NE -1) THEN timess  = REFORM(my_tdss.TIME[gels[*],*])   ELSE timess  = dumbd
IF (gels[0] NE -1) THEN evnums  = my_tdss.EVENT_N[gels[*]]          ELSE evnums  = -1
IF (gels[0] NE -1) THEN atypes  = my_tdss.A_TYPE[gels[*]]           ELSE atypes  = ''
IF (gels[0] NE -1) THEN sangss  = my_tdss.S_ANG[gels[*]]            ELSE sangss  = 0.
IF (gels[0] NE -1) THEN eangss  = my_tdss.E_ANG[gels[*]]            ELSE eangss  = 0.

ascets     = scetss
; => STRMID(scet,0,2)+STRMID(scet,3,2)+'-'+STRMID(scet,6,2)+'x'+STRMID(scet,9,3)
ascets2    = string_replace_char(string_replace_char(ascets,'/','-'),' ','_')
ascets2    = STRMID(ascets2[*],0L,23L)  ; => Remove the _UT
fdates     = STRMID(ascets2[*],0L,11L)
fscets     = STRMID(ascets2[*],11L)
fscets     = STRMID(fscets[*],0,2)+STRMID(fscets[*],3,2)+'-'+$
             STRMID(fscets[*],6,2)+'x'+STRMID(fscets[*],9,3)
fn_scets   = fdates[*]+fscets[*]

afields    = fieldss
atimes     = timess
aevnum     = evnums
aatype     = atypes
asangs     = sangss
aeangs     = eangss
; => Eliminate bad elements
bad        = WHERE(ascets EQ '',bd,COMPLEMENT=good,NCOMPLEMENT=gd)
IF (gd GT 0) THEN ascets  = ascets[good]
IF (gd GT 0) THEN afields = afields[good,*]
IF (gd GT 0) THEN atimes  = atimes[good,*]
IF (gd GT 0) THEN aevnum  = aevnum[good]
IF (gd GT 0) THEN aatype  = aatype[good]
IF (gd GT 0) THEN asangs  = asangs[good]
IF (gd GT 0) THEN aeangs  = aeangs[good]
; => sort elements
mts        = my_time_string(ascets,STR=1,FORM=1,PREC=3,/NOMSSG)
ascets     = mts.DATE_TIME
aunix      = mts.UNIX
sp         = SORT(aunix)
ascets     = ascets[sp]
aunix      = aunix[sp]
afields    = afields[sp,*]
atimes     = atimes[sp,*]
aevnum     = aevnum[sp]
aatype     = aatype[sp]
asangs     = asangs[sp]
aeangs     = aeangs[sp]
;-----------------------------------------------------------------------------------------
; => define fields
;-----------------------------------------------------------------------------------------
nsams   = N_ELEMENTS(REFORM(my_tdss.TIME[0,*]))
efxyz   = DBLARR(N_ELEMENTS(UNIQ(ascets,SORT(ascets))),nsams,3L)  ; => Dummy array of E-fields (mV/m)
bfxyz   = DBLARR(N_ELEMENTS(UNIQ(ascets,SORT(ascets))),nsams,3L)  ; => Dummy array of B-fields (nT)
unqel   = UNIQ(aevnum,SORT(aevnum))
n_uq    = N_ELEMENTS(unqel) - 1L
tempevn = aevnum[unqel]
n_avgs  = N_ELEMENTS(aevnum)/N_ELEMENTS(unqel) - 1L

jj      = 0L
FOR j=0L, n_uq DO BEGIN                                                    $
  t_evn   = tempevn[j]                                                   & $
  ggd     = WHERE(t_evn[0] EQ aevnum)                                    & $
  t_types = STRMID(aatype[ggd],0L,2L)                                    & $
  t_field = afields[ggd,*]                                               & $
  FOR k=0L, n_avgs DO BEGIN                                                $
    t_type = STRMID(t_types[k],0L,2L)                                    & $
    IF (t_type EQ 'EX') THEN efxyz[j,*,0] = t_field[k,*]                 & $
    IF (t_type EQ 'EY') THEN efxyz[j,*,1] = t_field[k,*]                 & $
    IF (t_type EQ 'EZ') THEN efxyz[j,*,2] = t_field[k,*]                 & $
    IF (t_type EQ 'BX') THEN bfxyz[j,*,0] = t_field[k,*]                 & $
    IF (t_type EQ 'BY') THEN bfxyz[j,*,1] = t_field[k,*]                 & $
    IF (t_type EQ 'BZ') THEN bfxyz[j,*,2] = t_field[k,*]                 & $
  ENDFOR                                                                 & $
  jj += 1L

FOR j=0L, n_uq DO BEGIN                                                    $
  jstr  = 'T'+STRTRIM(j,2)                                               & $
  str_element,waves_ef,jstr,REFORM(efxyz[j,*,*]),/ADD_REPLACE            & $
  str_element,waves_bf,jstr,REFORM(bfxyz[j,*,*]),/ADD_REPLACE
;-----------------------------------------------------------------------------------------
; => find unique elements of fields
;-----------------------------------------------------------------------------------------
unqel   = UNIQ(ascets,SORT(ascets))
nscets  = REFORM(ascets[unqel])
nunix   = REFORM(aunix[unqel])
nsangs  = REFORM(asangs[unqel])
neangs  = REFORM(aeangs[unqel])
nevnm   = REFORM(aevnum[unqel])
natype  = aatype[unqel]
fn_scet = fn_scets[unqel]
ntimes  = REFORM(atimes[unqel,*],N_ELEMENTS(unqel),nsams)
n_uq    = N_ELEMENTS(unqel) - 1L
;-----------------------------------------------------------------------------------------
; => interpolate angles
;-----------------------------------------------------------------------------------------
nangsi = DBLARR(nsams,n_uq+1L)
FOR k=0L, n_uq DO BEGIN                                              $
  kstr  = 'T'+STRTRIM(k,2)                                         & $
  tt0         = REFORM(ntimes[k,*])*1d-3 + nunix[k]                & $
  tts0        = [MIN(tt0,/NAN),MAX(tt0,/NAN)]                      & $
  temp0       = interp([nsangs[k],neangs[k]],tts0,tt0,/NO_EXTRAP)  & $
  str_element,tds_unx,kstr,tt0,/ADD_REPLACE                        & $
  nangsi[*,k] = temp0

san_str    = STRTRIM(STRING(FORMAT='(f15.1)',nsangs),2)
ean_str    = STRTRIM(STRING(FORMAT='(f15.1)',neangs),2)
ang_str    = san_str[*]+'!Uo!N'+'-'+ean_str[*]+'!Uo!N'
fang_str   = '+E!Dx!N Angle to Sun:  '+ang_str[*]
;-----------------------------------------------------------------------------------------
; => filter fields
;-----------------------------------------------------------------------------------------
lfc1  = [4d0,7d0,1d1,4d1,6d1,6d1,6d1,15d1]   ; => For 1998-08-26/06:40:26.120 UT
hfc1  = [2d1,3d1,3d1,4d2,5d2,2d2,15d1,20d1]  ; => For 1998-08-26/06:40:26.120 UT
lfc2  = [3d0]                                ; => For 1998-08-26/06:40:54.941 UT
hfc2  = [3d1]                                ; => For 1998-08-26/06:40:54.941 UT
lfc3  = [3d0]                                ; => For 1998-08-26/06:41:10.001 UT
hfc3  = [3d1]                                ; => For 1998-08-26/06:41:10.001 UT
lfc4  = [3d1]                                ; => For 1998-08-26/06:41:37.623 UT
hfc4  = [13d1]                               ; => For 1998-08-26/06:41:37.623 UT
lfc5  = [3d1]                                ; => For 1998-08-26/06:41:44.013 UT
hfc5  = [13d1]                               ; => For 1998-08-26/06:41:44.013 UT
lfc6  = [3.5d1]                              ; => For 1998-08-26/06:41:53.249 UT
hfc6  = [15d1]                               ; => For 1998-08-26/06:41:53.249 UT
lfc7  = [3d1]                                ; => For 1998-08-26/06:41:56.315 UT
hfc7  = [15d1]                               ; => For 1998-08-26/06:41:56.315 UT
lfc8  = [3d1]                                ; => For 1998-08-26/06:41:57.909 UT
hfc8  = [15d1]                               ; => For 1998-08-26/06:41:57.909 UT
lfc9  = [3d1]                                ; => For 1998-08-26/06:41:59.233 UT
hfc9  = [15d1]                               ; => For 1998-08-26/06:41:59.233 UT
lfc10 = [4d1]                                ; => For 1998-08-26/06:42:05.763 UT
hfc10 = [20d1]                               ; => For 1998-08-26/06:42:05.763 UT
lfc11 = [5d1]                                ; => For 1998-08-26/06:42:09.131 UT
hfc11 = [20d1]                               ; => For 1998-08-26/06:42:09.131 UT

tags  = ['t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11']

lf_str = CREATE_STRUCT(tags,lfc1,lfc2,lfc3,lfc4,lfc5,lfc6,lfc7,lfc8,lfc9,lfc10,lfc11)
hf_str = CREATE_STRUCT(tags,hfc1,hfc2,hfc3,hfc4,hfc5,hfc6,hfc7,hfc8,hfc9,hfc10,hfc11)

DELVAR,filter_sf0,filter_ef0,filter_bf0,filter_sf,filter_ef,filter_bf
jj     = 0L
FOR j=0L, n_uq DO BEGIN                                                             $
  evln  = (MAX(ntimes[j,*],/NAN) - MIN(ntimes[j,*],/NAN))*1d-3                    & $
  tsam  = (nsams - 1L)/evln                                                       & $
  jstr  = 'T'+STRTRIM(j,2)                                                        & $
  lfc0  = lf_str.(j)                                                              & $
  hfc0  = hf_str.(j)                                                              & $
  n_fr  = N_ELEMENTS(lfc0) - 1L                                                   & $
  t_ef  = REFORM(waves_ef.(j))                                                    & $
  t_bf  = REFORM(waves_bf.(j))                                                    & $
  FOR k=0L, n_fr DO BEGIN                                                           $
    kstr  = 'T'+STRTRIM(k,2)                                                      & $
    flow  = lfc0[k]                                                               & $
    fhigh = hfc0[k]                                                               & $
    filte = vector_bandpass(t_ef,tsam[0],flow[0],fhigh[0],/MIDF)                  & $
    filtb = vector_bandpass(t_bf,tsam[0],flow[0],fhigh[0],/MIDF)                  & $
    str_element,filter_ef0,kstr,filte,/ADD_REPLACE                                & $
    str_element,filter_bf0,kstr,filtb,/ADD_REPLACE                                & $
    vec_ef = REFORM(filte)*1d-3                                                   & $
    vec_bf = REFORM(filtb)*1d-9                                                   & $
    poy_sf = my_crossp_2(vec_ef,vec_bf,/NOM)/muo*1d6                              & $
    str_element,filter_sf0,kstr,poy_sf,/ADD_REPLACE                               & $
  ENDFOR                                                                          & $
  str_element,filter_sf,jstr,filter_sf0,/ADD_REPLACE                              & $
  str_element,filter_ef,jstr,filter_ef0,/ADD_REPLACE                              & $
  str_element,filter_bf,jstr,filter_bf0,/ADD_REPLACE                              & $
  FOR k=0L, n_fr DO BEGIN                                                           $
    kstr  = 'T'+STRTRIM(k,2)                                                      & $
    str_element,filter_ef0,kstr,/DELETE                                           & $
    str_element,filter_bf0,kstr,/DELETE                                           & $
    str_element,filter_sf0,kstr,/DELETE                                           & $
  ENDFOR                                                                          & $
ENDFOR                                                                            & $
jj += 1L

DELVAR,filter_sf0,filter_ef0,filter_bf0,vec_ef,vec_bf,filte,filtb,poy_sf,t_ef,b_ef

; => [erg cm^(-2) s^(-1) = 10^(-3) W m^(-2)]
; => [milliergs cm^(-2) s^(-1) = 10^(-6) W m^(-2)]
;-----------------------------------------------------------------------------------------
; => rotate fields into GSE and FAC Coordinates [use Shock Norm. Vec. as second vector]
;-----------------------------------------------------------------------------------------
unx_t0     = ntimes*1d-3 + (nunix # REPLICATE(1d0,2048L))
t_mag0     = tds_bfield(unx_t0,nsangs,neangs,B3SMAG=magf_3s,HTRMAG=magf_htr,DATE=date,/NOCURR)
b3s_gse    = t_mag0.G3MAG                ; => [# of TDSF, # of points, 3L]
htr_gse    = t_mag0.GHTR
; => Change the following line when HTR MFI is available...
;mag_gse    = b3s_gse
mag_gse    = htr_gse
mag_waves  = t_mag0.ROT_HTR
sun_dir    = gnorm

jj     = 0L
FOR j=0L, n_uq DO BEGIN                                                     $
  jstr    = 'T'+STRTRIM(j,2)                                              & $
  unx0    = REFORM(unx_t0[j,*])                                           & $
  g_magf  = REFORM(mag_gse[j,*,*])                                        & $
  angles  = REFORM(nangsi[*,j])                                           & $
  filter_ef0 = filter_ef.(j)                                              & $
  filter_bf0 = filter_bf.(j)                                              & $
  filter_sf0 = filter_sf.(j)                                              & $
  n_fr       = N_ELEMENTS(lf_str.(j)) - 1L                                & $
  FOR k=0L, n_fr DO BEGIN                                                   $
    kstr    = 'T'+STRTRIM(k,2)                                            & $
    vec_ef  = REFORM(filter_ef0.(k))*1d0                                  & $
    vec_bf  = REFORM(filter_bf0.(k))*1d0                                  & $
    vec_sf  = REFORM(filter_sf0.(k))*1d0                                  & $
    rot_efg = DBLARR(nsams,3L)                                            & $
    rot_bfg = DBLARR(nsams,3L)                                            & $
    rot_sfg = DBLARR(nsams,3L)                                            & $
    rot_ef  = DBLARR(nsams,3L)                                            & $
    rot_bf  = DBLARR(nsams,3L)                                            & $
    rot_sf  = DBLARR(nsams,3L)                                            & $
    FOR i=0L, nsams - 1L DO BEGIN                                           $
      rotm0 = TRANSPOSE(eulermat(0d0,angles[i],180d0,/DEG))               & $
      t_eef = REFORM(rotm0 ## REFORM(vec_ef[i,*]))                        & $
      t_ebf = REFORM(rotm0 ## REFORM(vec_bf[i,*]))                        & $
      t_esf = REFORM(rotm0 ## REFORM(vec_sf[i,*]))                        & $
      rot_efg[i,*] = t_eef                                                & $
      rot_bfg[i,*] = t_ebf                                                & $
      rot_sfg[i,*] = t_esf                                                & $
      magf  = REFORM(g_magf[i,*])                                         & $
      rotm0 = rot_mat(magf,sun_dir)                                       & $
      t_eef = REFORM(rotm0 ## REFORM(vec_ef[i,*]))                        & $
      t_ebf = REFORM(rotm0 ## REFORM(vec_bf[i,*]))                        & $
      t_esf = REFORM(rotm0 ## REFORM(vec_sf[i,*]))                        & $
      rot_ef[i,*] = t_eef                                                 & $
      rot_bf[i,*] = t_ebf                                                 & $
      rot_sf[i,*] = t_esf                                                 & $
    ENDFOR                                                                & $
    str_element,rotated_gse_ef0,kstr,rot_efg,/ADD_REPLACE                 & $
    str_element,rotated_gse_bf0,kstr,rot_bfg,/ADD_REPLACE                 & $
    str_element,rotated_gse_sf0,kstr,rot_sfg,/ADD_REPLACE                 & $
    str_element,rotated_fac_ef0,kstr,rot_ef,/ADD_REPLACE                  & $
    str_element,rotated_fac_bf0,kstr,rot_bf,/ADD_REPLACE                  & $
    str_element,rotated_fac_sf0,kstr,rot_sf,/ADD_REPLACE                  & $
  ENDFOR                                                                  & $
  str_element,rotated_gse_ef,jstr,rotated_gse_ef0,/ADD_REPLACE            & $
  str_element,rotated_gse_bf,jstr,rotated_gse_bf0,/ADD_REPLACE            & $
  str_element,rotated_gse_sf,jstr,rotated_gse_sf0,/ADD_REPLACE            & $
  str_element,rotated_fac_ef,jstr,rotated_fac_ef0,/ADD_REPLACE            & $
  str_element,rotated_fac_bf,jstr,rotated_fac_bf0,/ADD_REPLACE            & $
  str_element,rotated_fac_sf,jstr,rotated_fac_sf0,/ADD_REPLACE            & $
  FOR k=0L, n_fr DO BEGIN                                                   $
    kstr    = 'T'+STRTRIM(k,2)                                            & $
    str_element,rotated_gse_ef0,kstr,/DELETE                              & $
    str_element,rotated_gse_bf0,kstr,/DELETE                              & $
    str_element,rotated_gse_sf0,kstr,/DELETE                              & $
    str_element,rotated_fac_ef0,kstr,/DELETE                              & $
    str_element,rotated_fac_bf0,kstr,/DELETE                              & $
    str_element,rotated_fac_sf0,kstr,/DELETE                              & $
  ENDFOR                                                                  & $
ENDFOR                                                                            & $
jj += 1L

;      rotm0 = eulermat(0d0,angles[i],180d0,/DEG)                          & $
DELVAR,filter_sf0,filter_ef0,filter_bf0
DELVAR,rotated_gse_ef0,rotated_gse_bf0,rotated_gse_sf0,rot_efg,rot_bfg,rot_sfg
DELVAR,rot_ef,rot_bf,rot_sf,vec_ef,vec_bf,vec_sf,t_eef,t_ebf,t_esf

; => *_gse_*  =  fields rotated into GSE Coordinates
; => *_fac_*  =  fields rotated into FACs
;-----------------------------------------------------------------------------------------
; => Plot waveforms in GSE Coordinates
;-----------------------------------------------------------------------------------------
wi,1
!P.MULTI = [0,1,3]

yttlsws   = ['S!Dx!N (!7l!3'+'W/m!U2!N'+')','S!Dy!N (!7l!3'+'W/m!U2!N'+')',$
             'S!Dz!N (!7l!3'+'W/m!U2!N'+')']
yttlbws   = ['B!Dx!N (nT)','B!Dy!N (nT)','B!Dz!N (nT)']
yttlews   = ['E!Dx!N (mV/m)','E!Dy!N (mV/m)','E!Dz!N (mV/m)']

xtntm     = ['0','200','400','600','800','1000']
xtvtm     = [0e0,2e2,4e2,6e2,8e2,1e3]
xtstm     = N_ELEMENTS(xtvtm) - 1L
xtt1      = 'Time (ms)'
exstr_s   = {XSTYLE:1,YSTYLE:1,NODATA:1,XTICKNAME:xtntm,XTICKV:xtvtm,$
             XTICKS:xtstm,XTITLE:xtt1,XMINOR:10,XTICKLEN:0.04}

ffw_prefx = 'FIXED_WAVES-Coords_filtered_'
colors    = [250,150,50]
!P.CHARSIZE = 1.5
!P.MULTI    = [0,1,3]



; => Plot Filtered fields 
jj = 0
FOR i=0L, n_uq DO BEGIN                                                         $
  lfc0       = lf_str.(i)                                                     & $
  hfc0       = hf_str.(i)                                                     & $
  fwl_str    = STRTRIM(STRING(FORMAT='(f15.1)',lfc0),2)                       & $
  fwh_str    = STRTRIM(STRING(FORMAT='(f15.1)',hfc0),2)                       & $
  fil_str    = fwl_str[*]+'-'+fwh_str[*]+'Hz_'                                & $
  fil_st2    = STRARR(N_ELEMENTS(fil_str))                                    & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                          & $
  FOR j=0L, n_fr DO fil_st2[j] = STRMID(fil_str[j],0L,STRLEN(fil_str[j])-1L)  & $
  FOR k=0L, n_fr DO BEGIN                                                       $
    ms_times = REFORM(ntimes[i,*])                                        & $
    sw_field = filter_sf.(i).(k)                                          & $
    ew_field = filter_ef.(i).(k)                                          & $
    bw_field = filter_bf.(i).(k)                                          & $
    yra_sw   = [-1e0*MAX(ABS(sw_field),/NAN),MAX(ABS(sw_field),/NAN)]     & $
    yra_bw   = [-1e0*MAX(ABS(bw_field),/NAN),MAX(ABS(bw_field),/NAN)]     & $
    yra_ew   = [-1e0*MAX(ABS(ew_field),/NAN),MAX(ABS(ew_field),/NAN)]     & $
    fname0   = ffw_prefx[0]+fil_str[k]+fn_scet[i]+'_Sxyz'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Poynting Flux [WAVES-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,sw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlsws[j],YRANGE=yra_sw,TITLE=ttle  & $
          OPLOT,ms_times,sw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffw_prefx[0]+fil_str[k]+fn_scet[i]+'_Bxyz'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Magnetic Field [WAVES-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,bw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlbws[j],YRANGE=yra_bw,TITLE=ttle  & $
          OPLOT,ms_times,bw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffw_prefx[0]+fil_str[k]+fn_scet[i]+'_Exyz'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Electric Field [WAVES-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,ew_field[*,j],_EXTRA=exstr_s,YTITLE=yttlews[j],YRANGE=yra_ew,TITLE=ttle  & $
          OPLOT,ms_times,ew_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
  ENDFOR                                                                  & $
  jj += 1L


ffr_prefx = 'FIXED_rotated_filtered_'
; => Plot rotated and filtered fields 
FOR i=0L, n_uq DO BEGIN                                                         $
  lfc0       = lf_str.(i)                                                     & $
  hfc0       = hf_str.(i)                                                     & $
  fwl_str    = STRTRIM(STRING(FORMAT='(f15.1)',lfc0),2)                       & $
  fwh_str    = STRTRIM(STRING(FORMAT='(f15.1)',hfc0),2)                       & $
  fil_str    = fwl_str[*]+'-'+fwh_str[*]+'Hz_'                                & $
  fil_st2    = STRARR(N_ELEMENTS(fil_str))                                    & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                          & $
  FOR j=0L, n_fr DO fil_st2[j] = STRMID(fil_str[j],0L,STRLEN(fil_str[j])-1L)  & $
  FOR k=0L, n_fr DO BEGIN                                                   $
    ms_times = REFORM(ntimes[i,*])                                        & $
    sw_field = rotated_gse_sf.(i).(k)                                     & $
    ew_field = rotated_gse_ef.(i).(k)                                     & $
    bw_field = rotated_gse_bf.(i).(k)                                     & $
    yra_sw   = [-1e0*MAX(ABS(sw_field),/NAN),MAX(ABS(sw_field),/NAN)]     & $
    yra_bw   = [-1e0*MAX(ABS(bw_field),/NAN),MAX(ABS(bw_field),/NAN)]     & $
    yra_ew   = [-1e0*MAX(ABS(ew_field),/NAN),MAX(ABS(ew_field),/NAN)]     & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_S-GSE'                & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Poynting Flux [GSE-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,sw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlsws[j],YRANGE=yra_sw,TITLE=ttle  & $
          OPLOT,ms_times,sw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_B-GSE'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Magnetic Field [GSE-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,bw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlbws[j],YRANGE=yra_bw,TITLE=ttle  & $
          OPLOT,ms_times,bw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_E-GSE'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Electric Field [GSE-Coords] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,ew_field[*,j],_EXTRA=exstr_s,YTITLE=yttlews[j],YRANGE=yra_ew,TITLE=ttle  & $
          OPLOT,ms_times,ew_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
  ENDFOR                                                                  & $
  jj += 1L


yttlsrs   = ['S!D!9x!3'+',1!N (!7l!3'+'W/m!U2!N'+')',$
             'S!D!9x!3'+',2!N (!7l!3'+'W/m!U2!N'+')',$
             'S!D!9#!3'+'!N (!7l!3'+'W/m!U2!N'+')']
yttlbrs   = ['B!D!9x!3'+',1!N (nT)','B!D!9x!3'+',2!N (nT)',$
             'B!D!9#!3'+'!N (nT)']
yttlers   = ['E!D!9x!3'+',1!N (mV/m)','E!D!9x!3'+',2!N (mV/m)',$
             'E!D!9#!3'+'!N (mV/m)']
ffr_prefx = 'FIXED_rotated_filtered_'
FOR i=0L, n_uq DO BEGIN                                                         $
  lfc0       = lf_str.(i)                                                     & $
  hfc0       = hf_str.(i)                                                     & $
  fwl_str    = STRTRIM(STRING(FORMAT='(f15.1)',lfc0),2)                       & $
  fwh_str    = STRTRIM(STRING(FORMAT='(f15.1)',hfc0),2)                       & $
  fil_str    = fwl_str[*]+'-'+fwh_str[*]+'Hz_'                                & $
  fil_st2    = STRARR(N_ELEMENTS(fil_str))                                    & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                          & $
  FOR j=0L, n_fr DO fil_st2[j] = STRMID(fil_str[j],0L,STRLEN(fil_str[j])-1L)  & $
  FOR k=0L, n_fr DO BEGIN                                                   $
    ms_times = REFORM(ntimes[i,*])                                        & $
    sw_field = rotated_fac_sf.(i).(k)                                     & $
    ew_field = rotated_fac_ef.(i).(k)                                     & $
    bw_field = rotated_fac_bf.(i).(k)                                     & $
    yra_sw   = [-1e0*MAX(ABS(sw_field),/NAN),MAX(ABS(sw_field),/NAN)]     & $
    yra_bw   = [-1e0*MAX(ABS(bw_field),/NAN),MAX(ABS(bw_field),/NAN)]     & $
    yra_ew   = [-1e0*MAX(ABS(ew_field),/NAN),MAX(ABS(ew_field),/NAN)]     & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_S-FACs'                & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Poynting Flux [FACs] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,sw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlsrs[j],YRANGE=yra_sw,TITLE=ttle  & $
          OPLOT,ms_times,sw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_B-FACs'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Magnetic Field [FACs] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,bw_field[*,j],_EXTRA=exstr_s,YTITLE=yttlbrs[j],YRANGE=yra_bw,TITLE=ttle  & $
          OPLOT,ms_times,bw_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
    fname0   = ffr_prefx[0]+fil_str[k]+fn_scet[i]+'_E-FACs'                 & $
    popen,fname0,/LAND                                                    & $
      FOR j=0L, 2L DO BEGIN                                                 $
        IF (j EQ 0) THEN ttle = 'Electric Field [FACs] at: '+nscets[i] & $
        IF (j EQ 1) THEN ttle = 'Filtered: '+fil_st2[k]+', '+fang_str[i]  & $
        IF (j EQ 2) THEN ttle = ''                                        & $
        PLOT,ms_times,ew_field[*,j],_EXTRA=exstr_s,YTITLE=yttlers[j],YRANGE=yra_ew,TITLE=ttle  & $
          OPLOT,ms_times,ew_field[*,j],COLOR=colors[j]                    & $
      ENDFOR                                                              & $
    pclose                                                                & $
  ENDFOR                                                                  & $
  jj += 1L

!P.MULTI = 0
;---------------------------------------------------------------------------------------------------
;      Date        Time                Ni          Ti            Vx              Vy             Vz
;===================================================================================================
;    1998/08/26 06:40:26.120 UT      14.147      48.250       -555.071         -2.777        -69.159
;    1998/08/26 06:40:54.941 UT      22.911     100.266       -627.834         -1.037       -147.112
;    1998/08/26 06:41:10.001 UT      21.810      75.230       -611.358          8.253       -167.555
;    1998/08/26 06:41:37.623 UT      20.740      97.926       -624.523         28.156       -172.991
;    1998/08/26 06:41:44.013 UT      19.820      94.920       -622.222         26.771       -171.121
;    1998/08/26 06:41:53.249 UT      18.489      90.192       -617.180         35.365       -172.132
;    1998/08/26 06:41:56.315 UT      18.048      90.428       -618.909         38.376       -172.310
;    1998/08/26 06:41:57.909 UT      17.818      92.303       -620.820         39.779       -171.913
;    1998/08/26 06:41:59.233 UT      17.628      90.878       -617.455         45.240       -175.425
;    1998/08/26 06:42:05.763 UT      16.687      89.882       -622.537         58.923       -179.050
;    1998/08/26 06:42:09.131 UT      16.734      89.497       -626.764         45.472       -179.093
;---------------------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
; => Perform MVA
;-----------------------------------------------------------------------------------------
dumbmag = magf_htr
jj      = 0L
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

spref = 'bvec'
ssuff = '   = ['
mfor0 = '(a11,f8.5,",",f8.5,",",f8.5,"]")'
mfor1 = '(a12,f8.5,",",f8.5,",",f8.5,"]")'
FOR j=0L, N_TAGS(tr_str) - 1L DO BEGIN                                $
  jstr   = STRTRIM(j,2L)                                            & $
  IF (j LT 10L) THEN mform = mfor0 ELSE mform = mfor1               & $
  strg   = spref[0]+jstr[0]+ssuff[0]                                & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  PRINT,FORMAT=mform,strg[0],avbvec

spref = 'bmag'
ssuff = '   = ['
mfor0 = '(a11,f8.5,"]")'
mfor1 = '(a12,f8.5,"]")'
FOR j=0L, N_TAGS(tr_str) - 1L DO BEGIN                                $
  jstr   = STRTRIM(j,2L)                                            & $
  IF (j LT 10L) THEN mform = mfor0 ELSE mform = mfor1               & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  strg   = spref[0]+jstr[0]+ssuff[0]                                & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  PRINT,FORMAT=mform,strg[0],avgbm

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}
dummy1  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(1)}
dummy2  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(2)}
dummy3  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(3)}
dummy4  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(4)}
dummy5  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(5)}
dummy6  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(6)}
dummy7  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(7)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;       4.0       7.0      10.0      40.0      60.0      60.0      60.0     150.0
print, hfc0, format='(";",8f10.1)'
;      20.0      30.0      30.0     400.0     500.0     200.0     150.0     200.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0640x26

vector_mv_plot,DATE=date,MYMAG=dummy1,FCUTOFF=[lfc0[1],hfc0[1]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0640x26

vector_mv_plot,DATE=date,MYMAG=dummy2,FCUTOFF=[lfc0[2],hfc0[2]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0640x26

vector_mv_plot,DATE=date,MYMAG=dummy3,FCUTOFF=[lfc0[3],hfc0[3]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0640x26

vector_mv_plot,DATE=date,MYMAG=dummy4,FCUTOFF=[lfc0[4],hfc0[4]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0640x26

vector_mv_plot,DATE=date,MYMAG=dummy5,FCUTOFF=[lfc0[5],hfc0[5]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0640x26

vector_mv_plot,DATE=date,MYMAG=dummy6,FCUTOFF=[lfc0[6],hfc0[6]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0640x26

vector_mv_plot,DATE=date,MYMAG=dummy7,FCUTOFF=[lfc0[7],hfc0[7]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0640x26

;-----------------------------------------------------------------------------------------
; => For  4 Hz < f < 20 Hz  at  1998-08-26/06:40:26.120 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 244-763
;Plot Range: 06:40:26.2501-06:40:26.5269
;The angle between DC-Field and the k-vector is :
;       54.348 +/- 0.383 degrees
;The eigenvalues ratios are:
;       45.233531       1.2735423
;The Minimum Variance eigenvector is:
;<-0.75528, 0.55880,-0.34249> +/- <-0.02406,-0.04140,-0.01449>
;

struct0 = stats_082698_0640x26
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:40:26.2501',prefd[0]+'06:40:26.5269'])
kvec0   = [-0.75528, 0.55880,-0.34249]
dkvec0  = ABS([-0.02406,-0.04140,-0.01449])
elam0   = [45.233531,1.2735423]

bvec0   = [-0.09312, 0.98823, 0.11685]
bmag0   = [17.64474]


tags    = ['t0']
tr_str  = CREATE_STRUCT(tags,tr0)
kv_str  = CREATE_STRUCT(tags,kvec0)
dkv_str = CREATE_STRUCT(tags,dkvec0)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  4 Hz < f < 20 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.2501-06:40:26.5269     -0.755      0.559     -0.342     -0.093      0.988      0.117     17.645

vswu   = [-555.071,-2.777,-69.159]         ; => My 3DP estimates (km/s) For 1998-08-26/06:40:26.120 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  4 Hz < f < 20 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.2501-06:40:26.5269     54.371    125.629     39.168    140.832     37.904    142.096     27.458    152.542

theta_kb0826_04_20   = DBLARR(nn)
theta_kn0826_04_20   = DBLARR(nn)
theta_kn20826_04_20  = DBLARR(nn)
theta_kv0826_04_20   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_04_20[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_04_20[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_04_20[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_04_20[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_04_20[j]),  $
                     REFORM(theta_kn0826_04_20[j]),$
                     REFORM(theta_kv0826_04_20[j]),$
                     REFORM(theta_kn20826_04_20[j])
;
; => For  4 Hz < f < 20 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.2501-06:40:26.5269     54.371     39.168     37.904     27.458

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_04_20
PRINT,FORMAT=tkbf,theta_kn0826_04_20
PRINT,FORMAT=tkbf,theta_kv0826_04_20
PRINT,FORMAT=tkbf,theta_kn20826_04_20


theta_kb0826_04_20  = [54.37]
theta_kn0826_04_20  = [39.17]
theta_kv0826_04_20  = [37.90]
theta_kn20826_04_20 = [27.46]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For  7 Hz < f < 30 Hz  at  1998-08-26/06:40:26.120 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 0-2047
;Plot Range: 06:40:26.1200-06:40:27.2117
;The angle between DC-Field and the k-vector is :
;       86.183 +/- 0.491 degrees
;The eigenvalues ratios are:
;       8.5446916       1.3614047
;The Minimum Variance eigenvector is:
;< 0.92111,-0.03668, 0.38756> +/- <-0.02545,-0.05844, 0.05497>
;
;Plot Index Range: 0-1275
;Plot Range: 06:40:26.1200-06:40:26.8000
;The angle between DC-Field and the k-vector is :
;       83.707 +/- 0.577 degrees
;The eigenvalues ratios are:
;       9.6380508       1.5542066
;The Minimum Variance eigenvector is:
;< 0.90096,-0.06303, 0.42931> +/- <-0.03076,-0.05770, 0.05608>
;
;Plot Index Range: 282-1143
;Plot Range: 06:40:26.2704-06:40:26.7296
;The angle between DC-Field and the k-vector is :
;       81.115 +/- 0.635 degrees
;The eigenvalues ratios are:
;       11.369266       1.5493357
;The Minimum Variance eigenvector is:
;< 0.88528,-0.11080, 0.45167> +/- <-0.03504,-0.05796, 0.05446>
;
;Plot Index Range: 285-946
;Plot Range: 06:40:26.2720-06:40:26.6245
;The angle between DC-Field and the k-vector is :
;       69.111 +/- 0.659 degrees
;The eigenvalues ratios are:
;       13.394446       1.5012153
;The Minimum Variance eigenvector is:
;< 0.88917,-0.30740, 0.33895> +/- <-0.03915,-0.05047, 0.05694>
;
;Plot Index Range: 287-858
;Plot Range: 06:40:26.2731-06:40:26.5776
;The angle between DC-Field and the k-vector is :
;       60.820 +/- 0.447 degrees
;The eigenvalues ratios are:
;       30.811204       1.2267413
;The Minimum Variance eigenvector is:
;<-0.81224, 0.45489,-0.36516> +/- < 0.00620,-0.03021,-0.05143>
;
;Plot Index Range: 289-759
;Plot Range: 06:40:26.2741-06:40:26.5248
;The angle between DC-Field and the k-vector is :
;       54.047 +/- 0.300 degrees
;The eigenvalues ratios are:
;       79.826478       1.1297338
;The Minimum Variance eigenvector is:
;<-0.74506, 0.56526,-0.35408> +/- <-0.02192,-0.03239,-0.00559>
;
;Plot Index Range: 910-1256
;Plot Range: 06:40:26.6053-06:40:26.7899
;The angle between DC-Field and the k-vector is :
;       89.264 +/- 0.657 degrees
;The eigenvalues ratios are:
;       24.020896       1.5808126
;The Minimum Variance eigenvector is:
;< 0.89282, 0.03908, 0.44872> +/- <-0.02448,-0.04473, 0.05260>
;
;Plot Index Range: 572-1246
;Plot Range: 06:40:26.4251-06:40:26.7845
;The angle between DC-Field and the k-vector is :
;       84.105 +/- 0.720 degrees
;The eigenvalues ratios are:
;       11.332868       1.6004137
;The Minimum Variance eigenvector is:
;< 0.90320,-0.05326, 0.42590> +/- <-0.03234,-0.06077, 0.06097>
;
;Plot Index Range: 1257-1443
;Plot Range: 06:40:26.7904-06:40:26.8896
;The angle between DC-Field and the k-vector is :
;       69.290 +/- 0.733 degrees
;The eigenvalues ratios are:
;       34.964636       2.1990164
;The Minimum Variance eigenvector is:
;<-0.92841,-0.36634, 0.06200> +/- <-0.01898, 0.03965,-0.04999>
;
;Plot Index Range: 1510-1774
;Plot Range: 06:40:26.9253-06:40:27.0661
;The angle between DC-Field and the k-vector is :
;       76.264 +/- 0.663 degrees
;The eigenvalues ratios are:
;       30.394394       4.6116373
;The Minimum Variance eigenvector is:
;< 0.95386, 0.21550, 0.20907> +/- <-0.01783, 0.04634, 0.03359>
;

struct0 = stats_082698_0640x26
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:40:26.2704',prefd[0]+'06:40:26.7296'])
tr1     = time_double([prefd[0]+'06:40:26.2720',prefd[0]+'06:40:26.6245'])
tr2     = time_double([prefd[0]+'06:40:26.2731',prefd[0]+'06:40:26.5776'])
tr3     = time_double([prefd[0]+'06:40:26.2741',prefd[0]+'06:40:26.5248'])
tr4     = time_double([prefd[0]+'06:40:26.6053',prefd[0]+'06:40:26.7899'])
tr5     = time_double([prefd[0]+'06:40:26.4251',prefd[0]+'06:40:26.7845'])
tr6     = time_double([prefd[0]+'06:40:26.7904',prefd[0]+'06:40:26.8896'])
tr7     = time_double([prefd[0]+'06:40:26.9253',prefd[0]+'06:40:27.0661'])

kvec0   = [ 0.88528,-0.11080, 0.45167]
kvec1   = [ 0.88917,-0.30740, 0.33895]
kvec2   = [-0.81224, 0.45489,-0.36516]
kvec3   = [-0.74506, 0.56526,-0.35408]
kvec4   = [ 0.89282, 0.03908, 0.44872]
kvec5   = [ 0.90320,-0.05326, 0.42590]
kvec6   = [-0.92841,-0.36634, 0.06200]
kvec7   = [ 0.95386, 0.21550, 0.20907]

dkvec0  = ABS([-0.03504,-0.05796, 0.05446])
dkvec1  = ABS([-0.03915,-0.05047, 0.05694])
dkvec2  = ABS([ 0.00620,-0.03021,-0.05143])
dkvec3  = ABS([-0.02192,-0.03239,-0.00559])
dkvec4  = ABS([-0.02448,-0.04473, 0.05260])
dkvec5  = ABS([-0.03234,-0.06077, 0.06097])
dkvec6  = ABS([-0.01898, 0.03965,-0.04999])
dkvec7  = ABS([-0.01783, 0.04634, 0.03359])

elam0   = [11.369266,1.5493357]
elam1   = [13.394446,1.5012153]
elam2   = [30.811204,1.2267413]
elam3   = [79.826478,1.1297338]
elam4   = [24.020896,1.5808126]
elam5   = [11.332868,1.6004137]
elam6   = [34.964636,2.1990164]
elam7   = [30.394394,4.6116373]

bvec0   = [-0.07556, 0.98903, 0.05111]
bvec1   = [-0.09954, 0.98837, 0.10659]
bvec2   = [-0.09956, 0.98753, 0.11718]
bvec3   = [-0.09312, 0.98823, 0.11646]
bvec4   = [ 0.00914, 0.98721,-0.13268]
bvec5   = [-0.05223, 0.98609,-0.00412]
bvec6   = [-0.01856, 0.99266,-0.11068]
bvec7   = [ 0.02999, 0.99886,-0.03120]

bmag0   = [18.70196]
bmag1   = [18.33008]
bmag2   = [18.07262]
bmag3   = [17.71259]
bmag4   = [19.78089]
bmag5   = [19.48486]
bmag6   = [18.30282]
bmag7   = [19.01694]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,$
                             dkvec7)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  7 Hz < f < 30 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.2704-06:40:26.7296      0.885     -0.111      0.452     -0.076      0.989      0.051     18.702
;   06:40:26.2720-06:40:26.6245      0.889     -0.307      0.339     -0.100      0.988      0.107     18.330
;   06:40:26.2731-06:40:26.5776     -0.812      0.455     -0.365     -0.100      0.988      0.117     18.073
;   06:40:26.2741-06:40:26.5248     -0.745      0.565     -0.354     -0.093      0.988      0.116     17.713
;   06:40:26.6053-06:40:26.7899      0.893      0.039      0.449      0.009      0.987     -0.133     19.781
;   06:40:26.4251-06:40:26.7845      0.903     -0.053      0.426     -0.052      0.986     -0.004     19.485
;   06:40:26.7904-06:40:26.8896     -0.928     -0.366      0.062     -0.019      0.993     -0.111     18.303
;   06:40:26.9253-06:40:27.0661      0.954      0.215      0.209      0.030      0.999     -0.031     19.017

vswu   = [-555.071,-2.777,-69.159]         ; => My 3DP estimates (km/s) For 1998-08-26/06:40:26.120 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  7 Hz < f < 30 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.2704-06:40:26.7296     98.824     81.176    157.646     22.354    159.030     20.970    173.103      6.897
;   06:40:26.2720-06:40:26.6245    110.867     69.133    148.241     31.759    157.327     22.673    163.896     16.104
;   06:40:26.2731-06:40:26.5776     60.837    119.163     34.356    145.644     31.909    148.091     21.193    158.807
;   06:40:26.2741-06:40:26.5248     54.073    125.927     38.959    141.041     38.711    141.289     27.594    152.406
;   06:40:26.6053-06:40:26.7899     90.733     89.267    157.157     22.843    160.327     19.673    167.593     12.407
;   06:40:26.4251-06:40:26.7845     95.822     84.178    156.185     23.815    161.559     18.441    170.165      9.835
;   06:40:26.7904-06:40:26.8896    110.688     69.312     56.859    123.141     23.733    156.267     47.288    132.712
;   06:40:26.9253-06:40:27.0661     76.271    103.729    140.696     39.304    166.767     13.233    150.453     29.547

theta_kb0826_07_30   = DBLARR(nn)
theta_kn0826_07_30   = DBLARR(nn)
theta_kn20826_07_30  = DBLARR(nn)
theta_kv0826_07_30   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_07_30[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_07_30[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_07_30[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_07_30[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_07_30[j]),  $
                     REFORM(theta_kn0826_07_30[j]),$
                     REFORM(theta_kv0826_07_30[j]),$
                     REFORM(theta_kn20826_07_30[j])
;
; => For  7 Hz < f < 30 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.2704-06:40:26.7296     81.176     22.354     20.970      6.897
;   06:40:26.2720-06:40:26.6245     69.133     31.759     22.673     16.104
;   06:40:26.2731-06:40:26.5776     60.837     34.356     31.909     21.193
;   06:40:26.2741-06:40:26.5248     54.073     38.959     38.711     27.594
;   06:40:26.6053-06:40:26.7899     89.267     22.843     19.673     12.407
;   06:40:26.4251-06:40:26.7845     84.178     23.815     18.441      9.835
;   06:40:26.7904-06:40:26.8896     69.312     56.859     23.733     47.288
;   06:40:26.9253-06:40:27.0661     76.271     39.304     13.233     29.547

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_07_30
PRINT,FORMAT=tkbf,theta_kn0826_07_30
PRINT,FORMAT=tkbf,theta_kv0826_07_30
PRINT,FORMAT=tkbf,theta_kn20826_07_30


theta_kb0826_07_30  = [81.18,69.13,60.84,54.07,89.27,84.18,69.31,76.27]
theta_kn0826_07_30  = [22.35,31.76,34.36,38.96,22.84,23.81,56.86,39.30]
theta_kv0826_07_30  = [20.97,22.67,31.91,38.71,19.67,18.44,23.73,13.23]
theta_kn20826_07_30 = [ 6.90,16.10,21.19,27.59,12.41, 9.84,47.29,29.55]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For 10 Hz < f < 30 Hz  at  1998-08-26/06:40:26.120 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 188-1283
;Plot Range: 06:40:26.2203-06:40:26.8043
;The angle between DC-Field and the k-vector is :
;       81.160 +/- 0.688 degrees
;The eigenvalues ratios are:
;       8.2219946       1.3487306
;The Minimum Variance eigenvector is:
;< 0.97522,-0.09894, 0.19790> +/- <-0.02044,-0.07634, 0.06255>
;
;Plot Index Range: 0-2047
;Plot Range: 06:40:26.1200-06:40:27.2117
;The angle between DC-Field and the k-vector is :
;       80.831 +/- 0.522 degrees
;The eigenvalues ratios are:
;       7.7621804       1.2437270
;The Minimum Variance eigenvector is:
;< 0.96776,-0.12404, 0.21923> +/- <-0.02196,-0.06344, 0.06107>
;
;Plot Index Range: 255-765
;Plot Range: 06:40:26.2560-06:40:26.5280
;The angle between DC-Field and the k-vector is :
;       75.400 +/- 0.950 degrees
;The eigenvalues ratios are:
;       9.0289722       1.0585799
;The Minimum Variance eigenvector is:
;<-0.95890, 0.18946,-0.21123> +/- < 0.01075,-0.06287,-0.10519>
;
;Plot Index Range: 382-762
;Plot Range: 06:40:26.3237-06:40:26.5264
;The angle between DC-Field and the k-vector is :
;       73.839 +/- 0.614 degrees
;The eigenvalues ratios are:
;       24.959507       1.1318334
;The Minimum Variance eigenvector is:
;< 0.97753,-0.19375, 0.08310> +/- <-0.00665,-0.00128, 0.07518>
;
;Plot Index Range: 477-712
;Plot Range: 06:40:26.3744-06:40:26.4997
;The eigenvalues ratios are:
;       79.445986       1.1979660
;The Minimum Variance eigenvector is:
;< 0.98265,-0.18422, 0.02172> +/- <-0.00782,-0.03884, 0.02431>
;
;Plot Index Range: 510-900
;Plot Range: 06:40:26.3920-06:40:26.6000
;The angle between DC-Field and the k-vector is :
;       77.319 +/- 0.427 degrees
;The eigenvalues ratios are:
;       48.277253       1.0837785
;The Minimum Variance eigenvector is:
;< 0.98946,-0.09520,-0.10915> +/- <-0.00500, 0.00884,-0.05302>
;
;Plot Index Range: 510-881
;Plot Range: 06:40:26.3920-06:40:26.5899
;The angle between DC-Field and the k-vector is :
;       76.589 +/- 0.454 degrees
;The eigenvalues ratios are:
;       45.040525       1.2288479
;The Minimum Variance eigenvector is:
;<-0.98757, 0.10656, 0.11557> +/- <-0.00677,-0.00366,-0.05443>
;
;Plot Index Range: 1023-2047
;Plot Range: 06:40:26.6656-06:40:27.2117
;The angle between DC-Field and the k-vector is :
;       76.952 +/- 0.421 degrees
;The eigenvalues ratios are:
;       20.044077       1.0676473
;The Minimum Variance eigenvector is:
;< 0.93488,-0.22788, 0.27217> +/- <-0.02194,-0.05694, 0.02767>
;
;Plot Index Range: 1023-1725
;Plot Range: 06:40:26.6656-06:40:27.0400
;The angle between DC-Field and the k-vector is :
;       76.254 +/- 0.444 degrees
;The eigenvalues ratios are:
;       25.678349       1.0526309
;The Minimum Variance eigenvector is:
;<-0.93604, 0.22445,-0.27100> +/- < 0.01134,-0.02418,-0.05919>
;
;Plot Index Range: 1023-1687
;Plot Range: 06:40:26.6656-06:40:27.0197
;The angle between DC-Field and the k-vector is :
;       75.994 +/- 0.424 degrees
;The eigenvalues ratios are:
;       29.448864       1.0521651
;The Minimum Variance eigenvector is:
;<-0.93492, 0.22550,-0.27399> +/- < 0.01123,-0.02178,-0.05623>
;

struct0 = stats_082698_0640x26
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:40:26.3237',prefd[0]+'06:40:26.5264'])
tr1     = time_double([prefd[0]+'06:40:26.3744',prefd[0]+'06:40:26.4997'])
tr2     = time_double([prefd[0]+'06:40:26.3920',prefd[0]+'06:40:26.6000'])
tr3     = time_double([prefd[0]+'06:40:26.3920',prefd[0]+'06:40:26.5899'])
tr4     = time_double([prefd[0]+'06:40:26.6656',prefd[0]+'06:40:27.2117'])
tr5     = time_double([prefd[0]+'06:40:26.6656',prefd[0]+'06:40:27.0400'])
tr6     = time_double([prefd[0]+'06:40:26.6656',prefd[0]+'06:40:27.0197'])

kvec0   = [ 0.97753,-0.19375, 0.08310]
kvec1   = [ 0.98265,-0.18422, 0.02172]
kvec2   = [ 0.98946,-0.09520,-0.10915]
kvec3   = [-0.98757, 0.10656, 0.11557]
kvec4   = [ 0.93488,-0.22788, 0.27217]
kvec5   = [-0.93604, 0.22445,-0.27100]
kvec6   = [-0.93492, 0.22550,-0.27399]

dkvec0  = ABS([-0.00665,-0.00128, 0.07518])
dkvec1  = ABS([-0.00782,-0.03884, 0.02431])
dkvec2  = ABS([-0.00500, 0.00884,-0.05302])
dkvec3  = ABS([-0.00677,-0.00366,-0.05443])
dkvec4  = ABS([-0.02194,-0.05694, 0.02767])
dkvec5  = ABS([ 0.01134,-0.02418,-0.05919])
dkvec6  = ABS([ 0.01123,-0.02178,-0.05623])

elam0   = [24.959507,1.1318334]
elam1   = [79.445986,1.1979660]
elam2   = [48.277253,1.0837785]
elam3   = [45.040525,1.2288479]
elam4   = [20.044077,1.0676473]
elam5   = [25.678349,1.0526309]
elam6   = [29.448864,1.0521651]

bvec0   = [-0.09959, 0.98680, 0.12427]
bvec1   = [-0.10322, 0.98548, 0.13300]
bvec2   = [-0.11300, 0.98505, 0.12696]
bvec3   = [-0.11326, 0.98465, 0.13068]
bvec4   = [ 0.02046, 0.99382,-0.06466]
bvec5   = [ 0.01502, 0.99164,-0.10498]
bvec6   = [ 0.01290, 0.99125,-0.10946]

bmag0   = [17.95993]
bmag1   = [18.05028]
bmag2   = [18.90074]
bmag3   = [18.84022]
bmag4   = [18.93319]
bmag5   = [19.00311]
bmag6   = [19.00202]

tags    = ['t0','t1','t2','t3','t4','t5','t6']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For 10 Hz < f < 30 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.3237-06:40:26.5264      0.978     -0.194      0.083     -0.100      0.987      0.124     17.960
;   06:40:26.3744-06:40:26.4997      0.983     -0.184      0.022     -0.103      0.985      0.133     18.050
;   06:40:26.3920-06:40:26.6000      0.989     -0.095     -0.109     -0.113      0.985      0.127     18.901
;   06:40:26.3920-06:40:26.5899     -0.988      0.107      0.116     -0.113      0.985      0.131     18.840
;   06:40:26.6656-06:40:27.2117      0.935     -0.228      0.272      0.020      0.994     -0.065     18.933
;   06:40:26.6656-06:40:27.0400     -0.936      0.224     -0.271      0.015      0.992     -0.105     19.003
;   06:40:26.6656-06:40:27.0197     -0.935      0.226     -0.274      0.013      0.991     -0.109     19.002

vswu   = [-555.071,-2.777,-69.159]         ; => My 3DP estimates (km/s) For 1998-08-26/06:40:26.120 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For 10 Hz < f < 30 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.3237-06:40:26.5264    106.154     73.846    135.291     44.709    168.330     11.670    151.190     28.810
;   06:40:26.3744-06:40:26.4997    106.265     73.735    131.865     48.135    167.653     12.347    147.690     32.310
;   06:40:26.3920-06:40:26.6000    102.676     77.324    124.723     55.277    165.441     14.559    140.006     39.994
;   06:40:26.3920-06:40:26.5899     76.593    103.407     55.668    124.332     15.168    164.832     40.308    139.692
;   06:40:26.6656-06:40:27.2117    103.000     77.000    145.759     34.241    163.784     16.216    161.884     18.116
;   06:40:26.6656-06:40:27.0400     76.292    103.708     34.267    145.733     16.005    163.995     18.147    161.853
;   06:40:26.6656-06:40:27.0197     76.027    103.973     34.108    145.892     16.159    163.841     17.985    162.015

theta_kb0826_10_30   = DBLARR(nn)
theta_kn0826_10_30   = DBLARR(nn)
theta_kn20826_10_30  = DBLARR(nn)
theta_kv0826_10_30   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_10_30[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_10_30[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_10_30[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_10_30[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_10_30[j]),  $
                     REFORM(theta_kn0826_10_30[j]),$
                     REFORM(theta_kv0826_10_30[j]),$
                     REFORM(theta_kn20826_10_30[j])
;
; => For 10 Hz < f < 30 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.3237-06:40:26.5264     73.846     44.709     11.670     28.810
;   06:40:26.3744-06:40:26.4997     73.735     48.135     12.347     32.310
;   06:40:26.3920-06:40:26.6000     77.324     55.277     14.559     39.994
;   06:40:26.3920-06:40:26.5899     76.593     55.668     15.168     40.308
;   06:40:26.6656-06:40:27.2117     77.000     34.241     16.216     18.116
;   06:40:26.6656-06:40:27.0400     76.292     34.267     16.005     18.147
;   06:40:26.6656-06:40:27.0197     76.027     34.108     16.159     17.985

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_10_30
PRINT,FORMAT=tkbf,theta_kn0826_10_30
PRINT,FORMAT=tkbf,theta_kv0826_10_30
PRINT,FORMAT=tkbf,theta_kn20826_10_30


theta_kb0826_10_30  = [73.85,73.73,77.32,76.59,77.00,76.29,76.03]
theta_kn0826_10_30  = [44.71,48.13,55.28,55.67,34.24,34.27,34.11]
theta_kv0826_10_30  = [11.67,12.35,14.56,15.17,16.22,16.00,16.16]
theta_kn20826_10_30 = [28.81,32.31,39.99,40.31,18.12,18.15,17.98]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For 40 Hz < f < 400 Hz  at  1998-08-26/06:40:26.120 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 0-2047
;Plot Range: 06:40:26.1200-06:40:27.2117
;The angle between DC-Field and the k-vector is :
;       71.425 +/- 1.171 degrees
;The eigenvalues ratios are:
;       2.8155642       1.0809374
;The Minimum Variance eigenvector is:
;<-0.92277,-0.35394,-0.15241> +/- < 0.04432,-0.04256,-0.16954>
;
;Plot Index Range: 769-958
;Plot Range: 06:40:26.5301-06:40:26.6309
;The angle between DC-Field and the k-vector is :
;       77.552 +/- 1.423 degrees
;The eigenvalues ratios are:
;       10.525796       1.7607588
;The Minimum Variance eigenvector is:
;<-0.94571,-0.32443, 0.01933> +/- <-0.04173, 0.12032,-0.02218>
;
;Plot Index Range: 769-946
;Plot Range: 06:40:26.5301-06:40:26.6245
;The angle between DC-Field and the k-vector is :
;       79.057 +/- 1.394 degrees
;The eigenvalues ratios are:
;       11.510828       1.7994062
;The Minimum Variance eigenvector is:
;<-0.95320,-0.30214, 0.01062> +/- <-0.03750, 0.11771,-0.01693>
;
;Plot Index Range: 813-946
;Plot Range: 06:40:26.5536-06:40:26.6245
;The angle between DC-Field and the k-vector is :
;       77.255 +/- 1.445 degrees
;The eigenvalues ratios are:
;       13.837183       1.8069773
;The Minimum Variance eigenvector is:
;<-0.94307,-0.33022, 0.03975> +/- <-0.04004, 0.11090,-0.02855>
;
;Plot Index Range: 815-937
;Plot Range: 06:40:26.5547-06:40:26.6197
;The angle between DC-Field and the k-vector is :
;       79.578 +/- 1.355 degrees
;The eigenvalues ratios are:
;       16.714567       1.7193179
;The Minimum Variance eigenvector is:
;<-0.95488,-0.29440, 0.03924> +/- <-0.03362, 0.10724,-0.01358>
;
;Plot Index Range: 1771-1841
;Plot Range: 06:40:27.0645-06:40:27.1019
;The angle between DC-Field and the k-vector is :
;       56.617 +/- 2.246 degrees
;The eigenvalues ratios are:
;       11.343086       1.5146043
;The Minimum Variance eigenvector is:
;< 0.22309,-0.97434,-0.02993> +/- <-0.15903,-0.03579,-0.02029>
;
;Plot Index Range: 1771-1839
;Plot Range: 06:40:27.0645-06:40:27.1008
;The angle between DC-Field and the k-vector is :
;       53.276 +/- 2.219 degrees
;The eigenvalues ratios are:
;       11.866381       1.5154065
;The Minimum Variance eigenvector is:
;< 0.22294,-0.97431,-0.03192> +/- <-0.15633,-0.03512,-0.02003>
;
;Plot Index Range: 1776-1839
;Plot Range: 06:40:27.0672-06:40:27.1008
;The angle between DC-Field and the k-vector is :
;       60.161 +/- 2.174 degrees
;The eigenvalues ratios are:
;       13.124817       1.5264839
;The Minimum Variance eigenvector is:
;< 0.22949,-0.97296,-0.02617> +/- <-0.15073,-0.03509,-0.01728>
;
;Plot Index Range: 1780-1818
;Plot Range: 06:40:27.0693-06:40:27.0896
;The angle between DC-Field and the k-vector is :
;       72.680 +/- 2.170 degrees
;The eigenvalues ratios are:
;       20.788348       1.3017435
;The Minimum Variance eigenvector is:
;<-0.20060, 0.97763, 0.06322> +/- <-0.12370,-0.02084,-0.07024>
;
;Plot Index Range: 1817-1836
;Plot Range: 06:40:27.0891-06:40:27.0992
;The angle between DC-Field and the k-vector is :
;       49.010 +/- 2.133 degrees
;The eigenvalues ratios are:
;       42.052182       2.4557908
;The Minimum Variance eigenvector is:
;< 0.36635,-0.92961, 0.04006> +/- <-0.09519,-0.03875,-0.02858>
;
;Plot Index Range: 1858-1873
;Plot Range: 06:40:27.1109-06:40:27.1189
;The angle between DC-Field and the k-vector is :
;       59.099 +/- 2.679 degrees
;The eigenvalues ratios are:
;       34.639794       2.6462136
;The Minimum Variance eigenvector is:
;< 0.59689,-0.79017, 0.13910> +/- <-0.09497,-0.07605,-0.02450>
;
; => For 40 Hz < f < 400 Hz  at  1998-08-26/06:40:26.120 UT

struct0 = stats_082698_0640x26
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:40:26.5301',prefd[0]+'06:40:26.6309'])
tr1     = time_double([prefd[0]+'06:40:26.5301',prefd[0]+'06:40:26.6245'])
tr2     = time_double([prefd[0]+'06:40:26.5536',prefd[0]+'06:40:26.6245'])
tr3     = time_double([prefd[0]+'06:40:26.5547',prefd[0]+'06:40:26.6197'])
tr4     = time_double([prefd[0]+'06:40:27.0645',prefd[0]+'06:40:27.1019'])
tr5     = time_double([prefd[0]+'06:40:27.0645',prefd[0]+'06:40:27.1008'])
tr6     = time_double([prefd[0]+'06:40:27.0672',prefd[0]+'06:40:27.1008'])
tr7     = time_double([prefd[0]+'06:40:27.0693',prefd[0]+'06:40:27.0896'])
tr8     = time_double([prefd[0]+'06:40:27.0891',prefd[0]+'06:40:27.0992'])
tr9     = time_double([prefd[0]+'06:40:27.1109',prefd[0]+'06:40:27.1189'])

kvec0   = [-0.94571,-0.32443, 0.01933]
kvec1   = [-0.95320,-0.30214, 0.01062]
kvec2   = [-0.94307,-0.33022, 0.03975]
kvec3   = [-0.95488,-0.29440, 0.03924]
kvec4   = [ 0.22309,-0.97434,-0.02993]
kvec5   = [ 0.22294,-0.97431,-0.03192]
kvec6   = [ 0.22949,-0.97296,-0.02617]
kvec7   = [-0.20060, 0.97763, 0.06322]
kvec8   = [ 0.36635,-0.92961, 0.04006]
kvec9   = [ 0.59689,-0.79017, 0.13910]

dkvec0  = ABS([-0.04173, 0.12032,-0.02218])
dkvec1  = ABS([-0.03750, 0.11771,-0.01693])
dkvec2  = ABS([-0.04004, 0.11090,-0.02855])
dkvec3  = ABS([-0.03362, 0.10724,-0.01358])
dkvec4  = ABS([-0.15903,-0.03579,-0.02029])
dkvec5  = ABS([-0.15633,-0.03512,-0.02003])
dkvec6  = ABS([-0.15073,-0.03509,-0.01728])
dkvec7  = ABS([-0.12370,-0.02084,-0.07024])
dkvec8  = ABS([-0.09519,-0.03875,-0.02858])
dkvec9  = ABS([-0.09497,-0.07605,-0.02450])

elam0   = [10.52580,1.760759]
elam1   = [11.51083,1.799406]
elam2   = [13.83718,1.806977]
elam3   = [16.71457,1.719318]
elam4   = [11.34309,1.514604]
elam5   = [11.86638,1.515406]
elam6   = [13.12482,1.526484]
elam7   = [20.78835,1.301744]
elam8   = [42.05218,2.455791]
elam9   = [34.63979,2.646214]

bvec0   = [-0.11065, 0.98948, 0.07512]
bvec1   = [-0.11394, 0.98892, 0.08174]
bvec2   = [-0.11069, 0.99045, 0.06727]
bvec3   = [-0.11325, 0.99007, 0.07160]
bvec4   = [ 0.03830, 0.99924,-0.00150]
bvec5   = [ 0.03849, 0.99923,-0.00180]
bvec6   = [ 0.03801, 0.99925,-0.00103]
bvec7   = [ 0.03964, 0.99920,-0.00365]
bvec8   = [ 0.03426, 0.99940, 0.00498]
bvec9   = [ 0.02693, 0.99950, 0.01675]

bmag0   = [19.95038]
bmag1   = [19.94608]
bmag2   = [20.05509]
bmag3   = [20.06384]
bmag4   = [18.88103]
bmag5   = [18.88249]
bmag6   = [18.87871]
bmag7   = [18.89113]
bmag8   = [18.84988]
bmag9   = [18.79719]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,$
                             kvec8,kvec9)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,$
                             dkvec7,dkvec8,dkvec9)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For 40 Hz < f < 400 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.5301-06:40:26.6309     -0.946     -0.324      0.019     -0.111      0.989      0.075     19.950
;   06:40:26.5301-06:40:26.6245     -0.953     -0.302      0.011     -0.114      0.989      0.082     19.946
;   06:40:26.5536-06:40:26.6245     -0.943     -0.330      0.040     -0.111      0.990      0.067     20.055
;   06:40:26.5547-06:40:26.6197     -0.955     -0.294      0.039     -0.113      0.990      0.072     20.064
;   06:40:27.0645-06:40:27.1019      0.223     -0.974     -0.030      0.038      0.999     -0.001     18.881
;   06:40:27.0645-06:40:27.1008      0.223     -0.974     -0.032      0.038      0.999     -0.002     18.882
;   06:40:27.0672-06:40:27.1008      0.229     -0.973     -0.026      0.038      0.999     -0.001     18.879
;   06:40:27.0693-06:40:27.0896     -0.201      0.978      0.063      0.040      0.999     -0.004     18.891
;   06:40:27.0891-06:40:27.0992      0.366     -0.930      0.040      0.034      0.999      0.005     18.850
;   06:40:27.1109-06:40:27.1189      0.597     -0.790      0.139      0.027      0.999      0.017     18.797

vswu   = [-555.071,-2.777,-69.159]         ; => My 3DP estimates (km/s) For 1998-08-26/06:40:26.120 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For 40 Hz < f < 400 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.5301-06:40:26.6309    102.411     77.589     53.709    126.291     20.337    159.663     43.787    136.213
;   06:40:26.5301-06:40:26.6245    100.913     79.087     52.825    127.175     18.904    161.096     42.611    137.389
;   06:40:26.5536-06:40:26.6245    102.709     77.291     54.933    125.067     21.165    158.835     44.956    135.044
;   06:40:26.5547-06:40:26.6197    100.400     79.600     54.262    125.738     19.239    160.761     43.732    136.268
;   06:40:27.0645-06:40:27.1019    164.798     15.202     99.354     80.646    102.289     77.711    107.535     72.465
;   06:40:27.0645-06:40:27.1008    164.780     15.220     99.261     80.739    102.266     77.734    107.461     72.539
;   06:40:27.0672-06:40:27.1008    164.469     15.531     99.759     80.241    102.689     77.311    107.965     72.035
;   06:40:27.0693-06:40:27.0896     14.381    165.619     82.945     97.055     79.258    100.742     74.642    105.358
;   06:40:27.0891-06:40:27.0992    156.391     23.609    107.900     72.100    111.338     68.662    116.845     63.155
;   06:40:27.1109-06:40:27.1189    140.477     39.523    121.833     58.167    127.270     52.730    132.579     47.421

theta_kb0826_40_400   = DBLARR(nn)
theta_kn0826_40_400   = DBLARR(nn)
theta_kn20826_40_400  = DBLARR(nn)
theta_kv0826_40_400   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_40_400[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_40_400[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_40_400[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_40_400[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_40_400[j]),  $
                     REFORM(theta_kn0826_40_400[j]),$
                     REFORM(theta_kv0826_40_400[j]),$
                     REFORM(theta_kn20826_40_400[j])
;
; => For 40 Hz < f < 400 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.5301-06:40:26.6309     77.589     53.709     20.337     43.787
;   06:40:26.5301-06:40:26.6245     79.087     52.825     18.904     42.611
;   06:40:26.5536-06:40:26.6245     77.291     54.933     21.165     44.956
;   06:40:26.5547-06:40:26.6197     79.600     54.262     19.239     43.732
;   06:40:27.0645-06:40:27.1019     15.202     80.646     77.711     72.465
;   06:40:27.0645-06:40:27.1008     15.220     80.739     77.734     72.539
;   06:40:27.0672-06:40:27.1008     15.531     80.241     77.311     72.035
;   06:40:27.0693-06:40:27.0896     14.381     82.945     79.258     74.642
;   06:40:27.0891-06:40:27.0992     23.609     72.100     68.662     63.155
;   06:40:27.1109-06:40:27.1189     39.523     58.167     52.730     47.421

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_40_400
PRINT,FORMAT=tkbf,theta_kn0826_40_400
PRINT,FORMAT=tkbf,theta_kv0826_40_400
PRINT,FORMAT=tkbf,theta_kn20826_40_400


theta_kb0826_40_400  = [77.59,79.09,77.29,79.60,15.20,15.22,15.53,14.38,23.61,39.52]
theta_kn0826_40_400  = [53.71,52.82,54.93,54.26,80.65,80.74,80.24,82.94,72.10,58.17]
theta_kv0826_40_400  = [20.34,18.90,21.16,19.24,77.71,77.73,77.31,79.26,68.66,52.73]
theta_kn20826_40_400 = [43.79,42.61,44.96,43.73,72.47,72.54,72.03,74.64,63.15,47.42]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For 60 Hz < f < 150 Hz  at  1998-08-26/06:40:26.120 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 777-1576
;Plot Range: 06:40:26.5344-06:40:26.9605
;The angle between DC-Field and the k-vector is :
;       84.559 +/- 1.876 degrees
;The eigenvalues ratios are:
;       2.8141455       1.1926812
;The Minimum Variance eigenvector is:
;< 0.99310, 0.11728, 0.00023> +/- < 0.02483,-0.21041, 0.06287>
;
;Plot Index Range: 957-1970
;Plot Range: 06:40:26.6304-06:40:27.1707
;The angle between DC-Field and the k-vector is :
;       88.185 +/- 3.098 degrees
;The eigenvalues ratios are:
;       1.7745361       1.3388846
;The Minimum Variance eigenvector is:
;< 0.99677, 0.02141, 0.07737> +/- < 0.00020,-0.28931, 0.07749>
;
;Plot Index Range: 994-1256
;Plot Range: 06:40:26.6501-06:40:26.7899
;The angle between DC-Field and the k-vector is :
;       82.048 +/- 4.873 degrees
;The eigenvalues ratios are:
;       2.0391897       2.0795377
;The Minimum Variance eigenvector is:
;< 0.86524,-0.08421, 0.49423> +/- <-0.14755,-0.19750, 0.22466>
;
;Plot Index Range: 957-1533
;Plot Range: 06:40:26.6304-06:40:26.9376
;The angle between DC-Field and the k-vector is :
;       82.832 +/- 2.296 degrees
;The eigenvalues ratios are:
;       2.7151797       1.2051025
;The Minimum Variance eigenvector is:
;< 0.99246, 0.12232, 0.00834> +/- < 0.02834,-0.23451, 0.06741>
;
;Plot Index Range: 1749-1847
;Plot Range: 06:40:27.0528-06:40:27.1051
;The angle between DC-Field and the k-vector is :
;       75.072 +/- 1.078 degrees
;The eigenvalues ratios are:
;       31.097998       1.2591099
;The Minimum Variance eigenvector is:
;< 0.23114,-0.97065,-0.06637> +/- < 0.03147, 0.01336,-0.08582>
;

struct0 = stats_082698_0640x26
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:40:27.0528',prefd[0]+'06:40:27.1051'])
kvec0   = [ 0.23114,-0.97065,-0.06637]
dkvec0  = ABS([ 0.03147, 0.01336,-0.08582])
elam0   = [31.09800,1.259110]
bvec0   = [ 0.03983, 0.99915,-0.00396]
bmag0   = [18.89349]

tags    = ['t0']
tr_str  = CREATE_STRUCT(tags,tr0)
kv_str  = CREATE_STRUCT(tags,kvec0)
dkv_str = CREATE_STRUCT(tags,dkvec0)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For 60 Hz < f < 150 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:27.0528-06:40:27.1051      0.231     -0.971     -0.066      0.040      0.999     -0.004     18.893

vswu   = [-555.071,-2.777,-69.159]         ; => My 3DP estimates (km/s) For 1998-08-26/06:40:26.120 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For 60 Hz < f < 150 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:27.0528-06:40:27.1051    163.812     16.188     98.058     81.942    102.494     77.506    106.693     73.307

theta_kb0826_60_150   = DBLARR(nn)
theta_kn0826_60_150   = DBLARR(nn)
theta_kn20826_60_150  = DBLARR(nn)
theta_kv0826_60_150   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_60_150[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_60_150[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_60_150[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_60_150[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_60_150[j]),  $
                     REFORM(theta_kn0826_60_150[j]),$
                     REFORM(theta_kv0826_60_150[j]),$
                     REFORM(theta_kn20826_60_150[j])
;
; => For 60 Hz < f < 150 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:27.0528-06:40:27.1051     16.188     81.942     77.506     73.307

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_60_150
PRINT,FORMAT=tkbf,theta_kn0826_60_150
PRINT,FORMAT=tkbf,theta_kv0826_60_150
PRINT,FORMAT=tkbf,theta_kn20826_60_150


theta_kb0826_60_150  = [16.19]
theta_kn0826_60_150  = [81.94]
theta_kv0826_60_150  = [77.51]
theta_kn20826_60_150 = [73.31]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For 60 Hz < f < 200 Hz  at  1998-08-26/06:40:26.120 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 865-958
;Plot Range: 06:40:26.5813-06:40:26.6309
;The angle between DC-Field and the k-vector is :
;       70.313 +/- 1.286 degrees
;The eigenvalues ratios are:
;       23.547182       1.1856979
;The Minimum Variance eigenvector is:
;<-0.96608,-0.05309, 0.25271> +/- <-0.01067,-0.09115,-0.05994>
;
;Plot Index Range: 865-937
;Plot Range: 06:40:26.5813-06:40:26.6197
;The angle between DC-Field and the k-vector is :
;       65.596 +/- 1.397 degrees
;The eigenvalues ratios are:
;       25.656457       1.4057131
;The Minimum Variance eigenvector is:
;<-0.97078,-0.01012, 0.23974> +/- <-0.01132,-0.09477,-0.04984>
;
;Plot Index Range: 1044-1115
;Plot Range: 06:40:26.6768-06:40:26.7147
;The angle between DC-Field and the k-vector is :
;       89.442 +/- 2.378 degrees
;The eigenvalues ratios are:
;       10.198478       2.7093540
;The Minimum Variance eigenvector is:
;<-0.65773, 0.44369,-0.60872> +/- <-0.10201, 0.01209, 0.11904>
;
;Plot Index Range: 1422-1509
;Plot Range: 06:40:26.8784-06:40:26.9248
;The angle between DC-Field and the k-vector is :
;       88.796 +/- 1.874 degrees
;The eigenvalues ratios are:
;       12.793261       1.3638889
;The Minimum Variance eigenvector is:
;<-0.73401,-0.65436,-0.18178> +/- < 0.10027,-0.09905,-0.04833>
;
;Plot Index Range: 1770-1845
;Plot Range: 06:40:27.0640-06:40:27.1040
;The angle between DC-Field and the k-vector is :
;       81.873 +/- 1.028 degrees
;The eigenvalues ratios are:
;       43.924920       1.1759708
;The Minimum Variance eigenvector is:
;< 0.26699,-0.96098,-0.07237> +/- < 0.02144, 0.01202,-0.08044>
;
;Plot Index Range: 1770-1836
;Plot Range: 06:40:27.0640-06:40:27.0992
;The angle between DC-Field and the k-vector is :
;       65.982 +/- 1.009 degrees
;The eigenvalues ratios are:
;       51.577664       1.1701637
;The Minimum Variance eigenvector is:
;< 0.25802,-0.96360,-0.06999> +/- < 0.02237, 0.01152,-0.07610>
;
;Plot Index Range: 1848-1872
;Plot Range: 06:40:27.1056-06:40:27.1184
;The angle between DC-Field and the k-vector is :
;       65.107 +/- 2.222 degrees
;The eigenvalues ratios are:
;       30.867511       2.0740140
;The Minimum Variance eigenvector is:
;< 0.33709,-0.93821,-0.07830> +/- <-0.11340,-0.03991,-0.00999>
;

struct0 = stats_082698_0640x26
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:40:26.5813',prefd[0]+'06:40:26.6197'])
tr1     = time_double([prefd[0]+'06:40:26.6768',prefd[0]+'06:40:26.7147'])
tr2     = time_double([prefd[0]+'06:40:26.8784',prefd[0]+'06:40:26.9248'])
tr3     = time_double([prefd[0]+'06:40:27.0640',prefd[0]+'06:40:27.0992'])
tr4     = time_double([prefd[0]+'06:40:27.1056',prefd[0]+'06:40:27.1184'])

kvec0   = [-0.97078,-0.01012, 0.23974]
kvec1   = [-0.65773, 0.44369,-0.60872]
kvec2   = [-0.73401,-0.65436,-0.18178]
kvec3   = [ 0.25802,-0.96360,-0.06999]
kvec4   = [ 0.33709,-0.93821,-0.07830]

dkvec0  = ABS([-0.01132,-0.09477,-0.04984])
dkvec1  = ABS([-0.10201, 0.01209, 0.11904])
dkvec2  = ABS([ 0.10027,-0.09905,-0.04833])
dkvec3  = ABS([ 0.02237, 0.01152,-0.07610])
dkvec4  = ABS([-0.11340,-0.03991,-0.00999])

elam0   = [25.65646,1.405713]
elam1   = [10.19848,2.709354]
elam2   = [12.79326,1.363889]
elam3   = [51.57766,1.170164]
elam4   = [30.86751,2.074014]

bvec0   = [-0.10111, 0.99330, 0.04603]
bvec1   = [ 0.01916, 0.98800,-0.15250]
bvec2   = [-0.02029, 0.99807,-0.05769]
bvec3   = [ 0.03887, 0.99922,-0.00242]
bvec4   = [ 0.02790, 0.99949, 0.01520]

bmag0   = [20.07243]
bmag1   = [19.93110]
bmag2   = [18.53309]
bmag3   = [18.88544]
bmag4   = [18.80395]

tags    = ['t0','t1','t2','t3','t4']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For 60 Hz < f < 200 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.5813-06:40:26.6197     -0.971     -0.010      0.240     -0.101      0.993      0.046     20.072
;   06:40:26.6768-06:40:26.7147     -0.658      0.444     -0.609      0.019      0.988     -0.152     19.931
;   06:40:26.8784-06:40:26.9248     -0.734     -0.654     -0.182     -0.020      0.998     -0.058     18.533
;   06:40:27.0640-06:40:27.0992      0.258     -0.964     -0.070      0.039      0.999     -0.002     18.885
;   06:40:27.1056-06:40:27.1184      0.337     -0.938     -0.078      0.028      0.999      0.015     18.804

vswu   = [-555.071,-2.777,-69.159]         ; => My 3DP estimates (km/s) For 1998-08-26/06:40:26.120 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For 60 Hz < f < 200 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.5813-06:40:26.6197     84.310     95.690     62.955    117.045     20.976    159.024     48.394    131.606
;   06:40:26.6768-06:40:26.7147     58.762    121.238     24.833    155.167     43.470    136.530     20.198    159.802
;   06:40:26.8784-06:40:26.9248    128.882     51.118     53.725    126.275     41.054    138.946     52.151    127.849
;   06:40:27.0640-06:40:27.0992    162.297     17.703     98.904     81.096    104.040     75.960    107.840     72.160
;   06:40:27.1056-06:40:27.1184    158.360     21.640    101.495     78.505    108.673     71.327    111.301     68.699

theta_kb0826_60_200   = DBLARR(nn)
theta_kn0826_60_200   = DBLARR(nn)
theta_kn20826_60_200  = DBLARR(nn)
theta_kv0826_60_200   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_60_200[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_60_200[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_60_200[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_60_200[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_60_200[j]),  $
                     REFORM(theta_kn0826_60_200[j]),$
                     REFORM(theta_kv0826_60_200[j]),$
                     REFORM(theta_kn20826_60_200[j])
;
; => For 60 Hz < f < 200 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.5813-06:40:26.6197     84.310     62.955     20.976     48.394
;   06:40:26.6768-06:40:26.7147     58.762     24.833     43.470     20.198
;   06:40:26.8784-06:40:26.9248     51.118     53.725     41.054     52.151
;   06:40:27.0640-06:40:27.0992     17.703     81.096     75.960     72.160
;   06:40:27.1056-06:40:27.1184     21.640     78.505     71.327     68.699

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_60_200
PRINT,FORMAT=tkbf,theta_kn0826_60_200
PRINT,FORMAT=tkbf,theta_kv0826_60_200
PRINT,FORMAT=tkbf,theta_kn20826_60_200


theta_kb0826_60_200  = [84.31,58.76,51.12,17.70,21.64]
theta_kn0826_60_200  = [62.95,24.83,53.72,81.10,78.50]
theta_kv0826_60_200  = [20.98,43.47,41.05,75.96,71.33]
theta_kn20826_60_200 = [48.39,20.20,52.15,72.16,68.70]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
; => For 150 Hz < f < 200 Hz  at  1998-08-26/06:40:26.120 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 57-2025
;Plot Range: 06:40:26.1504-06:40:27.2000
;The angle between DC-Field and the k-vector is :
;       10.020 +/- 0.841 degrees
;The eigenvalues ratios are:
;       4.1146222       1.8272944
;The Minimum Variance eigenvector is:
;<-0.13352,-0.99094, 0.01464> +/- <-0.12181, 0.01648, 0.00463>
;
;Plot Index Range: 900-2025
;Plot Range: 06:40:26.6000-06:40:27.2000
;The angle between DC-Field and the k-vector is :
;       7.437 +/- 1.108 degrees
;The eigenvalues ratios are:
;       4.1351941       1.8371975
;The Minimum Variance eigenvector is:
;<-0.13184,-0.99115, 0.01574> +/- <-0.13955, 0.01865, 0.00520>
;
;Plot Index Range: 1040-1462
;Plot Range: 06:40:26.6747-06:40:26.8997
;The angle between DC-Field and the k-vector is :
;       8.644 +/- 1.579 degrees
;The eigenvalues ratios are:
;       4.9258023       1.9396242
;The Minimum Variance eigenvector is:
;<-0.11565,-0.99264, 0.03584> +/- <-0.15897, 0.01848,-0.00125>
;
;Plot Index Range: 1125-1275
;Plot Range: 06:40:26.7200-06:40:26.8000
;The angle between DC-Field and the k-vector is :
;       10.057 +/- 1.744 degrees
;The eigenvalues ratios are:
;       9.1368162       1.9366657
;The Minimum Variance eigenvector is:
;<-0.07895,-0.99658, 0.02448> +/- <-0.14507, 0.01149,-0.00021>
;
;Plot Index Range: 1144-1256
;Plot Range: 06:40:26.7301-06:40:26.7899
;The angle between DC-Field and the k-vector is :
;       9.665 +/- 1.518 degrees
;The eigenvalues ratios are:
;       14.761899       2.0848445
;The Minimum Variance eigenvector is:
;<-0.06465,-0.99725, 0.03609> +/- <-0.11917, 0.00769,-0.00093>
;
;Plot Index Range: 1144-1211
;Plot Range: 06:40:26.7301-06:40:26.7659
;The angle between DC-Field and the k-vector is :
;       9.196 +/- 1.336 degrees
;The eigenvalues ratios are:
;       29.837023       1.8748883
;The Minimum Variance eigenvector is:
;<-0.02118,-0.99832, 0.05399> +/- <-0.09552, 0.00249, 0.00865>
;
;Plot Index Range: 1275-1365
;Plot Range: 06:40:26.8000-06:40:26.8480
;The angle between DC-Field and the k-vector is :
;       60.395 +/- 3.301 degrees
;The eigenvalues ratios are:
;       5.1924195       1.9984341
;The Minimum Variance eigenvector is:
;<-0.34441,-0.93807, 0.03760> +/- <-0.21283, 0.07727,-0.02178>
;
;Plot Index Range: 1710-1821
;Plot Range: 06:40:27.0320-06:40:27.0912
;The angle between DC-Field and the k-vector is :
;       9.615 +/- 2.407 degrees
;The eigenvalues ratios are:
;       7.0091501       1.5286140
;The Minimum Variance eigenvector is:
;<-0.20849,-0.97780,-0.02083> +/- <-0.16107, 0.03229, 0.09660>
;
;Plot Index Range: 1711-1786
;Plot Range: 06:40:27.0325-06:40:27.0725
;The angle between DC-Field and the k-vector is :
;       11.714 +/- 1.614 degrees
;The eigenvalues ratios are:
;       18.973829       1.2996175
;The Minimum Variance eigenvector is:
;<-0.23192,-0.97041,-0.06713> +/- < 0.09161,-0.02766, 0.08330>
;

struct0 = stats_082698_0640x26
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:40:26.7200',prefd[0]+'06:40:26.8000'])
tr1     = time_double([prefd[0]+'06:40:26.7301',prefd[0]+'06:40:26.7899'])
tr2     = time_double([prefd[0]+'06:40:26.7301',prefd[0]+'06:40:26.7659'])
tr3     = time_double([prefd[0]+'06:40:27.0325',prefd[0]+'06:40:27.0725'])

kvec0   = [-0.07895,-0.99658, 0.02448]
kvec1   = [-0.06465,-0.99725, 0.03609]
kvec2   = [-0.02118,-0.99832, 0.05399]
kvec3   = [-0.23192,-0.97041,-0.06713]

dkvec0  = ABS([-0.14507, 0.01149,-0.00021])
dkvec1  = ABS([-0.11917, 0.00769,-0.00093])
dkvec2  = ABS([-0.09552, 0.00249, 0.00865])
dkvec3  = ABS([ 0.09161,-0.02766, 0.08330])

elam0   = [9.136816,1.936666]
elam1   = [14.76190,2.084845]
elam2   = [29.83702,1.874888]
elam3   = [18.97383,1.299618]

bvec0   = [ 0.05342, 0.97874,-0.19698]
bvec1   = [ 0.05889, 0.97723,-0.20328]
bvec2   = [ 0.06308, 0.97619,-0.20715]
bvec3   = [ 0.04915, 0.99858,-0.01916]

bmag0   = [19.33826]
bmag1   = [19.36724]
bmag2   = [19.53251]
bmag3   = [18.97081]

tags    = ['t0','t1','t2','t3']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For 150 Hz < f < 200 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.7200-06:40:26.8000     -0.079     -0.997      0.024      0.053      0.979     -0.197     19.338
;   06:40:26.7301-06:40:26.7899     -0.065     -0.997      0.036      0.059      0.977     -0.203     19.367
;   06:40:26.7301-06:40:26.7659     -0.021     -0.998      0.054      0.063      0.976     -0.207     19.533
;   05:40:00.0000-07:40:00.0000     -0.232     -0.970     -0.067     -0.041      0.989      0.021     18.512

vswu   = [-555.071,-2.777,-69.159]         ; => My 3DP estimates (km/s) For 1998-08-26/06:40:26.120 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For 150 Hz < f < 200 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.7200-06:40:26.8000    169.877     10.123     90.379     89.621     85.396     94.604     94.943     85.057
;   06:40:26.7301-06:40:26.7899    170.295      9.705     91.419     88.581     86.294     93.706     95.995     84.005
;   06:40:26.7301-06:40:26.7659    170.775      9.225     93.828     86.172     88.894     91.106     98.639     81.361
;   06:40:27.0325-06:40:27.0725    168.278     11.722     80.578     99.422     75.921    104.079     84.615     95.385

theta_kb0826_150_200   = DBLARR(nn)
theta_kn0826_150_200   = DBLARR(nn)
theta_kn20826_150_200  = DBLARR(nn)
theta_kv0826_150_200   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_150_200[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_150_200[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_150_200[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_150_200[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_150_200[j]),  $
                     REFORM(theta_kn0826_150_200[j]),$
                     REFORM(theta_kv0826_150_200[j]),$
                     REFORM(theta_kn20826_150_200[j])
;
; => For 150 Hz < f < 200 Hz  at  1998-08-26/06:40:26.120 UT
;
;   06:40:26.7200-06:40:26.8000     10.123     89.621     85.396     85.057
;   06:40:26.7301-06:40:26.7899      9.705     88.581     86.294     84.005
;   06:40:26.7301-06:40:26.7659      9.225     86.172     88.894     81.361
;   06:40:27.0325-06:40:27.0725     11.722     80.578     75.921     84.615

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_150_200
PRINT,FORMAT=tkbf,theta_kn0826_150_200
PRINT,FORMAT=tkbf,theta_kv0826_150_200
PRINT,FORMAT=tkbf,theta_kn20826_150_200


theta_kb0826_150_200  = [10.12, 9.70, 9.22,17.81]
theta_kn0826_150_200  = [89.62,88.58,86.17,80.58]
theta_kv0826_150_200  = [85.40,86.29,88.89,75.92]
theta_kn20826_150_200 = [85.06,84.01,81.36,84.62]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 1L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;       3.0
print, hfc0, format='(";",8f10.1)'
;      30.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0640x54

;-----------------------------------------------------------------------------------------
; => For  3 Hz < f < 30 Hz  at  1998-08-26/06:40:54.941 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 1836-2012
;Plot Range: 06:40:55.9202-06:40:56.0141
;The angle between DC-Field and the k-vector is :
;       79.444 +/- 0.855 degrees
;The eigenvalues ratios are:
;       27.651000       1.4960640
;The Minimum Variance eigenvector is:
;< 0.52086,-0.68992, 0.50270> +/- <-0.06723,-0.02056, 0.04144>
;
;Plot Index Range: 1881-2012
;Plot Range: 06:40:55.9442-06:40:56.0141
;The angle between DC-Field and the k-vector is :
;       72.406 +/- 0.413 degrees
;The eigenvalues ratios are:
;       149.76101       4.0979031
;The Minimum Variance eigenvector is:
;<-0.38681, 0.70088,-0.59929> +/- <-0.01937, 0.00968, 0.02382>
;

struct0 = stats_082698_0640x54
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:40:55.9202',prefd[0]+'06:40:56.0141'])
tr1     = time_double([prefd[0]+'06:40:55.9442',prefd[0]+'06:40:56.0141'])

kvec0   = [ 0.52086,-0.68992, 0.50270]
kvec1   = [-0.38681, 0.70088,-0.59929]

dkvec0  = ABS([-0.06723,-0.02056, 0.04144])
dkvec1  = ABS([-0.01937, 0.00968, 0.02382])

elam0   = [27.651000,1.4960640]
elam1   = [149.76101,4.0979031]

bvec0   = [-0.53815, 0.57695, 0.61443]
bvec1   = [-0.53737, 0.57671, 0.61533]
bmag0   = [21.41130]
bmag1   = [21.39625]

tags    = ['t0','t1']
tr_str  = CREATE_STRUCT(tags,tr0,tr1)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  3 Hz < f < 30 Hz  at  1998-08-26/06:40:54.941 UT
;
;   06:40:55.9202-06:40:56.0141      0.521     -0.690      0.503     -0.538      0.577      0.614     21.411
;   06:40:55.9442-06:40:56.0141     -0.387      0.701     -0.599     -0.537      0.577      0.615     21.396

vswu   = [-627.834,-1.037,-147.112]         ; => My 3DP estimates (km/s) For 1998-08-26/06:40:54.941 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  3 Hz < f < 30 Hz  at  1998-08-26/06:40:54.941 UT
;
;   06:40:55.9202-06:40:56.0141    111.683     68.317    138.400     41.600    128.367     51.633    143.259     36.741
;   06:40:55.9442-06:40:56.0141     75.918    104.082     42.840    137.160     59.189    120.811     41.747    138.253

theta_kb0826_03_30   = DBLARR(nn)
theta_kn0826_03_30   = DBLARR(nn)
theta_kn20826_03_30  = DBLARR(nn)
theta_kv0826_03_30   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_03_30[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_03_30[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_03_30[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_03_30[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_03_30[j]),  $
                     REFORM(theta_kn0826_03_30[j]),$
                     REFORM(theta_kv0826_03_30[j]),$
                     REFORM(theta_kn20826_03_30[j])
;
; => For  3 Hz < f < 30 Hz  at  1998-08-26/06:40:54.941 UT
;
;   06:40:55.9202-06:40:56.0141     68.317     41.600     51.633     36.741
;   06:40:55.9442-06:40:56.0141     75.918     42.840     59.189     41.747

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_03_30
PRINT,FORMAT=tkbf,theta_kn0826_03_30
PRINT,FORMAT=tkbf,theta_kv0826_03_30
PRINT,FORMAT=tkbf,theta_kn20826_03_30


theta_kb0826_03_30  = [68.32,75.92]
theta_kn0826_03_30  = [41.60,42.84]
theta_kv0826_03_30  = [51.63,59.19]
theta_kn20826_03_30 = [36.74,41.75]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24

;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 2L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;       3.0
print, hfc0, format='(";",8f10.1)'
;      30.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0641x10

;-----------------------------------------------------------------------------------------
; => For  3 Hz < f < 30 Hz  at  1998-08-26/06:41:10.001 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 63-203
;Plot Range: 06:41:10.0346-06:41:10.1093
;The angle between DC-Field and the k-vector is :
;       44.424 +/- 1.204 degrees
;The eigenvalues ratios are:
;       18.239064       3.1544018
;The Minimum Variance eigenvector is:
;< 0.89108, 0.10851,-0.44067> +/- < 0.02598, 0.06177, 0.06775>
;
;Plot Index Range: 99-203
;Plot Range: 06:41:10.0538-06:41:10.1093
;The angle between DC-Field and the k-vector is :
;       60.902 +/- 1.129 degrees
;The eigenvalues ratios are:
;       26.980988       2.5218807
;The Minimum Variance eigenvector is:
;< 0.88332, 0.12394,-0.45209> +/- <-0.00555, 0.08517, 0.01251>
;
;Plot Index Range: 477-606
;Plot Range: 06:41:10.2554-06:41:10.3242
;The angle between DC-Field and the k-vector is :
;       74.160 +/- 1.284 degrees
;The eigenvalues ratios are:
;       17.490835       2.6499166
;The Minimum Variance eigenvector is:
;< 0.11374,-0.01262,-0.99343> +/- < 0.09729,-0.02719, 0.01148>
;
;Plot Index Range: 607-864
;Plot Range: 06:41:10.3247-06:41:10.4618
;The angle between DC-Field and the k-vector is :
;       53.544 +/- 0.437 degrees
;The eigenvalues ratios are:
;       69.054751       2.9738111
;The Minimum Variance eigenvector is:
;< 0.34592, 0.08953, 0.93398> +/- <-0.03599, 0.01731, 0.01167>
;
;Plot Index Range: 865-1056
;Plot Range: 06:41:10.4623-06:41:10.5642
;The angle between DC-Field and the k-vector is :
;       73.825 +/- 0.804 degrees
;The eigenvalues ratios are:
;       28.710902       2.3045157
;The Minimum Variance eigenvector is:
;< 0.47222,-0.29015, 0.83236> +/- <-0.06188, 0.00671, 0.03745>
;
;Plot Index Range: 1125-1269
;Plot Range: 06:41:10.6010-06:41:10.6778
;The angle between DC-Field and the k-vector is :
;       76.728 +/- 0.666 degrees
;The eigenvalues ratios are:
;       53.723311       16.734548
;The Minimum Variance eigenvector is:
;<-0.58702,-0.34816,-0.73089> +/- < 0.03356,-0.03360,-0.01095>
;
;Plot Index Range: 1390-1754
;Plot Range: 06:41:10.7423-06:41:10.9365
;The angle between DC-Field and the k-vector is :
;       76.674 +/- 0.521 degrees
;The eigenvalues ratios are:
;       35.337864       1.4128464
;The Minimum Variance eigenvector is:
;<-0.41696,-0.07042,-0.90619> +/- < 0.05507,-0.00484,-0.02496>
;
;Plot Index Range: 1424-1628
;Plot Range: 06:41:10.7605-06:41:10.8693
;The angle between DC-Field and the k-vector is :
;       82.493 +/- 0.121 degrees
;The eigenvalues ratios are:
;       1112.9460       1.3748762
;The Minimum Variance eigenvector is:
;<-0.44233,-0.16770,-0.88103> +/- < 0.00566,-0.01103,-0.00074>
;
;Plot Index Range: 1992-2047
;Plot Range: 06:41:11.0634-06:41:11.0927
;The angle between DC-Field and the k-vector is :
;       67.539 +/- 0.159 degrees
;The eigenvalues ratios are:
;       2393.8907       2.6093743
;The Minimum Variance eigenvector is:
;< 0.48910, 0.49246, 0.71991> +/- <-0.00480, 0.00895,-0.00286>
;

struct0 = stats_082698_0641x10
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:41:10.0538',prefd[0]+'06:41:10.1093'])
tr1     = time_double([prefd[0]+'06:41:10.2554',prefd[0]+'06:41:10.3242'])
tr2     = time_double([prefd[0]+'06:41:10.3247',prefd[0]+'06:41:10.4618'])
tr3     = time_double([prefd[0]+'06:41:10.4623',prefd[0]+'06:41:10.5642'])
tr4     = time_double([prefd[0]+'06:41:10.6010',prefd[0]+'06:41:10.6778'])
tr5     = time_double([prefd[0]+'06:41:10.7605',prefd[0]+'06:41:10.8693'])
tr6     = time_double([prefd[0]+'06:41:11.0634',prefd[0]+'06:41:11.0927'])

kvec0   = [ 0.88332, 0.12394,-0.45209]
kvec1   = [ 0.11374,-0.01262,-0.99343]
kvec2   = [ 0.34592, 0.08953, 0.93398]
kvec3   = [ 0.47222,-0.29015, 0.83236]
kvec4   = [-0.58702,-0.34816,-0.73089]
kvec5   = [-0.44233,-0.16770,-0.88103]
kvec6   = [ 0.48910, 0.49246, 0.71991]

dkvec0  = ABS([-0.00555, 0.08517, 0.01251])
dkvec1  = ABS([ 0.09729,-0.02719, 0.01148])
dkvec2  = ABS([-0.03599, 0.01731, 0.01167])
dkvec3  = ABS([-0.06188, 0.00671, 0.03745])
dkvec4  = ABS([ 0.03356,-0.03360,-0.01095])
dkvec5  = ABS([ 0.00566,-0.01103,-0.00074])
dkvec6  = ABS([-0.00480, 0.00895,-0.00286])

elam0   = [26.980988,2.5218807]
elam1   = [17.490835,2.6499166]
elam2   = [69.054751,2.9738111]
elam3   = [28.710902,2.3045157]
elam4   = [53.723311,16.734548]
elam5   = [1112.9460,1.3748762]
elam6   = [2393.8907,2.6093743]

bvec0   = [-0.44884, 0.87273, 0.19189]
bvec1   = [-0.47113, 0.84903, 0.23907]
bvec2   = [-0.44744, 0.85709, 0.25507]
bvec3   = [-0.41948, 0.87274, 0.24954]
bvec4   = [-0.39878, 0.88634, 0.23530]
bvec5   = [-0.38009, 0.89680, 0.22643]
bvec6   = [-0.40973, 0.87782, 0.24807]
bmag0   = [22.99710]
bmag1   = [23.92546]
bmag2   = [24.22296]
bmag3   = [24.70969]
bmag4   = [24.60894]
bmag5   = [24.52808]
bmag6   = [24.11260]

tags    = ['t0','t1','t2','t3','t4','t5','t6']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  3 Hz < f < 30 Hz  at  1998-08-26/06:41:10.001 UT
;
;   06:41:10.0538-06:41:10.1093      0.883      0.124     -0.452     -0.449      0.873      0.192     22.997
;   06:41:10.2554-06:41:10.3242      0.114     -0.013     -0.993     -0.471      0.849      0.239     23.925
;   06:41:10.3247-06:41:10.4618      0.346      0.090      0.934     -0.447      0.857      0.255     24.223
;   06:41:10.4623-06:41:10.5642      0.472     -0.290      0.832     -0.419      0.873      0.250     24.710
;   06:41:10.6010-06:41:10.6778     -0.587     -0.348     -0.731     -0.399      0.886      0.235     24.609
;   06:41:10.7605-06:41:10.8693     -0.442     -0.168     -0.881     -0.380      0.897      0.226     24.528
;   06:41:11.0634-06:41:11.0927      0.489      0.492      0.720     -0.410      0.878      0.248     24.113

vswu   = [-611.358,8.253,-167.555]         ; => My 3DP estimates (km/s) For 1998-08-26/06:41:10.001 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  3 Hz < f < 30 Hz  at  1998-08-26/06:41:10.001 UT
;
;   06:41:10.0538-06:41:10.1093    112.027     67.973    103.459     76.541    136.948     43.052    117.321     62.679
;   06:41:10.2554-06:41:10.3242    107.566     72.434     47.620    132.380     81.216     98.784     62.991    117.009
;   06:41:10.3247-06:41:10.4618     80.782     99.218    158.005     21.995    125.400     54.600    142.044     37.956
;   06:41:10.4623-06:41:10.5642    104.100     75.900    161.534     18.466    132.778     47.222    152.685     27.315
;   06:41:10.6010-06:41:10.6778    104.269     75.731     22.830    157.170     40.998    139.002     33.000    147.000
;   06:41:10.7605-06:41:10.8693    100.472     79.528     18.681    161.319     48.911    131.089     34.141    145.859
;   06:41:11.0634-06:41:11.0927     65.765    114.235    147.509     32.491    130.960     49.040    137.070     42.930

theta_kb0826_03_30_2   = DBLARR(nn)
theta_kn0826_03_30_2   = DBLARR(nn)
theta_kn20826_03_30_2  = DBLARR(nn)
theta_kv0826_03_30_2   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_03_30_2[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_03_30_2[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_03_30_2[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_03_30_2[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_03_30_2[j]),  $
                     REFORM(theta_kn0826_03_30_2[j]),$
                     REFORM(theta_kv0826_03_30_2[j]),$
                     REFORM(theta_kn20826_03_30_2[j])
;
; => For  3 Hz < f < 30 Hz  at  1998-08-26/06:41:10.001 UT
;
;   06:41:10.0538-06:41:10.1093     67.973     76.541     43.052     62.679
;   06:41:10.2554-06:41:10.3242     72.434     47.620     81.216     62.991
;   06:41:10.3247-06:41:10.4618     80.782     21.995     54.600     37.956
;   06:41:10.4623-06:41:10.5642     75.900     18.466     47.222     27.315
;   06:41:10.6010-06:41:10.6778     75.731     22.830     40.998     33.000
;   06:41:10.7605-06:41:10.8693     79.528     18.681     48.911     34.141
;   06:41:11.0634-06:41:11.0927     65.765     32.491     49.040     42.930

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_03_30_2
PRINT,FORMAT=tkbf,theta_kn0826_03_30_2
PRINT,FORMAT=tkbf,theta_kv0826_03_30_2
PRINT,FORMAT=tkbf,theta_kn20826_03_30_2


theta_kb0826_03_30_2  = [67.97,72.43,80.78,75.90,75.73,79.53,65.76]
theta_kn0826_03_30_2  = [76.54,47.62,21.99,18.47,22.83,18.68,32.49]
theta_kv0826_03_30_2  = [43.05,81.22,54.60,47.22,41.00,48.91,49.04]
theta_kn20826_03_30_2 = [62.68,62.99,37.96,27.31,33.00,34.14,42.93]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 3L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      30.0
print, hfc0, format='(";",8f10.1)'
;     130.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0641x37

;-----------------------------------------------------------------------------------------
; => For  30 Hz < f < 130 Hz  at  1998-08-26/06:41:37.623 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 0-2047
;Plot Range: 06:41:37.6230-06:41:38.7147
;The angle between DC-Field and the k-vector is :
;       6.979 +/- 0.316 degrees
;The eigenvalues ratios are:
;       18.036127       1.0333792
;The Minimum Variance eigenvector is:
;<-0.68585, 0.34232, 0.64221> +/- <-0.03320,-0.04919,-0.00924>
;
;Plot Index Range: 557-791
;Plot Range: 06:41:37.9201-06:41:38.0449
;The angle between DC-Field and the k-vector is :
;       87.507 +/- 0.785 degrees
;The eigenvalues ratios are:
;       24.821264       1.0866828
;The Minimum Variance eigenvector is:
;< 0.66202,-0.29986,-0.68689> +/- <-0.05301, 0.02666,-0.06273>
;
;Plot Index Range: 566-636
;Plot Range: 06:41:37.9249-06:41:37.9622
;The angle between DC-Field and the k-vector is :
;       84.639 +/- 1.604 degrees
;The eigenvalues ratios are:
;       20.436502       1.0498023
;The Minimum Variance eigenvector is:
;<-0.54803, 0.39120, 0.73934> +/- <-0.10739,-0.01126,-0.07365>
;
;Plot Index Range: 637-791
;Plot Range: 06:41:37.9627-06:41:38.0449
;The angle between DC-Field and the k-vector is :
;       62.216 +/- 0.790 degrees
;The eigenvalues ratios are:
;       36.379200       1.1394255
;The Minimum Variance eigenvector is:
;< 0.69208,-0.27042,-0.66926> +/- < 0.02589, 0.07335,-0.00286>
;
;Plot Index Range: 792-1104
;Plot Range: 06:41:38.0454-06:41:38.2118
;The angle between DC-Field and the k-vector is :
;       10.977 +/- 0.463 degrees
;The eigenvalues ratios are:
;       51.245744       1.0409382
;The Minimum Variance eigenvector is:
;<-0.71918, 0.38116, 0.58095> +/- <-0.03636,-0.03714,-0.02065>
;
;Plot Index Range: 1192-1456
;Plot Range: 06:41:38.2587-06:41:38.3995
;The angle between DC-Field and the k-vector is :
;       61.870 +/- 0.463 degrees
;The eigenvalues ratios are:
;       60.206391       1.0554272
;The Minimum Variance eigenvector is:
;< 0.70806,-0.35198,-0.61218> +/- <-0.02643, 0.01998,-0.04206>
;

struct0 = stats_082698_0641x37
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:41:37.9249',prefd[0]+'06:41:37.9622'])
tr1     = time_double([prefd[0]+'06:41:37.9627',prefd[0]+'06:41:38.0449'])
tr2     = time_double([prefd[0]+'06:41:38.0454',prefd[0]+'06:41:38.2118'])
tr3     = time_double([prefd[0]+'06:41:38.2587',prefd[0]+'06:41:38.3995'])

kvec0   = [-0.54803, 0.39120, 0.73934]
kvec1   = [ 0.69208,-0.27042,-0.66926]
kvec2   = [-0.71918, 0.38116, 0.58095]
kvec3   = [ 0.70806,-0.35198,-0.61218]

dkvec0  = ABS([-0.10739,-0.01126,-0.07365])
dkvec1  = ABS([ 0.02589, 0.07335,-0.00286])
dkvec2  = ABS([-0.03636,-0.03714,-0.02065])
dkvec3  = ABS([-0.02643, 0.01998,-0.04206])

elam0   = [20.436502,1.0498023]
elam1   = [36.379200,1.1394255]
elam2   = [51.245744,1.0409382]
elam3   = [60.206391,1.0554272]

bvec0   = [-0.58682, 0.36427, 0.72315]
bvec1   = [-0.58188, 0.36486, 0.72682]
bvec2   = [-0.57921, 0.35917, 0.73177]
bvec3   = [-0.59508, 0.33813, 0.72906]
bmag0   = [20.64521]
bmag1   = [20.69357]
bmag2   = [20.69774]
bmag3   = [20.88043]

tags    = ['t0','t1','t2','t3']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  30 Hz < f < 130 Hz  at  1998-08-26/06:41:37.623 UT
;
;   06:41:37.9249-06:41:37.9622     -0.548      0.391      0.739     -0.587      0.364      0.723     20.645
;   06:41:37.9627-06:41:38.0449      0.692     -0.270     -0.669     -0.582      0.365      0.727     20.694
;   06:41:38.0454-06:41:38.2118     -0.719      0.381      0.581     -0.579      0.359      0.732     20.698
;   06:41:38.2587-06:41:38.3995      0.708     -0.352     -0.612     -0.595      0.338      0.729     20.880

vswu   = [-624.523,28.156,-172.991]         ; => My 3DP estimates (km/s) For 1998-08-26/06:41:37.623 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  30 Hz < f < 130 Hz  at  1998-08-26/06:41:37.623 UT
;
;   06:41:37.9249-06:41:37.9622      2.862    177.138    100.536     79.464     69.669    110.331     84.513     95.487
;   06:41:37.9627-06:41:38.0449    171.044      8.956     87.679     92.321    119.973     60.027    103.657     76.343
;   06:41:38.0454-06:41:38.2118     11.881    168.119     87.233     92.767     56.356    123.644     71.186    108.814
;   06:41:38.2587-06:41:38.3995    170.638      9.362     90.933     89.067    122.258     57.742    106.982     73.018

theta_kb0826_30_130   = DBLARR(nn)
theta_kn0826_30_130   = DBLARR(nn)
theta_kn20826_30_130  = DBLARR(nn)
theta_kv0826_30_130   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_30_130[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_30_130[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_30_130[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_30_130[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_30_130[j]),  $
                     REFORM(theta_kn0826_30_130[j]),$
                     REFORM(theta_kv0826_30_130[j]),$
                     REFORM(theta_kn20826_30_130[j])
;
; => For  30 Hz < f < 130 Hz  at  1998-08-26/06:41:37.623 UT
;
;   06:41:37.9249-06:41:37.9622      2.862     79.464     69.669     84.513
;   06:41:37.9627-06:41:38.0449      8.956     87.679     60.027     76.343
;   06:41:38.0454-06:41:38.2118     11.881     87.233     56.356     71.186
;   06:41:38.2587-06:41:38.3995      9.362     89.067     57.742     73.018

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_30_130
PRINT,FORMAT=tkbf,theta_kn0826_30_130
PRINT,FORMAT=tkbf,theta_kv0826_30_130
PRINT,FORMAT=tkbf,theta_kn20826_30_130


theta_kb0826_30_130  = [ 2.86, 8.96,11.88, 9.36]
theta_kn0826_30_130  = [79.46,87.68,87.23,89.07]
theta_kv0826_30_130  = [69.67,60.03,56.36,57.74]
theta_kn20826_30_130 = [84.51,76.34,71.19,73.02]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 4L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      30.0
print, hfc0, format='(";",8f10.1)'
;     130.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0641x44

;-----------------------------------------------------------------------------------------
; => For  30 Hz < f < 130 Hz  at  1998-08-26/06:41:44.013 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 0-2047
;Plot Range: 06:41:44.0130-06:41:45.1047
;The angle between DC-Field and the k-vector is :
;       5.857 +/- 0.235 degrees
;The eigenvalues ratios are:
;       31.046658       1.0216983
;The Minimum Variance eigenvector is:
;<-0.67272, 0.31972, 0.66725> +/- <-0.03258,-0.02266,-0.02199>
;
;Plot Index Range: 0-189
;Plot Range: 06:41:44.0130-06:41:44.1138
;The angle between DC-Field and the k-vector is :
;       8.744 +/- 0.482 degrees
;The eigenvalues ratios are:
;       77.257208       1.0786112
;The Minimum Variance eigenvector is:
;< 0.64594,-0.28969,-0.70629> +/- <-0.03230, 0.01605,-0.03612>
;
;Plot Index Range: 237-365
;Plot Range: 06:41:44.1394-06:41:44.2077
;The angle between DC-Field and the k-vector is :
;       69.504 +/- 0.431 degrees
;The eigenvalues ratios are:
;       141.34440       1.0405578
;The Minimum Variance eigenvector is:
;<-0.72505, 0.28523, 0.62686> +/- < 0.02353, 0.03229, 0.01252>
;
;Plot Index Range: 366-575
;Plot Range: 06:41:44.2082-06:41:44.3197
;The angle between DC-Field and the k-vector is :
;       75.400 +/- 0.442 degrees
;The eigenvalues ratios are:
;       82.674630       1.0186937
;The Minimum Variance eigenvector is:
;<-0.67761, 0.24410, 0.69373> +/- <-0.03380, 0.00505,-0.03479>
;
;Plot Index Range: 613-706
;Plot Range: 06:41:44.3399-06:41:44.3895
;The angle between DC-Field and the k-vector is :
;       88.047 +/- 1.596 degrees
;The eigenvalues ratios are:
;       15.947115       1.1605405
;The Minimum Variance eigenvector is:
;< 0.78077,-0.24585,-0.57442> +/- <-0.05386, 0.06930,-0.10287>
;
;Plot Index Range: 833-1041
;Plot Range: 06:41:44.4573-06:41:44.5682
;The angle between DC-Field and the k-vector is :
;       7.817 +/- 0.551 degrees
;The eigenvalues ratios are:
;       54.200106       1.0471970
;The Minimum Variance eigenvector is:
;<-0.69836, 0.27962, 0.65887> +/- <-0.04289,-0.01225,-0.04026>
;
;Plot Index Range: 833-957
;Plot Range: 06:41:44.4573-06:41:44.5234
;The angle between DC-Field and the k-vector is :
;       78.613 +/- 0.632 degrees
;The eigenvalues ratios are:
;       68.704042       1.0654233
;The Minimum Variance eigenvector is:
;<-0.70521, 0.32770, 0.62872> +/- < 0.03928, 0.03943, 0.02351>
;
;Plot Index Range: 958-1041
;Plot Range: 06:41:44.5239-06:41:44.5682
;The angle between DC-Field and the k-vector is :
;       10.285 +/- 0.852 degrees
;The eigenvalues ratios are:
;       57.099761       1.1194410
;The Minimum Variance eigenvector is:
;<-0.69401, 0.24030, 0.67868> +/- <-0.05145,-0.02846,-0.04253>
;
;Plot Index Range: 1081-1203
;Plot Range: 06:41:44.5895-06:41:44.6546
;The angle between DC-Field and the k-vector is :
;       68.166 +/- 0.636 degrees
;The eigenvalues ratios are:
;       68.970768       1.0651076
;The Minimum Variance eigenvector is:
;< 0.65592,-0.28391,-0.69940> +/- <-0.03203, 0.02955,-0.04203>
;
;Plot Index Range: 1203-1323
;Plot Range: 06:41:44.6546-06:41:44.7186
;The angle between DC-Field and the k-vector is :
;       77.873 +/- 0.513 degrees
;The eigenvalues ratios are:
;       107.01331       1.0715389
;The Minimum Variance eigenvector is:
;< 0.67964,-0.35864,-0.63989> +/- <-0.02263, 0.02252,-0.03666>
;
;Plot Index Range: 1644-1797
;Plot Range: 06:41:44.8898-06:41:44.9714
;The angle between DC-Field and the k-vector is :
;       88.280 +/- 0.831 degrees
;The eigenvalues ratios are:
;       33.224218       1.0332873
;The Minimum Variance eigenvector is:
;<-0.63806, 0.41326, 0.64969> +/- <-0.06432,-0.03270,-0.04237>
;
;Plot Index Range: 1859-2008
;Plot Range: 06:41:45.0045-06:41:45.0839
;The angle between DC-Field and the k-vector is :
;       86.910 +/- 0.648 degrees
;The eigenvalues ratios are:
;       54.825617       1.0682807
;The Minimum Variance eigenvector is:
;< 0.65344,-0.37936,-0.65506> +/- < 0.03048, 0.05695,-0.00258>
;

struct0 = stats_082698_0641x44
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:41:44.0130',prefd[0]+'06:41:44.1138'])
tr1     = time_double([prefd[0]+'06:41:44.1394',prefd[0]+'06:41:44.2077'])
tr2     = time_double([prefd[0]+'06:41:44.2082',prefd[0]+'06:41:44.3197'])
tr3     = time_double([prefd[0]+'06:41:44.3399',prefd[0]+'06:41:44.3895'])
tr4     = time_double([prefd[0]+'06:41:44.4573',prefd[0]+'06:41:44.5234'])
tr5     = time_double([prefd[0]+'06:41:44.5239',prefd[0]+'06:41:44.5682'])
tr6     = time_double([prefd[0]+'06:41:44.5895',prefd[0]+'06:41:44.6546'])
tr7     = time_double([prefd[0]+'06:41:44.6546',prefd[0]+'06:41:44.7186'])
tr8     = time_double([prefd[0]+'06:41:44.8898',prefd[0]+'06:41:44.9714'])
tr9     = time_double([prefd[0]+'06:41:45.0045',prefd[0]+'06:41:45.0839'])

kvec0   = [ 0.64594,-0.28969,-0.70629]
kvec1   = [-0.72505, 0.28523, 0.62686]
kvec2   = [-0.67761, 0.24410, 0.69373]
kvec3   = [ 0.78077,-0.24585,-0.57442]
kvec4   = [-0.70521, 0.32770, 0.62872]
kvec5   = [-0.69401, 0.24030, 0.67868]
kvec6   = [ 0.65592,-0.28391,-0.69940]
kvec7   = [ 0.67964,-0.35864,-0.63989]
kvec8   = [-0.63806, 0.41326, 0.64969]
kvec9   = [ 0.65344,-0.37936,-0.65506]

dkvec0  = ABS([-0.03230, 0.01605,-0.03612])
dkvec1  = ABS([ 0.02353, 0.03229, 0.01252])
dkvec2  = ABS([-0.03380, 0.00505,-0.03479])
dkvec3  = ABS([-0.05386, 0.06930,-0.10287])
dkvec4  = ABS([ 0.03928, 0.03943, 0.02351])
dkvec5  = ABS([-0.05145,-0.02846,-0.04253])
dkvec6  = ABS([-0.03203, 0.02955,-0.04203])
dkvec7  = ABS([-0.02263, 0.02252,-0.03666])
dkvec8  = ABS([-0.06432,-0.03270,-0.04237])
dkvec9  = ABS([ 0.03048, 0.05695,-0.00258])

elam0   = [77.257208,1.0786112]
elam1   = [141.34440,1.0405578]
elam2   = [82.674630,1.0186937]
elam3   = [15.947115,1.1605405]
elam4   = [68.704042,1.0654233]
elam5   = [57.099761,1.1194410]
elam6   = [68.970768,1.0651076]
elam7   = [107.01331,1.0715389]
elam8   = [33.224218,1.0332873]
elam9   = [54.825617,1.0682807]

bvec0   = [-0.67032, 0.42498, 0.60832]
bvec1   = [-0.68673, 0.40902, 0.60087]
bvec2   = [-0.70327, 0.39143, 0.59344]
bvec3   = [-0.71039, 0.38494, 0.58921]
bvec4   = [-0.71209, 0.39106, 0.58310]
bvec5   = [-0.71205, 0.39192, 0.58256]
bvec6   = [-0.71080, 0.39057, 0.58499]
bvec7   = [-0.70754, 0.38988, 0.58938]
bvec8   = [-0.69172, 0.39232, 0.60630]
bvec9   = [-0.68935, 0.38578, 0.61316]
bmag0   = [21.92541]
bmag1   = [22.33346]
bmag2   = [22.53878]
bmag3   = [22.61108]
bmag4   = [22.69026]
bmag5   = [22.63639]
bmag6   = [22.60861]
bmag7   = [22.66954]
bmag8   = [22.53012]
bmag9   = [22.28330]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  30 Hz < f < 130 Hz  at  1998-08-26/06:41:44.013 UT
;
;   06:41:44.0130-06:41:44.1138      0.646     -0.290     -0.706     -0.670      0.425      0.608     21.925
;   06:41:44.1394-06:41:44.2077     -0.725      0.285      0.627     -0.687      0.409      0.601     22.333
;   06:41:44.2082-06:41:44.3197     -0.678      0.244      0.694     -0.703      0.391      0.593     22.539
;   06:41:44.3399-06:41:44.3895      0.781     -0.246     -0.574     -0.710      0.385      0.589     22.611
;   06:41:44.4573-06:41:44.5234     -0.705      0.328      0.629     -0.712      0.391      0.583     22.690
;   06:41:44.5239-06:41:44.5682     -0.694      0.240      0.679     -0.712      0.392      0.583     22.636
;   06:41:44.5895-06:41:44.6546      0.656     -0.284     -0.699     -0.711      0.391      0.585     22.609
;   06:41:44.6546-06:41:44.7186      0.680     -0.359     -0.640     -0.708      0.390      0.589     22.670
;   06:41:44.8898-06:41:44.9714     -0.638      0.413      0.650     -0.692      0.392      0.606     22.530
;   06:41:45.0045-06:41:45.0839      0.653     -0.379     -0.655     -0.689      0.386      0.613     22.283

vswu   = [-622.222,26.771,-171.121]         ; => My 3DP estimates (km/s) For 1998-08-26/06:41:44.013 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  30 Hz < f < 130 Hz  at  1998-08-26/06:41:44.013 UT
;
;   06:41:44.0130-06:41:44.1138    170.316      9.684     84.384     95.616    116.562     63.438    100.391     79.609
;   06:41:44.1394-06:41:44.2077      7.589    172.411     89.217     90.783     57.028    122.972     73.220    106.780
;   06:41:44.2082-06:41:44.3197     10.335    169.665     93.984     86.016     61.373    118.627     78.051    101.949
;   06:41:44.3399-06:41:44.3895    171.020      8.980     95.056     84.944    127.602     52.398    110.981     69.019
;   06:41:44.4573-06:41:44.5234      4.494    175.506     89.945     90.055     58.238    121.762     73.905    106.095
;   06:41:44.5239-06:41:44.5682     10.352    169.648     92.725     87.275     60.083    119.917     76.801    103.199
;   06:41:44.5895-06:41:44.6546    170.490      9.510     85.046     94.954    117.281     62.719    101.045     78.955
;   06:41:44.6546-06:41:44.7186    176.234      3.766     88.684     91.316    120.005     59.995    104.732     75.268
;   06:41:44.8898-06:41:44.9714      4.137    175.863     93.176     86.824     62.633    117.367     77.160    102.840
;   06:41:45.0045-06:41:45.0839    176.816      3.184     87.092     92.908    118.143     61.857    103.134     76.866

theta_kb0826_30_130_2   = DBLARR(nn)
theta_kn0826_30_130_2   = DBLARR(nn)
theta_kn20826_30_130_2  = DBLARR(nn)
theta_kv0826_30_130_2   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_30_130_2[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_30_130_2[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_30_130_2[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_30_130_2[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_30_130_2[j]),  $
                     REFORM(theta_kn0826_30_130_2[j]),$
                     REFORM(theta_kv0826_30_130_2[j]),$
                     REFORM(theta_kn20826_30_130_2[j])
;
; => For  30 Hz < f < 130 Hz  at  1998-08-26/06:41:44.013 UT
;
;   06:41:44.0130-06:41:44.1138      9.684     84.384     63.438     79.609
;   06:41:44.1394-06:41:44.2077      7.589     89.217     57.028     73.220
;   06:41:44.2082-06:41:44.3197     10.335     86.016     61.373     78.051
;   06:41:44.3399-06:41:44.3895      8.980     84.944     52.398     69.019
;   06:41:44.4573-06:41:44.5234      4.494     89.945     58.238     73.905
;   06:41:44.5239-06:41:44.5682     10.352     87.275     60.083     76.801
;   06:41:44.5895-06:41:44.6546      9.510     85.046     62.719     78.955
;   06:41:44.6546-06:41:44.7186      3.766     88.684     59.995     75.268
;   06:41:44.8898-06:41:44.9714      4.137     86.824     62.633     77.160
;   06:41:45.0045-06:41:45.0839      3.184     87.092     61.857     76.866

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_30_130_2
PRINT,FORMAT=tkbf,theta_kn0826_30_130_2
PRINT,FORMAT=tkbf,theta_kv0826_30_130_2
PRINT,FORMAT=tkbf,theta_kn20826_30_130_2


theta_kb0826_30_130_2  = [ 9.68, 7.59,10.34, 8.98, 4.49,10.35, 9.51, 3.77, 4.14, 3.18]
theta_kn0826_30_130_2  = [84.38,89.22,86.02,84.94,89.94,87.28,85.05,88.68,86.82,87.09]
theta_kv0826_30_130_2  = [63.44,57.03,61.37,52.40,58.24,60.08,62.72,59.99,62.63,61.86]
theta_kn20826_30_130_2 = [79.61,73.22,78.05,69.02,73.91,76.80,78.96,75.27,77.16,76.87]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 5L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      35.0
print, hfc0, format='(";",8f10.1)'
;     150.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0641x53

;-----------------------------------------------------------------------------------------
; => For  35 Hz < f < 150 Hz  at  1998-08-26/06:41:53.249 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 0-189
;Plot Range: 06:41:53.2490-06:41:53.3498
;The angle between DC-Field and the k-vector is :
;       0.240 +/- 0.910 degrees
;The eigenvalues ratios are:
;       23.020496       1.0845570
;The Minimum Variance eigenvector is:
;<-0.71857, 0.33705, 0.60832> +/- <-0.06591,-0.03113,-0.06061>
;
;Plot Index Range: 241-396
;Plot Range: 06:41:53.3775-06:41:53.4602
;The angle between DC-Field and the k-vector is :
;       69.061 +/- 0.664 degrees
;The eigenvalues ratios are:
;       50.388286       1.0429588
;The Minimum Variance eigenvector is:
;<-0.72340, 0.42194, 0.54649> +/- < 0.04564, 0.03884, 0.03043>
;
;Plot Index Range: 424-601
;Plot Range: 06:41:53.4751-06:41:53.5695
;The angle between DC-Field and the k-vector is :
;       39.621 +/- 0.764 degrees
;The eigenvalues ratios are:
;       33.923291       1.0275233
;The Minimum Variance eigenvector is:
;<-0.65801, 0.45555, 0.59958> +/- <-0.05682,-0.05100,-0.02360>
;
;Plot Index Range: 468-601
;Plot Range: 06:41:53.4986-06:41:53.5695
;The angle between DC-Field and the k-vector is :
;       80.021 +/- 0.593 degrees
;The eigenvalues ratios are:
;       72.809370       1.0743070
;The Minimum Variance eigenvector is:
;<-0.65096, 0.44022, 0.61843> +/- <-0.04262,-0.03139,-0.02251>
;
;Plot Index Range: 654-808
;Plot Range: 06:41:53.5978-06:41:53.6799
;The angle between DC-Field and the k-vector is :
;       26.357 +/- 0.465 degrees
;The eigenvalues ratios are:
;       101.32968       1.0516733
;The Minimum Variance eigenvector is:
;< 0.79728,-0.36430,-0.48127> +/- < 0.01414, 0.04389,-0.00980>
;
;Plot Index Range: 884-1011
;Plot Range: 06:41:53.7205-06:41:53.7882
;The angle between DC-Field and the k-vector is :
;       85.130 +/- 0.576 degrees
;The eigenvalues ratios are:
;       80.458615       1.0762210
;The Minimum Variance eigenvector is:
;<-0.79802, 0.29995, 0.52267> +/- <-0.02989,-0.04090,-0.02217>
;
;Plot Index Range: 1062-1230
;Plot Range: 06:41:53.8154-06:41:53.9050
;The angle between DC-Field and the k-vector is :
;       65.013 +/- 0.526 degrees
;The eigenvalues ratios are:
;       72.917958       1.0670922
;The Minimum Variance eigenvector is:
;< 0.75311,-0.31901,-0.57537> +/- <-0.02358, 0.02256,-0.04337>
;
;Plot Index Range: 1230-1295
;Plot Range: 06:41:53.9050-06:41:53.9397
;The angle between DC-Field and the k-vector is :
;       84.319 +/- 0.606 degrees
;The eigenvalues ratios are:
;       141.82521       1.0994739
;The Minimum Variance eigenvector is:
;<-0.64898, 0.41304, 0.63892> +/- < 0.03441, 0.00019, 0.03482>
;
;Plot Index Range: 1296-1371
;Plot Range: 06:41:53.9402-06:41:53.9802
;The angle between DC-Field and the k-vector is :
;       52.655 +/- 0.721 degrees
;The eigenvalues ratios are:
;       87.225966       1.1017825
;The Minimum Variance eigenvector is:
;<-0.68468, 0.42833, 0.58970> +/- <-0.04044,-0.04141,-0.01688>
;
;Plot Index Range: 1606-1710
;Plot Range: 06:41:54.1055-06:41:54.1610
;The angle between DC-Field and the k-vector is :
;       82.692 +/- 0.764 degrees
;The eigenvalues ratios are:
;       56.650936       1.0821324
;The Minimum Variance eigenvector is:
;< 0.77272,-0.31673,-0.55008> +/- <-0.02785, 0.02968,-0.05620>
;
;Plot Index Range: 1753-1813
;Plot Range: 06:41:54.1839-06:41:54.2159
;The angle between DC-Field and the k-vector is :
;       89.450 +/- 0.542 degrees
;The eigenvalues ratios are:
;       191.07466       1.0133163
;The Minimum Variance eigenvector is:
;<-0.63062, 0.60421, 0.48707> +/- <-0.02688,-0.00011,-0.03467>
;
;Plot Index Range: 1836-1899
;Plot Range: 06:41:54.2282-06:41:54.2618
;The angle between DC-Field and the k-vector is :
;       76.964 +/- 1.048 degrees
;The eigenvalues ratios are:
;       50.177812       1.0688639
;The Minimum Variance eigenvector is:
;<-0.78678, 0.30459, 0.53684> +/- <-0.04820,-0.05735,-0.03810>
;

struct0 = stats_082698_0641x53
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:41:53.2490',prefd[0]+'06:41:53.3498'])
tr1     = time_double([prefd[0]+'06:41:53.3775',prefd[0]+'06:41:53.4602'])
tr2     = time_double([prefd[0]+'06:41:53.4986',prefd[0]+'06:41:53.5695'])
tr3     = time_double([prefd[0]+'06:41:53.5978',prefd[0]+'06:41:53.6799'])
tr4     = time_double([prefd[0]+'06:41:53.7205',prefd[0]+'06:41:53.7882'])
tr5     = time_double([prefd[0]+'06:41:53.8154',prefd[0]+'06:41:53.9050'])
tr6     = time_double([prefd[0]+'06:41:53.9050',prefd[0]+'06:41:53.9397'])
tr7     = time_double([prefd[0]+'06:41:53.9402',prefd[0]+'06:41:53.9802'])
tr8     = time_double([prefd[0]+'06:41:54.1055',prefd[0]+'06:41:54.1610'])
tr9     = time_double([prefd[0]+'06:41:54.1839',prefd[0]+'06:41:54.2159'])
tr10    = time_double([prefd[0]+'06:41:54.2282',prefd[0]+'06:41:54.2618'])

kvec0   = [-0.71857, 0.33705, 0.60832]
kvec1   = [-0.72340, 0.42194, 0.54649]
kvec2   = [-0.65096, 0.44022, 0.61843]
kvec3   = [ 0.79728,-0.36430,-0.48127]
kvec4   = [-0.79802, 0.29995, 0.52267]
kvec5   = [ 0.75311,-0.31901,-0.57537]
kvec6   = [-0.64898, 0.41304, 0.63892]
kvec7   = [-0.68468, 0.42833, 0.58970]
kvec8   = [ 0.77272,-0.31673,-0.55008]
kvec9   = [-0.63062, 0.60421, 0.48707]
kvec10  = [-0.78678, 0.30459, 0.53684]

dkvec0  = ABS([-0.06591,-0.03113,-0.06061])
dkvec1  = ABS([ 0.04564, 0.03884, 0.03043])
dkvec2  = ABS([-0.04262,-0.03139,-0.02251])
dkvec3  = ABS([ 0.01414, 0.04389,-0.00980])
dkvec4  = ABS([-0.02989,-0.04090,-0.02217])
dkvec5  = ABS([-0.02358, 0.02256,-0.04337])
dkvec6  = ABS([ 0.03441, 0.00019, 0.03482])
dkvec7  = ABS([-0.04044,-0.04141,-0.01688])
dkvec8  = ABS([-0.02785, 0.02968,-0.05620])
dkvec9  = ABS([-0.02688,-0.00011,-0.03467])
dkvec10 = ABS([-0.04820,-0.05735,-0.03810])

elam0   = [23.020496,1.0845570]
elam1   = [50.388286,1.0429588]
elam2   = [72.809370,1.0743070]
elam3   = [101.32968,1.0516733]
elam4   = [80.458615,1.0762210]
elam5   = [72.917958,1.0670922]
elam6   = [141.82521,1.0994739]
elam7   = [87.225966,1.1017825]
elam8   = [56.650936,1.0821324]
elam9   = [191.07466,1.0133163]
elam10  = [50.177812,1.0688639]

bvec0   = [-0.71270, 0.33756, 0.61490]
bvec1   = [-0.71329, 0.33851, 0.61370]
bvec2   = [-0.71272, 0.33591, 0.61579]
bvec3   = [-0.71097, 0.33992, 0.61560]
bvec4   = [-0.71155, 0.34745, 0.61071]
bvec5   = [-0.71200, 0.35256, 0.60726]
bvec6   = [-0.71065, 0.35034, 0.61011]
bvec7   = [-0.70905, 0.34747, 0.61360]
bvec8   = [-0.70680, 0.33889, 0.62096]
bvec9   = [-0.70979, 0.33921, 0.61736]
bvec10  = -0.71310, 0.33966, 0.61329]
bmag0   = [22.67592]
bmag1   = [22.68315]
bmag2   = [22.68923]
bmag3   = [22.64278]
bmag4   = [22.60146]
bmag5   = [22.62789]
bmag6   = [22.66160]
bmag7   = [22.69207]
bmag8   = [22.65236]
bmag9   = [22.57604]
bmag10  = 22.54052]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9,kvec10)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9,dkvec10)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  35 Hz < f < 150 Hz  at  1998-08-26/06:41:53.249 UT
;
;   06:41:53.2490-06:41:53.3498     -0.719      0.337      0.608     -0.713      0.338      0.615     22.676
;   06:41:53.3775-06:41:53.4602     -0.723      0.422      0.546     -0.713      0.339      0.614     22.683
;   06:41:53.4986-06:41:53.5695     -0.651      0.440      0.618     -0.713      0.336      0.616     22.689
;   06:41:53.5978-06:41:53.6799      0.797     -0.364     -0.481     -0.711      0.340      0.616     22.643
;   06:41:53.7205-06:41:53.7882     -0.798      0.300      0.523     -0.712      0.347      0.611     22.601
;   06:41:53.8154-06:41:53.9050      0.753     -0.319     -0.575     -0.712      0.353      0.607     22.628
;   06:41:53.9050-06:41:53.9397     -0.649      0.413      0.639     -0.711      0.350      0.610     22.662
;   06:41:53.9402-06:41:53.9802     -0.685      0.428      0.590     -0.709      0.347      0.614     22.692
;   06:41:54.1055-06:41:54.1610      0.773     -0.317     -0.550     -0.707      0.339      0.621     22.652
;   06:41:54.1839-06:41:54.2159     -0.631      0.604      0.487     -0.710      0.339      0.617     22.576
;   06:41:54.2282-06:41:54.2618     -0.787      0.305      0.537     -0.713      0.340      0.613     22.541

vswu   = [-617.180,35.365,-172.132]         ; => My 3DP estimates (km/s) For 1998-08-26/06:41:53.249 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  35 Hz < f < 150 Hz  at  1998-08-26/06:41:53.249 UT
;
;   06:41:53.2490-06:41:53.3498      0.542    179.458     88.540     91.460     56.873    123.127     72.496    107.504
;   06:41:53.3775-06:41:53.4602      6.171    173.829     85.489     94.511     55.081    124.919     69.473    110.527
;   06:41:53.4986-06:41:53.5695      6.952    173.048     91.278     88.722     61.024    118.976     75.295    104.705
;   06:41:53.5978-06:41:53.6799    170.734      9.266    100.015     79.985    131.131     48.869    116.072     63.928
;   06:41:53.7205-06:41:53.7882      7.585    172.415     81.917     98.083     49.921    130.079     65.900    114.100
;   06:41:53.8154-06:41:53.9050    176.449      3.551     94.141     85.859    125.984     54.016    110.176     69.824
;   06:41:53.9050-06:41:53.9397      5.306    174.694     92.301     87.699     61.605    118.395     76.282    103.718
;   06:41:53.9402-06:41:53.9802      5.032    174.968     88.799     91.201     58.404    121.596     72.794    107.206
;   06:41:54.1055-06:41:54.1610    174.309      5.691     95.972     84.028    127.813     52.187    112.005     67.995
;   06:41:54.1839-06:41:54.2159     17.587    162.413     85.988     94.012     59.392    120.608     70.585    109.415
;   06:41:54.2282-06:41:54.2618      6.411    173.589     82.949     97.051     50.988    129.012     66.928    113.072

theta_kb0826_35_150   = DBLARR(nn)
theta_kn0826_35_150   = DBLARR(nn)
theta_kn20826_35_150  = DBLARR(nn)
theta_kv0826_35_150   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_35_150[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_35_150[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_35_150[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_35_150[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_35_150[j]),  $
                     REFORM(theta_kn0826_35_150[j]),$
                     REFORM(theta_kv0826_35_150[j]),$
                     REFORM(theta_kn20826_35_150[j])
;
; => For  35 Hz < f < 150 Hz  at  1998-08-26/06:41:53.249 UT
;
;   06:41:53.2490-06:41:53.3498      0.542     88.540     56.873     72.496
;   06:41:53.3775-06:41:53.4602      6.171     85.489     55.081     69.473
;   06:41:53.4986-06:41:53.5695      6.952     88.722     61.024     75.295
;   06:41:53.5978-06:41:53.6799      9.266     79.985     48.869     63.928
;   06:41:53.7205-06:41:53.7882      7.585     81.917     49.921     65.900
;   06:41:53.8154-06:41:53.9050      3.551     85.859     54.016     69.824
;   06:41:53.9050-06:41:53.9397      5.306     87.699     61.605     76.282
;   06:41:53.9402-06:41:53.9802      5.032     88.799     58.404     72.794
;   06:41:54.1055-06:41:54.1610      5.691     84.028     52.187     67.995
;   06:41:54.1839-06:41:54.2159     17.587     85.988     59.392     70.585
;   06:41:54.2282-06:41:54.2618      6.411     82.949     50.988     66.928

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_35_150
PRINT,FORMAT=tkbf,theta_kn0826_35_150
PRINT,FORMAT=tkbf,theta_kv0826_35_150
PRINT,FORMAT=tkbf,theta_kn20826_35_150


theta_kb0826_35_150  = [ 0.54, 6.17, 6.95, 9.27, 7.58, 3.55, 5.31, 5.03, 5.69,17.59, 6.41]
theta_kn0826_35_150  = [88.54,85.49,88.72,79.98,81.92,85.86,87.70,88.80,84.03,85.99,82.95]
theta_kv0826_35_150  = [56.87,55.08,61.02,48.87,49.92,54.02,61.60,58.40,52.19,59.39,50.99]
theta_kn20826_35_150 = [72.50,69.47,75.29,63.93,65.90,69.82,76.28,72.79,67.99,70.59,66.93]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 6L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      30.0
print, hfc0, format='(";",8f10.1)'
;     150.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0641x56

;-----------------------------------------------------------------------------------------
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:56.315 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 96-381
;Plot Range: 06:41:56.3662-06:41:56.5182
;The angle between DC-Field and the k-vector is :
;       85.114 +/- 0.543 degrees
;The eigenvalues ratios are:
;       41.215552       1.0404293
;The Minimum Variance eigenvector is:
;<-0.71912, 0.34017, 0.60593> +/- <-0.04231,-0.00438,-0.04776>
;
;Plot Index Range: 175-253
;Plot Range: 06:41:56.4083-06:41:56.4499
;The angle between DC-Field and the k-vector is :
;       89.257 +/- 0.731 degrees
;The eigenvalues ratios are:
;       81.726651       1.0213823
;The Minimum Variance eigenvector is:
;<-0.70166, 0.36776, 0.61027> +/- <-0.03793, 0.00933,-0.04924>
;
;Plot Index Range: 254-316
;Plot Range: 06:41:56.4505-06:41:56.4835
;The angle between DC-Field and the k-vector is :
;       55.713 +/- 0.890 degrees
;The eigenvalues ratios are:
;       69.891152       1.0270812
;The Minimum Variance eigenvector is:
;<-0.69818, 0.32148, 0.63968> +/- <-0.04860, 0.00018,-0.05314>
;
;Plot Index Range: 317-381
;Plot Range: 06:41:56.4841-06:41:56.5182
;The angle between DC-Field and the k-vector is :
;       81.705 +/- 0.577 degrees
;The eigenvalues ratios are:
;       158.59619       1.0957155
;The Minimum Variance eigenvector is:
;<-0.72924, 0.24473, 0.63899> +/- <-0.02606,-0.03484,-0.01639>
;
;Plot Index Range: 642-797
;Plot Range: 06:41:56.6574-06:41:56.7401
;The angle between DC-Field and the k-vector is :
;       83.584 +/- 0.582 degrees
;The eigenvalues ratios are:
;       64.842003       1.0403833
;The Minimum Variance eigenvector is:
;< 0.76439,-0.25870,-0.59058> +/- <-0.00855, 0.04874,-0.03242>
;
;Plot Index Range: 819-971
;Plot Range: 06:41:56.7518-06:41:56.8329
;The angle between DC-Field and the k-vector is :
;       88.544 +/- 0.822 degrees
;The eigenvalues ratios are:
;       34.172169       1.0331742
;The Minimum Variance eigenvector is:
;<-0.73884, 0.27150, 0.61677> +/- <-0.04464,-0.06489,-0.02491>
;
;Plot Index Range: 972-1068
;Plot Range: 06:41:56.8334-06:41:56.8846
;The angle between DC-Field and the k-vector is :
;       3.154 +/- 1.099 degrees
;The eigenvalues ratios are:
;       30.555324       1.0833266
;The Minimum Variance eigenvector is:
;< 0.69332,-0.33404,-0.63853> +/- <-0.04957, 0.03862,-0.07403>
;
;Plot Index Range: 1069-1153
;Plot Range: 06:41:56.8851-06:41:56.9299
;The angle between DC-Field and the k-vector is :
;       69.968 +/- 0.907 degrees
;The eigenvalues ratios are:
;       50.009890       1.0545905
;The Minimum Variance eigenvector is:
;<-0.67065, 0.32021, 0.66910> +/- <-0.05805,-0.02858,-0.04451>
;
;Plot Index Range: 1206-1271
;Plot Range: 06:41:56.9582-06:41:56.9929
;The angle between DC-Field and the k-vector is :
;       82.617 +/- 1.797 degrees
;The eigenvalues ratios are:
;       17.834343       1.0485336
;The Minimum Variance eigenvector is:
;<-0.76972, 0.17812, 0.61303> +/- < 0.05632, 0.12719, 0.03376>
;
;Plot Index Range: 1527-1685
;Plot Range: 06:41:57.1294-06:41:57.2137
;The angle between DC-Field and the k-vector is :
;       75.688 +/- 0.957 degrees
;The eigenvalues ratios are:
;       24.794096       1.0663217
;The Minimum Variance eigenvector is:
;<-0.70929, 0.29576, 0.63986> +/- <-0.06000,-0.06527,-0.03634>
;
;Plot Index Range: 1776-2034
;Plot Range: 06:41:57.2622-06:41:57.3998
;The angle between DC-Field and the k-vector is :
;       38.968 +/- 0.739 degrees
;The eigenvalues ratios are:
;       25.319988       1.1668849
;The Minimum Variance eigenvector is:
;<-0.73789, 0.37022, 0.56431> +/- <-0.05032,-0.05863,-0.02734>
;

struct0 = stats_082698_0641x56
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:41:56.4083',prefd[0]+'06:41:56.4499'])
tr1     = time_double([prefd[0]+'06:41:56.4505',prefd[0]+'06:41:56.4835'])
tr2     = time_double([prefd[0]+'06:41:56.4841',prefd[0]+'06:41:56.5182'])
tr3     = time_double([prefd[0]+'06:41:56.6574',prefd[0]+'06:41:56.7401'])
tr4     = time_double([prefd[0]+'06:41:56.7518',prefd[0]+'06:41:56.8329'])
tr5     = time_double([prefd[0]+'06:41:56.8334',prefd[0]+'06:41:56.8846'])
tr6     = time_double([prefd[0]+'06:41:56.8851',prefd[0]+'06:41:56.9299'])
tr7     = time_double([prefd[0]+'06:41:56.9582',prefd[0]+'06:41:56.9929'])
tr8     = time_double([prefd[0]+'06:41:57.1294',prefd[0]+'06:41:57.2137'])
tr9     = time_double([prefd[0]+'06:41:57.2622',prefd[0]+'06:41:57.3998'])

kvec0   = [-0.70166, 0.36776, 0.61027]
kvec1   = [-0.69818, 0.32148, 0.63968]
kvec2   = [-0.72924, 0.24473, 0.63899]
kvec3   = [ 0.76439,-0.25870,-0.59058]
kvec4   = [-0.73884, 0.27150, 0.61677]
kvec5   = [ 0.69332,-0.33404,-0.63853]
kvec6   = [-0.67065, 0.32021, 0.66910]
kvec7   = [-0.76972, 0.17812, 0.61303]
kvec8   = [-0.70929, 0.29576, 0.63986]
kvec9   = [-0.73789, 0.37022, 0.56431]

dkvec0  = ABS([-0.03793, 0.00933,-0.04924])
dkvec1  = ABS([-0.04860, 0.00018,-0.05314])
dkvec2  = ABS([-0.02606,-0.03484,-0.01639])
dkvec3  = ABS([-0.00855, 0.04874,-0.03242])
dkvec4  = ABS([-0.04464,-0.06489,-0.02491])
dkvec5  = ABS([-0.04957, 0.03862,-0.07403])
dkvec6  = ABS([-0.05805,-0.02858,-0.04451])
dkvec7  = ABS([ 0.05632, 0.12719, 0.03376])
dkvec8  = ABS([-0.06000,-0.06527,-0.03634])
dkvec9  = ABS([-0.05032,-0.05863,-0.02734])

elam0   = [81.726651,1.0213823]
elam1   = [69.891152,1.0270812]
elam2   = [158.59619,1.0957155]
elam3   = [64.842003,1.0403833]
elam4   = [34.172169,1.0331742]
elam5   = [30.555324,1.0833266]
elam6   = [50.009890,1.0545905]
elam7   = [17.834343,1.0485336]
elam8   = [24.794096,1.0663217]
elam9   = [25.319988,1.1668849]

bvec0   = [-0.70662, 0.30808, 0.63701]
bvec1   = [-0.70540, 0.30560, 0.63954]
bvec2   = [-0.70287, 0.29850, 0.64565]
bvec3   = [-0.66893, 0.34714, 0.65678]
bvec4   = [-0.64365, 0.41604, 0.64219]
bvec5   = [-0.63018, 0.44739, 0.63457]
bvec6   = [-0.62131, 0.46437, 0.63112]
bvec7   = [-0.61584, 0.47424, 0.62916]
bvec8   = [-0.62204, 0.47015, 0.62611]
bvec9   = [-0.62723, 0.46341, 0.62596]
bmag0   = [22.68244]
bmag1   = [22.66097]
bmag2   = [22.71204]
bmag3   = [22.59012]
bmag4   = [22.21371]
bmag5   = [22.11794]
bmag6   = [22.17453]
bmag7   = [22.40475]
bmag8   = [22.36374]
bmag9   = [22.02134]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:56.315 UT
;
;   06:41:56.4083-06:41:56.4499     -0.702      0.368      0.610     -0.707      0.308      0.637     22.682
;   06:41:56.4505-06:41:56.4835     -0.698      0.321      0.640     -0.705      0.306      0.640     22.661
;   06:41:56.4841-06:41:56.5182     -0.729      0.245      0.639     -0.703      0.299      0.646     22.712
;   06:41:56.6574-06:41:56.7401      0.764     -0.259     -0.591     -0.669      0.347      0.657     22.590
;   06:41:56.7518-06:41:56.8329     -0.739      0.271      0.617     -0.644      0.416      0.642     22.214
;   06:41:56.8334-06:41:56.8846      0.693     -0.334     -0.639     -0.630      0.447      0.635     22.118
;   06:41:56.8851-06:41:56.9299     -0.671      0.320      0.669     -0.621      0.464      0.631     22.175
;   06:41:56.9582-06:41:56.9929     -0.770      0.178      0.613     -0.616      0.474      0.629     22.405
;   06:41:57.1294-06:41:57.2137     -0.709      0.296      0.640     -0.622      0.470      0.626     22.364
;   06:41:57.2622-06:41:57.3998     -0.738      0.370      0.564     -0.627      0.463      0.626     22.021

vswu   = [-618.909,38.376,-172.310]         ; => My 3DP estimates (km/s) For 1998-08-26/06:41:56.315 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:56.315 UT
;
;   06:41:56.4083-06:41:56.4499      3.757    176.243     89.189     90.811     57.772    122.228     73.140    106.860
;   06:41:56.4505-06:41:56.4835      1.016    178.984     90.696     89.304     58.714    121.286     74.661    105.339
;   06:41:56.4841-06:41:56.5182      3.461    176.539     89.677     90.323     56.990    123.010     73.749    106.251
;   06:41:56.6574-06:41:56.7401    171.500      8.500     93.769     86.231    126.326     53.674    109.721     70.279
;   06:41:56.7518-06:41:56.8329     10.070    169.930     88.295     91.705     55.836    124.164     72.319    107.681
;   06:41:56.8334-06:41:56.8846    172.548      7.452     89.200     90.800    121.044     58.956    105.242     74.758
;   06:41:56.8851-06:41:56.9299      9.011    170.989     93.005     86.995     60.995    119.005     76.971    103.029
;   06:41:56.9582-06:41:56.9929     19.233    160.767     87.188     92.812     54.077    125.923     71.441    108.559
;   06:41:57.1294-06:41:57.2137     11.222    168.778     90.346     89.654     58.102    121.898     74.335    105.665
;   06:41:57.2622-06:41:57.3998      9.025    170.975     85.835     94.165     54.509    125.491     69.783    110.217

theta_kb0826_30_150   = DBLARR(nn)
theta_kn0826_30_150   = DBLARR(nn)
theta_kn20826_30_150  = DBLARR(nn)
theta_kv0826_30_150   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_30_150[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_30_150[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_30_150[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_30_150[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_30_150[j]),  $
                     REFORM(theta_kn0826_30_150[j]),$
                     REFORM(theta_kv0826_30_150[j]),$
                     REFORM(theta_kn20826_30_150[j])
;
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:56.315 UT
;
;   06:41:56.4083-06:41:56.4499      3.757     89.189     57.772     73.140
;   06:41:56.4505-06:41:56.4835      1.016     89.304     58.714     74.661
;   06:41:56.4841-06:41:56.5182      3.461     89.677     56.990     73.749
;   06:41:56.6574-06:41:56.7401      8.500     86.231     53.674     70.279
;   06:41:56.7518-06:41:56.8329     10.070     88.295     55.836     72.319
;   06:41:56.8334-06:41:56.8846      7.452     89.200     58.956     74.758
;   06:41:56.8851-06:41:56.9299      9.011     86.995     60.995     76.971
;   06:41:56.9582-06:41:56.9929     19.233     87.188     54.077     71.441
;   06:41:57.1294-06:41:57.2137     11.222     89.654     58.102     74.335
;   06:41:57.2622-06:41:57.3998      9.025     85.835     54.509     69.783

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_30_150
PRINT,FORMAT=tkbf,theta_kn0826_30_150
PRINT,FORMAT=tkbf,theta_kv0826_30_150
PRINT,FORMAT=tkbf,theta_kn20826_30_150


theta_kb0826_30_150  = [ 3.76, 1.02, 3.46, 8.50,10.07, 7.45, 9.01,19.23,11.22, 9.02]
theta_kn0826_30_150  = [89.19,89.30,89.68,86.23,88.29,89.20,87.00,87.19,89.65,85.83]
theta_kv0826_30_150  = [57.77,58.71,56.99,53.67,55.84,58.96,61.00,54.08,58.10,54.51]
theta_kn20826_30_150 = [73.14,74.66,73.75,70.28,72.32,74.76,76.97,71.44,74.34,69.78]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 7L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      30.0
print, hfc0, format='(";",8f10.1)'
;     150.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0641x57

;-----------------------------------------------------------------------------------------
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:57.909 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 68-204
;Plot Range: 06:41:57.9453-06:41:58.0178
;The angle between DC-Field and the k-vector is :
;       75.690 +/- 0.666 degrees
;The eigenvalues ratios are:
;       56.776628       1.0441361
;The Minimum Variance eigenvector is:
;< 0.69946,-0.40614,-0.58805> +/- <-0.03266, 0.02027,-0.05285>
;
;Plot Index Range: 247-347
;Plot Range: 06:41:58.0407-06:41:58.0941
;The angle between DC-Field and the k-vector is :
;       79.168 +/- 1.711 degrees
;The eigenvalues ratios are:
;       13.250825       1.0871106
;The Minimum Variance eigenvector is:
;<-0.73531, 0.20694, 0.64537> +/- <-0.09085,-0.09207,-0.07399>
;
;Plot Index Range: 348-390
;Plot Range: 06:41:58.0946-06:41:58.1170
;The angle between DC-Field and the k-vector is :
;       78.553 +/- 0.780 degrees
;The eigenvalues ratios are:
;       133.75925       1.2015846
;The Minimum Variance eigenvector is:
;<-0.77695, 0.20943, 0.59370> +/- < 0.03265, 0.03122, 0.03171>
;
;Plot Index Range: 483-804
;Plot Range: 06:41:58.1666-06:41:58.3378
;The angle between DC-Field and the k-vector is :
;       80.362 +/- 0.590 degrees
;The eigenvalues ratios are:
;       31.487686       1.0172186
;The Minimum Variance eigenvector is:
;<-0.76054, 0.28052, 0.58556> +/- < 0.04103, 0.05131, 0.02872>
;
;Plot Index Range: 483-551
;Plot Range: 06:41:58.1666-06:41:58.2029
;The angle between DC-Field and the k-vector is :
;       65.952 +/- 1.414 degrees
;The eigenvalues ratios are:
;       26.465349       1.0410327
;The Minimum Variance eigenvector is:
;<-0.76155, 0.25899, 0.59411> +/- < 0.06198, 0.08814, 0.04102>
;
;Plot Index Range: 597-778
;Plot Range: 06:41:58.2274-06:41:58.3239
;The angle between DC-Field and the k-vector is :
;       70.702 +/- 0.657 degrees
;The eigenvalues ratios are:
;       44.176349       1.0355746
;The Minimum Variance eigenvector is:
;<-0.75206, 0.29026, 0.59174> +/- < 0.04535, 0.02994, 0.04294>
;
;Plot Index Range: 849-927
;Plot Range: 06:41:58.3618-06:41:58.4034
;The angle between DC-Field and the k-vector is :
;       89.154 +/- 1.720 degrees
;The eigenvalues ratios are:
;       16.349479       1.3005424
;The Minimum Variance eigenvector is:
;<-0.63854, 0.24379, 0.72996> +/- <-0.09090,-0.08753,-0.05028>
;
;Plot Index Range: 973-1063
;Plot Range: 06:41:58.4279-06:41:58.4759
;The angle between DC-Field and the k-vector is :
;       10.983 +/- 0.583 degrees
;The eigenvalues ratios are:
;       110.47582       1.0307918
;The Minimum Variance eigenvector is:
;<-0.68236, 0.48338, 0.54838> +/- <-0.03629,-0.01097,-0.03549>
;
;Plot Index Range: 1063-1152
;Plot Range: 06:41:58.4759-06:41:58.5234
;The angle between DC-Field and the k-vector is :
;       64.696 +/- 1.453 degrees
;The eigenvalues ratios are:
;       19.609831       1.1260466
;The Minimum Variance eigenvector is:
;< 0.78393,-0.31785,-0.53331> +/- < 0.04643, 0.11444, 0.00004>
;
;Plot Index Range: 1231-1321
;Plot Range: 06:41:58.5655-06:41:58.6135
;The angle between DC-Field and the k-vector is :
;       41.308 +/- 0.616 degrees
;The eigenvalues ratios are:
;       99.257377       1.2330834
;The Minimum Variance eigenvector is:
;<-0.65764, 0.47323, 0.58614> +/- <-0.03919,-0.01577,-0.03124>
;
;Plot Index Range: 1322-1496
;Plot Range: 06:41:58.6141-06:41:58.7069
;The angle between DC-Field and the k-vector is :
;       40.237 +/- 0.616 degrees
;The eigenvalues ratios are:
;       51.923459       1.1399952
;The Minimum Variance eigenvector is:
;<-0.78878, 0.32017, 0.52471> +/- <-0.03861,-0.02903,-0.04032>
;
;Plot Index Range: 1521-1591
;Plot Range: 06:41:58.7202-06:41:58.7575
;The angle between DC-Field and the k-vector is :
;       60.363 +/- 1.706 degrees
;The eigenvalues ratios are:
;       18.291772       1.8304973
;The Minimum Variance eigenvector is:
;<-0.06527,-0.00717, 0.99784> +/- < 0.11738, 0.03530, 0.00793>
;
;Plot Index Range: 1667-1726
;Plot Range: 06:41:58.7981-06:41:58.8295
;The angle between DC-Field and the k-vector is :
;       69.909 +/- 1.622 degrees
;The eigenvalues ratios are:
;       23.457846       1.1202276
;The Minimum Variance eigenvector is:
;< 0.56993,-0.41903,-0.70683> +/- < 0.06403, 0.10668,-0.01161>
;
;Plot Index Range: 1749-1817
;Plot Range: 06:41:58.8418-06:41:58.8781
;The angle between DC-Field and the k-vector is :
;       73.079 +/- 1.565 degrees
;The eigenvalues ratios are:
;       21.967218       1.1684371
;The Minimum Variance eigenvector is:
;< 0.66194,-0.41899,-0.62151> +/- < 0.05831, 0.10828,-0.01089>
;
;Plot Index Range: 1900-2022
;Plot Range: 06:41:58.9223-06:41:58.9874
;The angle between DC-Field and the k-vector is :
;       82.549 +/- 0.715 degrees
;The eigenvalues ratios are:
;       54.982449       1.0423804
;The Minimum Variance eigenvector is:
;< 0.70517,-0.38336,-0.59647> +/- < 0.03137, 0.06064,-0.00189>
;

struct0 = stats_082698_0641x57
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:41:57.9453',prefd[0]+'06:41:58.0178'])
tr1     = time_double([prefd[0]+'06:41:58.0407',prefd[0]+'06:41:58.0941'])
tr2     = time_double([prefd[0]+'06:41:58.0946',prefd[0]+'06:41:58.1170'])
tr3     = time_double([prefd[0]+'06:41:58.1666',prefd[0]+'06:41:58.2029'])
tr4     = time_double([prefd[0]+'06:41:58.2274',prefd[0]+'06:41:58.3239'])
tr5     = time_double([prefd[0]+'06:41:58.3618',prefd[0]+'06:41:58.4034'])
tr6     = time_double([prefd[0]+'06:41:58.4279',prefd[0]+'06:41:58.4759'])
tr7     = time_double([prefd[0]+'06:41:58.4759',prefd[0]+'06:41:58.5234'])
tr8     = time_double([prefd[0]+'06:41:58.5655',prefd[0]+'06:41:58.6135'])
tr9     = time_double([prefd[0]+'06:41:58.6141',prefd[0]+'06:41:58.7069'])
tr10    = time_double([prefd[0]+'06:41:58.7202',prefd[0]+'06:41:58.7575'])
tr11    = time_double([prefd[0]+'06:41:58.7981',prefd[0]+'06:41:58.8295'])
tr12    = time_double([prefd[0]+'06:41:58.8418',prefd[0]+'06:41:58.8781'])
tr13    = time_double([prefd[0]+'06:41:58.9223',prefd[0]+'06:41:58.9874'])

kvec0   = [ 0.69946,-0.40614,-0.58805]
kvec1   = [-0.73531, 0.20694, 0.64537]
kvec2   = [-0.77695, 0.20943, 0.59370]
kvec3   = [-0.76155, 0.25899, 0.59411]
kvec4   = [-0.75206, 0.29026, 0.59174]
kvec5   = [-0.63854, 0.24379, 0.72996]
kvec6   = [-0.68236, 0.48338, 0.54838]
kvec7   = [ 0.78393,-0.31785,-0.53331]
kvec8   = [-0.65764, 0.47323, 0.58614]
kvec9   = [-0.78878, 0.32017, 0.52471]
kvec10  = [-0.06527,-0.00717, 0.99784]
kvec11  = [ 0.56993,-0.41903,-0.70683]
kvec12  = [ 0.66194,-0.41899,-0.62151]
kvec13  = [ 0.70517,-0.38336,-0.59647]

dkvec0  = ABS([-0.03266, 0.02027,-0.05285])
dkvec1  = ABS([-0.09085,-0.09207,-0.07399])
dkvec2  = ABS([ 0.03265, 0.03122, 0.03171])
dkvec3  = ABS([ 0.06198, 0.08814, 0.04102])
dkvec4  = ABS([ 0.04535, 0.02994, 0.04294])
dkvec5  = ABS([-0.09090,-0.08753,-0.05028])
dkvec6  = ABS([-0.03629,-0.01097,-0.03549])
dkvec7  = ABS([ 0.04643, 0.11444, 0.00004])
dkvec8  = ABS([-0.03919,-0.01577,-0.03124])
dkvec9  = ABS([-0.03861,-0.02903,-0.04032])
dkvec10 = ABS([ 0.11738, 0.03530, 0.00793])
dkvec11 = ABS([ 0.06403, 0.10668,-0.01161])
dkvec12 = ABS([ 0.05831, 0.10828,-0.01089])
dkvec13 = ABS([ 0.03137, 0.06064,-0.00189])

elam0   = [56.776628,1.0441361]
elam1   = [13.250825,1.0871106]
elam2   = [133.75925,1.2015846]
elam3   = [26.465349,1.0410327]
elam4   = [44.176349,1.0355746]
elam5   = [16.349479,1.3005424]
elam6   = [110.47582,1.0307918]
elam7   = [19.609831,1.1260466]
elam8   = [99.257377,1.2330834]
elam9   = [51.923459,1.1399952]
elam10  = [18.291772,1.8304973]
elam11  = [23.457846,1.1202276]
elam12  = [21.967218,1.1684371]
elam13  = [54.982449,1.0423804]

bvec0   = [-0.70341, 0.31087, 0.63919]
bvec1   = [-0.70318, 0.30140, 0.64396]
bvec2   = [-0.70573, 0.29406, 0.64458]
bvec3   = [-0.70227, 0.30172, 0.64481]
bvec4   = [-0.69872, 0.31332, 0.64313]
bvec5   = [-0.69229, 0.31891, 0.64733]
bvec6   = [-0.68340, 0.31974, 0.65629]
bvec7   = [-0.67936, 0.32190, 0.65943]
bvec8   = [-0.68066, 0.33197, 0.65306]
bvec9   = [-0.67829, 0.33670, 0.65311]
bvec10  = -0.67570, 0.33874, 0.65474]
bvec11  = -0.67492, 0.33952, 0.65514]
bvec12  = -0.67485, 0.33865, 0.65566]
bvec13  = -0.67474, 0.32887, 0.66073]
bmag0   = [22.92490]
bmag1   = [22.82689]
bmag2   = [22.74834]
bmag3   = [22.70143]
bmag4   = [22.90626]
bmag5   = [22.95597]
bmag6   = [23.15103]
bmag7   = [23.23489]
bmag8   = [23.10665]
bmag9   = [23.14444]
bmag10  = 23.22434]
bmag11  = 23.22989]
bmag12  = 23.22379]
bmag13  = 23.29114]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,$
                        tr13)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9,kvec10,kvec11,kvec12,kvec13)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:57.909 UT
;
;   06:41:57.9453-06:41:58.0178      0.699     -0.406     -0.588     -0.703      0.311      0.639     22.925
;   06:41:58.0407-06:41:58.0941     -0.735      0.207      0.645     -0.703      0.301      0.644     22.827
;   06:41:58.0946-06:41:58.1170     -0.777      0.209      0.594     -0.706      0.294      0.645     22.748
;   06:41:58.1666-06:41:58.2029     -0.762      0.259      0.594     -0.702      0.302      0.645     22.701
;   06:41:58.2274-06:41:58.3239     -0.752      0.290      0.592     -0.699      0.313      0.643     22.906
;   06:41:58.3618-06:41:58.4034     -0.639      0.244      0.730     -0.692      0.319      0.647     22.956
;   06:41:58.4279-06:41:58.4759     -0.682      0.483      0.548     -0.683      0.320      0.656     23.151
;   06:41:58.4759-06:41:58.5234      0.784     -0.318     -0.533     -0.679      0.322      0.659     23.235
;   06:41:58.5655-06:41:58.6135     -0.658      0.473      0.586     -0.681      0.332      0.653     23.107
;   06:41:58.6141-06:41:58.7069     -0.789      0.320      0.525     -0.678      0.337      0.653     23.144
;   06:41:58.7202-06:41:58.7575     -0.065     -0.007      0.998     -0.676      0.339      0.655     23.224
;   06:41:58.7981-06:41:58.8295      0.570     -0.419     -0.707     -0.675      0.340      0.655     23.230
;   06:41:58.8418-06:41:58.8781      0.662     -0.419     -0.622     -0.675      0.339      0.656     23.224
;   06:41:58.9223-06:41:58.9874      0.705     -0.383     -0.596     -0.675      0.329      0.661     23.291

vswu   = [-620.820,39.779,-171.913]         ; => My 3DP estimates (km/s) For 1998-08-26/06:41:57.909 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:57.909 UT
;
;   06:41:57.9453-06:41:58.0178    173.795      6.205     91.777     88.223    122.766     57.234    107.807     72.193
;   06:41:58.0407-06:41:58.0941      5.720    174.280     89.811     90.189     56.760    123.240     73.973    106.027
;   06:41:58.0946-06:41:58.1170      6.982    173.018     86.007     93.993     52.978    127.022     70.170    109.830
;   06:41:58.1666-06:41:58.2029      5.098    174.902     86.490     93.510     53.825    126.175     70.537    109.463
;   06:41:58.2274-06:41:58.3239      4.450    175.550     86.673     93.327     54.290    125.710     70.669    109.331
;   06:41:58.3618-06:41:58.4034      7.104    172.896     97.030     82.970     64.227    115.773     81.092     98.908
;   06:41:58.4279-06:41:58.4759     11.251    168.749     86.973     93.027     57.310    122.690     71.074    108.926
;   06:41:58.4759-06:41:58.5234    170.598      9.402     97.127     82.873    129.168     50.832    113.162     66.838
;   06:41:58.5655-06:41:58.6135      9.063    170.937     89.557     90.443     59.627    120.373     73.635    106.365
;   06:41:58.6141-06:41:58.7069      9.764    170.236     82.309     97.691     50.305    129.695     66.272    113.728
;   06:41:58.7202-06:41:58.7575     45.973    134.027    135.227     44.773    101.739     78.261    119.943     60.057
;   06:41:58.7981-06:41:58.8295    171.890      8.110     81.785     98.215    112.692     67.308     97.784     82.216
;   06:41:58.8418-06:41:58.8781    174.939      5.061     88.952     91.048    119.802     60.198    104.966     75.034
;   06:41:58.9223-06:41:58.9874    174.867      5.133     91.575     88.425    122.892     57.108    107.620     72.380

theta_kb0826_30_150_2   = DBLARR(nn)
theta_kn0826_30_150_2   = DBLARR(nn)
theta_kn20826_30_150_2  = DBLARR(nn)
theta_kv0826_30_150_2   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_30_150_2[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_30_150_2[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_30_150_2[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_30_150_2[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_30_150_2[j]),  $
                     REFORM(theta_kn0826_30_150_2[j]),$
                     REFORM(theta_kv0826_30_150_2[j]),$
                     REFORM(theta_kn20826_30_150_2[j])
;
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:57.909 UT
;
;   06:41:57.9453-06:41:58.0178      6.205     88.223     57.234     72.193
;   06:41:58.0407-06:41:58.0941      5.720     89.811     56.760     73.973
;   06:41:58.0946-06:41:58.1170      6.982     86.007     52.978     70.170
;   06:41:58.1666-06:41:58.2029      5.098     86.490     53.825     70.537
;   06:41:58.2274-06:41:58.3239      4.450     86.673     54.290     70.669
;   06:41:58.3618-06:41:58.4034      7.104     82.970     64.227     81.092
;   06:41:58.4279-06:41:58.4759     11.251     86.973     57.310     71.074
;   06:41:58.4759-06:41:58.5234      9.402     82.873     50.832     66.838
;   06:41:58.5655-06:41:58.6135      9.063     89.557     59.627     73.635
;   06:41:58.6141-06:41:58.7069      9.764     82.309     50.305     66.272
;   06:41:58.7202-06:41:58.7575     45.973     44.773     78.261     60.057
;   06:41:58.7981-06:41:58.8295      8.110     81.785     67.308     82.216
;   06:41:58.8418-06:41:58.8781      5.061     88.952     60.198     75.034
;   06:41:58.9223-06:41:58.9874      5.133     88.425     57.108     72.380

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_30_150_2
PRINT,FORMAT=tkbf,theta_kn0826_30_150_2
PRINT,FORMAT=tkbf,theta_kv0826_30_150_2
PRINT,FORMAT=tkbf,theta_kn20826_30_150_2


theta_kb0826_30_150_2  = [ 6.21, 5.72, 6.98, 5.10, 4.45, 7.10,11.25, 9.40, 9.06, 9.76,45.97, 8.11, 5.06, 5.13]
theta_kn0826_30_150_2  = [88.22,89.81,86.01,86.49,86.67,82.97,86.97,82.87,89.56,82.31,44.77,81.79,88.95,88.43]
theta_kv0826_30_150_2  = [57.23,56.76,52.98,53.83,54.29,64.23,57.31,50.83,59.63,50.31,78.26,67.31,60.20,57.11]
theta_kn20826_30_150_2 = [72.19,73.97,70.17,70.54,70.67,81.09,71.07,66.84,73.64,66.27,60.06,82.22,75.03,72.38]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 8L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      30.0
print, hfc0, format='(";",8f10.1)'
;     150.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0641x59

;-----------------------------------------------------------------------------------------
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:59.233 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 38-239
;Plot Range: 06:41:59.2533-06:41:59.3605
;The angle between DC-Field and the k-vector is :
;       69.953 +/- 0.515 degrees
;The eigenvalues ratios are:
;       63.862653       1.0490634
;The Minimum Variance eigenvector is:
;<-0.70808, 0.37290, 0.59964> +/- <-0.03771,-0.03352,-0.02368>
;
;Plot Index Range: 263-452
;Plot Range: 06:41:59.3733-06:41:59.4741
;The angle between DC-Field and the k-vector is :
;       59.054 +/- 0.747 degrees
;The eigenvalues ratios are:
;       33.267954       1.0975649
;The Minimum Variance eigenvector is:
;<-0.60926, 0.36730, 0.70278> +/- <-0.05914,-0.00046,-0.05102>
;
;Plot Index Range: 848-972
;Plot Range: 06:41:59.6853-06:41:59.7514
;The angle between DC-Field and the k-vector is :
;       78.005 +/- 0.565 degrees
;The eigenvalues ratios are:
;       85.550629       1.0431188
;The Minimum Variance eigenvector is:
;<-0.72152, 0.25778, 0.64262> +/- <-0.03433,-0.03396,-0.02492>
;
;Plot Index Range: 992-1144
;Plot Range: 06:41:59.7621-06:41:59.8431
;The angle between DC-Field and the k-vector is :
;       9.966 +/- 0.871 degrees
;The eigenvalues ratios are:
;       30.605358       1.0460319
;The Minimum Variance eigenvector is:
;<-0.80005, 0.22679, 0.55542> +/- <-0.04672,-0.05981,-0.04288>
;
;Plot Index Range: 1179-1313
;Plot Range: 06:41:59.8618-06:41:59.9333
;The angle between DC-Field and the k-vector is :
;       70.621 +/- 0.676 degrees
;The eigenvalues ratios are:
;       55.939098       1.1386847
;The Minimum Variance eigenvector is:
;< 0.78940,-0.25745,-0.55729> +/- <-0.02525, 0.03174,-0.05043>
;
;Plot Index Range: 1404-1484
;Plot Range: 06:41:59.9818-06:42:00.0245
;The angle between DC-Field and the k-vector is :
;       62.582 +/- 1.200 degrees
;The eigenvalues ratios are:
;       30.838095       1.1280847
;The Minimum Variance eigenvector is:
;< 0.64275,-0.38038,-0.66496> +/- <-0.04491, 0.05184,-0.07306>
;
;Plot Index Range: 1597-1665
;Plot Range: 06:42:00.0847-06:42:00.1210
;The angle between DC-Field and the k-vector is :
;       84.474 +/- 2.113 degrees
;The eigenvalues ratios are:
;       12.901196       1.1734808
;The Minimum Variance eigenvector is:
;< 0.76937,-0.35960,-0.52798> +/- < 0.04656, 0.15254,-0.03604>
;
;Plot Index Range: 1864-1999
;Plot Range: 06:42:00.2271-06:42:00.2991
;The angle between DC-Field and the k-vector is :
;       89.263 +/- 1.351 degrees
;The eigenvalues ratios are:
;       15.364887       1.0556720
;The Minimum Variance eigenvector is:
;< 0.70212,-0.38897,-0.59643> +/- <-0.04783, 0.06607,-0.09939>
;

struct0 = stats_082698_0641x59
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:41:59.2533',prefd[0]+'06:41:59.3605'])
tr1     = time_double([prefd[0]+'06:41:59.3733',prefd[0]+'06:41:59.4741'])
tr2     = time_double([prefd[0]+'06:41:59.6853',prefd[0]+'06:41:59.7514'])
tr3     = time_double([prefd[0]+'06:41:59.7621',prefd[0]+'06:41:59.8431'])
tr4     = time_double([prefd[0]+'06:41:59.8618',prefd[0]+'06:41:59.9333'])
tr5     = time_double([prefd[0]+'06:41:59.9818',prefd[0]+'06:42:00.0245'])
tr6     = time_double([prefd[0]+'06:42:00.0847',prefd[0]+'06:42:00.1210'])
tr7     = time_double([prefd[0]+'06:42:00.2271',prefd[0]+'06:42:00.2991'])

kvec0   = [-0.70808, 0.37290, 0.59964]
kvec1   = [-0.60926, 0.36730, 0.70278]
kvec2   = [-0.72152, 0.25778, 0.64262]
kvec3   = [-0.80005, 0.22679, 0.55542]
kvec4   = [ 0.78940,-0.25745,-0.55729]
kvec5   = [ 0.64275,-0.38038,-0.66496]
kvec6   = [ 0.76937,-0.35960,-0.52798]
kvec7   = [ 0.70212,-0.38897,-0.59643]

dkvec0  = ABS([-0.03771,-0.03352,-0.02368])
dkvec1  = ABS([-0.05914,-0.00046,-0.05102])
dkvec2  = ABS([-0.03433,-0.03396,-0.02492])
dkvec3  = ABS([-0.04672,-0.05981,-0.04288])
dkvec4  = ABS([-0.02525, 0.03174,-0.05043])
dkvec5  = ABS([-0.04491, 0.05184,-0.07306])
dkvec6  = ABS([ 0.04656, 0.15254,-0.03604])
dkvec7  = ABS([-0.04783, 0.06607,-0.09939])

elam0   = [63.862653,1.0490634]
elam1   = [33.267954,1.0975649]
elam2   = [85.550629,1.0431188]
elam3   = [30.605358,1.0460319]
elam4   = [55.939098,1.1386847]
elam5   = [30.838095,1.1280847]
elam6   = [12.901196,1.1734808]
elam7   = [15.364887,1.0556720]

bvec0   = [-0.66915, 0.34159, 0.65996]
bvec1   = [-0.66965, 0.35371, 0.65303]
bvec2   = [-0.68565, 0.34109, 0.64306]
bvec3   = [-0.69202, 0.32187, 0.64607]
bvec4   = [-0.69914, 0.29971, 0.64913]
bvec5   = [-0.70414, 0.29858, 0.64422]
bvec6   = [-0.71262, 0.28753, 0.63993]
bvec7   = [-0.71044, 0.29128, 0.64064]
bmag0   = [23.24000]
bmag1   = [23.14751]
bmag2   = [22.91241]
bmag3   = [22.63211]
bmag4   = [22.39244]
bmag5   = [22.20046]
bmag6   = [22.01527]
bmag7   = [22.28983]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:59.233 UT
;
;   06:41:59.2533-06:41:59.3605     -0.708      0.373      0.600     -0.669      0.342      0.660     23.240
;   06:41:59.3733-06:41:59.4741     -0.609      0.367      0.703     -0.670      0.354      0.653     23.148
;   06:41:59.6853-06:41:59.7514     -0.722      0.258      0.643     -0.686      0.341      0.643     22.912
;   06:41:59.7621-06:41:59.8431     -0.800      0.227      0.555     -0.692      0.322      0.646     22.632
;   06:41:59.8618-06:41:59.9333      0.789     -0.257     -0.557     -0.699      0.300      0.649     22.392
;   06:41:59.9818-06:42:00.0245      0.643     -0.380     -0.665     -0.704      0.299      0.644     22.200
;   06:42:00.0847-06:42:00.1210      0.769     -0.360     -0.528     -0.713      0.288      0.640     22.015
;   06:42:00.2271-06:42:00.2991      0.702     -0.389     -0.596     -0.710      0.291      0.641     22.290

vswu   = [-617.455,45.240,-175.425]         ; => My 3DP estimates (km/s) For 1998-08-26/06:41:59.233 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:59.233 UT
;
;   06:41:59.2533-06:41:59.3605      4.493    175.507     88.477     91.523     57.168    122.832     72.428    107.572
;   06:41:59.3733-06:41:59.4741      4.553    175.447     96.669     83.331     65.238    114.762     80.627     99.373
;   06:41:59.6853-06:41:59.7514      5.200    174.800     90.093     89.907     57.638    122.362     74.140    105.860
;   06:41:59.7621-06:41:59.8431      9.774    170.226     83.436     96.564     50.786    129.214     67.555    112.445
;   06:41:59.8618-06:41:59.9333    172.228      7.772     96.152     83.848    128.583     51.417    112.101     67.899
;   06:41:59.9818-06:42:00.0245    174.012      5.988     86.264     93.736    117.530     62.470    102.305     77.695
;   06:42:00.0847-06:42:00.1210    171.701      8.299     96.905     83.095    128.287     51.713    112.959     67.041
;   06:42:00.2271-06:42:00.2991    173.831      6.169     91.475     88.525    122.579     57.421    107.517     72.483

theta_kb0826_30_150_3   = DBLARR(nn)
theta_kn0826_30_150_3   = DBLARR(nn)
theta_kn20826_30_150_3  = DBLARR(nn)
theta_kv0826_30_150_3   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_30_150_3[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_30_150_3[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_30_150_3[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_30_150_3[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_30_150_3[j]),  $
                     REFORM(theta_kn0826_30_150_3[j]),$
                     REFORM(theta_kv0826_30_150_3[j]),$
                     REFORM(theta_kn20826_30_150_3[j])
;
; => For  30 Hz < f < 150 Hz  at  1998-08-26/06:41:59.233 UT
;
;   06:41:59.2533-06:41:59.3605      4.493     88.477     57.168     72.428
;   06:41:59.3733-06:41:59.4741      4.553     83.331     65.238     80.627
;   06:41:59.6853-06:41:59.7514      5.200     89.907     57.638     74.140
;   06:41:59.7621-06:41:59.8431      9.774     83.436     50.786     67.555
;   06:41:59.8618-06:41:59.9333      7.772     83.848     51.417     67.899
;   06:41:59.9818-06:42:00.0245      5.988     86.264     62.470     77.695
;   06:42:00.0847-06:42:00.1210      8.299     83.095     51.713     67.041
;   06:42:00.2271-06:42:00.2991      6.169     88.525     57.421     72.483

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_30_150_3
PRINT,FORMAT=tkbf,theta_kn0826_30_150_3
PRINT,FORMAT=tkbf,theta_kv0826_30_150_3
PRINT,FORMAT=tkbf,theta_kn20826_30_150_3


theta_kb0826_30_150_3  = [ 4.49, 4.55, 5.20, 9.77, 7.77, 5.99, 8.30, 6.17]
theta_kn0826_30_150_3  = [88.48,83.33,89.91,83.44,83.85,86.26,83.09,88.53]
theta_kv0826_30_150_3  = [57.17,65.24,57.64,50.79,51.42,62.47,51.71,57.42]
theta_kn20826_30_150_3 = [72.43,80.63,74.14,67.56,67.90,77.70,67.04,72.48]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 9L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      40.0
print, hfc0, format='(";",8f10.1)'
;     200.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0642x05

;-----------------------------------------------------------------------------------------
; => For  40 Hz < f < 200 Hz  at  1998-08-26/06:42:05.763 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 288-1148
;Plot Range: 06:42:05.9166-06:42:06.3753
;The angle between DC-Field and the k-vector is :
;       1.319 +/- 0.221 degrees
;The eigenvalues ratios are:
;       80.167828       1.0363719
;The Minimum Variance eigenvector is:
;<-0.72723,-0.03132, 0.68568> +/- <-0.01016,-0.03075,-0.01218>
;
;Plot Index Range: 288-395
;Plot Range: 06:42:05.9166-06:42:05.9737
;The angle between DC-Field and the k-vector is :
;       80.015 +/- 0.623 degrees
;The eigenvalues ratios are:
;       81.799620       1.0472895
;The Minimum Variance eigenvector is:
;<-0.70233,-0.04321, 0.71054> +/- < 0.03911, 0.01504, 0.03958>
;
;Plot Index Range: 396-555
;Plot Range: 06:42:05.9742-06:42:06.0590
;The angle between DC-Field and the k-vector is :
;       87.400 +/- 0.402 degrees
;The eigenvalues ratios are:
;       130.25913       1.0250858
;The Minimum Variance eigenvector is:
;<-0.74212,-0.02971, 0.66961> +/- <-0.01507,-0.03407,-0.01821>
;
;Plot Index Range: 556-688
;Plot Range: 06:42:06.0595-06:42:06.1299
;The angle between DC-Field and the k-vector is :
;       78.355 +/- 0.317 degrees
;The eigenvalues ratios are:
;       250.63236       1.0710043
;The Minimum Variance eigenvector is:
;<-0.72277, 0.01366, 0.69096> +/- <-0.01093,-0.02681,-0.01090>
;
;Plot Index Range: 689-894
;Plot Range: 06:42:06.1305-06:42:06.2398
;The angle between DC-Field and the k-vector is :
;       86.984 +/- 0.512 degrees
;The eigenvalues ratios are:
;       63.346781       1.0600819
;The Minimum Variance eigenvector is:
;<-0.74717,-0.08665, 0.65896> +/- <-0.02488,-0.03703,-0.03308>
;
;Plot Index Range: 906-1096
;Plot Range: 06:42:06.2462-06:42:06.3475
;The angle between DC-Field and the k-vector is :
;       1.654 +/- 0.447 degrees
;The eigenvalues ratios are:
;       88.783803       1.0802446
;The Minimum Variance eigenvector is:
;<-0.70841,-0.00184, 0.70580> +/- <-0.01701,-0.04088,-0.01718>
;
;Plot Index Range: 1144-1215
;Plot Range: 06:42:06.3731-06:42:06.4110
;The angle between DC-Field and the k-vector is :
;       65.688 +/- 0.850 degrees
;The eigenvalues ratios are:
;       66.939244       1.0565737
;The Minimum Variance eigenvector is:
;< 0.76314, 0.12361,-0.63430> +/- <-0.02084, 0.06638,-0.01214>
;
;Plot Index Range: 1291-1488
;Plot Range: 06:42:06.4515-06:42:06.5566
;The angle between DC-Field and the k-vector is :
;       85.414 +/- 0.631 degrees
;The eigenvalues ratios are:
;       44.099089       1.0605337
;The Minimum Variance eigenvector is:
;<-0.67356,-0.05522, 0.73706> +/- <-0.01603,-0.06261,-0.01934>
;
;Plot Index Range: 1520-1800
;Plot Range: 06:42:06.5737-06:42:06.7230
;The angle between DC-Field and the k-vector is :
;       57.560 +/- 0.675 degrees
;The eigenvalues ratios are:
;       27.805898       1.1346938
;The Minimum Variance eigenvector is:
;<-0.65079, 0.04683, 0.75782> +/- <-0.04595,-0.04995,-0.03637>
;
;Plot Index Range: 1520-1659
;Plot Range: 06:42:06.5737-06:42:06.6478
;The angle between DC-Field and the k-vector is :
;       84.099 +/- 0.847 degrees
;The eigenvalues ratios are:
;       35.157734       1.3644207
;The Minimum Variance eigenvector is:
;< 0.65235, 0.01233,-0.75781> +/- <-0.04024, 0.05773,-0.03370>
;
;Plot Index Range: 1660-1800
;Plot Range: 06:42:06.6483-06:42:06.7230
;The angle between DC-Field and the k-vector is :
;       88.730 +/- 1.051 degrees
;The eigenvalues ratios are:
;       23.327832       1.2197354
;The Minimum Variance eigenvector is:
;<-0.64128, 0.11754, 0.75825> +/- < 0.04766, 0.08190, 0.02761>
;
;Plot Index Range: 1806-1919
;Plot Range: 06:42:06.7262-06:42:06.7865
;The angle between DC-Field and the k-vector is :
;       84.430 +/- 0.862 degrees
;The eigenvalues ratios are:
;       41.460500       1.3833670
;The Minimum Variance eigenvector is:
;<-0.75391, 0.09869, 0.64952> +/- < 0.03494, 0.05876, 0.03163>
;
;Plot Index Range: 1951-2047
;Plot Range: 06:42:06.8035-06:42:06.8547
;The angle between DC-Field and the k-vector is :
;       11.985 +/- 0.481 degrees
;The eigenvalues ratios are:
;       151.40903       1.1111955
;The Minimum Variance eigenvector is:
;<-0.55192,-0.07111, 0.83086> +/- <-0.03137,-0.01858,-0.02243>
;

struct0 = stats_082698_0642x05
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:42:05.9166',prefd[0]+'06:42:05.9737'])
tr1     = time_double([prefd[0]+'06:42:05.9742',prefd[0]+'06:42:06.0590'])
tr2     = time_double([prefd[0]+'06:42:06.0595',prefd[0]+'06:42:06.1299'])
tr3     = time_double([prefd[0]+'06:42:06.1305',prefd[0]+'06:42:06.2398'])
tr4     = time_double([prefd[0]+'06:42:06.2462',prefd[0]+'06:42:06.3475'])
tr5     = time_double([prefd[0]+'06:42:06.3731',prefd[0]+'06:42:06.4110'])
tr6     = time_double([prefd[0]+'06:42:06.4515',prefd[0]+'06:42:06.5566'])
tr7     = time_double([prefd[0]+'06:42:06.5737',prefd[0]+'06:42:06.6478'])
tr8     = time_double([prefd[0]+'06:42:06.6483',prefd[0]+'06:42:06.7230'])
tr9     = time_double([prefd[0]+'06:42:06.7262',prefd[0]+'06:42:06.7865'])
tr10    = time_double([prefd[0]+'06:42:06.8035',prefd[0]+'06:42:06.8547'])

kvec0   = [-0.70233,-0.04321, 0.71054]
kvec1   = [-0.74212,-0.02971, 0.66961]
kvec2   = [-0.72277, 0.01366, 0.69096]
kvec3   = [-0.74717,-0.08665, 0.65896]
kvec4   = [-0.70841,-0.00184, 0.70580]
kvec5   = [ 0.76314, 0.12361,-0.63430]
kvec6   = [-0.67356,-0.05522, 0.73706]
kvec7   = [ 0.65235, 0.01233,-0.75781]
kvec8   = [-0.64128, 0.11754, 0.75825]
kvec9   = [-0.75391, 0.09869, 0.64952]
kvec10  = [-0.55192,-0.07111, 0.83086]

dkvec0  = ABS([ 0.03911, 0.01504, 0.03958])
dkvec1  = ABS([-0.01507,-0.03407,-0.01821])
dkvec2  = ABS([-0.01093,-0.02681,-0.01090])
dkvec3  = ABS([-0.02488,-0.03703,-0.03308])
dkvec4  = ABS([-0.01701,-0.04088,-0.01718])
dkvec5  = ABS([-0.02084, 0.06638,-0.01214])
dkvec6  = ABS([-0.01603,-0.06261,-0.01934])
dkvec7  = ABS([-0.04024, 0.05773,-0.03370])
dkvec8  = ABS([ 0.04766, 0.08190, 0.02761])
dkvec9  = ABS([ 0.03494, 0.05876, 0.03163])
dkvec10 = ABS([-0.03137,-0.01858,-0.02243])

elam0   = [81.799620,1.0472895]
elam1   = [130.25913,1.0250858]
elam2   = [250.63236,1.0710043]
elam3   = [63.346781,1.0600819]
elam4   = [88.783803,1.0802446]
elam5   = [66.939244,1.0565737]
elam6   = [44.099089,1.0605337]
elam7   = [35.157734,1.3644207]
elam8   = [23.327832,1.2197354]
elam9   = [41.460500,1.3833670]
elam10  = [151.40903,1.1111955]

bvec0   = [-0.72532,-0.03620, 0.68742]
bvec1   = [-0.73649,-0.06588, 0.67315]
bvec2   = [-0.74452,-0.07290, 0.66360]
bvec3   = [-0.74628,-0.08145, 0.66062]
bvec4   = [-0.74196,-0.06997, 0.66673]
bvec5   = [-0.72941,-0.04611, 0.68251]
bvec6   = [-0.71540,-0.02219, 0.69835]
bvec7   = [-0.72215,-0.02966, 0.69109]
bvec8   = [-0.72191,-0.04130, 0.69075]
bvec9   = [-0.71961,-0.04429, 0.69297]
bvec10  = -0.71426,-0.04714, 0.69829]
bmag0   = [21.71395]
bmag1   = [21.69367]
bmag2   = [21.60414]
bmag3   = [21.70569]
bmag4   = [22.06434]
bmag5   = [22.17538]
bmag6   = [21.69396]
bmag7   = [21.33414]
bmag8   = [21.30489]
bmag9   = [21.34068]
bmag10  = 21.27862]

tags    = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                        kvec9,kvec10)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,$
                        dkvec8,dkvec9,dkvec10)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  40 Hz < f < 200 Hz  at  1998-08-26/06:42:05.763 UT
;
;   06:42:05.9166-06:42:05.9737     -0.702     -0.043      0.711     -0.725     -0.036      0.687     21.714
;   06:42:05.9742-06:42:06.0590     -0.742     -0.030      0.670     -0.736     -0.066      0.673     21.694
;   06:42:06.0595-06:42:06.1299     -0.723      0.014      0.691     -0.745     -0.073      0.664     21.604
;   06:42:06.1305-06:42:06.2398     -0.747     -0.087      0.659     -0.746     -0.081      0.661     21.706
;   06:42:06.2462-06:42:06.3475     -0.708     -0.002      0.706     -0.742     -0.070      0.667     22.064
;   06:42:06.3731-06:42:06.4110      0.763      0.124     -0.634     -0.729     -0.046      0.683     22.175
;   06:42:06.4515-06:42:06.5566     -0.674     -0.055      0.737     -0.715     -0.022      0.698     21.694
;   06:42:06.5737-06:42:06.6478      0.652      0.012     -0.758     -0.722     -0.030      0.691     21.334
;   06:42:06.6483-06:42:06.7230     -0.641      0.118      0.758     -0.722     -0.041      0.691     21.305
;   06:42:06.7262-06:42:06.7865     -0.754      0.099      0.650     -0.720     -0.044      0.693     21.341
;   06:42:06.8035-06:42:06.8547     -0.552     -0.071      0.831     -0.714     -0.047      0.698     21.279

vswu   = [-622.537,58.923,-179.050]         ; => My 3DP estimates (km/s) For 1998-08-26/06:42:05.763 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  40 Hz < f < 200 Hz  at  1998-08-26/06:42:05.763 UT
;
;   06:42:05.9166-06:42:05.9737      1.957    178.043     94.442     85.558     61.791    118.209     79.722    100.278
;   06:42:05.9742-06:42:06.0590      2.184    177.816     91.145     88.855     58.449    121.551     76.371    103.629
;   06:42:06.0595-06:42:06.1299      5.350    174.650     92.695     87.305     59.815    120.185     77.649    102.351
;   06:42:06.1305-06:42:06.2398      0.387    179.613     90.626     89.374     58.273    121.727     76.243    103.757
;   06:42:06.2462-06:42:06.3475      4.914    175.086     93.913     86.087     61.082    118.918     78.945    101.055
;   06:42:06.3731-06:42:06.4110    174.417      5.583     90.954     89.046    122.997     57.003    105.039     74.961
;   06:42:06.4515-06:42:06.5566      3.787    176.213     96.706     83.294     64.102    115.898     82.042     97.958
;   06:42:06.5737-06:42:06.6478    174.369      5.631     81.686     98.314    114.496     65.504     96.630     83.370
;   06:42:06.6483-06:42:06.7230     10.932    169.068     98.452     81.548     65.438    114.562     82.875     97.125
;   06:42:06.7262-06:42:06.7865      8.794    171.206     89.540     90.460     56.516    123.484     74.089    105.911
;   06:42:06.8035-06:42:06.8547     12.110    167.890    105.534     74.466     72.957    107.043     90.894     89.106

theta_kb0826_40_200   = DBLARR(nn)
theta_kn0826_40_200   = DBLARR(nn)
theta_kn20826_40_200  = DBLARR(nn)
theta_kv0826_40_200   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_40_200[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_40_200[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_40_200[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_40_200[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_40_200[j]),  $
                     REFORM(theta_kn0826_40_200[j]),$
                     REFORM(theta_kv0826_40_200[j]),$
                     REFORM(theta_kn20826_40_200[j])
;
; => For  40 Hz < f < 200 Hz  at  1998-08-26/06:42:05.763 UT
;
;   06:42:05.9166-06:42:05.9737      1.957     85.558     61.791     79.722
;   06:42:05.9742-06:42:06.0590      2.184     88.855     58.449     76.371
;   06:42:06.0595-06:42:06.1299      5.350     87.305     59.815     77.649
;   06:42:06.1305-06:42:06.2398      0.387     89.374     58.273     76.243
;   06:42:06.2462-06:42:06.3475      4.914     86.087     61.082     78.945
;   06:42:06.3731-06:42:06.4110      5.583     89.046     57.003     74.961
;   06:42:06.4515-06:42:06.5566      3.787     83.294     64.102     82.042
;   06:42:06.5737-06:42:06.6478      5.631     81.686     65.504     83.370
;   06:42:06.6483-06:42:06.7230     10.932     81.548     65.438     82.875
;   06:42:06.7262-06:42:06.7865      8.794     89.540     56.516     74.089
;   06:42:06.8035-06:42:06.8547     12.110     74.466     72.957     89.106

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_40_200
PRINT,FORMAT=tkbf,theta_kn0826_40_200
PRINT,FORMAT=tkbf,theta_kv0826_40_200
PRINT,FORMAT=tkbf,theta_kn20826_40_200


theta_kb0826_40_200  = [ 1.96, 2.18, 5.35, 0.39, 4.91, 5.58, 3.79, 5.63,10.93, 8.79,12.11]
theta_kn0826_40_200  = [85.56,88.85,87.30,89.37,86.09,89.05,83.29,81.69,81.55,89.54,74.47]
theta_kv0826_40_200  = [61.79,58.45,59.82,58.27,61.08,57.00,64.10,65.50,65.44,56.52,72.96]
theta_kn20826_40_200 = [79.72,76.37,77.65,76.24,78.94,74.96,82.04,83.37,82.87,74.09,89.11]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 10L
dumbmag = magf_htr
tt_tds  = [MIN(REFORM(unx_t0[jj,*]),/NAN),MAX(REFORM(unx_t0[jj,*]),/NAN)]
tmagfx  = MEAN(interp(dumbmag.Y[*,0],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfy  = MEAN(interp(dumbmag.Y[*,1],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
tmagfz  = MEAN(interp(dumbmag.Y[*,2],dumbmag.X,tt_tds,/NO_EXTRAP),/NAN)
dumb_tt = [tt_tds[0],MEAN(tt_tds,/NAN),tt_tds[1]]
dumb_mf = REFORM(REPLICATE(1d0,3L) # [tmagfx,tmagfy,tmagfz])
dumbmfi = {X:dumb_tt,Y:dumb_mf}
dumb_bm = SQRT(TOTAL(dumb_mf^2,2L,/NAN))
dumb_bv = REFORM(dumb_mf[0,*])/dumb_bm[0]

htrmfit = REFORM(t_mag0.GTIME[jj,*])      ; => Unix Time for HTR MFI data
htrmagf = REFORM(t_mag0.GHTR[jj,*,*])       ; => GSE HTR MFI (nT)
htrbmag = SQRT(TOTAL(htrmagf^2,2,/NAN))

dummy0  = {X:REFORM(unx_t0[jj,*]),Y:rotated_gse_bf.(jj).(0)}

lfc0    = lf_str.(jj)
hfc0    = hf_str.(jj)
print, lfc0, format='(";",8f10.1)'
;      50.0
print, hfc0, format='(";",8f10.1)'
;     200.0

vector_mv_plot,DATE=date,MYMAG=dummy0,FCUTOFF=[lfc0[0],hfc0[0]],$
               SAT='W',COORD='GSE',FIELD='B',DCBKGF=dumbmfi,STATS=stats_082698_0642x09

;-----------------------------------------------------------------------------------------
; => For  50 Hz < f < 200 Hz  at  1998-08-26/06:42:09.131 UT
;-----------------------------------------------------------------------------------------
;Plot Index Range: 492-610
;Plot Range: 06:42:09.3934-06:42:09.4563
;The angle between DC-Field and the k-vector is :
;       67.512 +/- 0.455 degrees
;The eigenvalues ratios are:
;       137.56003       1.6282660
;The Minimum Variance eigenvector is:
;< 0.66072, 0.05899,-0.74831> +/- <-0.02632, 0.01951,-0.02170>
;
;Plot Index Range: 790-1192
;Plot Range: 06:42:09.5523-06:42:09.7667
;The angle between DC-Field and the k-vector is :
;       3.652 +/- 0.714 degrees
;The eigenvalues ratios are:
;       17.993657       1.3682548
;The Minimum Variance eigenvector is:
;< 0.66952, 0.24495,-0.70124> +/- <-0.04244, 0.07143,-0.01557>
;
;Plot Index Range: 840-936
;Plot Range: 06:42:09.5790-06:42:09.6302
;The angle between DC-Field and the k-vector is :
;       88.193 +/- 0.805 degrees
;The eigenvalues ratios are:
;       55.292936       1.3841160
;The Minimum Variance eigenvector is:
;< 0.67158, 0.06644,-0.73795> +/- <-0.03735, 0.04815,-0.02966>
;
;Plot Index Range: 936-1077
;Plot Range: 06:42:09.6302-06:42:09.7054
;The angle between DC-Field and the k-vector is :
;       6.015 +/- 0.544 degrees
;The eigenvalues ratios are:
;       81.218768       1.4295861
;The Minimum Variance eigenvector is:
;< 0.70597, 0.25995,-0.65882> +/- <-0.02648, 0.04096,-0.01221>
;
;Plot Index Range: 1129-1194
;Plot Range: 06:42:09.7331-06:42:09.7678
;The angle between DC-Field and the k-vector is :
;       84.333 +/- 0.693 degrees
;The eigenvalues ratios are:
;       108.77635       1.3089999
;The Minimum Variance eigenvector is:
;< 0.51442, 0.14403,-0.84535> +/- <-0.04250,-0.01627,-0.02863>
;
;Plot Index Range: 1567-1741
;Plot Range: 06:42:09.9667-06:42:10.0595
;The angle between DC-Field and the k-vector is :
;       79.252 +/- 0.751 degrees
;The eigenvalues ratios are:
;       35.623546       1.4451388
;The Minimum Variance eigenvector is:
;< 0.83767, 0.22470,-0.49781> +/- <-0.03903, 0.01425,-0.05924>
;
;Plot Index Range: 1742-1970
;Plot Range: 06:42:10.0601-06:42:10.1817
;The angle between DC-Field and the k-vector is :
;       88.859 +/- 0.846 degrees
;The eigenvalues ratios are:
;       22.175074       1.5491978
;The Minimum Variance eigenvector is:
;< 0.80344, 0.29902,-0.51486> +/- <-0.05062, 0.03803,-0.05690>
;

struct0 = stats_082698_0642x09
nplots  = N_TAGS(struct0)
tr_ss   = STRARR(nplots)
kv_ss   = STRARR(nplots)
dkv_ss  = STRARR(nplots)
eig_ss  = STRARR(nplots)
pr_str  = ',prefd[0]+'
tr_pre  = '     = time_double([prefd[0]+'
dv_0s   = '])'
kv_0s   = ']'

FOR j=0L, nplots - 1L DO BEGIN                                            $
  tr_0p = 'tr'+STRTRIM(j,2L)                                            & $
  tr_00 = time_string(struct0.(j).TRANGE,PREC=4)                        & $
  tr_01 = STRMID(tr_00[*],11L)                                          & $
  test  = tr_0p[0]+tr_pre[0]+"'"+tr_01[0]+"'"+pr_str[0]+"'"+tr_01[1]+"'"+dv_0s[0]  & $
  tr_ss[j] = test[0]

kvform = '(f8.5,",",f8.5,",",f8.5)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  kv_0p = 'kvec'+STRTRIM(j,2L)+'   = ['                                 & $
  kv_00 = struct0.(j).MVA.EIGENVECTORS[*,0]                             & $
  kv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = kv_0p[0]+kv_01+kv_0s[0]                                       & $
  kv_ss[j] = test[0]

FOR j=0L, nplots - 1L DO BEGIN                                            $
  dv_0p = 'dkvec'+STRTRIM(j,2L)+'  = ABS(['                             & $
  dv_00 = struct0.(j).MVA.DMIN_VEC                                      & $
  dv_01 = STRING(FORMAT=kvform,kv_00)                                   & $
  test  = dv_0p[0]+dv_01+dv_0s[0]                                       & $
  dkv_ss[j] = test[0]

eform = '(g,",",g)'
FOR j=0L, nplots - 1L DO BEGIN                                            $
  eg_0p = 'elam'+STRTRIM(j,2L)+'   = ['                                 & $
  eg_mx = struct0.(j).MVA.EIGENVALUES[0]                                & $
  eg_md = struct0.(j).MVA.EIGENVALUES[1]                                & $
  eg_mn = struct0.(j).MVA.EIGENVALUES[2]                                & $
  er_00 = FLOAT([eg_md/eg_mn,eg_mx/eg_md])                              & $
  er_01 = STRCOMPRESS(STRING(FORMAT=eform,er_00),/REMOVE_ALL)           & $
  test  = eg_0p[0]+er_01+kv_0s[0]                                       & $
  eig_ss[j] = test[0]


PRINT, TRANSPOSE(tr_ss)
PRINT, TRANSPOSE(kv_ss)
PRINT, TRANSPOSE(dkv_ss)
PRINT, TRANSPOSE(eig_ss)

prefd   = '1998-08-26/'
tr0     = time_double([prefd[0]+'06:42:09.3934',prefd[0]+'06:42:09.4563'])
tr1     = time_double([prefd[0]+'06:42:09.5790',prefd[0]+'06:42:09.6302'])
tr2     = time_double([prefd[0]+'06:42:09.6302',prefd[0]+'06:42:09.7054'])
tr3     = time_double([prefd[0]+'06:42:09.7331',prefd[0]+'06:42:09.7678'])
tr4     = time_double([prefd[0]+'06:42:09.9667',prefd[0]+'06:42:10.0595'])
tr5     = time_double([prefd[0]+'06:42:10.0601',prefd[0]+'06:42:10.1817'])

kvec0   = [ 0.66072, 0.05899,-0.74831]
kvec1   = [ 0.67158, 0.06644,-0.73795]
kvec2   = [ 0.70597, 0.25995,-0.65882]
kvec3   = [ 0.51442, 0.14403,-0.84535]
kvec4   = [ 0.83767, 0.22470,-0.49781]
kvec5   = [ 0.80344, 0.29902,-0.51486]

dkvec0  = ABS([-0.02632, 0.01951,-0.02170])
dkvec1  = ABS([-0.03735, 0.04815,-0.02966])
dkvec2  = ABS([-0.02648, 0.04096,-0.01221])
dkvec3  = ABS([-0.04250,-0.01627,-0.02863])
dkvec4  = ABS([-0.03903, 0.01425,-0.05924])
dkvec5  = ABS([-0.05062, 0.03803,-0.05690])

elam0   = [137.56003,1.6282660]
elam1   = [55.292936,1.3841160]
elam2   = [81.218768,1.4295861]
elam3   = [108.77635,1.3089999]
elam4   = [35.623546,1.4451388]
elam5   = [22.175074,1.5491978]

bvec0   = [-0.69691,-0.16769, 0.69724]
bvec1   = [-0.69133,-0.20644, 0.69241]
bvec2   = [-0.67879,-0.19808, 0.70705]
bvec3   = [-0.65808,-0.19168, 0.72813]
bvec4   = [-0.61778,-0.22393, 0.75380]
bvec5   = [-0.61610,-0.23278, 0.75245]
bmag0   = [19.04467]
bmag1   = [18.79389]
bmag2   = [18.71999]
bmag3   = [18.64730]
bmag4   = [18.53768]
bmag5   = [18.47439]

tags    = ['t0','t1','t2','t3','t4','t5']
tr_str  = CREATE_STRUCT(tags,tr0,tr1,tr2,tr3,tr4,tr5)
kv_str  = CREATE_STRUCT(tags,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5)
dkv_str = CREATE_STRUCT(tags,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5)
nn      = N_ELEMENTS(tags)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  tr_00  = tr_str.(j)                                               & $
  good   = WHERE(htrmfit LE tr_00[1] AND htrmfit GE tr_00[0],gd)    & $
  avgbm  = MEAN(htrbmag[good],/NAN)                                 & $
  avmagx = MEAN(htrmagf[good,0],/NAN)                               & $
  avmagy = MEAN(htrmagf[good,1],/NAN)                               & $
  avmagz = MEAN(htrmagf[good,2],/NAN)                               & $
  avbvec = [avmagx,avmagy,avmagz]/avgbm[0]                          & $
  trs000 = time_string(tr_str.(j),PREC=4)                           & $
  trs001 = STRMID(trs000[*],11L,13L)                                & $
  t_rang = trs001[0]+'-'+trs001[1]                                  & $
  str_element,bv_str,jstr,avbvec,/ADD_REPLACE                       & $
  str_element,bm_str,jstr,avgbm,/ADD_REPLACE                        & $
  str_element,st_str,jstr,t_rang,/ADD_REPLACE

mform = '(";",a30,7f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(kv_str.(j)),           $
                     REFORM(bv_str.(j)),REFORM(bm_str.(j))
;
; => For  50 Hz < f < 200 Hz  at  1998-08-26/06:42:09.131 UT
;
;   06:42:09.3934-06:42:09.4563      0.661      0.059     -0.748     -0.697     -0.168      0.697     19.045
;   06:42:09.5790-06:42:09.6302      0.672      0.066     -0.738     -0.691     -0.206      0.692     18.794
;   06:42:09.6302-06:42:09.7054      0.706      0.260     -0.659     -0.679     -0.198      0.707     18.720
;   06:42:09.7331-06:42:09.7678      0.514      0.144     -0.845     -0.658     -0.192      0.728     18.647
;   06:42:09.9667-06:42:10.0595      0.838      0.225     -0.498     -0.618     -0.224      0.754     18.538
;   06:42:10.0601-06:42:10.1817      0.803      0.299     -0.515     -0.616     -0.233      0.752     18.474

vswu   = [-626.764,45.472,-179.093]         ; => My 3DP estimates (km/s) For 1998-08-26/06:42:09.131 UT
vswuv  = vswu/(NORM(vswu))[0]
nvc00  = REFORM(gnorm)
nvc02  = REFORM(gnorm2)
FOR j=0L, nn - 1L DO BEGIN                                            $
  jstr   = 'T'+STRTRIM(j,2L)                                        & $
  mag00  = REFORM(bv_str.(j))                                       & $
  kvc00  = REFORM(kv_str.(j))                                       & $
  thkb0  = ACOS(my_dot_prod(kvc00,mag00,/NOM))*18d1/!DPI            & $
  thkb1  = 18d1 - thkb0[0]                                          & $
  thkn0  = ACOS(my_dot_prod(kvc00,nvc00,/NOM))*18d1/!DPI            & $
  thkn1  = 18d1 - thkn0[0]                                          & $
  thkn02 = ACOS(my_dot_prod(kvc00,nvc02,/NOM))*18d1/!DPI            & $
  thkn12 = 18d1 - thkn02[0]                                         & $
  thkv0  = ACOS(my_dot_prod(kvc00,vswuv,/NOM))*18d1/!DPI            & $
  thkv1  = 18d1 - thkv0[0]                                          & $
  str_element,thkb_str,jstr,[thkb0,thkb1],/ADD_REPLACE              & $
  str_element,thkn_str,jstr,[thkn0,thkn1],/ADD_REPLACE              & $
  str_element,thkn2_str,jstr,[thkn02,thkn12],/ADD_REPLACE           & $
  str_element,thkv_str,jstr,[thkv0,thkv1],/ADD_REPLACE

mform = '(";",a30,8f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                            $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(thkb_str.(j)),         $
                     REFORM(thkn_str.(j)),REFORM(thkv_str.(j)),         $
                     REFORM(thkn2_str.(j))
;
; => For  50 Hz < f < 200 Hz  at  1998-08-26/06:42:09.131 UT
;
;   06:42:09.3934-06:42:09.4563    172.796      7.204     82.310     97.690    115.122     64.878     96.959     83.041
;   06:42:09.5790-06:42:09.6302    171.481      8.519     83.155     96.845    115.931     64.069     97.746     82.254
;   06:42:09.6302-06:42:09.7054    175.215      4.785     87.436     92.564    118.587     61.413    100.376     79.624
;   06:42:09.7331-06:42:09.7678    169.011     10.989     72.169    107.831    104.579     75.421     86.302     93.698
;   06:42:09.9667-06:42:10.0595    160.571     19.429     99.459     80.541    130.648     49.352    112.474     67.526
;   06:42:10.0601-06:42:10.1817    162.178     17.822     97.244     82.756    127.498     52.502    109.539     70.461

theta_kb0826_50_200   = DBLARR(nn)
theta_kn0826_50_200   = DBLARR(nn)
theta_kn20826_50_200  = DBLARR(nn)
theta_kv0826_50_200   = DBLARR(nn)
FOR j=0L, nn - 1L DO BEGIN                                                        $
  theta_kb0826_50_200[j]   = REFORM(thkb_str.(j)[0]) < REFORM(thkb_str.(j)[1])    & $
  theta_kn0826_50_200[j]   = REFORM(thkn_str.(j)[0]) < REFORM(thkn_str.(j)[1])    & $
  theta_kn20826_50_200[j]  = REFORM(thkn2_str.(j)[0]) < REFORM(thkn2_str.(j)[1])  & $
  theta_kv0826_50_200[j]   = REFORM(thkv_str.(j)[0]) < REFORM(thkv_str.(j)[1])

mform = '(";",a30,4f11.3)'
FOR j=0L, nn - 1L DO BEGIN                                              $
  PRINT,FORMAT=mform,REFORM(st_str.(j)),REFORM(theta_kb0826_50_200[j]),  $
                     REFORM(theta_kn0826_50_200[j]),$
                     REFORM(theta_kv0826_50_200[j]),$
                     REFORM(theta_kn20826_50_200[j])
;
; => For  50 Hz < f < 200 Hz  at  1998-08-26/06:42:09.131 UT
;
;   06:42:09.3934-06:42:09.4563      7.204     82.310     64.878     83.041
;   06:42:09.5790-06:42:09.6302      8.519     83.155     64.069     82.254
;   06:42:09.6302-06:42:09.7054      4.785     87.436     61.413     79.624
;   06:42:09.7331-06:42:09.7678     10.989     72.169     75.421     86.302
;   06:42:09.9667-06:42:10.0595     19.429     80.541     49.352     67.526
;   06:42:10.0601-06:42:10.1817     17.822     82.756     52.502     70.461

tkbf = '("[",'
FOR k=0L, nn - 1L DO BEGIN                                                      $
  tkbf += 'f5.2,",",' & $
  IF (k EQ nn - 1L) THEN tkbf = STRMID(tkbf,0L,STRLEN(tkbf)-4L)+'"]")'
  
PRINT,FORMAT=tkbf,theta_kb0826_50_200
PRINT,FORMAT=tkbf,theta_kn0826_50_200
PRINT,FORMAT=tkbf,theta_kv0826_50_200
PRINT,FORMAT=tkbf,theta_kn20826_50_200


theta_kb0826_50_200  = [ 7.20, 8.52, 4.79,10.99,19.43,17.82]
theta_kn0826_50_200  = [82.31,83.15,87.44,72.17,80.54,82.76]
theta_kv0826_50_200  = [64.88,64.07,61.41,75.42,49.35,52.50]
theta_kn20826_50_200 = [83.04,82.25,79.62,86.30,67.53,70.46]

DELVAR,tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24
DELVAR,kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24
DELVAR,dkvec0,dkvec1,dkvec2,dkvec3,dkvec4,dkvec5,dkvec6,dkvec7,dkvec8,dkvec9,dkvec10,dkvec11,dkvec12,dkvec13,dkvec14,dkvec15,dkvec16,dkvec17,dkvec18,dkvec19,dkvec20,dkvec21,dkvec22,dkvec23,dkvec24















