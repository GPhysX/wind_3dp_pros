; => Constants and dummy variables
kB     = 1.380658d-23      ; -Boltzmann Constant (J/K)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
K_eV   = 1.160474d4        ; -Conversion = degree Kelvin/eV
me     = 9.1093897d-31     ; -Electron mass (kg)
mp     = 1.6726231d-27     ; -Proton mass (kg)
epo    = 8.854187817d-12   ; -Permittivity of free space (F/m)
qq     = 1.60217733d-19    ; -Fundamental charge (C)
c      = 2.99792458d8      ; -Speed of light in vacuum (m/s)

wcefac  = 1d-9*qq/me
wcifac  = 1d-9*qq/mp
wpefac  = SQRT(1d6*qq^2/me/epo)
wpifac  = SQRT(1d6*qq^2/mp/epo)
vtifac  = SQRT(2d0*kB*K_eV/mp)
vtefac  = SQRT(2d0*kB*K_eV/me)
va_fac  = 1d-9/SQRT(2d0*muo*1d6*mp)
vdi_fac = SQRT(mp/me)*c
e_fact  = SQRT(1d6*me/(4d0*epo))
b_fact  = SQRT(mp/me)/c^2


'----------------------------------------------------------------------------------------------'
'  Tests of LHDI theory...                                                                     '
'----------------------------------------------------------------------------------------------'
; => Ramp durations (s) for the 1997-12-10, 1998-08-26, 1998-09-24, and 2000-02-11 IP shocks
d_tsh0  = [14.934d0-14.394d0,25.116d0-24.829d0,37.494d0-37.310d0,55.458d0-55.183d0]
d_dtsh0 = [      0.092d0    ,      0.092d0    ,      0.092d0    ,      0.092d0    ]
; => Shock normal speeds (km/s)
ushn0   = [      132.3d0    ,      401.3d0    ,      386.3d0    ,      263.6d0    ]
dushn0  = [        2.3d0    ,        3.8d0    ,        3.7d0    ,        2.4d0    ]
; => Shock Thickness (km)
L_sh0   = ushn0*d_tsh0
dL_sh0  = L_sh0*SQRT((d_dtsh0/d_tsh0)^2 + (dushn0/ushn0)^2)
t_sstr  = STRTRIM(STRING(FORMAT='(f15.3)',d_tsh0),2)
t_dsstr = STRTRIM(STRING(FORMAT='(f15.3)',d_dtsh0),2)
l_sstr  = STRTRIM(STRING(FORMAT='(f15.2)',L_sh0),2)
l_dsstr = STRTRIM(STRING(FORMAT='(f15.2)',dL_sh0),2)
l_shstr = l_sstr+' +/- '+l_dsstr+' km'
t_shstr = t_sstr+' +/- '+t_dsstr+' s'
date_st = ['1997-12-10', '1998-08-26', '1998-09-24', '2000-02-11']
mform   = '(";",a12,2a25)'
FOR j=0L, 3L DO BEGIN $
  PRINT,FORMAT=mform,date_st[j],t_shstr[j],l_shstr[j]
;----------------------------------------------------------------
;     Date                 dt (s)                L_sh (km)
;================================================================
;  1997-12-10        0.540 +/- 0.092 s       71.44 +/- 12.23 km
;  1998-08-26        0.287 +/- 0.092 s      115.17 +/- 36.94 km
;  1998-09-24        0.184 +/- 0.092 s       71.08 +/- 35.55 km
;  2000-02-11        0.275 +/- 0.092 s       72.49 +/- 24.26 km
;----------------------------------------------------------------


'----------------------------'
'Lower-Hybrid Only'
'----------------------------'
scets    = ['1998-08-26/06:40:54.9410','1998-08-26/06:41:10.0010','1998-09-24/23:43:18.9510',$
            '1998-09-24/23:48:39.0200','1998-09-24/23:48:51.6220','1998-09-25/00:04:04.5450',$
            '1998-09-25/00:14:50.6030']

lhw_only_amp   = [3.967,4.835,0.870,4.094,2.916,1.572,0.288]
bmago_lhw_only = [23.537,23.125,35.242,36.225,36.095,23.915,23.574]
edens_lhw_only = [22.911,21.810,24.699,24.534,25.467,22.313,14.165]
tavge_lhw_only = [58.057,57.458,44.660,49.034,50.228,58.013,55.925]
tavgi_lhw_only = [100.266,75.230,77.193,79.111,78.199,107.649,116.449]

bmag   = bmago_lhw_only    ; => Bo [nT]
etemp  = tavge_lhw_only    ; => Te [eV]
itemp  = tavgi_lhw_only    ; => Ti [eV]
edens  = edens_lhw_only    ; => Ne [cm^(-3)]
teti   = etemp/itemp       ; => Te/Ti 
wamp   = lhw_only_amp      ; => Wave (pk-pk) amplitude (nT)

; => Shock Thickness (m)
L_sh    = [REPLICATE(L_sh0[1],2) ,REPLICATE(L_sh0[2],5) ]*1d3
dL_sh   = [REPLICATE(dL_sh0[1],2),REPLICATE(dL_sh0[2],5)]*1d3
L_shlow = L_sh - dL_sh
L_shmid = L_sh
L_shhig = L_sh + dL_sh


'----------------------------'
'Lower-Hybrid Whistler Mix'
'----------------------------'
scets    = ['1997-12-10/04:33:15.6050','1998-08-26/06:40:26.1200','1998-09-24/23:20:38.8420',$
            '1998-09-24/23:22:26.6320','1998-09-24/23:22:48.1500','1998-09-24/23:30:48.5420',$
            '1998-09-24/23:45:52.1840','1998-09-24/23:48:42.1310','1998-09-24/23:45:53.3790',$
            '1998-09-25/00:05:23.4320','2000-02-11/23:33:56.4910','2000-02-11/23:33:58.3510',$
            '2000-02-11/23:34:00.7310']

mix_only_amp   = [7.592,18.750,30.000,1.718,1.606,1.187,3.074,3.349,6.20,7.36,4.57,3.06,1.77]
bmago_mix_only = [11.378,17.279,31.786,42.112,42.351,40.631,36.222,37.328,36.608,22.070,16.570,16.261,15.251]
edens_mix_only = [14.002,14.147,16.586,21.087,21.499,24.016,20.004,24.764,19.946,21.804,14.821,15.463,16.053]
tavge_mix_only = [18.782,51.970,24.752,50.450,50.215,50.290,45.391,49.329,45.323,57.823,59.755,54.980,50.937]
tavgi_mix_only = [9.837,48.250,33.823,86.049,83.873,75.068,86.598,78.886,86.363,125.535,22.904,27.846,31.459]

bmag   = bmago_mix_only    ; => Bo [nT]
etemp  = tavge_mix_only    ; => Te [eV]
itemp  = tavgi_mix_only    ; => Ti [eV]
edens  = edens_mix_only    ; => Ne [cm^(-3)]
teti   = etemp/itemp       ; => Te/Ti 
wamp   = mix_only_amp      ; => Wave (pk-pk) amplitude (nT)

; => Shock Thickness (m)
L_sh    = [L_sh0[0],L_sh0[1],REPLICATE(L_sh0[2],8),REPLICATE(L_sh0[3],3)]*1d3
dL_sh   = [dL_sh0[0],dL_sh0[1],REPLICATE(dL_sh0[2],8),REPLICATE(dL_sh0[3],3)]*1d3
L_shlow = L_sh - dL_sh
L_shmid = L_sh
L_shhig = L_sh + dL_sh


'----------------------------'
'Whistler Only'
'----------------------------'
scets    = ['1998-08-26/06:41:37.6230','1998-08-26/06:41:44.0130','1998-08-26/06:41:53.2490',$
            '1998-08-26/06:41:56.3150','1998-08-26/06:41:57.9090','1998-08-26/06:41:59.2330',$
            '1998-08-26/06:42:05.7630','1998-08-26/06:42:09.1310','2000-02-11/23:34:27.5030',$
            '2000-02-11/23:34:29.0650','2000-02-12/00:14:21.7090','2000-02-12/00:26:17.2170',$
            '2000-02-12/00:27:19.1420']

whi_only_amp   = [1.666,1.286,1.952,2.226,3.539,1.259,2.574,1.960,1.174,0.994,0.269,0.920,0.610]
bmago_whi_only = [20.737,21.830,22.725,22.606,22.951,23.296,22.147,20.148,22.576,22.703,18.123,15.039,15.308]
edens_whi_only = [20.740,19.820,18.489,18.048,17.818,17.628,16.687,16.734,16.849,16.895,24.601,20.398,19.291]
tavge_whi_only = [62.881,62.914,63.259,63.186,62.886,62.304,60.529,58.293,43.983,43.839,26.423,28.604,31.017]
tavgi_whi_only = [97.926,94.920,90.192,90.428,92.303,90.878,89.882,89.497,41.461,42.224,27.713,25.645,26.395]

bmag   = bmago_whi_only    ; => Bo [nT]
etemp  = tavge_whi_only    ; => Te [eV]
itemp  = tavgi_whi_only    ; => Ti [eV]
edens  = edens_whi_only    ; => Ne [cm^(-3)]
teti   = etemp/itemp       ; => Te/Ti 
wamp   = whi_only_amp      ; => Wave (pk-pk) amplitude (nT)

; => Shock Thickness (m)
L_sh    = [REPLICATE(L_sh0[0],8),REPLICATE(L_sh0[3],5)]*1d3
dL_sh   = [REPLICATE(dL_sh0[0],8),REPLICATE(dL_sh0[3],5)]*1d3
L_shlow = L_sh - dL_sh
L_shmid = L_sh
L_shhig = L_sh + dL_sh



;-----------------------------------------------------------------------------------------
; => Huba et al., [1978] Eq. for |E| saturation due to current relaxation
;      [After Eq. 23 in their paper]
;
;  |E| = [(ne me V_di^2)/(4 epo)]^(1/2) [1 + (wpe/wce)^2]^(-1/2) [1 + Te/Ti]
;
;  |B| = [V_Ti/c^2] [Mi/me]^(1/2) [wpe/wce]^2 |E|
;
;      V_di ~< V_Ti
;
; => Estimate E and B-fields using V_di = [Mi/me]^(1/2) [c/(wpe L_sh)] V_A
;      {L_sh = shock thickness, V_A = Alfven speed}
;-----------------------------------------------------------------------------------------

nlhw   = N_ELEMENTS(edens)

vti    = vtifac[0]*SQRT(itemp)  ; => Ion Thermal Speed (m/s)
vte    = vtefac[0]*SQRT(etemp)  ; => Electron Thermal Speed (m/s)
wce    = wcefac[0]*bmag         ; => Electron cyclotron frequency (rad/s)
wci    = wcifac[0]*bmag         ; => Ion cyclotron frequency (rad/s)
wpe    = wpefac[0]*SQRT(edens)  ; => Electron plasma frequency (rad/s)
wpi    = wpifac[0]*SQRT(edens)  ; => Ion plasma frequency (rad/s)
valf   = va_fac[0]*bmag/SQRT(edens)  ; => Alfven Speed (m/s)
rhoe   = vte/wce                ; => Electron thermal cyclotron radii (m)
rhoi   = vti/wci                ; => Electron thermal cyclotron radii (m)
einert = c/wpe                  ; => Electron inertial length (m)
iinert = c/wpi                  ; => Ion inertial length (m)

; => w_lh = wpi/[1 + (wpe/wce)^2]^(1/2)  ; Lower Hybrid Resonance Frequency (rad/s)
wlh    = wpi/SQRT(1 + (wpe/wce)^2)


;-----------------------------------------------------------------------------------------
; => Estimate V_di = [Mi/me]^(1/2) [c/(wpe L_sh)] V_A
;      {L_sh = shock thickness, V_A = Alfven speed}
;-----------------------------------------------------------------------------------------

; =>  [Low, Middle, High]
vdi_0   = DBLARR(nlhw,3)       ; => Estimate of drift speed (m/s)
FOR j=0L, nlhw - 1L DO BEGIN           $
  temp0 = vdi_fac[0]*valf[j]/wpe[j]  & $
  templ = temp0[0]/L_shlow[j]        & $
  tempm = temp0[0]/L_shmid[j]        & $
  temph = temp0[0]/L_shhig[j]        & $
  vdi_0[j,*] = [templ,tempm,temph]

mform    = '(";",a5,a26,3f15.4)'
FOR j=0L, nlhw - 1L DO BEGIN           $
  jstr = STRTRIM(j,2)                & $
  PRINT,FORMAT=mform,jstr[0],scets[j],REVERSE(REFORM(vdi_0[j,*]))*1d-3
;-------------------------------------------------------------------------------
;    j        Date/Time                Vdi (Low)      Vdi (Mid)      Vdi (High)
;===============================================================================
; => Lower Hybrid Only
;-------------------------------------------------------------------------------
;    0  1998-08-26/06:40:54.9410        23.7201        31.3271        46.1166
;    1  1998-08-26/06:41:10.0010        24.4814        32.3325        47.5966
;    2  1998-09-24/23:43:18.9510        46.9987        70.5023       141.0305
;    3  1998-09-24/23:48:39.0200        48.6345        72.9562       145.9391
;    4  1998-09-24/23:48:51.6220        46.6846        70.0312       140.0880
;    5  1998-09-25/00:04:04.5450        35.3034        52.9584       105.9361
;    6  1998-09-25/00:14:50.6030        54.8177        82.2316       164.4934
;-------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;-------------------------------------------------------------------------------
;    0  1997-12-10/04:33:15.6050        34.1064        39.9472        48.2021
;    1  1998-08-26/06:40:26.1200        28.2010        37.2450        54.8283
;    2  1998-09-24/23:20:38.8420        63.1246        94.6926       189.4200
;    3  1998-09-24/23:22:26.6320        65.7802        98.6764       197.3889
;    4  1998-09-24/23:22:48.1500        64.8858        97.3346       194.7050
;    5  1998-09-24/23:30:48.5420        55.7264        83.5947       167.2201
;    6  1998-09-24/23:45:52.1840        59.6430        89.4700       178.9729
;    7  1998-09-24/23:48:42.1310        49.6499        74.4794       148.9861
;    8  1998-09-24/23:45:53.3790        60.4539        90.6864       181.4061
;    9  1998-09-25/00:05:23.4320        33.3404        50.0136       100.0456
;   10  2000-02-11/23:33:56.4910        40.5843        54.1666        81.4130
;   11  2000-02-11/23:33:58.3510        38.1739        50.9495        76.5777
;   12  2000-02-11/23:34:00.7310        34.4870        46.0287        69.1817
;-------------------------------------------------------------------------------
; => Whistler Only
;-------------------------------------------------------------------------------
;-------------------------------------------------------------------------------

vdiavg  = DBLARR(nlhw)
dvdiav  = DBLARR(nlhw)
FOR j=0L, nlhw - 1L DO BEGIN           $
  temp0     = MOMENT(REFORM(vdi_0[j,*]),/NAN,/DOUBLE,SDEV=unc0) & $
  vdiavg[j] = temp0[0]  & $
  dvdiav[j] = unc0[0]/SQRT(3d0)

mform    = '(";",a5,a26,2f15.4)'
date_st2 = [REPLICATE(date_st[1],2) ,REPLICATE(date_st[2],5)]
FOR j=0L, nlhw - 1L DO BEGIN           $
  jstr = STRTRIM(j,2)                & $
  PRINT,FORMAT=mform,jstr[0],scets[j],REFORM(vdiavg[j])*1d-3,REFORM(dvdiav[j])*1d-3
;-------------------------------------------------------------------------------
;    j        Date/Time               Vdi (km/s)      dVdi (km/s)
;===============================================================================
; => Lower Hybrid Only
;-------------------------------------------------------------------------------
;    0  1998-08-26/06:40:54.9410        33.7213         6.5752
;    1  1998-08-26/06:41:10.0010        34.8035         6.7862
;    2  1998-09-24/23:43:18.9510        86.1771        28.2534
;    3  1998-09-24/23:48:39.0200        89.1766        29.2368
;    4  1998-09-24/23:48:51.6220        85.6012        28.0646
;    5  1998-09-25/00:04:04.5450        64.7326        21.2228
;    6  1998-09-25/00:14:50.6030       100.5142        32.9539
;-------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;-------------------------------------------------------------------------------
;    0  1997-12-10/04:33:15.6050        40.7519         4.0889
;    1  1998-08-26/06:40:26.1200        40.0914         7.8173
;    2  1998-09-24/23:20:38.8420       115.7457        37.9476
;    3  1998-09-24/23:22:26.6320       120.6152        39.5441
;    4  1998-09-24/23:22:48.1500       118.9751        39.0064
;    5  1998-09-24/23:30:48.5420       102.1804        33.5002
;    6  1998-09-24/23:45:52.1840       109.3620        35.8547
;    7  1998-09-24/23:48:42.1310        91.0384        29.8472
;    8  1998-09-24/23:45:53.3790       110.8488        36.3421
;    9  1998-09-25/00:05:23.4320        61.1332        20.0427
;   10  2000-02-11/23:33:56.4910        58.7213        12.0042
;   11  2000-02-11/23:33:58.3510        55.2337        11.2913
;   12  2000-02-11/23:34:00.7310        49.8991        10.2007
;-------------------------------------------------------------------------------
; => Whistler Only
;-------------------------------------------------------------------------------
;-------------------------------------------------------------------------------


;-----------------------------------------------------------------------------------------
; => Now Estimate V_di = V_Ti [(2 (1 + Beta_e))/(Beta_i)]^(1/2)
;-----------------------------------------------------------------------------------------
beta_fac = 1d6*(kB*K_eV)*(2d0*muo)
beta_e   = beta_fac[0]*edens*etemp/((bmag*1d-9)^2)
beta_i   = beta_fac[0]*edens*itemp/((bmag*1d-9)^2)

v_di     = vti*SQRT(2d0*(1d0 + beta_e)/beta_i)

mform    = '(";",a5,a26,3f15.4)'
date_st2 = [REPLICATE(date_st[1],2) ,REPLICATE(date_st[2],5)]
FOR j=0L, nlhw - 1L DO BEGIN           $
  jstr = STRTRIM(j,2)                & $
  PRINT,FORMAT=mform,jstr[0],scets[j],REFORM(v_di[j])*1d-3,beta_i[j],beta_e[j]
;-------------------------------------------------------------------------------
;    j        Date/Time               Vdi (km/s)        Beta_i         Beta_e
;===============================================================================
; => Lower Hybrid Only
;-------------------------------------------------------------------------------
;    0  1998-08-26/06:40:54.9410       212.7284         1.6698         0.9668
;    1  1998-08-26/06:41:10.0010       212.9474         1.2355         0.9436
;    2  1998-09-24/23:43:18.9510       254.8726         0.6182         0.3576
;    3  1998-09-24/23:48:39.0200       263.9744         0.5956         0.3692
;    4  1998-09-24/23:48:51.6220       260.6226         0.6155         0.3954
;    5  1998-09-25/00:04:04.5450       215.9121         1.6912         0.9114
;    6  1998-09-25/00:14:50.6030       242.4038         1.1952         0.5740
;-------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;-------------------------------------------------------------------------------
;    0  1997-12-10/04:33:15.6050       126.4680         0.4284         0.8180
;    1  1998-08-26/06:40:26.1200       199.9860         0.9206         0.9916
;    2  1998-09-24/23:20:38.8420       259.7060         0.2236         0.1636
;    3  1998-09-24/23:22:26.6320       315.2052         0.4120         0.2416
;    4  1998-09-24/23:22:48.1500       314.0449         0.4048         0.2424
;    5  1998-09-24/23:30:48.5420       290.9950         0.4397         0.2946
;    6  1998-09-24/23:45:52.1840       282.4917         0.5317         0.2787
;    7  1998-09-24/23:48:42.1310       269.1470         0.5646         0.3530
;    8  1998-09-24/23:45:53.3790       285.1282         0.5176         0.2716
;    9  1998-09-25/00:05:23.4320       208.3556         2.2629         1.0423
;   10  2000-02-11/23:33:56.4910       201.3041         0.4979         1.2989
;   11  2000-02-11/23:33:58.3510       193.2294         0.6557         1.2947
;   12  2000-02-11/23:34:00.7310       182.4937         0.8743         1.4156
;-------------------------------------------------------------------------------
; => Whistler Only
;-------------------------------------------------------------------------------
;-------------------------------------------------------------------------------



;-----------------------------------------------------------------------------------------
;  |E| = [(ne me V_di^2)/(4 epo)]^(1/2) [1 + (wpe/wce)^2]^(-1/2) [1 + Te/Ti]
;  |B| = [V_Ti/c^2] [Mi/me]^(1/2) [wpe/wce]^2 |E|
;-----------------------------------------------------------------------------------------


; => Estimate E and B-fields using V_di = V_Ti
efield0 = e_fact[0]*SQRT(edens*vti^2)*(1d0 + teti)/SQRT(1 + (wpe/wce)^2)
bfield0 = b_fact[0]*vti*(wpe/wce)^2*efield0

; => Estimate E and B-fields using V_di = [Mi/me]^(1/2) [c/(wpe L_sh)] V_A
efield1 = e_fact[0]*SQRT(edens*vdiavg^2)*(1d0 + teti)/SQRT(1 + (wpe/wce)^2)
bfield1 = b_fact[0]*vti*(wpe/wce)^2*efield1

; => Estimate E and B-fields using V_di = V_Ti [(2 (1 + Beta_e))/(Beta_i)]^(1/2)
efield2 = e_fact[0]*SQRT(edens*v_di^2)*(1d0 + teti)/SQRT(1 + (wpe/wce)^2)
bfield2 = b_fact[0]*vti*(wpe/wce)^2*efield2

PRINT, efield0*1d3, bfield0*1d9, bfield0*1d9/wamp
;----------------------------------------------------------------------------------------------------------------
; [E] = mV/m,  [B] = nT, and dB/B
;----------------------------------------------------------------------------------------------------------------
; => Lower Hybrid Only
;----------------------------------------------------------------------------------------------------------------
;       2.5752181       2.4480079       3.3818040       3.6109833       3.6269498       2.6422926       2.6055600
;      0.72404054      0.58793703      0.40116762      0.40768602      0.42565336      0.72616169      0.48657442
;      0.18251589      0.12160021      0.46111220     0.099581346      0.14597167      0.46193491       1.6894946
;----------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;----------------------------------------------------------------------------------------------------------------
;      0.71848264       1.7251486       2.2149314       4.2867853       4.2895645       4.0670902       3.5543855       3.7282201       3.5888616       2.4993056       1.9804534       1.7662132       1.5504157
;      0.16547640      0.38550730      0.14357094      0.32102434      0.31970209      0.34803839      0.34238973      0.39956105      0.33701915      0.85106674      0.34736259      0.37004461      0.40748386
;     0.021796154     0.020560389    0.0047856979      0.18685933      0.19906731      0.29320841      0.11138248      0.11930757     0.054357929      0.11563407     0.076009317      0.12092961      0.23021687
;----------------------------------------------------------------------------------------------------------------
; => Whistler Only
;----------------------------------------------------------------------------------------------------------------

PRINT, efield1*1d3, bfield1*1d9, bfield1*1d9/wamp
;----------------------------------------------------------------------------------------------------------------
; [E] = mV/m,  [B] = nT, and dB/B
;----------------------------------------------------------------------------------------------------------------
; => Lower Hybrid Only
;----------------------------------------------------------------------------------------------------------------
;      0.62656286      0.70968188       2.3964857       2.6156593       2.5365553       1.1910294       1.7534122
;      0.17616252      0.17044400      0.28428390      0.29531227      0.29768632      0.32732178      0.32744036
;     0.044406989     0.035252119      0.32676311     0.072132947      0.10208722      0.20821996       1.1369457
;----------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;----------------------------------------------------------------------------------------------------------------
;      0.67445984      0.71937025       3.1848029       4.0270221       4.0260729       3.4653519       3.0178683       2.7608933       3.0927670      0.98522894       1.7556093       1.3356390      0.99653317
;      0.15533734      0.16075281      0.20643760      0.30157147      0.30006401      0.29654505      0.29070767      0.29589064      0.29043240      0.33549142      0.30792596      0.27983373      0.26191116
;     0.020460662    0.0085734830    0.0068812534      0.17553636      0.18683936      0.24982733     0.094569837     0.088351938     0.046843938     0.045583073     0.067379856     0.091448932      0.14797241
;----------------------------------------------------------------------------------------------------------------
; => Whistler Only
;----------------------------------------------------------------------------------------------------------------

PRINT, efield2*1d3, bfield2*1d9, bfield2*1d9/wamp
;----------------------------------------------------------------------------------------------------------------
; [E] = mV/m,  [B] = nT, and dB/B
;----------------------------------------------------------------------------------------------------------------
; => Lower Hybrid Only
;----------------------------------------------------------------------------------------------------------------
;       3.9526273       4.3422303       7.0877102       7.7426934       7.7228271       3.9726124       4.2285928
;       1.1113088       1.0428716      0.84078195      0.87416295      0.90633935       1.0917636      0.78966712
;      0.28013833      0.21569217      0.96641603      0.21352295      0.31081598      0.69450610       2.7418998
;----------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;----------------------------------------------------------------------------------------------------------------
;       2.0930949       3.5883997       7.1459423       10.523870       10.627157       9.8688194       7.7954206       8.1623339       7.9552953       3.3578822       6.0184535       4.6725964       3.6445741
;      0.48206843      0.80187543      0.46319701      0.78810072      0.79204414      0.84451729      0.75092359      0.87477419      0.74705776       1.1434303       1.0556096      0.97896966      0.95787543
;     0.063496896     0.042766690     0.015439900      0.45873149      0.49317819      0.71147200      0.24428225      0.26120460      0.12049319      0.15535738      0.23098678      0.31992473      0.54117257
;----------------------------------------------------------------------------------------------------------------
; => Whistler Only
;----------------------------------------------------------------------------------------------------------------



;-----------------------------------------------------------------------------------------
; => Huba et al., [1978] Eq. for k_para/k_perp  [Between Eqs 16 and 17 in paper]
;
;    k_para/k_perp ~< (1/4) (V_di/V_Ti) [Ti/Te]^(1/2) [me/Mi]^(1/2)
;
; => For comparison, [me/MI]^(1/2) =  0.023337031
; => For comparison, [Mi/me]^(1/2) = 42.850353000
;-----------------------------------------------------------------------------------------
k_ratio0 = 0d0  ; => k_para/k_perp for V_di = V_Ti
k_ratio1 = 0d0  ; => k_para/k_perp for V_di = [Mi/me]^(1/2) [c/(wpe L_sh)] V_A
k_ratio2 = 0d0  ; => k_para/k_perp for V_di = V_Ti [(2 (1 + Beta_e))/(Beta_i)]^(1/2)

k_ratio0 = (1d0/4d0)*SQRT(me/mp)*SQRT(itemp/etemp)
k_ratio1 = (1d0/4d0)*SQRT(me/mp)*SQRT(itemp/etemp)*(vdiavg/vti)
k_ratio2 = (1d0/4d0)*SQRT(me/mp)*SQRT(itemp/etemp)*(v_di/vti)


' => For V_di = V_Ti'
PRINT, k_ratio0, 1d0/k_ratio0, (1d0/k_ratio0)/SQRT(mp/me)
;----------------------------------------------------------------------------------------------------------------
; => k_para/k_perp, k_perp/k_para, and (k_perp/k_para)/[Mi/me]^(1/2)
;----------------------------------------------------------------------------------------------------------------
; => Lower Hybrid Only
;----------------------------------------------------------------------------------------------------------------
;    0.0076671709    0.0066758398    0.0076703507    0.0074106345    0.0072796959    0.0079474523    0.0084188057
;       130.42620       149.79389       130.37213       134.94121       137.36837       125.82649       118.78169
;       3.0437603       3.4957446       3.0424985       3.1491272       3.2057700       2.9364166       2.7720120
;----------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;----------------------------------------------------------------------------------------------------------------
;    0.0042222703    0.0056215738    0.0068200338    0.0076195259    0.0075401494    0.0071280740    0.0080585087    0.0073779280    0.0080536013    0.0085964219    0.0036120531    0.0041520699    0.0045850214
;       236.83941       177.88613       146.62684       131.24176       132.62337       140.29035       124.09244       135.53941       124.16805       116.32747       276.85086       240.84373       218.10149
;       5.5271286       4.1513341       3.4218350       3.0627930       3.0950356       3.2739602       2.8959490       3.1630873       2.8977137       2.7147377       6.4608770       5.6205775       5.0898412
;----------------------------------------------------------------------------------------------------------------
; => Whistler Only
;----------------------------------------------------------------------------------------------------------------

' => For V_di = [Mi/me]^(1/2) [c/(wpe L_sh)] V_A'
PRINT, k_ratio1, 1d0/k_ratio1, (1d0/k_ratio1)/SQRT(mp/me)
;----------------------------------------------------------------------------------------------------------------
; => k_para/k_perp, k_perp/k_para, and (k_perp/k_para)/[Mi/me]^(1/2)
;----------------------------------------------------------------------------------------------------------------
; => Lower Hybrid Only
;----------------------------------------------------------------------------------------------------------------
;    0.0018654593    0.0019353379    0.0054355266    0.0053679823    0.0050911517    0.0035823623    0.0056654370
;       536.06101       516.70563       183.97481       186.28973       196.41921       279.14541       176.50889
;       12.510072       12.058375       4.2934259       4.3474492       4.5838411       6.5144251       4.1191934
;----------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;----------------------------------------------------------------------------------------------------------------
;    0.0039635637    0.0023441418    0.0098063819    0.0071578112    0.0070769867    0.0060734537    0.0068421161    0.0054636452    0.0069403379    0.0033887187    0.0032019709    0.0031398625    0.0029470327
;       252.29820       426.59536       101.97441       139.70751       141.30308       164.65096       146.15361       183.02799       144.08520       295.09678       312.30765       318.48529       339.32436
;       5.8878908       9.9554690       2.3797799       3.2603585       3.2975942       3.8424646       3.4107914       4.2713298       3.3625208       6.8866827       7.2883332       7.4325009       7.9188230
;----------------------------------------------------------------------------------------------------------------
; => Whistler Only
;----------------------------------------------------------------------------------------------------------------

' => For V_di = V_Ti [(2 (1 + Beta_e))/(Beta_i)]^(1/2)'
PRINT, k_ratio2, 1d0/k_ratio1, (1d0/k_ratio2)/SQRT(mp/me)
;----------------------------------------------------------------------------------------------------------------
; => k_para/k_perp, k_perp/k_para, and (k_perp/k_para)/[Mi/me]^(1/2)
;----------------------------------------------------------------------------------------------------------------
; => Lower Hybrid Only
;----------------------------------------------------------------------------------------------------------------
;     0.011768118     0.011841479     0.016075805     0.015889930     0.015500582     0.011948770     0.013662975
;       536.06101       516.70563       183.97481       186.28973       196.41921       279.14541       176.50889
;       1.9830725       1.9707868       1.4516866       1.4686680       1.5055583       1.9530906       1.7080490
;----------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;----------------------------------------------------------------------------------------------------------------
;     0.012300384     0.011693169     0.022003195     0.018705603     0.018680301     0.017296315     0.017673791     0.016152778     0.017852117     0.011549517     0.010976766     0.010984488     0.010778045
;       252.29820       426.59536       101.97441       139.70751       141.30308       164.65096       146.15361       183.02799       144.08520       295.09678       312.30765       318.48529       339.32436
;       1.8972603       1.9957833       1.0606201       1.2475958       1.2492856       1.3492487       1.3204315       1.4447689       1.3072416       2.0206067       2.1260388       2.1245443       2.1652379
;----------------------------------------------------------------------------------------------------------------
; => Whistler Only
;----------------------------------------------------------------------------------------------------------------


;-----------------------------------------------------------------------------------------
; - Since we have found k_para = C * k_perp
;   =>  k = [ k_perp^2 + k_para^2 ]^(1/2) = k_perp [ 1 + C^2 ]^(1/2)
;   So we have:  k/k_perp = [ 1 + C^2 ]^(1/2)
;   or we have:  k/k_para = [ 1 + (1/C)^2 ]^(1/2)
;-----------------------------------------------------------------------------------------

' => For V_di = V_Ti'
PRINT, 1d0/SQRT(1d0 + k_ratio0^2), 1d0/SQRT(1d0 + (1d0/k_ratio0)^2)
;----------------------------------------------------------------------------------------------------------------
; => k_perp/k and k_para/k
;----------------------------------------------------------------------------------------------------------------
; => Lower Hybrid Only
;----------------------------------------------------------------------------------------------------------------
;      0.99997061      0.99997772      0.99997058      0.99997254      0.99997350      0.99996842      0.99996456
;    0.0076669456    0.0066756910    0.0076701251    0.0074104310    0.0072795031    0.0079472013    0.0084185074
;----------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;----------------------------------------------------------------------------------------------------------------
;      0.99999109      0.99998420      0.99997674      0.99997097      0.99997157      0.99997460      0.99996753      0.99997278      0.99996757      0.99996305      0.99999348      0.99999138      0.99998949
;    0.0042222326    0.0056214849    0.0068198752    0.0076193047    0.0075399351    0.0071278929    0.0080582471    0.0073777272    0.0080533401    0.0085961043    0.0036120295    0.0041520341    0.0045849732
;----------------------------------------------------------------------------------------------------------------
; => Whistler Only
;----------------------------------------------------------------------------------------------------------------

' => For V_di = [Mi/me]^(1/2) [c/(wpe L_sh)] V_A'
PRINT, 1d0/SQRT(1d0 + k_ratio1^2), 1d0/SQRT(1d0 + (1d0/k_ratio1)^2)
;----------------------------------------------------------------------------------------------------------------
; => k_perp/k and k_para/k
;----------------------------------------------------------------------------------------------------------------
; => Lower Hybrid Only
;----------------------------------------------------------------------------------------------------------------
;      0.99999826      0.99999813      0.99998523      0.99998559      0.99998704      0.99999358      0.99998395
;    0.0018654561    0.0019353343    0.0054354463    0.0053679050    0.0050910857    0.0035823393    0.0056653461
;----------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;----------------------------------------------------------------------------------------------------------------
;      0.99999215      0.99999725      0.99995192      0.99997438      0.99997496      0.99998156      0.99997659      0.99998507      0.99997592      0.99999426      0.99999487      0.99999507      0.99999566
;    0.0039635326    0.0023441353    0.0098059104    0.0071576278    0.0070768095    0.0060733417    0.0068419560    0.0054635637    0.0069401708    0.0033886993    0.0032019545    0.0031398470    0.0029470199
;----------------------------------------------------------------------------------------------------------------
; => Whistler Only
;----------------------------------------------------------------------------------------------------------------

' => For V_di = V_Ti [(2 (1 + Beta_e))/(Beta_i)]^(1/2)'
PRINT, 1d0/SQRT(1d0 + k_ratio2^2), 1d0/SQRT(1d0 + (1d0/k_ratio2)^2)
;----------------------------------------------------------------------------------------------------------------
; => k_perp/k and k_para/k
;----------------------------------------------------------------------------------------------------------------
; => Lower Hybrid Only
;----------------------------------------------------------------------------------------------------------------
;      0.99993076      0.99992990      0.99987081      0.99987378      0.99987989      0.99992862      0.99990667
;     0.011767303     0.011840649     0.016073728     0.015887924     0.015498720     0.011947917     0.013661700
;----------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;----------------------------------------------------------------------------------------------------------------
;      0.99992436      0.99993164      0.99975802      0.99982510      0.99982557      0.99985045      0.99984386      0.99986957      0.99984069      0.99993331      0.99993976      0.99993968      0.99994192
;     0.012299453     0.011692369     0.021997871     0.018702331     0.018677042     0.017293728     0.017671031     0.016150671     0.017849273     0.011548747     0.010976105     0.010983825     0.010777419
;----------------------------------------------------------------------------------------------------------------
; => Whistler Only
;----------------------------------------------------------------------------------------------------------------



'----------------------------------------------------------------------------------------------'
'Look at our measured values compared to ranges in literature '
'----------------------------------------------------------------------------------------------'
; => Constants and dummy variables
kB     = 1.380658d-23      ; -Boltzmann Constant (J/K)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
K_eV   = 1.160474d4        ; -Conversion = degree Kelvin/eV
me     = 9.1093897d-31     ; -Electron mass (kg)
mp     = 1.6726231d-27     ; -Proton mass (kg)
epo    = 8.854187817d-12   ; -Permittivity of free space (F/m)
qq     = 1.60217733d-19    ; -Fundamental charge (C)
c      = 2.99792458d8      ; -Speed of light in vacuum (m/s)

wcefac = 1d-9*qq/me
wcifac = 1d-9*qq/mp
wpefac = SQRT(1d6*qq^2/me/epo)
wpifac = SQRT(1d6*qq^2/mp/epo)
vtifac = SQRT(2d0*kB*K_eV/mp)
vtefac = SQRT(2d0*kB*K_eV/me)
va_fac = 1d-9/SQRT(2d0*muo*1d6*mp)

;----------------------------------------------------------------
; => Huba et al., [1978] found 0.5 < k rho_ce < 5.0
;      => 0.5/rho_ce < k < 5.0/rho_ce
;----------------------------------------------------------------

klow    = 5d-1/rhoe*1d3  ; => km^(-1)
khigh   = 5d0/rhoe*1d3   ; => km^(-1)
vphlow  = wlh/khigh      ; => km/s
vphhigh = wlh/klow       ; => km/s

vstrl = STRTRIM(STRING(FORMAT='(f15.4)',vphlow),2)
vstrh = STRTRIM(STRING(FORMAT='(f15.4)',vphhigh),2)
kstrl = STRTRIM(STRING(FORMAT='(f15.4)',klow),2)
kstrh = STRTRIM(STRING(FORMAT='(f15.4)',khigh),2)

k_str = kstrl+' km^(-1) < |k| < '+kstrh+' km^(-1)'
v_str = vstrl+' km/s < w/|k| < '+vstrh+' km/s'

mform    = '(";",a5,a26,2a42)'
FOR j=0L, nlhw - 1L DO BEGIN           $
  jstr = STRTRIM(j,2)                & $
  PRINT,FORMAT=mform,jstr[0],scets[j],k_str[j],v_str[j]

;--------------------------------------------------------------------------------------------------------------------
;    j        Date/Time                      0.5 < k rho_ce < 5.0                          wlh/k (km/s)
;=====================================================================================================================
; => Lower Hybrid Only
;--------------------------------------------------------------------------------------------------------------------
;    0  1998-08-26/06:40:54.9410     0.4580 km^(-1) < |k| < 4.5802 km^(-1)      21.0903 km/s < w/|k| < 210.9031 km/s
;    1  1998-08-26/06:41:10.0010     0.4523 km^(-1) < |k| < 4.5234 km^(-1)      20.9812 km/s < w/|k| < 209.8120 km/s
;    2  1998-09-24/23:43:18.9510     0.7819 km^(-1) < |k| < 7.8192 km^(-1)      18.4952 km/s < w/|k| < 184.9524 km/s
;    3  1998-09-24/23:48:39.0200     0.7670 km^(-1) < |k| < 7.6704 km^(-1)      19.3795 km/s < w/|k| < 193.7950 km/s
;    4  1998-09-24/23:48:51.6220     0.7552 km^(-1) < |k| < 7.5515 km^(-1)      19.6143 km/s < w/|k| < 196.1425 km/s
;    5  1998-09-25/00:04:04.5450     0.4656 km^(-1) < |k| < 4.6555 km^(-1)      21.0822 km/s < w/|k| < 210.8217 km/s
;    6  1998-09-25/00:14:50.6030     0.4674 km^(-1) < |k| < 4.6740 km^(-1)      20.6979 km/s < w/|k| < 206.9793 km/s
;--------------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;--------------------------------------------------------------------------------------------------------------------
;    0  1997-12-10/04:33:15.6050     0.3893 km^(-1) < |k| < 3.8927 km^(-1)      11.9966 km/s < w/|k| < 119.9660 km/s
;    1  1998-08-26/06:40:26.1200     0.3554 km^(-1) < |k| < 3.5539 km^(-1)      19.9544 km/s < w/|k| < 199.5439 km/s
;    2  1998-09-24/23:20:38.8420     0.9473 km^(-1) < |k| < 9.4731 km^(-1)      13.7684 km/s < w/|k| < 137.6840 km/s
;    3  1998-09-24/23:22:26.6320     0.8791 km^(-1) < |k| < 8.7909 km^(-1)      19.6544 km/s < w/|k| < 196.5440 km/s
;    4  1998-09-24/23:22:48.1500     0.8861 km^(-1) < |k| < 8.8615 km^(-1)      19.6086 km/s < w/|k| < 196.0864 km/s
;    5  1998-09-24/23:30:48.5420     0.8495 km^(-1) < |k| < 8.4953 km^(-1)      19.6247 km/s < w/|k| < 196.2468 km/s
;    6  1998-09-24/23:45:52.1840     0.7972 km^(-1) < |k| < 7.9716 km^(-1)      18.6446 km/s < w/|k| < 186.4461 km/s
;    7  1998-09-24/23:48:42.1310     0.7880 km^(-1) < |k| < 7.8803 km^(-1)      19.4374 km/s < w/|k| < 194.3744 km/s
;    8  1998-09-24/23:45:53.3790     0.8063 km^(-1) < |k| < 8.0626 km^(-1)      18.6305 km/s < w/|k| < 186.3049 km/s
;    9  1998-09-25/00:05:23.4320     0.4303 km^(-1) < |k| < 4.3034 km^(-1)      21.0480 km/s < w/|k| < 210.4795 km/s
;   10  2000-02-11/23:33:56.4910     0.3178 km^(-1) < |k| < 3.1783 km^(-1)      21.3971 km/s < w/|k| < 213.9709 km/s
;   11  2000-02-11/23:33:58.3510     0.3252 km^(-1) < |k| < 3.2517 km^(-1)      20.5245 km/s < w/|k| < 205.2452 km/s
;   12  2000-02-11/23:34:00.7310     0.3168 km^(-1) < |k| < 3.1684 km^(-1)      19.7557 km/s < w/|k| < 197.5572 km/s
;--------------------------------------------------------------------------------------------------------------------
; => Whistler Only
;--------------------------------------------------------------------------------------------------------------------
;--------------------------------------------------------------------------------------------------------------------


; => McBride et al., [1972] found 0.05 < k rho_ce < 0.4  [1D Simulation results]
klow  = 5d-2/rhoe*1d3    ; => km^(-1)
khigh = 4d-1/rhoe*1d3    ; => km^(-1)
vphlow  = wlh/khigh      ; => km/s
vphhigh = wlh/klow       ; => km/s

vstrl = STRTRIM(STRING(FORMAT='(f15.4)',vphlow),2)
vstrh = STRTRIM(STRING(FORMAT='(f15.4)',vphhigh),2)
kstrl = STRTRIM(STRING(FORMAT='(f15.4)',klow),2)
kstrh = STRTRIM(STRING(FORMAT='(f15.4)',khigh),2)
k_str = kstrl+' km^(-1) < |k| < '+kstrh+' km^(-1)'
v_str = vstrl+' km/s < w/|k| < '+vstrh+' km/s'

mform    = '(";",a5,a26,2a42)'
FOR j=0L, nlhw - 1L DO BEGIN           $
  jstr = STRTRIM(j,2)                & $
  PRINT,FORMAT=mform,jstr[0],scets[j],k_str[j],v_str[j]
;--------------------------------------------------------------------------------------------------------------------
;    j        Date/Time                     0.05 < k rho_ce < 0.4                          wlh/k (km/s)
;------------------------------------------------------------------------------------------------------
;=====================================================================================================================
; => Lower Hybrid Only
;--------------------------------------------------------------------------------------------------------------------
;    0  1998-08-26/06:40:54.9410     0.0458 km^(-1) < |k| < 0.3664 km^(-1)    263.6289 km/s < w/|k| < 2109.0311 km/s
;    1  1998-08-26/06:41:10.0010     0.0452 km^(-1) < |k| < 0.3619 km^(-1)    262.2649 km/s < w/|k| < 2098.1196 km/s
;    2  1998-09-24/23:43:18.9510     0.0782 km^(-1) < |k| < 0.6255 km^(-1)    231.1905 km/s < w/|k| < 1849.5239 km/s
;    3  1998-09-24/23:48:39.0200     0.0767 km^(-1) < |k| < 0.6136 km^(-1)    242.2437 km/s < w/|k| < 1937.9497 km/s
;    4  1998-09-24/23:48:51.6220     0.0755 km^(-1) < |k| < 0.6041 km^(-1)    245.1781 km/s < w/|k| < 1961.4250 km/s
;    5  1998-09-25/00:04:04.5450     0.0466 km^(-1) < |k| < 0.3724 km^(-1)    263.5271 km/s < w/|k| < 2108.2169 km/s
;    6  1998-09-25/00:14:50.6030     0.0467 km^(-1) < |k| < 0.3739 km^(-1)    258.7241 km/s < w/|k| < 2069.7930 km/s
;--------------------------------------------------------------------------------------------------------------------
; => Lower-Hybrid Whistler Mix
;--------------------------------------------------------------------------------------------------------------------
;    0  1997-12-10/04:33:15.6050     0.0389 km^(-1) < |k| < 0.3114 km^(-1)    149.9575 km/s < w/|k| < 1199.6598 km/s
;    1  1998-08-26/06:40:26.1200     0.0355 km^(-1) < |k| < 0.2843 km^(-1)    249.4299 km/s < w/|k| < 1995.4393 km/s
;    2  1998-09-24/23:20:38.8420     0.0947 km^(-1) < |k| < 0.7578 km^(-1)    172.1049 km/s < w/|k| < 1376.8395 km/s
;    3  1998-09-24/23:22:26.6320     0.0879 km^(-1) < |k| < 0.7033 km^(-1)    245.6801 km/s < w/|k| < 1965.4404 km/s
;    4  1998-09-24/23:22:48.1500     0.0886 km^(-1) < |k| < 0.7089 km^(-1)    245.1080 km/s < w/|k| < 1960.8638 km/s
;    5  1998-09-24/23:30:48.5420     0.0850 km^(-1) < |k| < 0.6796 km^(-1)    245.3084 km/s < w/|k| < 1962.4676 km/s
;    6  1998-09-24/23:45:52.1840     0.0797 km^(-1) < |k| < 0.6377 km^(-1)    233.0576 km/s < w/|k| < 1864.4605 km/s
;    7  1998-09-24/23:48:42.1310     0.0788 km^(-1) < |k| < 0.6304 km^(-1)    242.9680 km/s < w/|k| < 1943.7443 km/s
;    8  1998-09-24/23:45:53.3790     0.0806 km^(-1) < |k| < 0.6450 km^(-1)    232.8811 km/s < w/|k| < 1863.0490 km/s
;    9  1998-09-25/00:05:23.4320     0.0430 km^(-1) < |k| < 0.3443 km^(-1)    263.0994 km/s < w/|k| < 2104.7954 km/s
;   10  2000-02-11/23:33:56.4910     0.0318 km^(-1) < |k| < 0.2543 km^(-1)    267.4636 km/s < w/|k| < 2139.7092 km/s
;   11  2000-02-11/23:33:58.3510     0.0325 km^(-1) < |k| < 0.2601 km^(-1)    256.5565 km/s < w/|k| < 2052.4519 km/s
;   12  2000-02-11/23:34:00.7310     0.0317 km^(-1) < |k| < 0.2535 km^(-1)    246.9465 km/s < w/|k| < 1975.5718 km/s
;--------------------------------------------------------------------------------------------------------------------
; => Whistler Only
;--------------------------------------------------------------------------------------------------------------------
;--------------------------------------------------------------------------------------------------------------------

















