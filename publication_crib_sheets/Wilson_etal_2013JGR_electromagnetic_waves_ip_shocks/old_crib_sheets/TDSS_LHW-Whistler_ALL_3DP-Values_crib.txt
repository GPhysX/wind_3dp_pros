;-----------------------------------------------------------------------------------------
; => Constants and dummy variables
;-----------------------------------------------------------------------------------------
f      = !VALUES.F_NAN
d      = !VALUES.D_NAN
kB     = 1.380658d-23      ; -Boltzmann Constant (J/K)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
K_eV   = 1.160474d4        ; -Conversion = degree Kelvin/eV
epo    = 8.854187817d-12   ; -Permittivity of free space (F/m)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
me     = 9.1093897d-31     ; -Electron mass (kg)
mp     = 1.6726231d-27     ; -Proton mass (kg)
qq     = 1.60217733d-19    ; -Fundamental charge (C)
c      = 2.99792458d8      ; -Speed of light in vacuum (m/s)
c2     = (c*1d-3)^2        ; -" " squared (km/s)^2
me_ev  = 0.5109906d6       ; -Electron mass in eV/c^2
me_3dp = me_ev/c2          ; -Electron mass [eV/(km/s)^2]
mp_ev  = 938.27231d6       ; -Proton mass in eV/c^2
mp_3dp = mp_ev/c2          ; -Proton mass [eV/(km/s)^2]
beta_fac = 1d6*(kB*K_eV)*(2d0*muo)
;-----------------------------------------------------------------------------------------
; => Check date 
;-----------------------------------------------------------------------------------------
date   = '121097'
t      = ['1997-12-10/03:33:00','1997-12-10/05:33:00']
tramp  = '1997-12-10/04:33:14.664'
gnorm      = [-0.903, 0.168,-0.397]   ; => Using RH08 from JCK's site
dgnorm     = [ 0.015, 0.032, 0.374]
gnorm2     = [-0.971, 0.094,-0.218]   ; => Using RH08 from JCK's site
dgnorm2    = [ 0.016, 0.071, 0.214]


date    = '082698'
t       = ['1998-08-26/05:40:00','1998-08-26/07:40:00']  ; -For moment writing
tramp   = '1998-08-26/06:40:24.972'
gnorm   = [-0.655,0.040,-0.754]   ; => Using RH08 from JCK's site
dgnorm  = [0.010,0.009,0.561]
gnorm2  = [-0.822,0.138,-0.553]   ; => Using RH09 from JCK's site
dgnorm2 = [0.040,0.070,0.488]

date    = '092498'
t       = ['1998-09-24/22:20:00','1998-09-25/00:30:00']
tramp   = '1998-09-24/23:20:37.374'
gnorm   = [-0.914,-0.220,-0.341]   ; => Using RH08 from JCK's site
dgnorm  = [ 0.004, 0.009, 0.327]
gnorm2  = [-0.939,-0.175,-0.296]   ; => Using RH09 from JCK's site
dgnorm2 = [ 0.024, 0.070, 0.287]

date    = '021100'
t       = ['2000-02-11/22:33:00','2000-02-12/00:33:00']
tramp   = '2000-02-11/23:33:55.319'
gnorm   = [-0.865,-0.452,0.218]   ; => Using RH08 from JCK's site
dgnorm  = [ 0.017, 0.030,0.214]
gnorm2  = [-0.930,-0.367,-0.028]   ; => Using RH09 from JCK's site
dgnorm2 = [ 0.025, 0.063, 0.028]
;-----------------------------------------------------------------------------------------
; => Load MFI data
;-----------------------------------------------------------------------------------------
tr3    = time_double(t)
tura   = time_double(tramp)

mydate = my_str_date(DATE=date)
sdate  = mydate.S_DATE[0]  ; -('MMDDYY')
ldate  = mydate.DATE[0]    ; -('YYYYMMDD')
tdate  = mydate.TDATE[0]   ; => 'YYYY-MM-DD'

mag3  = read_wind_mfi(TRANGE=tr3)
t3x   = mag3.MAG.X
bmag4 = mag3.MAG.Y
magf4 = mag3.BGSE.Y
nt    = N_ELEMENTS(t3x) 
store_data,'wi_B3_MAG(GSE)',DATA={X:mag3.MAG.X,Y:bmag4}
store_data,'wi_B3(GSE)',DATA={X:mag3.MAG.X,Y:magf4}
nn0 =['wi_B3_MAG(GSE)','wi_B3(GSE)']
options,'wi_B3_MAG(GSE)',"YTITLE","|B| (nT)!C[GSE,3s]"
options,'wi_B3(GSE)',"YTITLE","B (nT)!C[GSE,3s]"
options,'wi_B3(GSE)','COLORS',[250,150,50]
tplot_options,'xmargin',[18,12]
tplot_options,'ymargin',[5,5]
tplot,nn0,TRANGE=tr3

htr_mfi2tplot,DATE=date
get_data,'WIND_B3_HTR(GSE,nT)',DATA=temporary_mfi
magf_htr = temporary_mfi
str_element,magf_htr,'R',REPLICATE(1L,N_ELEMENTS(magf_htr.X)),/ADD_REPLACE
;-----------------------------------------------------------------------------------------
; => Get TDS data
;-----------------------------------------------------------------------------------------
; => Get TDSS data
my_tdss    = get_wind_tds_data(DATE=date,FIXFILE=1,/TDSS)
x          = LINDGEN(N_ELEMENTS(my_tdss.SCET))
IF (sdate[0] EQ '121097') THEN gels = [x[17L:20L]]
IF (sdate[0] EQ '082698') THEN gels = [x[14L:37L],x[41L:60L]]
IF (sdate[0] EQ '092498') THEN gels = [x[24L:43L],x[47L:50L],x[53L:72L],x[76L:91L]]
IF (sdate[0] EQ '021100') THEN gels = [x[0L:11L],x[15L:34L]]
; => Get ONLY whistler TDSS
IF (gels[0] NE -1) THEN scetss  = my_tdss.SCET[gels[*]]             ELSE scetss  = ''
IF (gels[0] NE -1) THEN evnums  = my_tdss.EVENT_N[gels[*]]          ELSE evnums  = -1

unq        = UNIQ(evnums,SORT(evnums))
ascets     = scetss[unq]
aevnum     = evnums[unq]

unix0      = time_double(ascets)
unix       = [unix0-6d0,unix0-3d0,unix0,unix0+3d0,unix0+6d0]
spu        = SORT(unix)
unix       = unix[spu]
;-----------------------------------------------------------------------------------------
; => Find shock info
;-----------------------------------------------------------------------------------------
sh_mit     = read_shocks_jck_database()
mit_dates  = sh_mit.SDATES                 ; => 'MMDDYY'
shocks     = sh_mit.SHOCK
header     = sh_mit.HEADER
ymdb_ra    = header.DATE_TIME              ; => ['YYYY-MM-DD/HH:MM:SS.sss']
mts        = my_time_string(ymdb_ra,STR=1,FORM=1)
unix_ra    = mts.UNIX

a_thetabn  = shocks.THETA_BN               ; => Shock normal angles (deg)
a_shnorms  = shocks.SH_NORM                ; => " " vectors (GSE)
a_vshn     = shocks.VSH_N                  ; => Shock normal velocity (SC-Frame) [km/s]
a_ushn     = shocks.USH_N                  ; => Shock normal velocity (Shock-Frame) [km/s]
a_compr    = shocks.COMPRESSION            ; => Shock compression ratio
a_vsw_up   = REFORM(header.VSW[*,*,0])     ; => Upstream SW Velocity (km/s)
a_vsw_dn   = REFORM(header.VSW[*,*,1])     ; => Downstream SW Velocity (km/s)
a_Cs_up    = REFORM(header.C_SOUND[*,0])   ; => Upstream Sound Speed (km/s)
a_Cs_dn    = REFORM(header.C_SOUND[*,1])   ; => Downstream Sound Speed (km/s)
a_Va_up    = REFORM(header.V_ALFVEN[*,0])  ; => Upstream Alfven Speed (km/s)
a_Va_dn    = REFORM(header.V_ALFVEN[*,1])  ; => Downstream Alfven Speed (km/s)

gshock     = WHERE(mit_dates EQ date,gsh)

IF (sdate[0] EQ '021100') THEN kk = 1 ELSE kk = 0

midra = tura
  gnorm = REFORM(a_shnorms[gshock[kk],*])
  gthbn = (REFORM(a_thetabn[gshock[kk]]))[0]
  gvshn = (REFORM(a_vshn[gshock[kk]]))[0]
  gushn = (REFORM(a_ushn[gshock[kk]]))[0]
  gcomp = (REFORM(a_compr[gshock[kk]]))[0]
  gvswu = REFORM(a_vsw_up)
  gvswd = REFORM(a_vsw_dn)
  gcsup = (REFORM(a_Cs_up[gshock[kk]]))[0]
  gcsdn = (REFORM(a_Cs_dn[gshock[kk]]))[0]
  gvaup = (REFORM(a_Va_up[gshock[kk]]))[0]
  gvadn = (REFORM(a_Va_dn[gshock[kk]]))[0]
;-----------------------------------------------------------------------------------------
; => Find Wind/3DP IDL Save Files
;-----------------------------------------------------------------------------------------
default_extension = '/wind_3dp_pros/wind_data_dir/Wind_3DP_DATA/IDL_Save_Files/'
default_location  = default_extension+date+'/'

DEFSYSV,'!wind3dp_umn',EXISTS=exists
IF NOT KEYWORD_SET(exists) THEN mdir  = FILE_EXPAND_PATH('')+default_location
IF     KEYWORD_SET(exists) THEN mdir  = !wind3dp_umn.WIND_3DP_SAVE_FILE_DIR+date+'/'
IF (mdir EQ '')            THEN mdir = default_location
mfiles = FILE_SEARCH(mdir,'*.sav')


RESTORE,mfiles[0]
RESTORE,mfiles[1]
RESTORE,mfiles[2]
RESTORE,mfiles[3]   ; => For 1998-08-26

goodsf = WHERE(asf.TIME GE tr3[0] and asf.END_TIME LE tr3[1],gdsf)
goodso = WHERE(aso.TIME GE tr3[0] and aso.END_TIME LE tr3[1],gdso)
asf    = asf[goodsf]
aso    = aso[goodso]
;-----------------------------------------------------------------------------------------
; => SST Open and Foil 3DP Maps
;-----------------------------------------------------------------------------------------
plot3d_options,MAP='ham',LOG =1,TRIANGULATE=1,COMPRESS=1,GRID=[30,30]
eb         = [0,6]
tasf       = asf
nsf        = N_ELEMENTS(tasf)
g_ener     = TOTAL(tasf.ENERGY,3,/NAN)/ TOTAL(FINITE(tasf.ENERGY),3,/NAN)
eners      = REVERSE(TOTAL(g_ener,2,/NAN)/ TOTAL(FINITE(g_ener),2,/NAN))
g_string   = [(roundsig(minmax(eners[eb]),SIG=2))[0],(roundsig(minmax(eners[eb]),SIG=2))[1]]
estring    = STRTRIM(STRING(FORMAT='(f10.1)',g_string*1d-3),2)
IF (FLOAT(estring[0]) LT 100.) THEN ss = 4 ELSE ss = 3
IF (FLOAT(estring[1]) GT 1e3)  THEN mm = 4 ELSE mm = 3
estring    = '_'+STRMID(estring[0],0,ss)+'-'+STRMID(estring[1],0,mm)+'keV'
bdir       = '~/Desktop/3DP_contours/'+date[0]
;pdir       = bdir+'/Hammer-Aitoff_Projections/SST_Foil_anti-Bfield-center/'
;suffx      = estring+'_anti-Bfield-center_DF_MAGF-MID'
pdir       = bdir+'/Hammer-Aitoff_Projections/SST_Foil_Bfield-center/'
suffx      = estring+'_Bfield-center_DF_MAGF-MID'
pref       = 'SST-Foil_Hammer-Aitoff_'
mts        = my_time_string(tasf.TIME,UNIX=1)
ymdb       = mts.DATE_TIME
UTtime     = STRMID(ymdb[*],11L,2L)+STRMID(ymdb[*],14L,2L)+$
             STRMID(ymdb[*],17L,2L)+STRMID(ymdb[*],19L,3L)
gdate      = STRMID(ymdb[*],0L,10L)
FOR j=0L, nsf - 1L DO BEGIN                                    $
  dat    = tasf[j]                                           & $
  fname  = pdir+pref+gdate[j]+'_'+UTtime[j]+suffx            & $
  popen,fname,/PORT                                          & $
;    plot3d,dat,BNCENTER=-1,UNITS='df',EBINS=eb,EX_VEC=gnorm  & $
    plot3d,dat,BNCENTER=1,UNITS='df',EBINS=eb,EX_VEC=gnorm  & $
  pclose


eb         = [3,8]  ; => For 1998-08-26
taso       = aso
nso        = N_ELEMENTS(taso)
g_ener     = TOTAL(taso.ENERGY,3,/NAN)/ TOTAL(FINITE(taso.ENERGY),3,/NAN)
eners      = TOTAL(g_ener,2,/NAN)/ TOTAL(FINITE(g_ener),2,/NAN)
g_string   = [(roundsig(minmax(eners[eb]),SIG=2))[0],(roundsig(minmax(eners[eb]),SIG=2))[1]]
estring    = STRTRIM(STRING(FORMAT='(f10.1)',g_string*1d-3),2)
IF (FLOAT(estring[0]) LT 100.) THEN ss = 4 ELSE ss = 3
IF (FLOAT(estring[1]) GT 1e3)  THEN mm = 4 ELSE mm = 3
estring    = '_'+STRMID(estring[0],0,ss)+'-'+STRMID(estring[1],0,mm)+'keV'
bdir       = '~/Desktop/3DP_contours/'+date[0]
;pdir       = bdir+'/Hammer-Aitoff_Projections/SST_Open_anti-Bfield-center/'
;suffx      = estring+'_anti-Bfield-center_DF_MAGF-MID'
pdir       = bdir+'/Hammer-Aitoff_Projections/SST_Open_Bfield-center/'
suffx      = estring+'_Bfield-center_DF_MAGF-MID'
pref       = 'SST-Open_Hammer-Aitoff_'
mts        = my_time_string(taso.TIME,UNIX=1)
ymdb       = mts.DATE_TIME
UTtime     = STRMID(ymdb[*],11L,2L)+STRMID(ymdb[*],14L,2L)+$
             STRMID(ymdb[*],17L,2L)+STRMID(ymdb[*],19L,3L)
gdate      = STRMID(ymdb[*],0L,10L)
FOR j=0L, nso - 1L DO BEGIN                                    $
  dat    = taso[j]                                           & $
  fname  = pdir+pref+gdate[j]+'_'+UTtime[j]+suffx            & $
  popen,fname,/PORT                                          & $
;    plot3d,dat,BNCENTER=-1,UNITS='df',EBINS=eb,EX_VEC=gnorm  & $
    plot3d,dat,BNCENTER=1,UNITS='df',EBINS=eb,EX_VEC=gnorm  & $
  pclose

;-----------------------------------------------------------------------------------------
; => Spectra Plots
;-----------------------------------------------------------------------------------------
temp = [ael,aelb]
sp   = SORT(temp.TIME)
temp = temp[sp]

tr0  = ['1998-08-26/06:36:42','1998-08-26/06:42:40']
avra = time_double(['1998-08-26/05:40:00','1998-08-26/06:30:00'])

data = calc_padspecs('el',DAT_ARR=temp,/G_MAGF,NUM_PA=16L,/DAT_CLN,EBINS=[0,7],UNITS='df')
data = calc_padspecs('eh',DAT_ARR=aeh,/G_MAGF,NUM_PA=10L,/DAT_CLN,UNITS='df')
data = calc_padspecs('sf',DAT_ARR=asf,/G_MAGF,NUM_PA=10L,/DAT_CLN,UNITS='df',/NO_KILL,/DAT_NORM,RANGE_AVG=avra)
data = calc_padspecs('so',DAT_ARR=aso,/G_MAGF,NUM_PA=10L,/DAT_CLN,UNITS='df',/NO_KILL,/DAT_NORM,RANGE_AVG=avra)


DELVAR,temp
pesa_high_str_fill,temp,NAME='ph',DUM1=aph,DUM2=aphb
sp   = SORT(temp.TIME)
temp = temp[sp]


my_eners = dat_3dp_energy_bins(aph[0],EBINS=enbins)
estart   = my_eners.E_BINS[0]
eend     = my_eners.E_BINS[1]
diffen   = eend-estart+1
nenergy  = diffen
myen     = my_eners.ALL_ENERGIES
labels   = STRMID(STRTRIM(STRING(FORMAT='(f12.1)',myen),2),0,6)+' eV'

num_pa   = 8L
nph      = N_ELEMENTS(aph)
nphb     = N_ELEMENTS(aphb)
units    = 'df'
data     = REPLICATE(f,nph,nenergy,num_pa) ; -data array [# of time samples, energies, angles]
energy   = REPLICATE(f,nph,nenergy)
pang     = REPLICATE(f,nph,num_pa)

datab    = REPLICATE(f,nphb,nenergy,num_pa) ; -data array [# of time samples, energies, angles]
energyb  = REPLICATE(f,nphb,nenergy)
pangb    = REPLICATE(f,nphb,num_pa)


FOR i=0L, nph - 1L DO BEGIN                                                    $
  tdat = aph[i]                                                              & $
  tdat = conv_units(tdat,units)                                              & $
  pad  = pad(tdat,NUM_PA=num_pa,BINS=bins,SPIKES=spikes)                     & $
  IF (pad.VALID EQ 1) THEN data[i,*,*] = pad.DATA                            & $
  energy[i,*] = TOTAL(pad.ENERGY,2,/NAN)/TOTAL(FINITE(pad.ANGLES),2,/NAN)    & $
  pang[i,*]   = TOTAL(pad.ANGLES,1,/NAN)/TOTAL(FINITE(pad.ENERGY),1,/NAN)

FOR i=0L, nphb - 1L DO BEGIN                                                   $
  tdat = aphb[i]                                                             & $
  tdat = conv_units(tdat,units)                                              & $
  pad  = pad(tdat,NUM_PA=num_pa,BINS=bins,SPIKES=spikes)                     & $
  IF (pad.VALID EQ 1) THEN datab[i,*,*] = pad.DATA                           & $
  energyb[i,*] = TOTAL(pad.ENERGY,2,/NAN)/TOTAL(FINITE(pad.ANGLES),2,/NAN)   & $
  pangb[i,*]   = TOTAL(pad.ANGLES,1,/NAN)/TOTAL(FINITE(pad.ENERGY),1,/NAN)

mytim    = [aph.TIME,aphb.TIME]
pang0    = [pang,pangb]
energy0  = [energy,energyb]
data0    = [data,datab]

;mytim    = aph.TIME
spu      = SORT(mytim)
mytim    = mytim[spu]
data0    = data0[spu,*,*]
energy0  = energy0[spu,*]
pang0    = pang0[spu,*]

name     = 'ph_pads'
IF KEYWORD_SET(name) EQ 0 THEN name = yname ELSE yname = name
yname = yname+' ('+units+')'

dum_t    = ['YTITLE','X','Y','V1','V2','YLOG','LABELS','PANEL_SIZE']
datastr  = CREATE_STRUCT(dum_t,yname,mytim,data0,energy0,pang0,1,labels,2.0)
store_data,'ph_pads',DATA=datastr

get_data,'ph_pads',DATA=dat,DLIM=dlim,LIM=lim
my_ens = dat_3dp_energy_bins(dat,EBINS=ebins2)
estart = my_ens.E_BINS[0]
eend   = my_ens.E_BINS[1]
myen   = my_ens.ALL_ENERGIES
myn    = N_ELEMENTS(dat)
datv1  = dat.V1[*,estart:eend]
mbins  = N_ELEMENTS(dat.V1[*,0])       ; # of samples
daty   = dat.Y
gvals  = WHERE(datv1 LE 0.0 OR FINITE(datv1) EQ 0,gvls)
  datv1 = dat.v1
  datv2 = REPLICATE(1.,mbins) # myen[estart:eend]
  gvind = ARRAY_INDICES(datv1,gvals)
  datv1[gvind[0,*],gvind[1,*]] = datv2[gvind[0,*],gvind[1,*]]
mylb  = STRARR(myn)
tn1   = STRUPCASE(STRMID(name,0,1)) ; -1st letter of structure name
tn2   = STRUPCASE(STRMID(name,1,1)) ; -2nd letter of structure name
tnlen = STRLEN(name)
    mylb  = STRMID(STRTRIM(STRING(FORMAT='(f12.1)',myen),2),0,6)+' eV'
dat2 = CREATE_STRUCT(dum_t,name,dat.X,daty[*,estart:eend,*],datv1,dat.V2,1,$
                     mylb[estart:eend],2.0)

dat_lab_posi = my_3dp_plot_labels(dat2)

myposi = dat_lab_posi.POSITIONS
mylabs = dat_lab_posi.LABELS
myen   = myen[estart:eend]
mylb   = mylb[estart:eend]
baabs  = WHERE(FINITE(mylabs) EQ 0,baa)  ; -make sure labels are not NAN's
gunits = units[0]
new_units = wind_3dp_units(gunits)
gunits    = new_units.G_UNIT_NAME      ; => e.g. 'flux'
punits    = new_units.G_UNIT_P_NAME    ; => e.g. ' (# cm!U-2!Ns!U-1!Nsr!U-1!NeV!U-1!N)'
IF NOT KEYWORD_SET(num_pa) THEN mynpa = meps.ANGLES ELSE mynpa = num_pa[0]
strns = dat_3dp_str_names('ph')
name  = strns.SN
pname = STRUPCASE(name)

nyttl = name+gunits[0]+'!C'+punits[0]
mstr  = CREATE_STRUCT(dum_t,nyttl,dat.X,daty[*,estart:eend,*],datv1,dat.V2,1,mylabs,2.0)
bdpts = WHERE(mstr.Y LE 0.0,bp)
newna = ''
newna = 'nph_pads'
store_data,newna,DATA=mstr,DLIM=dlim,LIM=lim

shon = ''
shon = STRMID(newna,0,3)
options,newna,'YTITLE',pname+' '+gunits[0]+'!C'+punits[0]
options,newna,'XMINOR',4    ; -set # of minor X-Tick marks to 4
options,newna,'YMINOR',9    ; -set # of minor Y-Tick marks to 9
gy11 = WHERE(mstr.Y GT 0.0 AND FINITE(mstr.Y),g11)
  gyind1 = ARRAY_INDICES(mstr.y,gy11)
  ymin1  = MIN(mstr.Y[gyind1[0,*],gyind1[1,*],gyind1[2,*]],/NAN)/1.1
  ymax1  = MAX(mstr.Y[gyind1[0,*],gyind1[1,*],gyind1[2,*]],/NAN)*1.1
  options,newna,'YRANGE',[ymin1,ymax1]
  options,newna,'YLOG',1
mysip = (SIZE(mstr.Y,/DIMENSIONS))[0]/800L
    hsmooth = 3L
    lsmooth = 3L
IF (shon EQ 'nsf' OR shon EQ 'nso') THEN lbflg = -1 ELSE lblfg = 1
options,newna,'LABFLAG',lbflg
    mysmp = [0,2,hsmooth]
    mysnp = lsmooth           ; -base smoothing step " "        

sffx_d0  = ''
sffx_d1  = ''
sffx_d0 += '_n'
sffx_d1 += '_cln'

newna2 = newna
clean_spec_spikes,newna2,NSMOOTH=mysnp,ESMOOTH=mysmp,NEW_NAME=newna2+sffx_d1

myangs  = STRARR(mynpa - 1L)
ang     = FLTARR(2,mynpa - 1L)
FOR i=0, mynpa - 2L DO BEGIN                    $
  j        = i + 1L                           & $
  pang     = FLTARR(2)                        & $
  reduce_pads,newna,2,i,j,ANGLES=pang,/NAN    & $
  ang[*,i] = pang

myangs  = STRTRIM(STRING(FORMAT='(f5.1)',ang[0,*]),1)
myangs += '-'+STRTRIM(STRING(FORMAT='(f5.1)',ang[1,*]),1)+'!Uo!N'
zdata   = omni_z_pads(newna,LABS=mylabs,PANGS=myangs)


FOR i=0L, mynpa - 2L DO BEGIN                    $
  tdata = zdata[i]                             & $
  tangl = myangs[i]                            & $
  options,tdata,'YTITLE',pname+'!C'+tangl      & $
  clean_spec_spikes,tdata,NSMOOTH=mysnp,ESMOOTH=mysmp,NEW_NAME=tdata+sffx_d1

; => average smoothed data to get normalized results
avra = time_double(['1998-08-26/05:40:00','1998-08-26/06:30:00'])
FOR i=0L, mynpa - 2L DO BEGIN                    $
  tdata = zdata[i]                             & $
  tangl = myangs[i]                            & $
  spec_vec_data_shift,tdata,NEW_NAME=tdata+sffx_d1+sffx_d0,/DATN,RANGE_AVG=avra & $
  options,tdata+sffx_d1+sffx_d0,'YTITLE',pname+' Normalized & Shifted'+'!C'+tangl



tr0  = ['1998-08-26/06:36:42','1998-08-26/06:42:40']
tlimit,tr0

test   = file_name_times(tr0,PREC=0)
sfname = test.F_TIME[0]+'_'+test.F_TIME[1]

nn0    = tnames(['WIND_MAG_HTR(GSE,nT)','WIND_B3_HTR(GSE,nT)'])
n00    = ['nel_pads-2-0:1_N','nel_pads-2-7:8_N','nel_pads-2-14:15_N']
prefx  = 'HTR-MFI_EL-para-perp-anti-dfspec_'
nna    = tnames(n00)
tplot,[nn0,nna],TRANGE=time_double(tr0)
popen,prefx[0]+sfname[0]
  tplot,[nn0,nna],TRANGE=time_double(tr0)
pclose

n00    = ['neh_pads-2-0:1_N','neh_pads-2-4:5_N','neh_pads-2-8:9_N']
prefx  = 'HTR-MFI_EH-para-perp-anti-dfspec_'
nna    = tnames(n00)
tplot,[nn0,nna],TRANGE=time_double(tr0)
popen,prefx[0]+sfname[0]
  tplot,[nn0,nna],TRANGE=time_double(tr0)
pclose


tr1    = time_double(tr0) + [-6d2,6d2]
test   = file_name_times(tr1,PREC=0)
sfname = test.F_TIME[0]+'_'+test.F_TIME[1]

n00    = ['nsf_pads-2-0:1_N_n','nsf_pads-2-4:5_N_n','nsf_pads-2-8:9_N_n']
prefx  = 'HTR-MFI_SF-para-perp-anti-dfspec-NORM_'
nna    = tnames(n00)
tplot,[nn0,nna],TRANGE=time_double(tr1)
popen,prefx[0]+sfname[0]
  tplot,[nn0,nna],TRANGE=time_double(tr1)
pclose

n00    = ['nso_pads-2-0:1_N_n','nso_pads-2-4:5_N_n','nso_pads-2-8:9_N_n']
prefx  = 'HTR-MFI_SO-para-perp-anti-dfspec-NORM_'
nna    = tnames(n00)
tplot,[nn0,nna],TRANGE=time_double(tr1)
popen,prefx[0]+sfname[0]
  tplot,[nn0,nna],TRANGE=time_double(tr1)
pclose


test   = file_name_times(tr3,PREC=0)
sfname = test.F_TIME[0]+'_'+test.F_TIME[1]
n00    = ['nsf_pads-2-0:1_N_n','nsf_pads-2-4:5_N_n','nsf_pads-2-8:9_N_n']
prefx  = 'HTR-MFI_SF-para-perp-anti-dfspec-NORM_'
nna    = tnames(n00)
tplot,[nn0,nna],TRANGE=time_double(tr3)
popen,prefx[0]+sfname[0]
  tplot,[nn0,nna],TRANGE=time_double(tr3)
pclose

n00    = ['nso_pads-2-0:1_N_n','nso_pads-2-4:5_N_n','nso_pads-2-8:9_N_n']
prefx  = 'HTR-MFI_SO-para-perp-anti-dfspec-NORM_'
nna    = tnames(n00)
tplot,[nn0,nna],TRANGE=time_double(tr3)
popen,prefx[0]+sfname[0]
  tplot,[nn0,nna],TRANGE=time_double(tr3)
pclose

n00    = ['nph_pads-2-0:1_N','nph_pads-2-3:4_N','nph_pads-2-6:7_N']+'_cln_n'
prefx  = 'HTR-MFI_PH-para-perp-anti-dfspec-NORM_'
nna    = tnames(n00)
tplot,[nn0,nna],TRANGE=time_double(tr0)
popen,prefx[0]+sfname[0]
  tplot,[nn0,nna],TRANGE=time_double(tr0)
pclose

;-----------------------------------------------------------------------------------------
; => Calculate the heat flux vectors
;-----------------------------------------------------------------------------------------
nel  = N_ELEMENTS(ael)
nelb = N_ELEMENTS(aelb)

aqvec  = DBLARR(nel,3L)
aqmag  = DBLARR(nel)
aqvecb = DBLARR(nelb,3L)
aqmagb = DBLARR(nelb)
FOR j=0L, nel - 1L DO BEGIN                   $
  dat     = ael[j]                          & $
  del     = convert_vframe(dat,/INTERP)     & $
  sum     = mom_sum(del,SC_POT=del.SC_POT)  & $
  sumt    = mom_translate(sum)              & $
  charge  = sumt.CHARGE                     & $
  mass    = sumt.MASS                       & $
  nnorm   = SQRT(ABS(2*charge/mass))        & $          ; -[(km/s) eV^(-1/2)]
  i3      = [[0,4,8],[9,13,17],[18,22,26]]  & $
  qtens   = (mass*nnorm^2)*sumt.NVVV        & $          ; => Heat flux tensor
  qqqs    = (sumt.NVVV[sumt.MAP_R3])[i3]    & $ 
  qvec    = TOTAL(qqqs,1L,/NAN)             & $          ; => Q_vec [eV km/s cm^(-3), GSE]
  qmag    = SQRT(TOTAL(qvec^2,/NAN))        & $          ; => Magnitude of Heat flux [eV km/s cm^(-3)]
  qvec    = qvec/qmag[0]                    & $
  aqvec[j,*] = qvec                         & $
  aqmag[j]   = qmag

FOR j=0L, nelb - 1L DO BEGIN                  $
  dat     = aelb[j]                         & $
  del     = convert_vframe(dat,/INTERP)     & $
  sum     = mom_sum(del,SC_POT=del.SC_POT)  & $
  sumt    = mom_translate(sum)              & $
  charge  = sumt.CHARGE                     & $
  mass    = sumt.MASS                       & $
  nnorm   = SQRT(ABS(2*charge/mass))        & $          ; -[(km/s) eV^(-1/2)]
  i3      = [[0,4,8],[9,13,17],[18,22,26]]  & $
  qtens   = (mass*nnorm^2)*sumt.NVVV        & $          ; => Heat flux tensor
  qqqs    = (sumt.NVVV[sumt.MAP_R3])[i3]    & $ 
  qvec    = TOTAL(qqqs,1L,/NAN)             & $          ; => Q_vec [eV km/s cm^(-3), GSE]
  qmag    = SQRT(TOTAL(qvec^2,/NAN))        & $          ; => Magnitude of Heat flux [eV km/s cm^(-3)]
  qvec    = qvec/qmag[0]                    & $
  aqvecb[j,*] = qvec                        & $
  aqmagb[j]   = qmag

; => 1998-09-24 Only has EL (no Burst data)
elscets = ael.TIME
elqvecs = aqvec
elbvecs = TRANSPOSE(ael.MAGF)
elqmag  = aqmag
sp      = SORT(elscets)
elscets = elscets[sp]
elqvecs = elqvecs[sp,*]
elbvecs = elbvecs[sp,*]
elqmag  = elqmag[sp]

elscets = [ael.TIME,aelb.TIME]
elqvecs = [aqvec,aqvecb]
elbvecs = [TRANSPOSE(ael.MAGF),TRANSPOSE(aelb.MAGF)]
elqmag  = [aqmag,aqmagb]
sp      = SORT(elscets)
elscets = elscets[sp]
elqvecs = elqvecs[sp,*]
elbvecs = elbvecs[sp,*]
elqmag  = elqmag[sp]

elunix  = elscets
unq     = UNIQ(elunix,SORT(elunix))
elunix  = elunix[unq]
elscets = elscets[unq]
elqvecs = elqvecs[unq,*]
elbvecs = elbvecs[unq,*]
elqmag  = elqmag[unq]
elscets = time_string(elunix,PREC=3)

uelbvec = elbvecs/(SQRT(TOTAL(elbvecs^2,2,/NAN)) # REPLICATE(1d0,3L))
thqb    = ACOS(my_dot_prod(elqvecs,uelbvec,/NOM))*18d1/!DPI
thqb    = thqb < (18d1 - thqb)

gels       = REPLICATE(-1,N_ELEMENTS(ascets),5L)
FOR j=0L, N_ELEMENTS(ascets) - 1L DO BEGIN      $
  good = WHERE(elunix LE unix0[j],gd)         & $
  gdmx = MAX(good)                            & $
  IF (gd GT 0 AND gdmx[0] GE 2) THEN gels[j,*] = [gdmx[0]-2L,gdmx[0]-1L,gdmx[0],gdmx[0]+1L,gdmx[0]+2L]  & $
  IF (gdmx[0] EQ 1) THEN gels[j,*] = [-1L,gdmx[0]-1L,gdmx[0],gdmx[0]+1L,gdmx[0]+2L]  & $
  IF (gdmx[0] EQ 0) THEN gels[j,*] = [-1L,-1L,gdmx[0],gdmx[0]+1L,gdmx[0]+2L]


mform      = '(";",a25,3f12.3,2f15.2)'
FOR j=0L, N_ELEMENTS(ascets) - 1L DO BEGIN      $
  g_els = REFORM(gels[j,*])                   & $
  FOR k=0L, 4L DO BEGIN                         $
    PRINT,FORMAT=mform,elscets[g_els[k]],elqvecs[g_els[k],0],elqvecs[g_els[k],1],elqvecs[g_els[k],2],elqmag[g_els[k]],thqb[g_els[k]]
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|           Theta_qB
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]     [deg]
;===================================================================================================
;  1997-12-10/04:33:08.851      -0.678       0.694       0.243       49288.46          20.68
;  1997-12-10/04:33:11.852      -0.580       0.799       0.158       25558.82          19.72
;  1997-12-10/04:33:14.854      -0.173       0.794       0.583       29980.29          10.15
;  1997-12-10/04:33:17.855      -0.639       0.750       0.170       47181.76          39.56
;  1997-12-10/04:33:20.857      -0.591       0.781       0.200       37165.00          33.30
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|           Theta_qB
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]     [deg]
;===================================================================================================
;  1998-08-26/06:40:18.569      -0.595       0.802       0.047      122473.93          19.05
;  1998-08-26/06:40:21.671      -0.690       0.720       0.070      119291.88          27.97
;  1998-08-26/06:40:24.773      -0.998       0.033      -0.060      581260.88          79.48
;  1998-08-26/06:40:27.874      -0.621      -0.774      -0.122      622388.88          42.44
;  1998-08-26/06:40:30.976      -0.952      -0.065      -0.300      302379.28          89.91
;  1998-08-26/06:40:46.484      -0.703      -0.711      -0.024      566547.19          44.41
;  1998-08-26/06:40:49.586      -0.798      -0.602      -0.030      611512.94          53.84
;  1998-08-26/06:40:52.688      -0.908       0.321      -0.268      532601.88          60.31
;  1998-08-26/06:40:55.789      -0.781      -0.353      -0.516      484066.75          85.15
;  1998-08-26/06:40:58.891      -0.812      -0.331      -0.481      584803.69          89.46
;  1998-08-26/06:40:55.789      -0.781      -0.353      -0.516      484066.75          85.15
;  1998-08-26/06:40:58.891      -0.812      -0.331      -0.481      584803.69          89.46
;  1998-08-26/06:41:08.196      -0.964      -0.253      -0.083      867317.56          75.56
;  1998-08-26/06:41:11.298      -0.956      -0.241      -0.165      705539.06          73.89
;  1998-08-26/06:41:14.399      -0.993       0.029      -0.117      653031.62          57.23
;  1998-08-26/06:41:29.908      -0.889      -0.222      -0.401      461978.34          79.05
;  1998-08-26/06:41:33.009      -0.938      -0.197      -0.286      505954.31          66.95
;  1998-08-26/06:41:36.111      -0.960      -0.212      -0.183      700478.94          67.08
;  1998-08-26/06:41:39.213      -0.912      -0.373      -0.169      647672.69          70.12
;  1998-08-26/06:41:42.314      -0.891      -0.406      -0.204      636713.69          73.55
;  1998-08-26/06:41:45.416      -0.911      -0.330      -0.248      612313.19          69.19
;  1998-08-26/06:41:48.170      -0.892      -0.416      -0.178      571918.69          70.66
;  1998-08-26/06:41:51.272      -0.882      -0.417      -0.218      551149.75          70.35
;  1998-08-26/06:41:54.373      -0.877      -0.431      -0.212      577154.12          70.43
;  1998-08-26/06:41:57.475      -0.854      -0.465      -0.235      582873.62          74.21
;  1998-08-26/06:42:00.577      -0.810      -0.548      -0.209      572277.44          70.02
;  1998-08-26/06:42:03.678      -0.813      -0.436      -0.387      467681.31          70.59
;  1998-08-26/06:42:06.780      -0.897      -0.329      -0.296      527356.62          61.83
;  1998-08-26/06:42:09.882      -0.841      -0.533      -0.093      526955.50          51.34
;  1998-08-26/06:42:12.983      -0.703      -0.608      -0.369      406896.12          73.39
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|           Theta_qB
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]     [deg]
;===================================================================================================
;  1998-09-24/23:17:11.389      -0.624       0.763       0.168      138630.03           3.49
;  1998-09-24/23:18:51.442      -0.423       0.897       0.126      119029.96           0.35
;  1998-09-24/23:20:31.496      -0.690       0.723       0.015      122909.21           4.24
;  1998-09-24/23:22:11.549      -0.789       0.547       0.280      509243.59          34.53
;  1998-09-24/23:23:51.603      -0.813       0.551       0.188      473331.62          35.42
;  1998-09-24/23:25:31.656      -0.949       0.254       0.187      402174.22          49.67
;  1998-09-24/23:27:11.709      -0.958       0.229       0.170      566852.62          49.09
;  1998-09-24/23:28:51.763      -0.816       0.554       0.167      499393.31          35.86
;  1998-09-24/23:30:31.816      -0.920       0.251       0.301      503668.16          47.59
;  1998-09-24/23:32:11.870      -0.963       0.230       0.139      604874.12          48.87
;  1998-09-24/23:33:51.923      -0.767       0.564       0.306      553658.12          32.19
;  1998-09-24/23:38:52.083      -0.947       0.273       0.171      584098.69          45.86
;  1998-09-24/23:40:32.137      -0.955       0.177       0.236      651539.25          51.71
;  1998-09-24/23:42:12.190      -0.833       0.550       0.054      435179.19          40.14
;  1998-09-24/23:43:52.243      -0.894       0.445      -0.055      517020.22          49.72
;  1998-09-24/23:45:32.297      -0.800       0.581       0.150      369204.84          31.26
;  1998-09-24/23:47:12.350      -0.765       0.377       0.522      503347.00          12.99
;  1998-09-24/23:48:52.404      -0.965       0.078       0.252      348453.34          52.59
;  1998-09-24/23:50:32.457      -0.986      -0.160       0.040      407451.53          67.15
;  1998-09-25/00:00:32.777      -0.944      -0.082       0.321      386093.41          39.02
;  1998-09-25/00:02:12.831      -0.992      -0.049      -0.112      289219.31          67.81
;  1998-09-25/00:03:53.396      -0.818      -0.560      -0.135      321150.75          87.06
;  1998-09-25/00:05:33.451      -0.951      -0.306      -0.054      296470.44          86.77
;  1998-09-25/00:07:13.506      -0.894      -0.043      -0.446      319071.34          86.01
;  1998-09-25/00:10:33.615      -0.764      -0.141      -0.629      321463.19          70.03
;  1998-09-25/00:12:13.670      -0.889      -0.453       0.064      352935.59          75.09
;  1998-09-25/00:13:53.725      -0.828      -0.531       0.182      279494.59          82.88
;  1998-09-25/00:15:33.780      -0.587      -0.809       0.031      231217.73          40.32
;  1998-09-25/00:17:13.834      -0.778      -0.609      -0.154      222925.72          44.77
;  1998-09-25/00:18:53.889      -0.781      -0.600      -0.173      190193.08          51.49
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|           Theta_qB
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]     [deg]
;===================================================================================================
;  2000-02-11/23:33:49.831      -0.499       0.849      -0.172      192977.48           1.74
;  2000-02-11/23:33:52.928      -0.436       0.884      -0.165      122641.39           3.85
;  2000-02-11/23:33:56.026      -0.551      -0.823      -0.140       70779.80          64.80
;  2000-02-11/23:33:59.123      -0.552       0.826      -0.109      138312.41           5.54
;  2000-02-11/23:34:02.221      -0.400       0.916      -0.021      201211.38           5.59
;  2000-02-11/23:34:05.318      -0.630       0.776      -0.033      206567.22          10.61
;  2000-02-11/23:34:20.805      -0.710       0.704      -0.018      257667.19          20.38
;  2000-02-11/23:34:23.902      -0.651       0.758       0.041      245440.16          17.33
;  2000-02-11/23:34:27.000      -0.625       0.770       0.131      211692.02          17.36
;  2000-02-11/23:34:30.097      -0.730       0.683      -0.005      191773.41          23.26
;  2000-02-11/23:34:33.194      -0.697       0.712       0.082      182623.66          22.30
;  2000-02-12/00:10:41.359      -0.576       0.569       0.587       99765.70          36.21
;  2000-02-12/00:12:20.475      -0.186       0.368       0.911       98323.45          27.20
;  2000-02-12/00:13:59.592      -0.303       0.452       0.839       95051.55          25.52
;  2000-02-12/00:15:38.708      -0.262       0.491       0.831       88252.61          25.91
;  2000-02-12/00:17:17.824      -0.229       0.484       0.845       87552.45          24.69
;  2000-02-12/00:22:15.172      -0.316       0.672       0.670       82671.75          24.12
;  2000-02-12/00:23:54.288      -0.332       0.687       0.646       78135.24          23.30
;  2000-02-12/00:25:33.404      -0.552       0.800       0.236       96658.23          16.13
;  2000-02-12/00:27:12.520      -0.712       0.701       0.041       97966.79          18.27
;  2000-02-12/00:28:51.637      -0.790       0.610      -0.056       90649.55          22.79
;  2000-02-12/00:30:30.753      -0.860       0.495      -0.125       69735.58          27.62
;---------------------------------------------------------------------------------------------------

thqb_before = [19.72,79.48,60.31,75.56,66.95,73.55,70.35,70.43,70.43,74.21,70.59,61.83,$
                0.35, 4.24, 4.24,35.86,35.86,40.14,49.72,49.72,12.99,12.99,12.99,67.81,$
               87.06,82.88, 3.85,64.80, 5.54,17.33,17.36,27.20,23.30,16.13]
thqb_during = [10.15,42.44,85.15,73.89,67.08,69.19,70.43,74.21,74.21,70.02,61.83,51.34,$
                4.24,34.53,34.53,47.59,47.59,49.72,31.26,31.26,52.59,52.59,52.59,87.06,$
               86.77,40.32,64.80, 5.54, 5.59,17.36,23.26,25.52,16.13,18.27]
thqb_after  = [39.56,89.91,89.46,57.23,70.12,70.66,74.21,70.02,70.02,70.59,51.34,73.39,$
               34.53,35.42,35.42,48.87,48.87,31.26,12.99,12.99,67.15,67.15,67.15,86.77,$
               86.01,44.77, 5.54, 5.59,10.61,23.26,22.30,25.91,18.27,22.79]




; => For 1998-08-26
c_el_ens = [[6L,14L],[5L,14L]]
h_el_ens = [[0L, 5L],[0L, 4L]]
gg_els   = (LINDGEN(1000))[55L:60L]

nel      = N_ELEMENTS(gg_els)
sform    = moments_3d()
ael3dp   = REPLICATE(sform,nel)
acl3dp   = REPLICATE(sform,nel)
ahl3dp   = REPLICATE(sform,nel)
FOR j=0L, nel - 1L DO BEGIN                                   $
  dat     = aelb[gg_els[j]]                                 & $
  IF (j LE 1) THEN cener = REFORM(c_el_ens[*,0])            & $
  IF (j LE 1) THEN hener = REFORM(h_el_ens[*,0])            & $
  IF (j GE 2) THEN cener = REFORM(c_el_ens[*,1])            & $
  IF (j GE 2) THEN hener = REFORM(h_el_ens[*,1])            & $
  del     = convert_vframe(dat,/INTERP)                     & $
  temp    = moments_3d(dat,SC_POT=dat.SC_POT)               & $
  ael3dp[j] = temp[0]                                       & $
  temp    = moments_3d(dat,SC_POT=dat.SC_POT,ERANGE=cener)  & $
  acl3dp[j] = temp[0]                                       & $
  temp    = moments_3d(dat,SC_POT=dat.SC_POT,ERANGE=hener)  & $
  ahl3dp[j] = temp[0]

avgtempa  = REFORM(ael3dp.AVGTEMP)       ; => Avg. Particle Temp (eV)
avgtempc  = REFORM(acl3dp.AVGTEMP)       ; => Avg. Particle Temp (eV)
avgtemph  = REFORM(ahl3dp.AVGTEMP)       ; => Avg. Particle Temp (eV)

tempveca  = TRANSPOSE(ael3dp.MAGT3)      ; => Vector Temp [perp1,perp2,para] (eV)
tempvecc  = TRANSPOSE(acl3dp.MAGT3)      ; => Vector Temp [perp1,perp2,para] (eV)
tempvech  = TRANSPOSE(ahl3dp.MAGT3)      ; => Vector Temp [perp1,perp2,para] (eV)

t_perpa   = 5e-1*(tempveca[*,0] + tempveca[*,1])
t_perpc   = 5e-1*(tempvecc[*,0] + tempvecc[*,1])
t_perph   = 5e-1*(tempvech[*,0] + tempvech[*,1])

t_paraa   = REFORM(tempveca[*,2])
t_parac   = REFORM(tempvecc[*,2])
t_parah   = REFORM(tempvech[*,2])

tanis     = t_perpa/t_paraa
tanic     = t_perpc/t_parac
tanih     = t_perph/t_parah

telscts   = time_string(aelb[gg_els].TIME,PREC=0)
test      = waves_fpe_ascii_read(DATE=date)
wunix     = test.UNIX          ; => Unix times
wdens     = test.DENSITY       ; => cm^(-3)
elmagf    = TRANSPOSE(aelb[gg_els].MAGF)
elbmag    = SQRT(TOTAL(elmagf^2,2L,/NAN))
eldens    = interp(wdens,wunix,aelb[gg_els].TIME,/NO_EXTRAP)
beta_cpar = (2d0*kB*muo)*(eldens*1d6)*(t_parac*K_eV)/((elbmag*1d-9)^2)

mform      = '(";",a30,f12.3,4f12.3)'
FOR j=0L, N_ELEMENTS(telscts) - 1L DO BEGIN      $
  PRINT,FORMAT=mform,telscts[j],beta_cpar[j],elmagf[j,0],elmagf[j,1],elmagf[j,2],elbmag[j]
;-----------------------------------------------------------------------------------------
;      Date        Time             Betaparc       Bx          By          Bz          |B|
;=========================================================================================
;           1998-08-26/06:40:18       0.745      -2.564       7.931       1.010       8.396
;           1998-08-26/06:40:21       0.513      -2.738       9.636       1.294      10.101
;           1998-08-26/06:40:24       0.524      -2.504      15.670       1.753      15.966
;           1998-08-26/06:40:27       0.866      -1.038      18.723      -0.077      18.752
;           1998-08-26/06:40:30       1.022      -0.753      19.669      -1.964      19.781
;           1998-08-26/06:40:34       0.744      -0.006      22.482      -2.833      22.660
;-----------------------------------------------------------------------------------------


mform     = '(";",a23,3f12.3)'
FOR j=0L, N_ELEMENTS(telscts) - 1L DO BEGIN      $
  PRINT,FORMAT=mform,telscts[j],avgtempa[j],avgtempc[j],avgtemph[j]
;-----------------------------------------------------------------------------------------
;      Date        Time         Te         Tec         Teh
;=========================================================================================
;    1998-08-26/06:40:18      24.163      16.942     176.591
;    1998-08-26/06:40:21      24.737      17.271     176.821
;    1998-08-26/06:40:24      46.663      34.800     169.668
;    1998-08-26/06:40:27      53.819      38.881     201.972
;    1998-08-26/06:40:30      54.718      40.876     200.187
;    1998-08-26/06:40:34      52.473      39.158     200.872
;-----------------------------------------------------------------------------------------

mform     = '(";",a23,3f12.3)'
FOR j=0L, N_ELEMENTS(telscts) - 1L DO BEGIN      $
  PRINT,FORMAT=mform,telscts[j],t_paraa[j],t_parac[j],t_parah[j]
;-----------------------------------------------------------------------------------------
;      Date        Time       Te_//       Tec_//      Teh_//
;=========================================================================================
;    1998-08-26/06:40:18      26.524      15.443     258.236
;    1998-08-26/06:40:21      26.434      15.212     253.474
;    1998-08-26/06:40:24      41.200      31.225     147.978
;    1998-08-26/06:40:27      55.099      40.378     202.954
;    1998-08-26/06:40:30      52.445      40.892     175.346
;    1998-08-26/06:40:34      53.189      39.079     212.712
;-----------------------------------------------------------------------------------------

mform     = '(";",a23,3f12.3)'
FOR j=0L, N_ELEMENTS(telscts) - 1L DO BEGIN      $
  PRINT,FORMAT=mform,telscts[j],t_perpa[j],t_perpc[j],t_perph[j]
;-----------------------------------------------------------------------------------------
;      Date        Time       Te_|_       Tec_|_      Teh_|_
;=========================================================================================
;    1998-08-26/06:40:18      22.983      17.691     135.768
;    1998-08-26/06:40:21      23.888      18.301     138.494
;    1998-08-26/06:40:24      49.394      36.588     180.513
;    1998-08-26/06:40:27      53.179      38.132     201.481
;    1998-08-26/06:40:30      55.854      40.868     212.607
;    1998-08-26/06:40:34      52.114      39.198     194.952
;-----------------------------------------------------------------------------------------

mform     = '(";",a23,3f12.3)'
FOR j=0L, N_ELEMENTS(telscts) - 1L DO BEGIN      $
  PRINT,FORMAT=mform,telscts[j],tanis[j],tanic[j],tanih[j]
;-----------------------------------------------------------------------------------------
;      Date        Time       Te_ani      Tec_ani     Teh_ani
;=========================================================================================
;    1998-08-26/06:40:18       0.866       1.146       0.526
;    1998-08-26/06:40:21       0.904       1.203       0.546
;    1998-08-26/06:40:24       1.199       1.172       1.220
;    1998-08-26/06:40:27       0.965       0.944       0.993
;    1998-08-26/06:40:30       1.065       0.999       1.212
;    1998-08-26/06:40:34       0.980       1.003       0.917
;-----------------------------------------------------------------------------------------



;-----------------------------------------------------------------------------------------
; => Load ion moments
;-----------------------------------------------------------------------------------------
eesa_pesa_low_to_tplot,DATE=date,TRANGE=tr3,/G_MAGF,PLM=apl,PLBM=aplb, $
                       ELM=ael,ELBM=aelb,/TO_TPLOT

;pesa_low_moment_calibrate,DATE=date,/NOLOAD,PLM=apl,PLBM=aplb,TRANGE=tr3,COMPRESS=gcomp,MIDRA=midra
pesa_high_moment_calibrate,DATE=date,/NOLOAD,PHM=aph,PHBM=aphb,TRANGE=tr3

nnw = tnames()
options,nnw,'YSTYLE',1
options,nnw,'PANEL_SIZE',2.
options,nnw,'XMINOR',5
options,nnw,'XTICKLEN',0.04
;-----------------------------------------------------------------------------------------
; => Load WAVES Denstiy estimates
;-----------------------------------------------------------------------------------------
test  = waves_fpe_ascii_read(DATE=date)
wunix = test.UNIX          ; => Unix times
wdens = test.DENSITY       ; => cm^(-3)
weine = test.E_INERT_L     ; => m
wfpe  = test.F_PE          ; => Hz

store_data,'waves_density',DATA={X:wunix,Y:wdens}
options,'waves_density','YTITLE','N!De!N (cm!U-3!N)'
nnw = tnames()
options,nnw,'YSTYLE',1
options,nnw,'PANEL_SIZE',2.
options,nnw,'XMINOR',5
options,nnw,'XTICKLEN',0.04

get_data,'T_avg_el_sw',DATA=temp_ela
get_data,'T_avg_ce_sw',DATA=temp_elc
get_data,'T_avg_he_sw',DATA=temp_elh
get_data,'Tpara_el_sw',DATA=tpara_ela
get_data,'Tperp_el_sw',DATA=tperp_ela
get_data,'Tpara_ce_sw',DATA=tpara_elc
get_data,'Tperp_ce_sw',DATA=tperp_elc
get_data,'Tpara_he_sw',DATA=tpara_elh
get_data,'Tperp_he_sw',DATA=tperp_elh

get_data,'V_sw2',DATA=vsw_pl
get_data,'T_i2',DATA=temp_pl
get_data,'N_i3',DATA=dens_pl

get_data,'WIND_B3_HTR(GSE,nT)',DATA=htr_mfi

gelsi      = REPLICATE(-1,N_ELEMENTS(ascets),5L)
FOR j=0L, N_ELEMENTS(ascets) - 1L DO BEGIN      $
  good = WHERE(temp_pl.X LE unix0[j],gd)      & $
  gdmx = MAX(good)                            & $
  IF (gd GT 0 AND gdmx[0] GE 2) THEN gelsi[j,*] = [gdmx[0]-2L,gdmx[0]-1L,gdmx[0],gdmx[0]+1L,gdmx[0]+2L]  & $
  IF (gdmx[0] EQ 1) THEN gelsi[j,*] = [-1L,gdmx[0]-1L,gdmx[0],gdmx[0]+1L,gdmx[0]+2L]  & $
  IF (gdmx[0] EQ 0) THEN gelsi[j,*] = [-1L,-1L,gdmx[0],gdmx[0]+1L,gdmx[0]+2L]


plscets    = time_string(temp_pl.X,PREC=3)
mform      = '(";",a30,2f12.3,3f15.3)'
FOR j=0L, N_ELEMENTS(ascets) - 1L DO BEGIN      $
  g_els = REFORM(gelsi[j,*])                  & $
  FOR k=0L, 4L DO BEGIN                         $
    PRINT,FORMAT=mform,plscets[g_els[k]],dens_pl.Y[g_els[k]],temp_pl.Y[g_els[k]],$
                       vsw_pl.Y[g_els[k],0],vsw_pl.Y[g_els[k],1],vsw_pl.Y[g_els[k],2]
;---------------------------------------------------------------------------------------------------
;      Date        Time                Ni[PL]      Ti            Vx              Vy             Vz
;===================================================================================================
;       1998-08-26/06:40:18.569       7.968      27.186       -493.556          4.161         -7.628
;       1998-08-26/06:40:21.671       8.131      26.887       -487.377          5.665        -14.044
;       1998-08-26/06:40:24.773       8.241      27.120       -496.088          5.147        -17.203
;       1998-08-26/06:40:27.874      25.943      75.780       -631.917        -13.102       -136.851
;       1998-08-26/06:40:30.976      25.941      87.070       -640.998         -7.789       -150.768
;---------------------------------------------------------------------------------------------------

elmagf     = [TRANSPOSE(ael.MAGF),TRANSPOSE(aelb.MAGF)]
elunix     = [ael.TIME,aelb.TIME]
spe        = SORT(elunix)
elmagf     = elmagf[spe,*]
elbmag     = SQRT(TOTAL(elmagf^2,2L,/NAN))

eldens     = interp(wdens,wunix,elunix,/NO_EXTRAP)
beta_cpar  = (2d0*kB*muo)*(eldens*1d6)*(tpara_elc.Y*K_eV)/((elbmag*1d-9)^2)

mform      = '(";",a30,3f12.3)'
FOR j=0L, N_ELEMENTS(ascets) - 1L DO BEGIN      $
  g_els = REFORM(gels[j,*])                   & $
  FOR k=0L, 4L DO BEGIN                         $
    PRINT,FORMAT=mform,elscets[g_els[k]],temp_ela.Y[g_els[k]],temp_elc.Y[g_els[k]],$
                       temp_elh.Y[g_els[k]]
;-----------------------------------------------------------------------------------------
;      Date        Time                Te         Tec         Teh
;=========================================================================================
;       1998-08-26/06:40:18.569      28.283      20.019     249.347
;       1998-08-26/06:40:21.671      28.870      20.393     248.389
;       1998-08-26/06:40:24.773      49.173      40.007     281.276
;       1998-08-26/06:40:27.874      55.614      43.842     304.825
;       1998-08-26/06:40:30.976      55.580      45.116     305.876
;-----------------------------------------------------------------------------------------

mform      = '(";",a30,f12.3,4f12.3)'
FOR j=0L, N_ELEMENTS(ascets) - 1L DO BEGIN      $
  g_els = REFORM(gels[j,*])                   & $
  FOR k=0L, 4L DO BEGIN                         $
    PRINT,FORMAT=mform,elscets[g_els[k]],beta_cpar[g_els[k]],elmagf[g_els[k],0],$
                       elmagf[g_els[k],1],elmagf[g_els[k],2],elbmag[g_els[k]]
;-----------------------------------------------------------------------------------------
;      Date        Time             Betaparc       Bx          By          Bz          |B|
;=========================================================================================
;       1998-08-26/06:40:18.569       0.715      -2.564       7.931       1.010       8.396
;       1998-08-26/06:40:21.671       0.477      -2.738       9.636       1.294      10.101
;       1998-08-26/06:40:24.773       0.323      -2.504      15.670       1.753      15.966
;       1998-08-26/06:40:27.874       0.310      -1.038      18.723      -0.077      18.752
;       1998-08-26/06:40:30.976       0.265      -0.753      19.669      -1.964      19.781
;-----------------------------------------------------------------------------------------

mform      = '(";",a30,3f12.3)'
FOR j=0L, N_ELEMENTS(ascets) - 1L DO BEGIN      $
  g_els = REFORM(gels[j,*])                   & $
  FOR k=0L, 4L DO BEGIN                         $
    PRINT,FORMAT=mform,elscets[g_els[k]],tpara_ela.Y[g_els[k]],tpara_elc.Y[g_els[k]],$
                       tpara_elh.Y[g_els[k]]
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_//       Tec_//      Teh_//
;=========================================================================================
;       1998-08-26/06:40:18.569      32.845      20.235     368.081
;       1998-08-26/06:40:21.671      32.523      19.666     363.911
;       1998-08-26/06:40:24.773      42.096      33.716     257.688
;       1998-08-26/06:40:27.874      56.974      44.876     304.466
;       1998-08-26/06:40:30.976      52.066      42.930     270.653
;-----------------------------------------------------------------------------------------

mform      = '(";",a30,3f12.3)'
FOR j=0L, N_ELEMENTS(ascets) - 1L DO BEGIN      $
  g_els = REFORM(gels[j,*])                   & $
  FOR k=0L, 4L DO BEGIN                         $
    PRINT,FORMAT=mform,elscets[g_els[k]],tperp_ela.Y[g_els[k]],tperp_elc.Y[g_els[k]],$
                       tperp_elh.Y[g_els[k]]
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_|_       Tec_|_      Teh_|_
;=========================================================================================
;       1998-08-26/06:40:18.569      26.002      19.911     189.980
;       1998-08-26/06:40:21.671      27.044      20.757     190.629
;       1998-08-26/06:40:24.773      52.711      43.152     293.070
;       1998-08-26/06:40:27.874      54.934      43.325     305.005
;       1998-08-26/06:40:30.976      57.336      46.209     323.488
;-----------------------------------------------------------------------------------------

tanis      = tperp_ela.Y/tpara_ela.Y
tanic      = tperp_elc.Y/tpara_elc.Y
tanih      = tperp_elh.Y/tpara_elh.Y
mform      = '(";",a30,3f12.3)'
FOR j=0L, N_ELEMENTS(ascets) - 1L DO BEGIN      $
  g_els = REFORM(gels[j,*])                   & $
  FOR k=0L, 4L DO BEGIN                         $
    PRINT,FORMAT=mform,elscets[g_els[k]],tanis[g_els[k]],tanic[g_els[k]],$
                       tanih[g_els[k]]
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_ani      Tec_ani     Teh_ani
;=========================================================================================
;       1998-08-26/06:40:18.569       0.792       0.984       0.516
;       1998-08-26/06:40:21.671       0.832       1.055       0.524
;       1998-08-26/06:40:24.773       1.252       1.280       1.137
;       1998-08-26/06:40:27.874       0.964       0.965       1.002
;       1998-08-26/06:40:30.976       1.101       1.076       1.195
;-----------------------------------------------------------------------------------------

;-----------------------------------------------------------------------------------------
; => Look at moments around TDS samples
;-----------------------------------------------------------------------------------------
tds_teall  = interp(temp_ela.Y,temp_ela.X,unix,/NO_EXTRAP)
tds_tec    = interp(temp_elc.Y,temp_elc.X,unix,/NO_EXTRAP)
tds_teh    = interp(temp_elh.Y,temp_elh.X,unix,/NO_EXTRAP)
tds_teapa  = interp(tpara_ela.Y,tpara_ela.X,unix,/NO_EXTRAP)
tds_teape  = interp(tperp_ela.Y,tperp_ela.X,unix,/NO_EXTRAP)
tds_tecpa  = interp(tpara_elc.Y,tpara_elc.X,unix,/NO_EXTRAP)
tds_tecpe  = interp(tperp_elc.Y,tperp_elc.X,unix,/NO_EXTRAP)
tds_tehpa  = interp(tpara_elh.Y,tpara_elh.X,unix,/NO_EXTRAP)
tds_tehpe  = interp(tperp_elh.Y,tperp_elh.X,unix,/NO_EXTRAP)

tds_dens   = interp(wdens,wunix,unix,/NO_EXTRAP)
tds_tipl   = interp(temp_pl.Y,temp_pl.X,unix,/NO_EXTRAP)
tds_vswx   = interp(vsw_pl.Y[*,0],vsw_pl.X,unix,/NO_EXTRAP)
tds_vswy   = interp(vsw_pl.Y[*,1],vsw_pl.X,unix,/NO_EXTRAP)
tds_vswz   = interp(vsw_pl.Y[*,2],vsw_pl.X,unix,/NO_EXTRAP)

tds_magx   = interp(htr_mfi.Y[*,0],htr_mfi.X,unix,/NO_EXTRAP)
tds_magy   = interp(htr_mfi.Y[*,1],htr_mfi.X,unix,/NO_EXTRAP)
tds_magz   = interp(htr_mfi.Y[*,2],htr_mfi.X,unix,/NO_EXTRAP)
tds_magf   = [[tds_magx],[tds_magy],[tds_magz]]
tds_bmag   = SQRT(TOTAL(tds_magf^2,2L,/NAN))

beta_cpar  = (2d0*kB*muo)*(tds_dens*1d6)*(tds_tecpa*K_eV)/((tds_bmag*1d-9)^2)

nscets     = time_string(unix,PREC=3)+' UT'
mform      = '(";",a30,2f12.3,3f15.3)'
FOR j=0L, N_ELEMENTS(nscets) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,nscets[j],tds_dens[j],tds_tipl[j],tds_vswx[j],tds_vswy[j],tds_vswz[j]

;---------------------------------------------------------------------------------------------------
;      Date        Time                Ni          Ti            Vx              Vy             Vz
;===================================================================================================
;    1997-12-10/04:33:09.605 UT      12.409       6.633       -294.636          8.505         -7.640
;    1997-12-10/04:33:12.605 UT      13.205       6.775       -291.469          9.671         -5.575
;    1997-12-10/04:33:15.605 UT      14.002       9.837       -314.548         10.913        -16.628
;    1997-12-10/04:33:18.605 UT      14.799      14.685       -367.825          9.440        -37.180
;    1997-12-10/04:33:21.605 UT      15.596      15.597       -369.565          4.941        -23.959
;---------------------------------------------------------------------------------------------------
;      Date        Time                Ni          Ti            Vx              Vy             Vz
;===================================================================================================
;    1998-08-26/06:40:20.120 UT       8.493      27.036       -490.468          4.913        -10.834
;    1998-08-26/06:40:23.120 UT       8.581      26.996       -491.445          5.423        -15.519
;    1998-08-26/06:40:26.120 UT      14.147      48.250       -555.071         -2.777        -69.159
;    1998-08-26/06:40:29.120 UT      21.989      80.312       -635.562        -10.969       -142.438
;    1998-08-26/06:40:32.120 UT      24.289      85.651       -635.771        -11.516       -142.386
;    1998-08-26/06:40:48.941 UT      23.836      87.839       -640.275        -16.440       -131.908
;    1998-08-26/06:40:51.941 UT      23.374      91.198       -635.899        -13.737       -143.008
;    1998-08-26/06:40:54.941 UT      22.911     100.266       -627.834         -1.037       -147.112
;    1998-08-26/06:40:57.941 UT      22.449      94.953       -625.061         24.244       -153.722
;    1998-08-26/06:41:00.941 UT      22.102      90.090       -626.660         24.026       -165.122
;    1998-08-26/06:41:04.001 UT      22.003      85.967       -627.087         19.232       -168.272
;    1998-08-26/06:41:07.001 UT      21.907      80.689       -626.424         19.270       -166.506
;    1998-08-26/06:41:10.001 UT      21.810      75.230       -611.358          8.253       -167.555
;    1998-08-26/06:41:13.001 UT      21.714      74.107       -600.319          2.063       -169.904
;    1998-08-26/06:41:16.001 UT      21.617      76.376       -599.615          5.130       -171.821
;    1998-08-26/06:41:31.623 UT      21.115      94.402       -617.989          2.276       -167.786
;    1998-08-26/06:41:34.623 UT      21.018      96.991       -621.688         18.514       -172.761
;    1998-08-26/06:41:37.623 UT      20.740      97.926       -624.523         28.156       -172.991
;    1998-08-26/06:41:38.013 UT      20.684      97.752       -625.373         29.659       -173.412
;    1998-08-26/06:41:40.623 UT      20.308      96.293       -627.037         28.659       -172.564
;    1998-08-26/06:41:41.013 UT      20.252      96.038       -626.774         27.102       -171.971
;    1998-08-26/06:41:43.623 UT      19.876      94.981       -623.066         25.654       -170.861
;    1998-08-26/06:41:44.013 UT      19.820      94.920       -622.222         26.771       -171.121
;    1998-08-26/06:41:47.013 UT      19.388      94.449       -615.734         35.365       -173.115
;    1998-08-26/06:41:47.249 UT      19.354      94.412       -615.223         36.041       -173.272
;    1998-08-26/06:41:50.013 UT      18.956      93.258       -615.022         36.584       -172.713
;    1998-08-26/06:41:50.249 UT      18.922      93.107       -615.423         36.096       -172.492
;    1998-08-26/06:41:50.315 UT      18.912      93.065       -615.535         35.959       -172.430
;    1998-08-26/06:41:51.909 UT      18.683      91.870       -617.653         33.633       -171.371
;    1998-08-26/06:41:53.233 UT      18.492      90.212       -617.185         35.344       -172.123
;    1998-08-26/06:41:53.249 UT      18.489      90.192       -617.180         35.365       -172.132
;    1998-08-26/06:41:53.315 UT      18.480      90.110       -617.156         35.450       -172.170
;    1998-08-26/06:41:54.909 UT      18.250      88.594       -616.924         37.399       -172.892
;    1998-08-26/06:41:56.233 UT      18.060      90.321       -618.793         38.319       -172.344
;    1998-08-26/06:41:56.249 UT      18.057      90.342       -618.816         38.330       -172.337
;    1998-08-26/06:41:56.315 UT      18.048      90.428       -618.909         38.376       -172.310
;    1998-08-26/06:41:57.909 UT      17.818      92.303       -620.820         39.779       -171.913
;    1998-08-26/06:41:59.233 UT      17.628      90.878       -617.455         45.240       -175.425
;    1998-08-26/06:41:59.249 UT      17.625      90.861       -617.415         45.306       -175.468
;    1998-08-26/06:41:59.315 UT      17.616      90.790       -617.247         45.578       -175.643
;    1998-08-26/06:41:59.763 UT      17.551      90.308       -616.108         47.425       -176.831
;    1998-08-26/06:42:00.909 UT      17.386      89.074       -613.196         52.152       -179.871
;    1998-08-26/06:42:02.233 UT      17.195      88.900       -617.809         55.471       -181.179
;    1998-08-26/06:42:02.315 UT      17.184      88.890       -618.100         55.675       -181.259
;    1998-08-26/06:42:02.763 UT      17.119      88.836       -619.694         56.789       -181.692
;    1998-08-26/06:42:03.131 UT      17.066      88.792       -621.003         57.704       -182.048
;    1998-08-26/06:42:03.909 UT      16.954      88.698       -623.770         59.640       -182.801
;    1998-08-26/06:42:05.233 UT      16.763      89.516       -623.041         59.231       -180.230
;    1998-08-26/06:42:05.763 UT      16.687      89.882       -622.537         58.923       -179.050
;    1998-08-26/06:42:06.131 UT      16.656      90.136       -622.187         58.709       -178.231
;    1998-08-26/06:42:08.763 UT      16.724      89.741       -625.749         47.797       -178.527
;    1998-08-26/06:42:09.131 UT      16.734      89.497       -626.764         45.472       -179.093
;    1998-08-26/06:42:11.763 UT      16.802      90.482       -630.370         37.317       -179.093
;    1998-08-26/06:42:12.131 UT      16.811      90.893       -630.508         37.026       -178.688
;    1998-08-26/06:42:15.131 UT      16.889      93.394       -634.345         24.001       -179.992
;---------------------------------------------------------------------------------------------------
;      Date        Time                Ni          Ti            Vx              Vy             Vz
;===================================================================================================
;    1998-09-24/23:20:32.842 UT      15.537      27.471       -457.860         37.189         70.446
;    1998-09-24/23:20:35.842 UT      16.062      30.647       -470.107         32.623         64.143
;    1998-09-24/23:20:38.842 UT      16.586      33.823       -482.355         28.057         57.841
;    1998-09-24/23:20:41.842 UT      17.111      36.998       -494.602         23.492         51.539
;    1998-09-24/23:20:44.842 UT      17.636      40.174       -506.849         18.926         45.237
;    1998-09-24/23:22:20.632 UT      20.973      86.656       -680.560        -18.848       -104.668
;    1998-09-24/23:22:23.632 UT      21.030      86.352       -680.441        -19.929       -102.978
;    1998-09-24/23:22:26.632 UT      21.087      86.049       -680.323        -21.010       -101.289
;    1998-09-24/23:22:29.632 UT      21.145      85.746       -680.205        -22.092        -99.600
;    1998-09-24/23:22:32.632 UT      21.202      85.442       -680.086        -23.173        -97.911
;    1998-09-24/23:22:42.150 UT      21.384      84.479       -679.711        -26.603        -92.551
;    1998-09-24/23:22:45.150 UT      21.441      84.176       -679.593        -27.685        -90.862
;    1998-09-24/23:22:48.150 UT      21.499      83.873       -679.474        -28.766        -89.172
;    1998-09-24/23:22:51.150 UT      21.556      83.569       -679.356        -29.847        -87.483
;    1998-09-24/23:22:54.150 UT      21.614      83.266       -679.238        -30.929        -85.794
;    1998-09-24/23:29:54.465 UT      24.313      75.222       -643.959        -34.796        -52.469
;    1998-09-24/23:29:57.465 UT      24.330      75.309       -644.762        -34.328        -54.906
;    1998-09-24/23:30:00.465 UT      24.340      75.395       -645.565        -33.859        -57.344
;    1998-09-24/23:30:03.465 UT      24.320      75.481       -646.367        -33.390        -59.782
;    1998-09-24/23:30:06.465 UT      24.300      75.567       -647.170        -32.922        -62.219
;    1998-09-24/23:30:42.542 UT      24.056      75.508       -650.751        -28.361        -83.622
;    1998-09-24/23:30:45.542 UT      24.036      75.288       -649.855        -28.193        -83.847
;    1998-09-24/23:30:48.542 UT      24.016      75.068       -648.959        -28.025        -84.072
;    1998-09-24/23:30:51.542 UT      23.996      74.847       -648.063        -27.857        -84.296
;    1998-09-24/23:30:54.542 UT      23.975      74.627       -647.167        -27.690        -84.521
;    1998-09-24/23:43:12.951 UT      24.691      77.074       -660.091        -39.413        -35.593
;    1998-09-24/23:43:15.951 UT      24.695      77.133       -659.870        -38.969        -34.057
;    1998-09-24/23:43:18.951 UT      24.699      77.193       -659.650        -38.526        -32.522
;    1998-09-24/23:43:21.951 UT      24.703      77.253       -659.429        -38.083        -30.986
;    1998-09-24/23:43:24.951 UT      24.707      77.313       -659.208        -37.639        -29.451
;    1998-09-24/23:45:46.184 UT      20.300      87.776       -675.986        -40.396        -23.483
;    1998-09-24/23:45:47.379 UT      20.241      87.541       -675.550        -39.985        -23.734
;    1998-09-24/23:45:49.184 UT      20.152      87.187       -674.892        -39.364        -24.113
;    1998-09-24/23:45:50.379 UT      20.093      86.952       -674.457        -38.953        -24.365
;    1998-09-24/23:45:52.184 UT      20.004      86.598       -673.799        -38.333        -24.744
;    1998-09-24/23:45:53.379 UT      19.946      86.363       -673.363        -37.922        -24.995
;    1998-09-24/23:45:55.184 UT      19.857      86.008       -672.705        -37.301        -25.374
;    1998-09-24/23:45:56.379 UT      19.798      85.774       -672.269        -36.891        -25.625
;    1998-09-24/23:45:58.184 UT      19.709      85.419       -671.611        -36.270        -26.004
;    1998-09-24/23:45:59.379 UT      19.650      85.184       -671.176        -35.859        -26.255
;    1998-09-24/23:48:33.020 UT      24.089      79.545       -672.310         62.135        -53.099
;    1998-09-24/23:48:36.020 UT      24.311      79.328       -674.586         67.003        -53.200
;    1998-09-24/23:48:36.131 UT      24.320      79.320       -674.671         67.183        -53.204
;    1998-09-24/23:48:39.020 UT      24.534      79.111       -676.862         71.871        -53.301
;    1998-09-24/23:48:39.131 UT      24.542      79.103       -676.947         72.052        -53.305
;    1998-09-24/23:48:42.020 UT      24.756      78.894       -679.138         76.740        -53.403
;    1998-09-24/23:48:42.131 UT      24.764      78.886       -679.223         76.920        -53.406
;    1998-09-24/23:48:45.020 UT      24.978      78.677       -681.414         81.608        -53.504
;    1998-09-24/23:48:45.131 UT      24.986      78.669       -681.499         81.788        -53.508
;    1998-09-24/23:48:45.622 UT      25.023      78.633       -681.871         82.585        -53.524
;    1998-09-24/23:48:48.131 UT      25.209      78.451       -683.775         86.657        -53.609
;    1998-09-24/23:48:48.622 UT      25.245      78.416       -684.147         87.453        -53.626
;    1998-09-24/23:48:51.622 UT      25.467      78.199       -686.423         92.322        -53.727
;    1998-09-24/23:48:54.622 UT      25.690      78.309       -687.512         88.616        -49.416
;    1998-09-24/23:48:57.622 UT      25.912      78.534       -688.183         81.887        -43.548
;    1998-09-25/00:03:58.545 UT      22.369     106.439       -703.545        -39.977        -28.426
;    1998-09-25/00:04:01.545 UT      22.332     107.044       -703.760        -39.554        -28.986
;    1998-09-25/00:04:04.545 UT      22.313     107.649       -703.974        -39.131        -29.547
;    1998-09-25/00:04:07.545 UT      22.293     108.253       -704.189        -38.707        -30.108
;    1998-09-25/00:04:10.545 UT      22.274     108.858       -704.403        -38.284        -30.669
;    1998-09-25/00:05:17.432 UT      21.843     124.027       -718.687          0.970        -38.406
;    1998-09-25/00:05:20.432 UT      21.823     124.781       -719.740          4.024        -38.547
;    1998-09-25/00:05:23.432 UT      21.804     125.535       -720.792          7.078        -38.687
;    1998-09-25/00:05:26.432 UT      21.785     126.288       -721.845         10.131        -38.828
;    1998-09-25/00:05:29.432 UT      21.766     127.042       -722.898         13.185        -38.968
;    1998-09-25/00:14:44.603 UT      14.658     119.533       -718.696        -43.183        -38.007
;    1998-09-25/00:14:47.603 UT      14.412     117.991       -716.989        -41.731        -34.465
;    1998-09-25/00:14:50.603 UT      14.165     116.449       -715.282        -40.280        -30.922
;    1998-09-25/00:14:53.603 UT      13.919     114.907       -713.575        -38.828        -27.379
;    1998-09-25/00:14:56.603 UT      13.673     113.365       -711.868        -37.377        -23.836
;    1998-09-25/00:28:36.305 UT      15.078         NaN            NaN            NaN            NaN
;    1998-09-25/00:28:39.305 UT      15.152         NaN            NaN            NaN            NaN
;    1998-09-25/00:28:42.305 UT      15.225         NaN            NaN            NaN            NaN
;    1998-09-25/00:28:45.305 UT      15.299         NaN            NaN            NaN            NaN
;    1998-09-25/00:28:48.305 UT      15.372         NaN            NaN            NaN            NaN
;---------------------------------------------------------------------------------------------------
;      Date        Time                Ni          Ti            Vx              Vy             Vz
;===================================================================================================
;    2000-02-11/23:33:50.491 UT      12.751      20.051       -488.151        -39.767         -8.348
;    2000-02-11/23:33:52.351 UT      13.393      21.063       -492.755        -39.822         -6.153
;    2000-02-11/23:33:53.491 UT      13.786      21.431       -498.735        -41.304         -4.090
;    2000-02-11/23:33:54.731 UT      14.214      21.548       -508.772        -44.535         -1.043
;    2000-02-11/23:33:55.351 UT      14.428      21.606       -513.790        -46.150          0.480
;    2000-02-11/23:33:56.491 UT      14.821      22.904       -528.007        -53.383          3.184
;    2000-02-11/23:33:57.731 UT      15.249      26.198       -551.358        -67.986          5.970
;    2000-02-11/23:33:58.351 UT      15.463      27.846       -563.033        -75.287          7.363
;    2000-02-11/23:33:59.491 UT      15.856      30.255       -577.398        -84.870          7.920
;    2000-02-11/23:34:00.731 UT      16.053      31.459       -576.773        -86.503          3.938
;    2000-02-11/23:34:01.351 UT      16.072      32.062       -576.461        -87.319          1.947
;    2000-02-11/23:34:02.491 UT      16.106      33.032       -577.472        -87.847          0.530
;    2000-02-11/23:34:03.731 UT      16.142      33.607       -584.134        -85.014          6.853
;    2000-02-11/23:34:04.351 UT      16.161      33.894       -587.464        -83.597         10.014
;    2000-02-11/23:34:06.731 UT      16.232      36.923       -595.046        -76.981         17.640
;    2000-02-11/23:34:21.503 UT      16.671      37.185       -613.134        -88.710         22.781
;    2000-02-11/23:34:23.065 UT      16.717      39.365       -614.681        -88.835         19.924
;    2000-02-11/23:34:24.503 UT      16.760      40.665       -615.798        -88.960         19.401
;    2000-02-11/23:34:26.065 UT      16.806      41.009       -616.547        -89.113         22.027
;    2000-02-11/23:34:27.503 UT      16.849      41.461       -616.468        -88.752         24.278
;    2000-02-11/23:34:29.065 UT      16.895      42.224       -614.831        -87.347         26.389
;    2000-02-11/23:34:30.503 UT      16.938      42.230       -613.494        -86.395         28.570
;    2000-02-11/23:34:32.065 UT      16.985      40.309       -612.511        -86.300         31.597
;    2000-02-11/23:34:33.503 UT      17.027      39.032       -611.733        -86.772         34.475
;    2000-02-11/23:34:35.065 UT      17.074      39.605       -611.390        -89.514         37.963
;    2000-02-12/00:14:15.709 UT      24.642      27.624       -544.721       -103.694         70.883
;    2000-02-12/00:14:18.709 UT      24.622      27.668       -544.894       -104.199         70.956
;    2000-02-12/00:14:21.709 UT      24.601      27.713       -545.068       -104.704         71.029
;    2000-02-12/00:14:24.709 UT      24.581      27.757       -545.241       -105.210         71.102
;    2000-02-12/00:14:27.709 UT      24.560      27.802       -545.415       -105.715         71.175
;    2000-02-12/00:26:11.217 UT      20.426      25.414       -544.939       -107.863         51.131
;    2000-02-12/00:26:14.217 UT      20.412      25.530       -544.925       -108.258         50.706
;    2000-02-12/00:26:17.217 UT      20.398      25.645       -544.911       -108.653         50.280
;    2000-02-12/00:26:20.217 UT      20.384      25.760       -544.897       -109.048         49.855
;    2000-02-12/00:26:23.217 UT      20.369      25.871       -544.876       -109.458         49.402
;    2000-02-12/00:27:13.142 UT      19.551      26.935       -543.135       -118.756         37.002
;    2000-02-12/00:27:16.142 UT      19.421      26.665       -543.320       -118.345         36.951
;    2000-02-12/00:27:19.142 UT      19.291      26.395       -543.505       -117.934         36.899
;    2000-02-12/00:27:22.142 UT      19.161      26.125       -543.689       -117.523         36.847
;    2000-02-12/00:27:25.142 UT      19.031      25.855       -543.874       -117.112         36.796
;---------------------------------------------------------------------------------------------------



mform      = '(";",a30,3f12.3)'
FOR j=0L, N_ELEMENTS(nscets) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,nscets[j],tds_teall[j],tds_tec[j],tds_teh[j]

;-----------------------------------------------------------------------------------------
;      Date        Time                Te         Tec         Teh
;=========================================================================================
;    1997-12-10/04:33:09.605 UT      18.170      15.466      97.335
;    1997-12-10/04:33:12.605 UT      19.036      16.616     126.906
;    1997-12-10/04:33:15.605 UT      18.782      16.590     121.404
;    1997-12-10/04:33:18.605 UT      18.656      16.760     124.161
;    1997-12-10/04:33:21.605 UT      18.565      16.637     123.194
;-----------------------------------------------------------------------------------------
;      Date        Time                Te         Tec         Teh
;=========================================================================================
;    1998-08-26/06:40:20.120 UT      28.576      20.206     248.868
;    1998-08-26/06:40:23.120 UT      38.352      29.553     263.748
;    1998-08-26/06:40:26.120 UT      51.970      41.672     291.502
;    1998-08-26/06:40:29.120 UT      55.600      44.353     305.247
;    1998-08-26/06:40:32.120 UT      54.735      44.296     306.790
;    1998-08-26/06:40:48.941 UT      51.835      42.838     300.427
;    1998-08-26/06:40:51.941 UT      54.117      45.925     297.876
;    1998-08-26/06:40:54.941 UT      58.057      50.001     288.052
;    1998-08-26/06:40:57.941 UT      58.565      51.293     283.031
;    1998-08-26/06:41:00.941 UT      58.161      50.976     285.267
;    1998-08-26/06:41:04.001 UT      58.033      50.430     289.736
;    1998-08-26/06:41:07.001 UT      57.907      49.894     294.118
;    1998-08-26/06:41:10.001 UT      57.458      48.693     298.257
;    1998-08-26/06:41:13.001 UT      58.470      48.780     301.181
;    1998-08-26/06:41:16.001 UT      58.685      49.208     302.139
;    1998-08-26/06:41:31.623 UT      61.653      51.411     297.782
;    1998-08-26/06:41:34.623 UT      63.074      52.942     291.173
;    1998-08-26/06:41:37.623 UT      62.881      53.114     289.095
;    1998-08-26/06:41:38.013 UT      62.860      53.180     289.035
;    1998-08-26/06:41:40.623 UT      62.566      53.398     287.755
;    1998-08-26/06:41:41.013 UT      62.503      53.402     287.451
;    1998-08-26/06:41:43.623 UT      62.772      53.501     287.611
;    1998-08-26/06:41:44.013 UT      62.914      53.526     287.960
;    1998-08-26/06:41:47.013 UT      63.168      53.466     288.787
;    1998-08-26/06:41:47.249 UT      63.130      53.444     288.724
;    1998-08-26/06:41:50.013 UT      63.031      53.420     288.454
;    1998-08-26/06:41:50.249 UT      63.037      53.428     288.452
;    1998-08-26/06:41:50.315 UT      63.039      53.430     288.451
;    1998-08-26/06:41:51.909 UT      63.128      53.607     287.714
;    1998-08-26/06:41:53.233 UT      63.258      53.907     286.205
;    1998-08-26/06:41:53.249 UT      63.259      53.911     286.186
;    1998-08-26/06:41:53.315 UT      63.266      53.925     286.111
;    1998-08-26/06:41:54.909 UT      63.319      54.218     284.494
;    1998-08-26/06:41:56.233 UT      63.194      54.350     283.480
;    1998-08-26/06:41:56.249 UT      63.193      54.351     283.468
;    1998-08-26/06:41:56.315 UT      63.186      54.358     283.417
;    1998-08-26/06:41:57.909 UT      62.886      54.331     282.535
;    1998-08-26/06:41:59.233 UT      62.304      53.897     282.555
;    1998-08-26/06:41:59.249 UT      62.297      53.891     282.556
;    1998-08-26/06:41:59.315 UT      62.268      53.870     282.557
;    1998-08-26/06:41:59.763 UT      62.070      53.723     282.564
;    1998-08-26/06:42:00.909 UT      61.683      53.478     282.598
;    1998-08-26/06:42:02.233 UT      61.567      53.565     282.687
;    1998-08-26/06:42:02.315 UT      61.560      53.571     282.693
;    1998-08-26/06:42:02.763 UT      61.521      53.600     282.723
;    1998-08-26/06:42:03.131 UT      61.489      53.625     282.747
;    1998-08-26/06:42:03.909 UT      61.340      53.543     283.215
;    1998-08-26/06:42:05.233 UT      60.761      52.866     285.694
;    1998-08-26/06:42:05.763 UT      60.529      52.595     286.687
;    1998-08-26/06:42:06.131 UT      60.368      52.407     287.376
;    1998-08-26/06:42:08.763 UT      58.574      50.575     290.443
;    1998-08-26/06:42:09.131 UT      58.293      50.297     290.786
;    1998-08-26/06:42:11.763 UT      58.865      51.292     285.053
;    1998-08-26/06:42:12.131 UT      59.089      51.598     283.794
;    1998-08-26/06:42:15.131 UT      60.254      52.608     280.444
;-----------------------------------------------------------------------------------------
;      Date        Time                Te         Tec         Teh
;=========================================================================================
;    1998-09-24/23:20:32.842 UT      23.079      18.509      95.322
;    1998-09-24/23:20:35.842 UT      23.915      19.191      97.767
;    1998-09-24/23:20:38.842 UT      24.752      19.873     100.213
;    1998-09-24/23:20:41.842 UT      25.589      20.555     102.658
;    1998-09-24/23:20:44.842 UT      26.426      21.237     105.103
;    1998-09-24/23:22:20.632 UT      50.516      40.878     175.933
;    1998-09-24/23:22:23.632 UT      50.483      40.855     175.983
;    1998-09-24/23:22:26.632 UT      50.450      40.832     176.033
;    1998-09-24/23:22:29.632 UT      50.417      40.808     176.083
;    1998-09-24/23:22:32.632 UT      50.385      40.785     176.134
;    1998-09-24/23:22:42.150 UT      50.281      40.711     176.293
;    1998-09-24/23:22:45.150 UT      50.248      40.687     176.343
;    1998-09-24/23:22:48.150 UT      50.215      40.664     176.393
;    1998-09-24/23:22:51.150 UT      50.183      40.641     176.443
;    1998-09-24/23:22:54.150 UT      50.150      40.617     176.494
;    1998-09-24/23:29:54.465 UT      50.037      41.285     175.254
;    1998-09-24/23:29:57.465 UT      50.096      41.310     175.429
;    1998-09-24/23:30:00.465 UT      50.155      41.335     175.603
;    1998-09-24/23:30:03.465 UT      50.214      41.360     175.778
;    1998-09-24/23:30:06.465 UT      50.274      41.385     175.952
;    1998-09-24/23:30:42.542 UT      50.464      41.445     176.864
;    1998-09-24/23:30:45.542 UT      50.377      41.402     176.706
;    1998-09-24/23:30:48.542 UT      50.290      41.359     176.549
;    1998-09-24/23:30:51.542 UT      50.204      41.317     176.391
;    1998-09-24/23:30:54.542 UT      50.117      41.274     176.234
;    1998-09-24/23:43:12.951 UT      44.776      38.518     168.762
;    1998-09-24/23:43:15.951 UT      44.718      38.485     168.620
;    1998-09-24/23:43:18.951 UT      44.660      38.452     168.478
;    1998-09-24/23:43:21.951 UT      44.603      38.419     168.336
;    1998-09-24/23:43:24.951 UT      44.545      38.386     168.194
;    1998-09-24/23:45:46.184 UT      45.733      39.293     165.631
;    1998-09-24/23:45:47.379 UT      45.665      39.239     165.482
;    1998-09-24/23:45:49.184 UT      45.562      39.158     165.258
;    1998-09-24/23:45:50.379 UT      45.494      39.104     165.110
;    1998-09-24/23:45:52.184 UT      45.391      39.023     164.886
;    1998-09-24/23:45:53.379 UT      45.323      38.970     164.738
;    1998-09-24/23:45:55.184 UT      45.220      38.889     164.514
;    1998-09-24/23:45:56.379 UT      45.151      38.835     164.365
;    1998-09-24/23:45:58.184 UT      45.049      38.754     164.141
;    1998-09-24/23:45:59.379 UT      44.980      38.700     163.993
;    1998-09-24/23:48:33.020 UT      48.465      39.966     174.653
;    1998-09-24/23:48:36.020 UT      48.749      40.135     175.386
;    1998-09-24/23:48:36.131 UT      48.760      40.141     175.413
;    1998-09-24/23:48:39.020 UT      49.034      40.304     176.119
;    1998-09-24/23:48:39.131 UT      49.044      40.310     176.147
;    1998-09-24/23:48:42.020 UT      49.318      40.473     176.853
;    1998-09-24/23:48:42.131 UT      49.329      40.479     176.880
;    1998-09-24/23:48:45.020 UT      49.603      40.642     177.586
;    1998-09-24/23:48:45.131 UT      49.613      40.648     177.613
;    1998-09-24/23:48:45.622 UT      49.660      40.676     177.733
;    1998-09-24/23:48:48.131 UT      49.898      40.817     178.346
;    1998-09-24/23:48:48.622 UT      49.944      40.845     178.466
;    1998-09-24/23:48:51.622 UT      50.228      41.014     179.200
;    1998-09-24/23:48:54.622 UT      50.368      41.094     179.367
;    1998-09-24/23:48:57.622 UT      50.457      41.143     179.335
;    1998-09-25/00:03:58.545 UT      58.028      45.515     172.691
;    1998-09-25/00:04:01.545 UT      58.020      45.506     172.711
;    1998-09-25/00:04:04.545 UT      58.013      45.497     172.731
;    1998-09-25/00:04:07.545 UT      58.006      45.487     172.751
;    1998-09-25/00:04:10.545 UT      57.999      45.478     172.770
;    1998-09-25/00:05:17.432 UT      57.837      45.270     173.214
;    1998-09-25/00:05:20.432 UT      57.830      45.260     173.234
;    1998-09-25/00:05:23.432 UT      57.823      45.251     173.254
;    1998-09-25/00:05:26.432 UT      57.816      45.242     173.274
;    1998-09-25/00:05:29.432 UT      57.809      45.232     173.294
;    1998-09-25/00:14:44.603 UT      56.070      43.310     174.007
;    1998-09-25/00:14:47.603 UT      55.997      43.229     173.977
;    1998-09-25/00:14:50.603 UT      55.925      43.148     173.947
;    1998-09-25/00:14:53.603 UT      55.852      43.067     173.917
;    1998-09-25/00:14:56.603 UT      55.779      42.986     173.888
;    1998-09-25/00:28:36.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:39.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:42.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:45.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:48.305 UT         NaN         NaN         NaN
;-----------------------------------------------------------------------------------------
;      Date        Time                Te         Tec         Teh
;=========================================================================================
;    2000-02-11/23:33:50.491 UT      44.312      23.750     198.988
;    2000-02-11/23:33:52.351 UT      54.705      30.670     246.635
;    2000-02-11/23:33:53.491 UT      58.481      33.483     261.416
;    2000-02-11/23:33:54.731 UT      59.688      34.945     261.366
;    2000-02-11/23:33:55.351 UT      60.291      35.676     261.341
;    2000-02-11/23:33:56.491 UT      59.755      36.120     260.292
;    2000-02-11/23:33:57.731 UT      56.571      35.177     257.565
;    2000-02-11/23:33:58.351 UT      54.980      34.706     256.202
;    2000-02-11/23:33:59.491 UT      52.525      34.036     253.112
;    2000-02-11/23:34:00.731 UT      50.937      33.755     248.418
;    2000-02-11/23:34:01.351 UT      50.142      33.615     246.071
;    2000-02-11/23:34:02.491 UT      48.961      33.432     242.419
;    2000-02-11/23:34:03.731 UT      48.653      33.500     240.772
;    2000-02-11/23:34:04.351 UT      48.500      33.534     239.948
;    2000-02-11/23:34:06.731 UT      47.881      33.617     236.678
;    2000-02-11/23:34:21.503 UT      43.900      34.439     219.014
;    2000-02-11/23:34:23.065 UT      43.840      34.530     219.196
;    2000-02-11/23:34:24.503 UT      43.851      34.602     218.590
;    2000-02-11/23:34:26.065 UT      43.963      34.659     216.758
;    2000-02-11/23:34:27.503 UT      43.983      34.655     215.973
;    2000-02-11/23:34:29.065 UT      43.839      34.538     216.939
;    2000-02-11/23:34:30.503 UT      43.523      34.346     217.796
;    2000-02-11/23:34:32.065 UT      42.671      33.909     218.639
;    2000-02-11/23:34:33.503 UT      41.878      33.531     219.357
;    2000-02-11/23:34:35.065 UT      40.980      33.215     219.911
;    2000-02-12/00:14:15.709 UT      26.448      24.024     194.913
;    2000-02-12/00:14:18.709 UT      26.435      24.009     194.917
;    2000-02-12/00:14:21.709 UT      26.423      23.993     194.920
;    2000-02-12/00:14:24.709 UT      26.411      23.978     194.924
;    2000-02-12/00:14:27.709 UT      26.399      23.963     194.928
;    2000-02-12/00:26:11.217 UT      28.365      25.173     194.644
;    2000-02-12/00:26:14.217 UT      28.485      25.285     194.518
;    2000-02-12/00:26:17.217 UT      28.604      25.398     194.393
;    2000-02-12/00:26:20.217 UT      28.724      25.510     194.267
;    2000-02-12/00:26:23.217 UT      28.843      25.623     194.142
;    2000-02-12/00:27:13.142 UT      30.825      27.485     192.100
;    2000-02-12/00:27:16.142 UT      30.921      27.556     192.201
;    2000-02-12/00:27:19.142 UT      31.017      27.627     192.301
;    2000-02-12/00:27:22.142 UT      31.114      27.698     192.402
;    2000-02-12/00:27:25.142 UT      31.210      27.768     192.502
;-----------------------------------------------------------------------------------------

mform      = '(";",a30,f12.3,4f12.3)'
FOR j=0L, N_ELEMENTS(nscets) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,nscets[j],beta_cpar[j],tds_magx[j],tds_magy[j],tds_magz[j],tds_bmag[j]
;-----------------------------------------------------------------------------------------
;      Date        Time             Betaparc       Bx          By          Bz          |B|
;=========================================================================================
;    1997-12-10/04:33:09.605 UT       1.171       2.438      -6.958      -2.706       7.854
;    1997-12-10/04:33:12.605 UT       1.408       2.043      -7.415      -1.177       7.781
;    1997-12-10/04:33:15.605 UT       0.711       3.562     -10.477      -2.648      11.378
;    1997-12-10/04:33:18.605 UT       0.324      -0.376     -16.057      -3.698      16.482
;    1997-12-10/04:33:21.605 UT       0.356      -0.058     -16.013      -2.771      16.251
;-----------------------------------------------------------------------------------------
;      Date        Time             Betaparc       Bx          By          Bz          |B|
;=========================================================================================
;    1998-08-26/06:40:20.120 UT       1.025      -2.131       7.806       1.049       8.160
;    1998-08-26/06:40:23.120 UT       1.285      -2.367       8.001       0.946       8.398
;    1998-08-26/06:40:26.120 UT       0.736      -3.377      16.519       3.780      17.279
;    1998-08-26/06:40:29.120 UT       1.250      -2.664      17.468      -0.459      17.676
;    1998-08-26/06:40:32.120 UT       1.253      -1.801      18.185       0.321      18.277
;    1998-08-26/06:40:48.941 UT       0.626       1.476      25.281      -3.935      25.628
;    1998-08-26/06:40:51.941 UT       0.811       0.242      23.545      -0.660      23.555
;    1998-08-26/06:40:54.941 UT       0.809     -12.014      14.620      13.997      23.537
;    1998-08-26/06:40:57.941 UT       0.917     -12.778      10.573      14.428      21.983
;    1998-08-26/06:41:00.941 UT       0.895     -12.110      13.455      13.182      22.393
;    1998-08-26/06:41:04.001 UT       0.872     -13.853      10.857      14.781      22.984
;    1998-08-26/06:41:07.001 UT       0.837     -15.068      12.382      13.551      23.748
;    1998-08-26/06:41:10.001 UT       0.841      -9.772      20.596       3.883      23.125
;    1998-08-26/06:41:13.001 UT       0.739     -13.871      17.870       8.654      24.221
;    1998-08-26/06:41:16.001 UT       0.781     -13.618      18.220       7.149      23.844
;    1998-08-26/06:41:31.623 UT       0.805     -14.519      12.067      13.268      23.075
;    1998-08-26/06:41:34.623 UT       0.869     -15.513       8.705      13.482      22.320
;    1998-08-26/06:41:37.623 UT       1.003     -11.757       7.391      15.400      20.737
;    1998-08-26/06:41:38.013 UT       1.007     -12.021       7.550      15.067      20.700
;    1998-08-26/06:41:40.623 UT       0.892     -14.312       8.566      14.342      21.998
;    1998-08-26/06:41:41.013 UT       0.919     -14.200       9.187      13.542      21.666
;    1998-08-26/06:41:43.623 UT       0.878     -14.382       9.464      13.782      22.054
;    1998-08-26/06:41:44.013 UT       0.894     -14.585       9.331      13.295      21.830
;    1998-08-26/06:41:47.013 UT       0.882     -15.220       7.156      13.659      21.666
;    1998-08-26/06:41:47.249 UT       0.877     -15.445       7.300      13.363      21.689
;    1998-08-26/06:41:50.013 UT       0.808     -14.338      10.033      13.852      22.319
;    1998-08-26/06:41:50.249 UT       0.798     -14.036      10.732      13.841      22.445
;    1998-08-26/06:41:50.315 UT       0.809     -13.965      10.644      13.719      22.283
;    1998-08-26/06:41:51.909 UT       0.823     -15.496       6.825      14.058      22.008
;    1998-08-26/06:41:53.233 UT       0.772     -16.235       7.529      14.004      22.724
;    1998-08-26/06:41:53.249 UT       0.772     -16.235       7.547      13.996      22.725
;    1998-08-26/06:41:53.315 UT       0.776     -16.133       7.693      13.925      22.658
;    1998-08-26/06:41:54.909 UT       0.809     -15.979       7.542      13.387      22.167
;    1998-08-26/06:41:56.233 UT       0.775     -15.719       7.379      14.467      22.602
;    1998-08-26/06:41:56.249 UT       0.777     -15.700       7.291      14.476      22.565
;    1998-08-26/06:41:56.315 UT       0.774     -15.850       7.100      14.471      22.606
;    1998-08-26/06:41:57.909 UT       0.747     -16.221       7.117      14.593      22.951
;    1998-08-26/06:41:59.233 UT       0.723     -15.606       7.808      15.434      23.296
;    1998-08-26/06:41:59.249 UT       0.724     -15.594       7.835      15.416      23.286
;    1998-08-26/06:41:59.315 UT       0.726     -15.547       7.948      15.339      23.241
;    1998-08-26/06:41:59.763 UT       0.757     -15.656       7.655      14.642      22.762
;    1998-08-26/06:42:00.909 UT       0.773     -16.345       7.868      13.316      22.503
;    1998-08-26/06:42:02.233 UT       0.831     -14.740       1.748      15.821      21.694
;    1998-08-26/06:42:02.315 UT       0.827     -14.777       1.748      15.850      21.740
;    1998-08-26/06:42:02.763 UT       0.780     -15.434       0.158      16.220      22.390
;    1998-08-26/06:42:03.131 UT       0.775     -15.672      -0.232      16.089      22.462
;    1998-08-26/06:42:03.909 UT       0.787     -15.988      -0.417      15.477      22.256
;    1998-08-26/06:42:05.233 UT       0.728     -16.470      -0.488      15.993      22.963
;    1998-08-26/06:42:05.763 UT       0.778     -15.730      -0.292      15.587      22.146
;    1998-08-26/06:42:06.131 UT       0.817     -16.118      -1.596      14.265      21.583
;    1998-08-26/06:42:08.763 UT       0.926     -14.719      -1.331      13.880      20.275
;    1998-08-26/06:42:09.131 UT       0.938     -14.292      -2.428      13.992      20.148
;    1998-08-26/06:42:11.763 UT       1.100     -13.004      -6.115      11.981      18.710
;    1998-08-26/06:42:12.131 UT       1.171     -13.205      -5.581      11.130      18.149
;    1998-08-26/06:42:15.131 UT       0.882     -14.676      -0.108      14.529      20.652
;-----------------------------------------------------------------------------------------
;      Date        Time             Betaparc       Bx          By          Bz          |B|
;=========================================================================================
;    1998-09-24/23:20:32.842 UT       0.744      -8.576      10.091       1.024      13.283
;    1998-09-24/23:20:35.842 UT       0.753      -8.818      10.377      -0.809      13.641
;    1998-09-24/23:20:38.842 UT       0.148     -12.031      29.239       3.273      31.787
;    1998-09-24/23:20:41.842 UT       0.167     -13.324      27.702       1.241      30.764
;    1998-09-24/23:20:44.842 UT       0.178      -9.969      29.016      -1.753      30.731
;    1998-09-24/23:22:20.632 UT       0.201     -12.367      37.126      16.267      42.378
;    1998-09-24/23:22:23.632 UT       0.210     -11.477      36.352      16.510      41.542
;    1998-09-24/23:22:26.632 UT       0.205     -12.266      37.373      15.042      42.112
;    1998-09-24/23:22:29.632 UT       0.207     -13.989      36.079      16.044      41.890
;    1998-09-24/23:22:32.632 UT       0.202     -14.533      34.513      20.053      42.479
;    1998-09-24/23:22:42.150 UT       0.207     -13.792      36.159      16.696      42.148
;    1998-09-24/23:22:45.150 UT       0.210     -12.607      37.128      14.595      41.838
;    1998-09-24/23:22:48.150 UT       0.205     -14.343      37.296      14.033      42.351
;    1998-09-24/23:22:51.150 UT       0.206     -10.970      38.427      13.879      42.303
;    1998-09-24/23:22:54.150 UT       0.206      -9.477      39.241      12.983      42.406
;    1998-09-24/23:29:54.465 UT       0.250     -18.045      28.898      24.272      41.831
;    1998-09-24/23:29:57.465 UT       0.256     -17.660      28.958      23.597      41.319
;    1998-09-24/23:30:00.465 UT       0.260     -16.473      30.728      21.613      41.021
;    1998-09-24/23:30:03.465 UT       0.255     -16.884      30.979      21.698      41.419
;    1998-09-24/23:30:06.465 UT       0.253     -16.517      30.629      22.645      41.518
;    1998-09-24/23:30:42.542 UT       0.263     -16.219      31.063      20.150      40.423
;    1998-09-24/23:30:45.542 UT       0.256     -17.028      30.812      20.779      40.879
;    1998-09-24/23:30:48.542 UT       0.259     -16.245      29.914      22.184      40.631
;    1998-09-24/23:30:51.542 UT       0.257     -16.302      31.001      20.818      40.746
;    1998-09-24/23:30:54.542 UT       0.255     -18.521      31.769      17.935      40.914
;    1998-09-24/23:43:12.951 UT       0.350      -7.817      34.734       3.063      35.734
;    1998-09-24/23:43:15.951 UT       0.346      -8.183      34.906       2.545      35.943
;    1998-09-24/23:43:18.951 UT       0.361      -7.470      34.292       3.198      35.242
;    1998-09-24/23:43:21.951 UT       0.353      -6.382      34.976       2.834      35.666
;    1998-09-24/23:43:24.951 UT       0.361      -5.872      34.683       2.900      35.296
;    1998-09-24/23:45:46.184 UT       0.312     -14.643      28.694      14.706      35.412
;    1998-09-24/23:45:47.379 UT       0.307     -15.583      29.153      13.228      35.605
;    1998-09-24/23:45:49.184 UT       0.330     -15.934      29.378       7.363      34.222
;    1998-09-24/23:45:50.379 UT       0.312     -13.247      32.142       4.670      35.077
;    1998-09-24/23:45:52.184 UT       0.290     -14.048      30.874      12.709      36.222
;    1998-09-24/23:45:53.379 UT       0.283     -12.372      34.424       1.435      36.608
;    1998-09-24/23:45:55.184 UT       0.254     -15.151      26.233      23.739      38.487
;    1998-09-24/23:45:56.379 UT       0.257     -18.097      24.387      23.108      38.160
;    1998-09-24/23:45:58.184 UT       0.257     -18.464      27.387      18.828      38.019
;    1998-09-24/23:45:59.379 UT       0.254     -14.027      27.016      22.991      38.147
;    1998-09-24/23:48:33.020 UT       0.364     -20.006      22.496      18.961      35.579
;    1998-09-24/23:48:36.020 UT       0.384     -21.684       7.304      26.372      34.914
;    1998-09-24/23:48:36.131 UT       0.379     -21.864       6.216      26.810      35.149
;    1998-09-24/23:48:39.020 UT       0.362     -21.008       4.743      29.128      36.225
;    1998-09-24/23:48:39.131 UT       0.373     -20.393       4.917      28.917      35.725
;    1998-09-24/23:48:42.020 UT       0.331     -19.571       0.175      32.807      38.201
;    1998-09-24/23:48:42.131 UT       0.346     -16.845       4.382      33.021      37.328
;    1998-09-24/23:48:45.020 UT       0.381     -18.023       0.718      30.991      35.858
;    1998-09-24/23:48:45.131 UT       0.395     -14.930       3.086      31.737      35.209
;    1998-09-24/23:48:45.622 UT       0.392     -13.535      -0.142      32.695      35.386
;    1998-09-24/23:48:48.131 UT       0.390     -15.626      -0.295      32.109      35.710
;    1998-09-24/23:48:48.622 UT       0.380     -16.462      -1.367      32.231      36.217
;    1998-09-24/23:48:51.622 UT       0.388     -15.841      -1.477      32.399      36.095
;    1998-09-24/23:48:54.622 UT       0.386     -13.886      -2.373      33.532      36.371
;    1998-09-24/23:48:57.622 UT       0.387     -14.228      -2.817      33.451      36.460
;    1998-09-25/00:03:58.545 UT       0.553     -17.744      17.523      12.043      27.694
;    1998-09-25/00:04:01.545 UT       0.685      -6.613      21.715      10.161      24.870
;    1998-09-25/00:04:04.545 UT       0.740      -2.482      23.327      -4.648      23.914
;    1998-09-25/00:04:07.545 UT       0.830      -2.807      21.979      -4.317      22.574
;    1998-09-25/00:04:10.545 UT       0.892      -2.150      21.012      -5.260      21.766
;    1998-09-25/00:05:17.432 UT       1.688      -6.910      13.265      -4.719      15.683
;    1998-09-25/00:05:20.432 UT       1.407      -6.793      10.017     -12.179      17.170
;    1998-09-25/00:05:23.432 UT       0.851      -9.826      18.068       8.005      22.070
;    1998-09-25/00:05:26.432 UT       0.851     -10.396      19.310       2.421      22.063
;    1998-09-25/00:05:29.432 UT       0.961      -8.982      17.641       6.232      20.754
;    1998-09-25/00:14:44.603 UT       0.424      -9.600      18.261     -12.855      24.308
;    1998-09-25/00:14:47.603 UT       0.446      -8.958      18.150     -11.866      23.462
;    1998-09-25/00:14:50.603 UT       0.434      -9.030      18.273     -11.844      23.574
;    1998-09-25/00:14:53.603 UT       0.464      -8.285      17.882     -10.991      22.566
;    1998-09-25/00:14:56.603 UT       0.431      -6.886      20.075      -9.349      23.191
;    1998-09-25/00:28:36.305 UT         NaN         NaN         NaN         NaN       0.000
;    1998-09-25/00:28:39.305 UT         NaN         NaN         NaN         NaN       0.000
;    1998-09-25/00:28:42.305 UT         NaN         NaN         NaN         NaN       0.000
;    1998-09-25/00:28:45.305 UT         NaN         NaN         NaN         NaN       0.000
;    1998-09-25/00:28:48.305 UT         NaN         NaN         NaN         NaN       0.000
;-----------------------------------------------------------------------------------------
;      Date        Time             Betaparc       Bx          By          Bz          |B|
;=========================================================================================
;    2000-02-11/23:33:50.491 UT       1.948       4.273      -7.262       1.307       8.527
;    2000-02-11/23:33:52.351 UT       2.937       4.064      -7.394       1.262       8.531
;    2000-02-11/23:33:53.491 UT       3.028       3.944      -7.809       1.114       8.819
;    2000-02-11/23:33:54.731 UT       2.453       4.600      -8.496       0.871       9.700
;    2000-02-11/23:33:55.351 UT       1.007       7.216     -13.114       1.557      15.049
;    2000-02-11/23:33:56.491 UT       0.823       8.441     -14.122       1.972      16.570
;    2000-02-11/23:33:57.731 UT       1.006       7.418     -12.932       2.026      15.045
;    2000-02-11/23:33:58.351 UT       0.865       8.086     -13.981       1.892      16.262
;    2000-02-11/23:33:59.491 UT       1.082       7.096     -12.657       0.988      14.544
;    2000-02-11/23:34:00.731 UT       0.957       7.569     -13.218       0.764      15.252
;    2000-02-11/23:34:01.351 UT       0.894       7.738     -13.570       0.453      15.627
;    2000-02-11/23:34:02.491 UT       0.703       8.265     -15.250       0.394      17.350
;    2000-02-11/23:34:03.731 UT       0.733       8.211     -14.700       0.289      16.840
;    2000-02-11/23:34:04.351 UT       0.700       8.164     -15.055       1.007      17.155
;    2000-02-11/23:34:06.731 UT       0.631       8.612     -15.774       0.389      17.976
;    2000-02-11/23:34:21.503 UT       0.454       9.437     -19.224      -0.182      21.417
;    2000-02-11/23:34:23.065 UT       0.435       9.075     -19.859      -1.284      21.872
;    2000-02-11/23:34:24.503 UT       0.420       9.238     -20.174      -0.998      22.211
;    2000-02-11/23:34:26.065 UT       0.406       8.643     -20.620      -2.245      22.470
;    2000-02-11/23:34:27.503 UT       0.398       8.921     -20.718      -0.924      22.576
;    2000-02-11/23:34:29.065 UT       0.390       8.527     -21.037      -0.421      22.704
;    2000-02-11/23:34:30.503 UT       0.374       9.428     -21.053       0.110      23.068
;    2000-02-11/23:34:32.065 UT       0.363       9.313     -21.350      -0.210      23.293
;    2000-02-11/23:34:33.503 UT       0.352       9.045     -21.718      -1.280      23.561
;    2000-02-11/23:34:35.065 UT       0.347       8.640     -21.779      -3.426      23.679
;    2000-02-12/00:14:15.709 UT       0.746      -2.786     -11.562     -13.765      18.191
;    2000-02-12/00:14:18.709 UT       0.748      -2.605     -11.879     -13.476      18.152
;    2000-02-12/00:14:21.709 UT       0.749      -2.216     -11.756     -13.614      18.124
;    2000-02-12/00:14:24.709 UT       0.748      -1.997     -11.952     -13.481      18.127
;    2000-02-12/00:14:27.709 UT       0.744      -2.390     -11.674     -13.711      18.165
;    2000-02-12/00:26:11.217 UT       1.000       5.515     -13.898      -1.732      15.052
;    2000-02-12/00:26:14.217 UT       1.005       5.721     -13.828      -1.646      15.056
;    2000-02-12/00:26:17.217 UT       1.013       6.405     -13.570      -1.004      15.040
;    2000-02-12/00:26:20.217 UT       0.999       6.345     -13.738      -1.251      15.184
;    2000-02-12/00:26:23.217 UT       1.022       6.018     -13.682      -1.775      15.052
;    2000-02-12/00:27:13.142 UT       1.021       6.989     -13.819      -0.021      15.486
;    2000-02-12/00:27:16.142 UT       1.025       7.219     -13.605       0.276      15.405
;    2000-02-12/00:27:19.142 UT       1.031       6.617     -13.802      -0.253      15.308
;    2000-02-12/00:27:22.142 UT       0.978       6.779     -14.116       0.375      15.664
;    2000-02-12/00:27:25.142 UT       0.976       7.132     -13.881       0.727      15.622
;-----------------------------------------------------------------------------------------



mform      = '(";",a30,3f12.3)'
FOR j=0L, N_ELEMENTS(nscets) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,nscets[j],tds_teapa[j],tds_tecpa[j],tds_tehpa[j]

;-----------------------------------------------------------------------------------------
;      Date        Time              Te_//       Tec_//      Teh_//
;=========================================================================================
;    1997-12-10/04:33:09.605 UT      17.508      14.455     102.820
;    1997-12-10/04:33:12.605 UT      18.942      16.029     141.106
;    1997-12-10/04:33:15.605 UT      19.055      16.316     137.176
;    1997-12-10/04:33:18.605 UT      16.930      14.791     129.753
;    1997-12-10/04:33:21.605 UT      17.105      14.973     125.498
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_//       Tec_//      Teh_//
;=========================================================================================
;    1998-08-26/06:40:20.120 UT      32.684      19.951     365.997
;    1998-08-26/06:40:23.120 UT      36.994      26.228     314.302
;    1998-08-26/06:40:26.120 UT      48.557      38.562     278.001
;    1998-08-26/06:40:29.120 UT      55.004      44.094     290.891
;    1998-08-26/06:40:32.120 UT      52.817      42.796     292.242
;    1998-08-26/06:40:48.941 UT      53.088      42.848     328.231
;    1998-08-26/06:40:51.941 UT      55.869      47.781     293.182
;    1998-08-26/06:40:54.941 UT      55.051      48.575     240.556
;    1998-08-26/06:40:57.941 UT      54.544      49.039     225.355
;    1998-08-26/06:41:00.941 UT      56.114      50.409     237.557
;    1998-08-26/06:41:04.001 UT      58.380      51.968     255.500
;    1998-08-26/06:41:07.001 UT      60.601      53.496     273.091
;    1998-08-26/06:41:10.001 UT      58.544      51.181     263.808
;    1998-08-26/06:41:13.001 UT      57.419      49.581     253.532
;    1998-08-26/06:41:16.001 UT      58.811      50.975     259.791
;    1998-08-26/06:41:31.623 UT      59.077      50.421     259.253
;    1998-08-26/06:41:34.623 UT      59.368      51.175     244.887
;    1998-08-26/06:41:37.623 UT      59.395      51.652     240.255
;    1998-08-26/06:41:38.013 UT      59.460      51.816     239.614
;    1998-08-26/06:41:40.623 UT      59.924      52.770     237.542
;    1998-08-26/06:41:41.013 UT      59.997      52.893     237.515
;    1998-08-26/06:41:43.623 UT      60.660      53.359     239.589
;    1998-08-26/06:41:44.013 UT      60.785      53.375     240.234
;    1998-08-26/06:41:47.013 UT      60.728      53.015     241.977
;    1998-08-26/06:41:47.249 UT      60.654      52.954     241.891
;    1998-08-26/06:41:50.013 UT      60.421      52.737     242.227
;    1998-08-26/06:41:50.249 UT      60.429      52.740     242.313
;    1998-08-26/06:41:50.315 UT      60.431      52.741     242.337
;    1998-08-26/06:41:51.909 UT      60.614      53.003     241.473
;    1998-08-26/06:41:53.233 UT      60.928      53.523     238.953
;    1998-08-26/06:41:53.249 UT      60.932      53.529     238.922
;    1998-08-26/06:41:53.315 UT      60.948      53.555     238.796
;    1998-08-26/06:41:54.909 UT      61.238      54.098     236.390
;    1998-08-26/06:41:56.233 UT      61.333      54.412     235.423
;    1998-08-26/06:41:56.249 UT      61.334      54.416     235.411
;    1998-08-26/06:41:56.315 UT      61.339      54.432     235.363
;    1998-08-26/06:41:57.909 UT      61.525      54.851     234.747
;    1998-08-26/06:41:59.233 UT      61.838      55.289     235.454
;    1998-08-26/06:41:59.249 UT      61.841      55.294     235.463
;    1998-08-26/06:41:59.315 UT      61.857      55.316     235.498
;    1998-08-26/06:41:59.763 UT      61.963      55.464     235.737
;    1998-08-26/06:42:00.909 UT      62.296      55.881     237.003
;    1998-08-26/06:42:02.233 UT      62.857      56.470     240.321
;    1998-08-26/06:42:02.315 UT      62.892      56.507     240.526
;    1998-08-26/06:42:02.763 UT      63.082      56.706     241.649
;    1998-08-26/06:42:03.131 UT      63.238      56.870     242.571
;    1998-08-26/06:42:03.909 UT      63.457      57.079     244.638
;    1998-08-26/06:42:05.233 UT      63.380      56.883     248.632
;    1998-08-26/06:42:05.763 UT      63.350      56.804     250.231
;    1998-08-26/06:42:06.131 UT      63.329      56.749     251.341
;    1998-08-26/06:42:08.763 UT      63.639      56.543     270.698
;    1998-08-26/06:42:09.131 UT      63.704      56.523     273.927
;    1998-08-26/06:42:11.763 UT      63.604      56.917     263.961
;    1998-08-26/06:42:12.131 UT      63.559      57.003     260.722
;    1998-08-26/06:42:15.131 UT      61.608      55.315     241.674
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_//       Tec_//      Teh_//
;=========================================================================================
;    1998-09-24/23:20:32.842 UT      28.776      20.988     108.431
;    1998-09-24/23:20:35.842 UT      29.390      21.653     108.660
;    1998-09-24/23:20:38.842 UT      30.005      22.318     108.888
;    1998-09-24/23:20:41.842 UT      30.619      22.984     109.116
;    1998-09-24/23:20:44.842 UT      31.233      23.649     109.345
;    1998-09-24/23:22:20.632 UT      48.924      42.799     116.687
;    1998-09-24/23:22:23.632 UT      48.902      42.773     116.932
;    1998-09-24/23:22:26.632 UT      48.881      42.747     117.178
;    1998-09-24/23:22:29.632 UT      48.860      42.721     117.424
;    1998-09-24/23:22:32.632 UT      48.839      42.695     117.669
;    1998-09-24/23:22:42.150 UT      48.772      42.613     118.449
;    1998-09-24/23:22:45.150 UT      48.751      42.587     118.695
;    1998-09-24/23:22:48.150 UT      48.730      42.561     118.940
;    1998-09-24/23:22:51.150 UT      48.709      42.535     119.186
;    1998-09-24/23:22:54.150 UT      48.688      42.509     119.432
;    1998-09-24/23:29:54.465 UT      51.129      44.718     135.915
;    1998-09-24/23:29:57.465 UT      51.113      44.693     135.883
;    1998-09-24/23:30:00.465 UT      51.096      44.668     135.852
;    1998-09-24/23:30:03.465 UT      51.080      44.642     135.820
;    1998-09-24/23:30:06.465 UT      51.063      44.617     135.789
;    1998-09-24/23:30:42.542 UT      50.745      44.294     135.482
;    1998-09-24/23:30:45.542 UT      50.696      44.264     135.471
;    1998-09-24/23:30:48.542 UT      50.646      44.234     135.459
;    1998-09-24/23:30:51.542 UT      50.596      44.204     135.448
;    1998-09-24/23:30:54.542 UT      50.547      44.174     135.437
;    1998-09-24/23:43:12.951 UT      51.241      44.902     168.186
;    1998-09-24/23:43:15.951 UT      51.356      44.989     169.232
;    1998-09-24/23:43:18.951 UT      51.472      45.075     170.277
;    1998-09-24/23:43:21.951 UT      51.587      45.162     171.322
;    1998-09-24/23:43:24.951 UT      51.703      45.249     172.368
;    1998-09-24/23:45:46.184 UT      54.572      47.829     165.502
;    1998-09-24/23:45:47.379 UT      54.457      47.723     165.097
;    1998-09-24/23:45:49.184 UT      54.283      47.562     164.484
;    1998-09-24/23:45:50.379 UT      54.168      47.456     164.078
;    1998-09-24/23:45:52.184 UT      53.995      47.296     163.465
;    1998-09-24/23:45:53.379 UT      53.880      47.189     163.059
;    1998-09-24/23:45:55.184 UT      53.706      47.029     162.446
;    1998-09-24/23:45:56.379 UT      53.591      46.923     162.040
;    1998-09-24/23:45:58.184 UT      53.417      46.762     161.427
;    1998-09-24/23:45:59.379 UT      53.302      46.656     161.021
;    1998-09-24/23:48:33.020 UT      57.452      47.560     196.237
;    1998-09-24/23:48:36.020 UT      57.868      47.835     198.469
;    1998-09-24/23:48:36.131 UT      57.883      47.845     198.551
;    1998-09-24/23:48:39.020 UT      58.283      48.110     200.700
;    1998-09-24/23:48:39.131 UT      58.299      48.120     200.782
;    1998-09-24/23:48:42.020 UT      58.699      48.385     202.931
;    1998-09-24/23:48:42.131 UT      58.714      48.395     203.014
;    1998-09-24/23:48:45.020 UT      59.114      48.659     205.162
;    1998-09-24/23:48:45.131 UT      59.130      48.670     205.245
;    1998-09-24/23:48:45.622 UT      59.198      48.715     205.610
;    1998-09-24/23:48:48.131 UT      59.545      48.944     207.476
;    1998-09-24/23:48:48.622 UT      59.613      48.989     207.841
;    1998-09-24/23:48:51.622 UT      60.029      49.264     210.073
;    1998-09-24/23:48:54.622 UT      60.117      49.319     210.086
;    1998-09-24/23:48:57.622 UT      60.090      49.297     209.317
;    1998-09-25/00:03:58.545 UT      59.384      47.117     170.794
;    1998-09-25/00:04:01.545 UT      59.387      47.121     170.828
;    1998-09-25/00:04:04.545 UT      59.389      47.125     170.862
;    1998-09-25/00:04:07.545 UT      59.392      47.128     170.896
;    1998-09-25/00:04:10.545 UT      59.395      47.132     170.930
;    1998-09-25/00:05:17.432 UT      59.460      47.213     171.683
;    1998-09-25/00:05:20.432 UT      59.462      47.216     171.717
;    1998-09-25/00:05:23.432 UT      59.465      47.220     171.751
;    1998-09-25/00:05:26.432 UT      59.468      47.224     171.785
;    1998-09-25/00:05:29.432 UT      59.471      47.227     171.819
;    1998-09-25/00:14:44.603 UT      54.043      42.433     159.556
;    1998-09-25/00:14:47.603 UT      53.942      42.349     159.187
;    1998-09-25/00:14:50.603 UT      53.841      42.264     158.818
;    1998-09-25/00:14:53.603 UT      53.740      42.180     158.448
;    1998-09-25/00:14:56.603 UT      53.638      42.096     158.079
;    1998-09-25/00:28:36.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:39.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:42.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:45.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:48.305 UT         NaN         NaN         NaN
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_//       Tec_//      Teh_//
;=========================================================================================
;    2000-02-11/23:33:50.491 UT      59.883      27.576     293.772
;    2000-02-11/23:33:52.351 UT      77.393      39.635     369.099
;    2000-02-11/23:33:53.491 UT      79.445      42.428     371.759
;    2000-02-11/23:33:54.731 UT      71.971      40.324     325.997
;    2000-02-11/23:33:55.351 UT      68.234      39.273     303.116
;    2000-02-11/23:33:56.491 UT      62.698      37.846     273.023
;    2000-02-11/23:33:57.731 UT      58.786      37.095     259.224
;    2000-02-11/23:33:58.351 UT      56.829      36.719     252.325
;    2000-02-11/23:33:59.491 UT      53.596      35.837     241.091
;    2000-02-11/23:34:00.731 UT      50.913      34.440     232.196
;    2000-02-11/23:34:01.351 UT      49.571      33.741     227.748
;    2000-02-11/23:34:02.491 UT      47.426      32.619     220.346
;    2000-02-11/23:34:03.731 UT      46.221      31.971     215.015
;    2000-02-11/23:34:04.351 UT      45.619      31.646     212.349
;    2000-02-11/23:34:06.731 UT      44.240      31.176     203.536
;    2000-02-11/23:34:21.503 UT      38.530      30.999     160.459
;    2000-02-11/23:34:23.065 UT      38.152      30.936     157.094
;    2000-02-11/23:34:24.503 UT      37.753      30.731     154.347
;    2000-02-11/23:34:26.065 UT      37.240      30.286     151.897
;    2000-02-11/23:34:27.503 UT      36.804      29.902     151.058
;    2000-02-11/23:34:29.065 UT      36.404      29.537     153.010
;    2000-02-11/23:34:30.503 UT      35.933      29.198     153.752
;    2000-02-11/23:34:32.065 UT      35.137      28.822     151.641
;    2000-02-11/23:34:33.503 UT      34.492      28.507     151.767
;    2000-02-11/23:34:35.065 UT      34.138      28.295     160.148
;    2000-02-12/00:14:15.709 UT      27.958      24.861     217.817
;    2000-02-12/00:14:18.709 UT      27.950      24.849     217.836
;    2000-02-12/00:14:21.709 UT      27.942      24.837     217.855
;    2000-02-12/00:14:24.709 UT      27.935      24.825     217.874
;    2000-02-12/00:14:27.709 UT      27.927      24.813     217.894
;    2000-02-12/00:26:11.217 UT      31.851      27.544     231.810
;    2000-02-12/00:26:14.217 UT      32.029      27.719     231.624
;    2000-02-12/00:26:17.217 UT      32.207      27.893     231.439
;    2000-02-12/00:26:20.217 UT      32.385      28.067     231.253
;    2000-02-12/00:26:23.217 UT      32.564      28.241     231.067
;    2000-02-12/00:27:13.142 UT      35.490      31.104     227.820
;    2000-02-12/00:27:16.142 UT      35.487      31.098     226.876
;    2000-02-12/00:27:19.142 UT      35.485      31.092     225.931
;    2000-02-12/00:27:22.142 UT      35.482      31.085     224.987
;    2000-02-12/00:27:25.142 UT      35.479      31.079     224.042
;-----------------------------------------------------------------------------------------


mform      = '(";",a30,3f12.3)'
FOR j=0L, N_ELEMENTS(nscets) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,nscets[j],tds_teape[j],tds_tecpe[j],tds_tehpe[j]

;-----------------------------------------------------------------------------------------
;      Date        Time              Te_|_       Tec_|_      Teh_|_
;=========================================================================================
;    1997-12-10/04:33:09.605 UT      18.501      15.971      94.592
;    1997-12-10/04:33:12.605 UT      19.083      16.909     119.806
;    1997-12-10/04:33:15.605 UT      18.646      16.728     113.518
;    1997-12-10/04:33:18.605 UT      19.519      17.745     121.365
;    1997-12-10/04:33:21.605 UT      19.295      17.469     122.042
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_|_       Tec_|_      Teh_|_
;=========================================================================================
;    1998-08-26/06:40:20.120 UT      26.523      20.334     190.304
;    1998-08-26/06:40:23.120 UT      39.031      31.216     238.471
;    1998-08-26/06:40:26.120 UT      53.677      43.227     298.253
;    1998-08-26/06:40:29.120 UT      55.898      44.483     312.425
;    1998-08-26/06:40:32.120 UT      55.693      45.046     314.064
;    1998-08-26/06:40:48.941 UT      51.209      42.832     286.525
;    1998-08-26/06:40:51.941 UT      53.240      44.997     300.223
;    1998-08-26/06:40:54.941 UT      59.559      50.713     311.799
;    1998-08-26/06:40:57.941 UT      60.576      52.420     311.869
;    1998-08-26/06:41:00.941 UT      59.184      51.260     309.121
;    1998-08-26/06:41:04.001 UT      57.859      49.661     306.854
;    1998-08-26/06:41:07.001 UT      56.561      48.093     304.632
;    1998-08-26/06:41:10.001 UT      56.915      47.449     315.482
;    1998-08-26/06:41:13.001 UT      58.995      48.380     325.006
;    1998-08-26/06:41:16.001 UT      58.622      48.324     323.313
;    1998-08-26/06:41:31.623 UT      62.942      51.906     317.047
;    1998-08-26/06:41:34.623 UT      64.927      53.826     314.316
;    1998-08-26/06:41:37.623 UT      64.624      53.846     313.515
;    1998-08-26/06:41:38.013 UT      64.559      53.862     313.746
;    1998-08-26/06:41:40.623 UT      63.888      53.712     312.861
;    1998-08-26/06:41:41.013 UT      63.757      53.657     312.420
;    1998-08-26/06:41:43.623 UT      63.828      53.571     311.622
;    1998-08-26/06:41:44.013 UT      63.979      53.601     311.823
;    1998-08-26/06:41:47.013 UT      64.389      53.691     312.193
;    1998-08-26/06:41:47.249 UT      64.368      53.689     312.140
;    1998-08-26/06:41:50.013 UT      64.336      53.762     311.568
;    1998-08-26/06:41:50.249 UT      64.342      53.772     311.521
;    1998-08-26/06:41:50.315 UT      64.343      53.775     311.508
;    1998-08-26/06:41:51.909 UT      64.385      53.909     310.834
;    1998-08-26/06:41:53.233 UT      64.422      54.099     309.831
;    1998-08-26/06:41:53.249 UT      64.423      54.101     309.819
;    1998-08-26/06:41:53.315 UT      64.425      54.111     309.769
;    1998-08-26/06:41:54.909 UT      64.360      54.279     308.546
;    1998-08-26/06:41:56.233 UT      64.125      54.319     307.509
;    1998-08-26/06:41:56.249 UT      64.122      54.319     307.496
;    1998-08-26/06:41:56.315 UT      64.110      54.321     307.444
;    1998-08-26/06:41:57.909 UT      63.567      54.071     306.429
;    1998-08-26/06:41:59.233 UT      62.537      53.201     306.106
;    1998-08-26/06:41:59.249 UT      62.524      53.190     306.102
;    1998-08-26/06:41:59.315 UT      62.473      53.147     306.086
;    1998-08-26/06:41:59.763 UT      62.124      52.852     305.977
;    1998-08-26/06:42:00.909 UT      61.377      52.276     305.396
;    1998-08-26/06:42:02.233 UT      60.922      52.113     303.870
;    1998-08-26/06:42:02.315 UT      60.894      52.103     303.776
;    1998-08-26/06:42:02.763 UT      60.740      52.047     303.259
;    1998-08-26/06:42:03.131 UT      60.614      52.002     302.835
;    1998-08-26/06:42:03.909 UT      60.281      51.775     302.503
;    1998-08-26/06:42:05.233 UT      59.451      50.858     304.225
;    1998-08-26/06:42:05.763 UT      59.118      50.491     304.914
;    1998-08-26/06:42:06.131 UT      58.887      50.236     305.393
;    1998-08-26/06:42:08.763 UT      56.041      47.591     300.315
;    1998-08-26/06:42:09.131 UT      55.588      47.184     299.216
;    1998-08-26/06:42:11.763 UT      56.495      48.479     295.599
;    1998-08-26/06:42:12.131 UT      56.853      48.895     295.330
;    1998-08-26/06:42:15.131 UT      59.578      51.255     299.830
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_|_       Tec_|_      Teh_|_
;=========================================================================================
;    1998-09-24/23:20:32.842 UT      20.230      17.269      88.767
;    1998-09-24/23:20:35.842 UT      21.178      17.959      92.321
;    1998-09-24/23:20:38.842 UT      22.126      18.650      95.875
;    1998-09-24/23:20:41.842 UT      23.074      19.340      99.429
;    1998-09-24/23:20:44.842 UT      24.023      20.031     102.983
;    1998-09-24/23:22:20.632 UT      51.312      39.918     205.556
;    1998-09-24/23:22:23.632 UT      51.273      39.896     205.509
;    1998-09-24/23:22:26.632 UT      51.235      39.874     205.461
;    1998-09-24/23:22:29.632 UT      51.196      39.852     205.413
;    1998-09-24/23:22:32.632 UT      51.157      39.830     205.366
;    1998-09-24/23:22:42.150 UT      51.035      39.760     205.215
;    1998-09-24/23:22:45.150 UT      50.997      39.738     205.167
;    1998-09-24/23:22:48.150 UT      50.958      39.716     205.120
;    1998-09-24/23:22:51.150 UT      50.920      39.694     205.072
;    1998-09-24/23:22:54.150 UT      50.881      39.672     205.024
;    1998-09-24/23:29:54.465 UT      49.490      39.568     194.924
;    1998-09-24/23:29:57.465 UT      49.587      39.619     195.202
;    1998-09-24/23:30:00.465 UT      49.685      39.669     195.479
;    1998-09-24/23:30:03.465 UT      49.782      39.719     195.757
;    1998-09-24/23:30:06.465 UT      49.879      39.770     196.034
;    1998-09-24/23:30:42.542 UT      50.324      40.020     197.554
;    1998-09-24/23:30:45.542 UT      50.218      39.971     197.324
;    1998-09-24/23:30:48.542 UT      50.113      39.922     197.093
;    1998-09-24/23:30:51.542 UT      50.007      39.873     196.862
;    1998-09-24/23:30:54.542 UT      49.902      39.824     196.632
;    1998-09-24/23:43:12.951 UT      41.543      35.326     169.050
;    1998-09-24/23:43:15.951 UT      41.399      35.233     168.315
;    1998-09-24/23:43:18.951 UT      41.255      35.140     167.579
;    1998-09-24/23:43:21.951 UT      41.111      35.048     166.843
;    1998-09-24/23:43:24.951 UT      40.966      34.955     166.108
;    1998-09-24/23:45:46.184 UT      41.314      35.025     165.695
;    1998-09-24/23:45:47.379 UT      41.269      34.997     165.675
;    1998-09-24/23:45:49.184 UT      41.201      34.956     165.646
;    1998-09-24/23:45:50.379 UT      41.156      34.929     165.626
;    1998-09-24/23:45:52.184 UT      41.089      34.887     165.597
;    1998-09-24/23:45:53.379 UT      41.044      34.860     165.577
;    1998-09-24/23:45:55.184 UT      40.976      34.818     165.547
;    1998-09-24/23:45:56.379 UT      40.932      34.791     165.528
;    1998-09-24/23:45:58.184 UT      40.864      34.750     165.498
;    1998-09-24/23:45:59.379 UT      40.819      34.722     165.479
;    1998-09-24/23:48:33.020 UT      43.971      36.169     163.861
;    1998-09-24/23:48:36.020 UT      44.190      36.285     163.845
;    1998-09-24/23:48:36.131 UT      44.198      36.289     163.844
;    1998-09-24/23:48:39.020 UT      44.409      36.401     163.829
;    1998-09-24/23:48:39.131 UT      44.417      36.405     163.829
;    1998-09-24/23:48:42.020 UT      44.628      36.517     163.813
;    1998-09-24/23:48:42.131 UT      44.636      36.521     163.813
;    1998-09-24/23:48:45.020 UT      44.847      36.633     163.798
;    1998-09-24/23:48:45.131 UT      44.855      36.637     163.797
;    1998-09-24/23:48:45.622 UT      44.891      36.656     163.795
;    1998-09-24/23:48:48.131 UT      45.074      36.753     163.781
;    1998-09-24/23:48:48.622 UT      45.109      36.772     163.779
;    1998-09-24/23:48:51.622 UT      45.328      36.888     163.763
;    1998-09-24/23:48:54.622 UT      45.494      36.981     164.007
;    1998-09-24/23:48:57.622 UT      45.640      37.066     164.343
;    1998-09-25/00:03:58.545 UT      57.350      44.714     173.639
;    1998-09-25/00:04:01.545 UT      57.337      44.698     173.652
;    1998-09-25/00:04:04.545 UT      57.325      44.683     173.665
;    1998-09-25/00:04:07.545 UT      57.313      44.667     173.678
;    1998-09-25/00:04:10.545 UT      57.301      44.651     173.691
;    1998-09-25/00:05:17.432 UT      57.026      44.298     173.979
;    1998-09-25/00:05:20.432 UT      57.014      44.282     173.992
;    1998-09-25/00:05:23.432 UT      57.002      44.266     174.005
;    1998-09-25/00:05:26.432 UT      56.990      44.251     174.018
;    1998-09-25/00:05:29.432 UT      56.977      44.235     174.031
;    1998-09-25/00:14:44.603 UT      57.083      43.749     181.232
;    1998-09-25/00:14:47.603 UT      57.025      43.669     181.372
;    1998-09-25/00:14:50.603 UT      56.967      43.590     181.512
;    1998-09-25/00:14:53.603 UT      56.908      43.510     181.652
;    1998-09-25/00:14:56.603 UT      56.850      43.431     181.792
;    1998-09-25/00:28:36.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:39.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:42.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:45.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:48.305 UT         NaN         NaN         NaN
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_|_       Tec_|_      Teh_|_
;=========================================================================================
;    2000-02-11/23:33:50.491 UT      36.527      21.838     151.597
;    2000-02-11/23:33:52.351 UT      43.362      26.188     185.403
;    2000-02-11/23:33:53.491 UT      48.000      29.010     206.245
;    2000-02-11/23:33:54.731 UT      53.546      32.256     229.050
;    2000-02-11/23:33:55.351 UT      56.319      33.878     240.453
;    2000-02-11/23:33:56.491 UT      58.283      35.257     253.926
;    2000-02-11/23:33:57.731 UT      55.464      34.219     256.735
;    2000-02-11/23:33:58.351 UT      54.055      33.700     258.140
;    2000-02-11/23:33:59.491 UT      51.990      33.135     259.122
;    2000-02-11/23:34:00.731 UT      50.949      33.413     256.529
;    2000-02-11/23:34:01.351 UT      50.428      33.551     255.232
;    2000-02-11/23:34:02.491 UT      49.728      33.839     253.455
;    2000-02-11/23:34:03.731 UT      49.869      34.264     253.650
;    2000-02-11/23:34:04.351 UT      49.940      34.477     253.748
;    2000-02-11/23:34:06.731 UT      49.702      34.838     253.248
;    2000-02-11/23:34:21.503 UT      46.586      36.159     248.292
;    2000-02-11/23:34:23.065 UT      46.684      36.327     250.247
;    2000-02-11/23:34:24.503 UT      46.900      36.537     250.711
;    2000-02-11/23:34:26.065 UT      47.324      36.845     249.189
;    2000-02-11/23:34:27.503 UT      47.573      37.032     248.430
;    2000-02-11/23:34:29.065 UT      47.557      37.038     248.903
;    2000-02-11/23:34:30.503 UT      47.318      36.921     249.818
;    2000-02-11/23:34:32.065 UT      46.438      36.453     252.137
;    2000-02-11/23:34:33.503 UT      45.572      36.042     253.152
;    2000-02-11/23:34:35.065 UT      44.401      35.676     249.792
;    2000-02-12/00:14:15.709 UT      25.692      23.605     183.461
;    2000-02-12/00:14:18.709 UT      25.678      23.588     183.457
;    2000-02-12/00:14:21.709 UT      25.664      23.571     183.453
;    2000-02-12/00:14:24.709 UT      25.649      23.555     183.449
;    2000-02-12/00:14:27.709 UT      25.635      23.538     183.445
;    2000-02-12/00:26:11.217 UT      26.623      23.987     176.061
;    2000-02-12/00:26:14.217 UT      26.713      24.069     175.965
;    2000-02-12/00:26:17.217 UT      26.803      24.150     175.870
;    2000-02-12/00:26:20.217 UT      26.893      24.232     175.774
;    2000-02-12/00:26:23.217 UT      26.983      24.313     175.679
;    2000-02-12/00:27:13.142 UT      28.492      25.676     174.240
;    2000-02-12/00:27:16.142 UT      28.638      25.785     174.863
;    2000-02-12/00:27:19.142 UT      28.784      25.894     175.486
;    2000-02-12/00:27:22.142 UT      28.930      26.004     176.109
;    2000-02-12/00:27:25.142 UT      29.075      26.113     176.732
;-----------------------------------------------------------------------------------------


mform      = '(";",a30,3f12.3)'
FOR j=0L, N_ELEMENTS(nscets) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,nscets[j],tds_teape[j]/tds_teapa[j],tds_tecpe[j]/tds_tecpa[j],tds_tehpe[j]/tds_tehpa[j]

;-----------------------------------------------------------------------------------------
;      Date        Time              Te_ani      Tec_ani     Teh_ani
;=========================================================================================
;    1997-12-10/04:33:09.605 UT       1.057       1.105       0.920
;    1997-12-10/04:33:12.605 UT       1.007       1.055       0.849
;    1997-12-10/04:33:15.605 UT       0.979       1.025       0.828
;    1997-12-10/04:33:18.605 UT       1.153       1.200       0.935
;    1997-12-10/04:33:21.605 UT       1.128       1.167       0.972
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_ani      Tec_ani     Teh_ani
;=========================================================================================
;    1998-08-26/06:40:20.120 UT       0.811       1.019       0.520
;    1998-08-26/06:40:23.120 UT       1.055       1.190       0.759
;    1998-08-26/06:40:26.120 UT       1.105       1.121       1.073
;    1998-08-26/06:40:29.120 UT       1.016       1.009       1.074
;    1998-08-26/06:40:32.120 UT       1.054       1.053       1.075
;    1998-08-26/06:40:48.941 UT       0.965       1.000       0.873
;    1998-08-26/06:40:51.941 UT       0.953       0.942       1.024
;    1998-08-26/06:40:54.941 UT       1.082       1.044       1.296
;    1998-08-26/06:40:57.941 UT       1.111       1.069       1.384
;    1998-08-26/06:41:00.941 UT       1.055       1.017       1.301
;    1998-08-26/06:41:04.001 UT       0.991       0.956       1.201
;    1998-08-26/06:41:07.001 UT       0.933       0.899       1.115
;    1998-08-26/06:41:10.001 UT       0.972       0.927       1.196
;    1998-08-26/06:41:13.001 UT       1.027       0.976       1.282
;    1998-08-26/06:41:16.001 UT       0.997       0.948       1.245
;    1998-08-26/06:41:31.623 UT       1.065       1.029       1.223
;    1998-08-26/06:41:34.623 UT       1.094       1.052       1.284
;    1998-08-26/06:41:37.623 UT       1.088       1.042       1.305
;    1998-08-26/06:41:38.013 UT       1.086       1.039       1.309
;    1998-08-26/06:41:40.623 UT       1.066       1.018       1.317
;    1998-08-26/06:41:41.013 UT       1.063       1.014       1.315
;    1998-08-26/06:41:43.623 UT       1.052       1.004       1.301
;    1998-08-26/06:41:44.013 UT       1.053       1.004       1.298
;    1998-08-26/06:41:47.013 UT       1.060       1.013       1.290
;    1998-08-26/06:41:47.249 UT       1.061       1.014       1.290
;    1998-08-26/06:41:50.013 UT       1.065       1.019       1.286
;    1998-08-26/06:41:50.249 UT       1.065       1.020       1.286
;    1998-08-26/06:41:50.315 UT       1.065       1.020       1.285
;    1998-08-26/06:41:51.909 UT       1.062       1.017       1.287
;    1998-08-26/06:41:53.233 UT       1.057       1.011       1.297
;    1998-08-26/06:41:53.249 UT       1.057       1.011       1.297
;    1998-08-26/06:41:53.315 UT       1.057       1.010       1.297
;    1998-08-26/06:41:54.909 UT       1.051       1.003       1.305
;    1998-08-26/06:41:56.233 UT       1.046       0.998       1.306
;    1998-08-26/06:41:56.249 UT       1.045       0.998       1.306
;    1998-08-26/06:41:56.315 UT       1.045       0.998       1.306
;    1998-08-26/06:41:57.909 UT       1.033       0.986       1.305
;    1998-08-26/06:41:59.233 UT       1.011       0.962       1.300
;    1998-08-26/06:41:59.249 UT       1.011       0.962       1.300
;    1998-08-26/06:41:59.315 UT       1.010       0.961       1.300
;    1998-08-26/06:41:59.763 UT       1.003       0.953       1.298
;    1998-08-26/06:42:00.909 UT       0.985       0.935       1.289
;    1998-08-26/06:42:02.233 UT       0.969       0.923       1.264
;    1998-08-26/06:42:02.315 UT       0.968       0.922       1.263
;    1998-08-26/06:42:02.763 UT       0.963       0.918       1.255
;    1998-08-26/06:42:03.131 UT       0.959       0.914       1.248
;    1998-08-26/06:42:03.909 UT       0.950       0.907       1.237
;    1998-08-26/06:42:05.233 UT       0.938       0.894       1.224
;    1998-08-26/06:42:05.763 UT       0.933       0.889       1.219
;    1998-08-26/06:42:06.131 UT       0.930       0.885       1.215
;    1998-08-26/06:42:08.763 UT       0.881       0.842       1.109
;    1998-08-26/06:42:09.131 UT       0.873       0.835       1.092
;    1998-08-26/06:42:11.763 UT       0.888       0.852       1.120
;    1998-08-26/06:42:12.131 UT       0.894       0.858       1.133
;    1998-08-26/06:42:15.131 UT       0.967       0.927       1.241
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_ani      Tec_ani     Teh_ani
;=========================================================================================
;    1998-09-24/23:20:32.842 UT       0.703       0.823       0.819
;    1998-09-24/23:20:35.842 UT       0.721       0.829       0.850
;    1998-09-24/23:20:38.842 UT       0.737       0.836       0.880
;    1998-09-24/23:20:41.842 UT       0.754       0.841       0.911
;    1998-09-24/23:20:44.842 UT       0.769       0.847       0.942
;    1998-09-24/23:22:20.632 UT       1.049       0.933       1.762
;    1998-09-24/23:22:23.632 UT       1.048       0.933       1.757
;    1998-09-24/23:22:26.632 UT       1.048       0.933       1.753
;    1998-09-24/23:22:29.632 UT       1.048       0.933       1.749
;    1998-09-24/23:22:32.632 UT       1.047       0.933       1.745
;    1998-09-24/23:22:42.150 UT       1.046       0.933       1.733
;    1998-09-24/23:22:45.150 UT       1.046       0.933       1.729
;    1998-09-24/23:22:48.150 UT       1.046       0.933       1.725
;    1998-09-24/23:22:51.150 UT       1.045       0.933       1.721
;    1998-09-24/23:22:54.150 UT       1.045       0.933       1.717
;    1998-09-24/23:29:54.465 UT       0.968       0.885       1.434
;    1998-09-24/23:29:57.465 UT       0.970       0.886       1.437
;    1998-09-24/23:30:00.465 UT       0.972       0.888       1.439
;    1998-09-24/23:30:03.465 UT       0.975       0.890       1.441
;    1998-09-24/23:30:06.465 UT       0.977       0.891       1.444
;    1998-09-24/23:30:42.542 UT       0.992       0.903       1.458
;    1998-09-24/23:30:45.542 UT       0.991       0.903       1.457
;    1998-09-24/23:30:48.542 UT       0.989       0.903       1.455
;    1998-09-24/23:30:51.542 UT       0.988       0.902       1.453
;    1998-09-24/23:30:54.542 UT       0.987       0.902       1.452
;    1998-09-24/23:43:12.951 UT       0.811       0.787       1.005
;    1998-09-24/23:43:15.951 UT       0.806       0.783       0.995
;    1998-09-24/23:43:18.951 UT       0.802       0.780       0.984
;    1998-09-24/23:43:21.951 UT       0.797       0.776       0.974
;    1998-09-24/23:43:24.951 UT       0.792       0.772       0.964
;    1998-09-24/23:45:46.184 UT       0.757       0.732       1.001
;    1998-09-24/23:45:47.379 UT       0.758       0.733       1.004
;    1998-09-24/23:45:49.184 UT       0.759       0.735       1.007
;    1998-09-24/23:45:50.379 UT       0.760       0.736       1.009
;    1998-09-24/23:45:52.184 UT       0.761       0.738       1.013
;    1998-09-24/23:45:53.379 UT       0.762       0.739       1.015
;    1998-09-24/23:45:55.184 UT       0.763       0.740       1.019
;    1998-09-24/23:45:56.379 UT       0.764       0.741       1.022
;    1998-09-24/23:45:58.184 UT       0.765       0.743       1.025
;    1998-09-24/23:45:59.379 UT       0.766       0.744       1.028
;    1998-09-24/23:48:33.020 UT       0.765       0.760       0.835
;    1998-09-24/23:48:36.020 UT       0.764       0.759       0.826
;    1998-09-24/23:48:36.131 UT       0.764       0.758       0.825
;    1998-09-24/23:48:39.020 UT       0.762       0.757       0.816
;    1998-09-24/23:48:39.131 UT       0.762       0.757       0.816
;    1998-09-24/23:48:42.020 UT       0.760       0.755       0.807
;    1998-09-24/23:48:42.131 UT       0.760       0.755       0.807
;    1998-09-24/23:48:45.020 UT       0.759       0.753       0.798
;    1998-09-24/23:48:45.131 UT       0.759       0.753       0.798
;    1998-09-24/23:48:45.622 UT       0.758       0.752       0.797
;    1998-09-24/23:48:48.131 UT       0.757       0.751       0.789
;    1998-09-24/23:48:48.622 UT       0.757       0.751       0.788
;    1998-09-24/23:48:51.622 UT       0.755       0.749       0.780
;    1998-09-24/23:48:54.622 UT       0.757       0.750       0.781
;    1998-09-24/23:48:57.622 UT       0.760       0.752       0.785
;    1998-09-25/00:03:58.545 UT       0.966       0.949       1.017
;    1998-09-25/00:04:01.545 UT       0.965       0.949       1.017
;    1998-09-25/00:04:04.545 UT       0.965       0.948       1.016
;    1998-09-25/00:04:07.545 UT       0.965       0.948       1.016
;    1998-09-25/00:04:10.545 UT       0.965       0.947       1.016
;    1998-09-25/00:05:17.432 UT       0.959       0.938       1.013
;    1998-09-25/00:05:20.432 UT       0.959       0.938       1.013
;    1998-09-25/00:05:23.432 UT       0.959       0.937       1.013
;    1998-09-25/00:05:26.432 UT       0.958       0.937       1.013
;    1998-09-25/00:05:29.432 UT       0.958       0.937       1.013
;    1998-09-25/00:14:44.603 UT       1.056       1.031       1.136
;    1998-09-25/00:14:47.603 UT       1.057       1.031       1.139
;    1998-09-25/00:14:50.603 UT       1.058       1.031       1.143
;    1998-09-25/00:14:53.603 UT       1.059       1.032       1.146
;    1998-09-25/00:14:56.603 UT       1.060       1.032       1.150
;    1998-09-25/00:28:36.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:39.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:42.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:45.305 UT         NaN         NaN         NaN
;    1998-09-25/00:28:48.305 UT         NaN         NaN         NaN
;-----------------------------------------------------------------------------------------
;      Date        Time              Te_ani      Tec_ani     Teh_ani
;=========================================================================================
;    2000-02-11/23:33:50.491 UT       0.610       0.792       0.516
;    2000-02-11/23:33:52.351 UT       0.560       0.661       0.502
;    2000-02-11/23:33:53.491 UT       0.604       0.684       0.555
;    2000-02-11/23:33:54.731 UT       0.744       0.800       0.703
;    2000-02-11/23:33:55.351 UT       0.825       0.863       0.793
;    2000-02-11/23:33:56.491 UT       0.930       0.932       0.930
;    2000-02-11/23:33:57.731 UT       0.944       0.922       0.990
;    2000-02-11/23:33:58.351 UT       0.951       0.918       1.023
;    2000-02-11/23:33:59.491 UT       0.970       0.925       1.075
;    2000-02-11/23:34:00.731 UT       1.001       0.970       1.105
;    2000-02-11/23:34:01.351 UT       1.017       0.994       1.121
;    2000-02-11/23:34:02.491 UT       1.049       1.037       1.150
;    2000-02-11/23:34:03.731 UT       1.079       1.072       1.180
;    2000-02-11/23:34:04.351 UT       1.095       1.089       1.195
;    2000-02-11/23:34:06.731 UT       1.123       1.117       1.244
;    2000-02-11/23:34:21.503 UT       1.209       1.166       1.547
;    2000-02-11/23:34:23.065 UT       1.224       1.174       1.593
;    2000-02-11/23:34:24.503 UT       1.242       1.189       1.624
;    2000-02-11/23:34:26.065 UT       1.271       1.217       1.641
;    2000-02-11/23:34:27.503 UT       1.293       1.238       1.645
;    2000-02-11/23:34:29.065 UT       1.306       1.254       1.627
;    2000-02-11/23:34:30.503 UT       1.317       1.265       1.625
;    2000-02-11/23:34:32.065 UT       1.322       1.265       1.663
;    2000-02-11/23:34:33.503 UT       1.321       1.264       1.668
;    2000-02-11/23:34:35.065 UT       1.301       1.261       1.560
;    2000-02-12/00:14:15.709 UT       0.919       0.949       0.842
;    2000-02-12/00:14:18.709 UT       0.919       0.949       0.842
;    2000-02-12/00:14:21.709 UT       0.918       0.949       0.842
;    2000-02-12/00:14:24.709 UT       0.918       0.949       0.842
;    2000-02-12/00:14:27.709 UT       0.918       0.949       0.842
;    2000-02-12/00:26:11.217 UT       0.836       0.871       0.760
;    2000-02-12/00:26:14.217 UT       0.834       0.868       0.760
;    2000-02-12/00:26:17.217 UT       0.832       0.866       0.760
;    2000-02-12/00:26:20.217 UT       0.830       0.863       0.760
;    2000-02-12/00:26:23.217 UT       0.829       0.861       0.760
;    2000-02-12/00:27:13.142 UT       0.803       0.825       0.765
;    2000-02-12/00:27:16.142 UT       0.807       0.829       0.771
;    2000-02-12/00:27:19.142 UT       0.811       0.833       0.777
;    2000-02-12/00:27:22.142 UT       0.815       0.837       0.783
;    2000-02-12/00:27:25.142 UT       0.820       0.840       0.789
;-----------------------------------------------------------------------------------------


;-----------------------------------------------------------------------------------------
; => Look at threshold conditions for Gary et. al. [1994,1999]
;
; => whistler heat flux instability  = WHFI
; => whistler anisotropy instability = WAI
;
; => Gary et al., [1999] found the whistler heat flux instability (WHFI) to ALWAYS be 
;      unstable if Thperp/Thpara > 1.01 and ALWAYS stable for beta_para,c < 0.25.  
;      Also, Gary et al., [1994] suggested that even when Thpara/Tcpara is small but 
;      Thperp/Thpara > 1.01, the WAI can still be unstable even in the absence of a
;      relative drift between halo and core.
;-----------------------------------------------------------------------------------------
f           = !VALUES.F_NAN
d           = !VALUES.D_NAN
tanih       = tds_tehpe/tds_tehpa
tanic       = tds_tecpe/tds_tecpa
tparhc      = tds_tehpa/tds_tecpa
gary_test_0 = (beta_cpar GT 6d-1 AND tanih GT 75d-2) OR  (beta_cpar GT 6d-1 AND tparhc GT 75d-1)
gary_test_1 = (beta_cpar GT 6d-1 AND tanih GT 75d-2) AND (beta_cpar GT 6d-1 AND tparhc GT 75d-1)
gary_test_2 = (beta_cpar GT 6d-1 AND tanih GT 75d-2)
gary_test_3 = (tparhc GT 75d-1)
gary_test_4 = (tanih GT 75d-2)

mform      = '(";",a30,5I12.1)'
FOR j=0L, N_ELEMENTS(nscets) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,nscets[j],gary_test_0[j],gary_test_1[j],gary_test_2[j],$
                     gary_test_3[j],gary_test_4[j]
;----------------------------------------------------------------------------------------------
;      Date        Time                 Test 0      Test 1      Test 2      Test 3      Test 4
;==============================================================================================
;    1998-08-26/06:40:20.120 UT           1           0           0           1           0
;    1998-08-26/06:40:23.120 UT           1           1           1           1           1
;    1998-08-26/06:40:26.120 UT           1           0           1           0           1
;    1998-08-26/06:40:29.120 UT           1           0           1           0           1
;    1998-08-26/06:40:32.120 UT           1           0           1           0           1
;    1998-08-26/06:40:48.941 UT           1           1           1           1           1
;    1998-08-26/06:40:51.941 UT           1           0           1           0           1
;    1998-08-26/06:40:54.941 UT           1           0           1           0           1
;    1998-08-26/06:40:57.941 UT           1           0           1           0           1
;    1998-08-26/06:41:00.941 UT           1           0           1           0           1
;    1998-08-26/06:41:04.001 UT           1           0           1           0           1
;    1998-08-26/06:41:07.001 UT           1           0           1           0           1
;    1998-08-26/06:41:10.001 UT           1           0           1           0           1
;    1998-08-26/06:41:13.001 UT           1           0           1           0           1
;    1998-08-26/06:41:16.001 UT           1           0           1           0           1
;    1998-08-26/06:41:31.623 UT           1           0           1           0           1
;    1998-08-26/06:41:34.623 UT           1           0           1           0           1
;    1998-08-26/06:41:37.623 UT           1           0           1           0           1
;    1998-08-26/06:41:38.013 UT           1           0           1           0           1
;    1998-08-26/06:41:40.623 UT           1           0           1           0           1
;    1998-08-26/06:41:41.013 UT           1           0           1           0           1
;    1998-08-26/06:41:43.623 UT           1           0           1           0           1
;    1998-08-26/06:41:44.013 UT           1           0           1           0           1
;    1998-08-26/06:41:47.013 UT           1           0           1           0           1
;    1998-08-26/06:41:47.249 UT           1           0           1           0           1
;    1998-08-26/06:41:50.013 UT           1           0           1           0           1
;    1998-08-26/06:41:50.249 UT           1           0           1           0           1
;    1998-08-26/06:41:50.315 UT           1           0           1           0           1
;    1998-08-26/06:41:51.909 UT           1           0           1           0           1
;    1998-08-26/06:41:53.233 UT           1           0           1           0           1
;    1998-08-26/06:41:53.249 UT           1           0           1           0           1
;    1998-08-26/06:41:53.315 UT           1           0           1           0           1
;    1998-08-26/06:41:54.909 UT           1           0           1           0           1
;    1998-08-26/06:41:56.233 UT           1           0           1           0           1
;    1998-08-26/06:41:56.249 UT           1           0           1           0           1
;    1998-08-26/06:41:56.315 UT           1           0           1           0           1
;    1998-08-26/06:41:57.909 UT           1           0           1           0           1
;    1998-08-26/06:41:59.233 UT           1           0           1           0           1
;    1998-08-26/06:41:59.249 UT           1           0           1           0           1
;    1998-08-26/06:41:59.315 UT           1           0           1           0           1
;    1998-08-26/06:41:59.763 UT           1           0           1           0           1
;    1998-08-26/06:42:00.909 UT           1           0           1           0           1
;    1998-08-26/06:42:02.233 UT           1           0           1           0           1
;    1998-08-26/06:42:02.315 UT           1           0           1           0           1
;    1998-08-26/06:42:02.763 UT           1           0           1           0           1
;    1998-08-26/06:42:03.131 UT           1           0           1           0           1
;    1998-08-26/06:42:03.909 UT           1           0           1           0           1
;    1998-08-26/06:42:05.233 UT           1           0           1           0           1
;    1998-08-26/06:42:05.763 UT           1           0           1           0           1
;    1998-08-26/06:42:06.131 UT           1           0           1           0           1
;    1998-08-26/06:42:08.763 UT           1           0           1           0           1
;    1998-08-26/06:42:09.131 UT           1           0           1           0           1
;    1998-08-26/06:42:11.763 UT           1           0           1           0           1
;    1998-08-26/06:42:12.131 UT           1           0           1           0           1
;    1998-08-26/06:42:15.131 UT           1           0           1           0           1
;----------------------------------------------------------------------------------------------
;      Date        Time                 Test 0      Test 1      Test 2      Test 3      Test 4
;==============================================================================================
;    1998-09-24/23:20:32.842 UT           1           0           1           0           1
;    1998-09-24/23:20:35.842 UT           1           0           1           0           1
;    1998-09-24/23:20:38.842 UT           0           0           0           0           1
;    1998-09-24/23:20:41.842 UT           0           0           0           0           1
;    1998-09-24/23:20:44.842 UT           0           0           0           0           1
;    1998-09-24/23:22:20.632 UT           0           0           0           0           1
;    1998-09-24/23:22:23.632 UT           0           0           0           0           1
;    1998-09-24/23:22:26.632 UT           0           0           0           0           1
;    1998-09-24/23:22:29.632 UT           0           0           0           0           1
;    1998-09-24/23:22:32.632 UT           0           0           0           0           1
;    1998-09-24/23:22:42.150 UT           0           0           0           0           1
;    1998-09-24/23:22:45.150 UT           0           0           0           0           1
;    1998-09-24/23:22:48.150 UT           0           0           0           0           1
;    1998-09-24/23:22:51.150 UT           0           0           0           0           1
;    1998-09-24/23:22:54.150 UT           0           0           0           0           1
;    1998-09-24/23:29:54.465 UT           0           0           0           0           1
;    1998-09-24/23:29:57.465 UT           0           0           0           0           1
;    1998-09-24/23:30:00.465 UT           0           0           0           0           1
;    1998-09-24/23:30:03.465 UT           0           0           0           0           1
;    1998-09-24/23:30:06.465 UT           0           0           0           0           1
;    1998-09-24/23:30:42.542 UT           0           0           0           0           1
;    1998-09-24/23:30:45.542 UT           0           0           0           0           1
;    1998-09-24/23:30:48.542 UT           0           0           0           0           1
;    1998-09-24/23:30:51.542 UT           0           0           0           0           1
;    1998-09-24/23:30:54.542 UT           0           0           0           0           1
;    1998-09-24/23:43:12.951 UT           0           0           0           0           1
;    1998-09-24/23:43:15.951 UT           0           0           0           0           1
;    1998-09-24/23:43:18.951 UT           0           0           0           0           1
;    1998-09-24/23:43:21.951 UT           0           0           0           0           1
;    1998-09-24/23:43:24.951 UT           0           0           0           0           1
;    1998-09-24/23:45:46.184 UT           0           0           0           0           1
;    1998-09-24/23:45:47.379 UT           0           0           0           0           1
;    1998-09-24/23:45:49.184 UT           0           0           0           0           1
;    1998-09-24/23:45:50.379 UT           0           0           0           0           1
;    1998-09-24/23:45:52.184 UT           0           0           0           0           1
;    1998-09-24/23:45:53.379 UT           0           0           0           0           1
;    1998-09-24/23:45:55.184 UT           0           0           0           0           1
;    1998-09-24/23:45:56.379 UT           0           0           0           0           1
;    1998-09-24/23:45:58.184 UT           0           0           0           0           1
;    1998-09-24/23:45:59.379 UT           0           0           0           0           1
;    1998-09-24/23:48:33.020 UT           0           0           0           0           1
;    1998-09-24/23:48:36.020 UT           0           0           0           0           1
;    1998-09-24/23:48:36.131 UT           0           0           0           0           1
;    1998-09-24/23:48:39.020 UT           0           0           0           0           1
;    1998-09-24/23:48:39.131 UT           0           0           0           0           1
;    1998-09-24/23:48:42.020 UT           0           0           0           0           1
;    1998-09-24/23:48:42.131 UT           0           0           0           0           1
;    1998-09-24/23:48:45.020 UT           0           0           0           0           1
;    1998-09-24/23:48:45.131 UT           0           0           0           0           1
;    1998-09-24/23:48:45.622 UT           0           0           0           0           1
;    1998-09-24/23:48:48.131 UT           0           0           0           0           1
;    1998-09-24/23:48:48.622 UT           0           0           0           0           1
;    1998-09-24/23:48:51.622 UT           0           0           0           0           1
;    1998-09-24/23:48:54.622 UT           0           0           0           0           1
;    1998-09-24/23:48:57.622 UT           0           0           0           0           1
;    1998-09-25/00:03:58.545 UT           0           0           0           0           1
;    1998-09-25/00:04:01.545 UT           1           0           1           0           1
;    1998-09-25/00:04:04.545 UT           1           0           1           0           1
;    1998-09-25/00:04:07.545 UT           1           0           1           0           1
;    1998-09-25/00:04:10.545 UT           1           0           1           0           1
;    1998-09-25/00:05:17.432 UT           1           0           1           0           1
;    1998-09-25/00:05:20.432 UT           1           0           1           0           1
;    1998-09-25/00:05:23.432 UT           1           0           1           0           1
;    1998-09-25/00:05:26.432 UT           1           0           1           0           1
;    1998-09-25/00:05:29.432 UT           1           0           1           0           1
;    1998-09-25/00:14:44.603 UT           0           0           0           0           1
;    1998-09-25/00:14:47.603 UT           0           0           0           0           1
;    1998-09-25/00:14:50.603 UT           0           0           0           0           1
;    1998-09-25/00:14:53.603 UT           0           0           0           0           1
;    1998-09-25/00:14:56.603 UT           0           0           0           0           1
;    1998-09-25/00:28:36.305 UT           0           0           0           0           0
;    1998-09-25/00:28:39.305 UT           0           0           0           0           0
;    1998-09-25/00:28:42.305 UT           0           0           0           0           0
;    1998-09-25/00:28:45.305 UT           0           0           0           0           0
;    1998-09-25/00:28:48.305 UT           0           0           0           0           0
;----------------------------------------------------------------------------------------------
;      Date        Time                 Test 0      Test 1      Test 2      Test 3      Test 4
;==============================================================================================
;    2000-02-11/23:33:50.491 UT           1           0           0           1           0
;    2000-02-11/23:33:52.351 UT           1           0           0           1           0
;    2000-02-11/23:33:53.491 UT           1           0           0           1           0
;    2000-02-11/23:33:54.731 UT           1           0           0           1           0
;    2000-02-11/23:33:55.351 UT           1           1           1           1           1
;    2000-02-11/23:33:56.491 UT           1           0           1           0           1
;    2000-02-11/23:33:57.731 UT           1           0           1           0           1
;    2000-02-11/23:33:58.351 UT           1           0           1           0           1
;    2000-02-11/23:33:59.491 UT           1           0           1           0           1
;    2000-02-11/23:34:00.731 UT           1           0           1           0           1
;    2000-02-11/23:34:01.351 UT           1           0           1           0           1
;    2000-02-11/23:34:02.491 UT           1           0           1           0           1
;    2000-02-11/23:34:03.731 UT           1           0           1           0           1
;    2000-02-11/23:34:04.351 UT           1           0           1           0           1
;    2000-02-11/23:34:06.731 UT           1           0           1           0           1
;    2000-02-11/23:34:21.503 UT           0           0           0           0           1
;    2000-02-11/23:34:23.065 UT           0           0           0           0           1
;    2000-02-11/23:34:24.503 UT           0           0           0           0           1
;    2000-02-11/23:34:26.065 UT           0           0           0           0           1
;    2000-02-11/23:34:27.503 UT           0           0           0           0           1
;    2000-02-11/23:34:29.065 UT           0           0           0           0           1
;    2000-02-11/23:34:30.503 UT           0           0           0           0           1
;    2000-02-11/23:34:32.065 UT           0           0           0           0           1
;    2000-02-11/23:34:33.503 UT           0           0           0           0           1
;    2000-02-11/23:34:35.065 UT           0           0           0           0           1
;    2000-02-12/00:14:15.709 UT           1           1           1           1           1
;    2000-02-12/00:14:18.709 UT           1           1           1           1           1
;    2000-02-12/00:14:21.709 UT           1           1           1           1           1
;    2000-02-12/00:14:24.709 UT           1           1           1           1           1
;    2000-02-12/00:14:27.709 UT           1           1           1           1           1
;    2000-02-12/00:26:11.217 UT           1           1           1           1           1
;    2000-02-12/00:26:14.217 UT           1           1           1           1           1
;    2000-02-12/00:26:17.217 UT           1           1           1           1           1
;    2000-02-12/00:26:20.217 UT           1           1           1           1           1
;    2000-02-12/00:26:23.217 UT           1           1           1           1           1
;    2000-02-12/00:27:13.142 UT           1           0           1           0           1
;    2000-02-12/00:27:16.142 UT           1           0           1           0           1
;    2000-02-12/00:27:19.142 UT           1           0           1           0           1
;    2000-02-12/00:27:22.142 UT           1           0           1           0           1
;    2000-02-12/00:27:25.142 UT           1           0           1           0           1
;----------------------------------------------------------------------------------------------

mform      = '(";",a30,3f15.3)'
FOR j=0L, N_ELEMENTS(nscets) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,nscets[j],beta_cpar[j],tanih[j],tparhc[j]
;----------------------------------------------------------------------------------------------
;      Date        Time                Betaparc        Teh_ani      Th/Tc [para]
;==============================================================================================
;    1998-08-26/06:40:20.120 UT          1.025          0.520         18.345
;    1998-08-26/06:40:23.120 UT          1.285          0.759         11.984
;    1998-08-26/06:40:26.120 UT          0.736          1.073          7.209
;    1998-08-26/06:40:29.120 UT          1.250          1.074          6.597
;    1998-08-26/06:40:32.120 UT          1.253          1.075          6.829
;    1998-08-26/06:40:48.941 UT          0.626          0.873          7.660
;    1998-08-26/06:40:51.941 UT          0.811          1.024          6.136
;    1998-08-26/06:40:54.941 UT          0.809          1.296          4.952
;    1998-08-26/06:40:57.941 UT          0.917          1.384          4.595
;    1998-08-26/06:41:00.941 UT          0.895          1.301          4.713
;    1998-08-26/06:41:04.001 UT          0.872          1.201          4.916
;    1998-08-26/06:41:07.001 UT          0.837          1.115          5.105
;    1998-08-26/06:41:10.001 UT          0.841          1.196          5.154
;    1998-08-26/06:41:13.001 UT          0.739          1.282          5.113
;    1998-08-26/06:41:16.001 UT          0.781          1.245          5.096
;    1998-08-26/06:41:31.623 UT          0.805          1.223          5.142
;    1998-08-26/06:41:34.623 UT          0.869          1.284          4.785
;    1998-08-26/06:41:37.623 UT          1.003          1.305          4.651
;    1998-08-26/06:41:38.013 UT          1.007          1.309          4.624
;    1998-08-26/06:41:40.623 UT          0.892          1.317          4.501
;    1998-08-26/06:41:41.013 UT          0.919          1.315          4.490
;    1998-08-26/06:41:43.623 UT          0.878          1.301          4.490
;    1998-08-26/06:41:44.013 UT          0.894          1.298          4.501
;    1998-08-26/06:41:47.013 UT          0.882          1.290          4.564
;    1998-08-26/06:41:47.249 UT          0.877          1.290          4.568
;    1998-08-26/06:41:50.013 UT          0.808          1.286          4.593
;    1998-08-26/06:41:50.249 UT          0.798          1.286          4.594
;    1998-08-26/06:41:50.315 UT          0.809          1.285          4.595
;    1998-08-26/06:41:51.909 UT          0.823          1.287          4.556
;    1998-08-26/06:41:53.233 UT          0.772          1.297          4.464
;    1998-08-26/06:41:53.249 UT          0.772          1.297          4.463
;    1998-08-26/06:41:53.315 UT          0.776          1.297          4.459
;    1998-08-26/06:41:54.909 UT          0.809          1.305          4.370
;    1998-08-26/06:41:56.233 UT          0.775          1.306          4.327
;    1998-08-26/06:41:56.249 UT          0.777          1.306          4.326
;    1998-08-26/06:41:56.315 UT          0.774          1.306          4.324
;    1998-08-26/06:41:57.909 UT          0.747          1.305          4.280
;    1998-08-26/06:41:59.233 UT          0.723          1.300          4.259
;    1998-08-26/06:41:59.249 UT          0.724          1.300          4.258
;    1998-08-26/06:41:59.315 UT          0.726          1.300          4.257
;    1998-08-26/06:41:59.763 UT          0.757          1.298          4.250
;    1998-08-26/06:42:00.909 UT          0.773          1.289          4.241
;    1998-08-26/06:42:02.233 UT          0.831          1.264          4.256
;    1998-08-26/06:42:02.315 UT          0.827          1.263          4.257
;    1998-08-26/06:42:02.763 UT          0.780          1.255          4.261
;    1998-08-26/06:42:03.131 UT          0.775          1.248          4.265
;    1998-08-26/06:42:03.909 UT          0.787          1.237          4.286
;    1998-08-26/06:42:05.233 UT          0.728          1.224          4.371
;    1998-08-26/06:42:05.763 UT          0.778          1.219          4.405
;    1998-08-26/06:42:06.131 UT          0.817          1.215          4.429
;    1998-08-26/06:42:08.763 UT          0.926          1.109          4.787
;    1998-08-26/06:42:09.131 UT          0.938          1.092          4.846
;    1998-08-26/06:42:11.763 UT          1.100          1.120          4.638
;    1998-08-26/06:42:12.131 UT          1.171          1.133          4.574
;    1998-08-26/06:42:15.131 UT          0.882          1.241          4.369
;----------------------------------------------------------------------------------------------
;      Date        Time                Betaparc        Teh_ani      Th/Tc [para]
;==============================================================================================
;    1998-09-24/23:20:32.842 UT          0.744          0.819          5.166
;    1998-09-24/23:20:35.842 UT          0.753          0.850          5.018
;    1998-09-24/23:20:38.842 UT          0.148          0.880          4.879
;    1998-09-24/23:20:41.842 UT          0.167          0.911          4.748
;    1998-09-24/23:20:44.842 UT          0.178          0.942          4.624
;    1998-09-24/23:22:20.632 UT          0.201          1.762          2.726
;    1998-09-24/23:22:23.632 UT          0.210          1.757          2.734
;    1998-09-24/23:22:26.632 UT          0.205          1.753          2.741
;    1998-09-24/23:22:29.632 UT          0.207          1.749          2.749
;    1998-09-24/23:22:32.632 UT          0.202          1.745          2.756
;    1998-09-24/23:22:42.150 UT          0.207          1.733          2.780
;    1998-09-24/23:22:45.150 UT          0.210          1.729          2.787
;    1998-09-24/23:22:48.150 UT          0.205          1.725          2.795
;    1998-09-24/23:22:51.150 UT          0.206          1.721          2.802
;    1998-09-24/23:22:54.150 UT          0.206          1.717          2.810
;    1998-09-24/23:29:54.465 UT          0.250          1.434          3.039
;    1998-09-24/23:29:57.465 UT          0.256          1.437          3.040
;    1998-09-24/23:30:00.465 UT          0.260          1.439          3.041
;    1998-09-24/23:30:03.465 UT          0.255          1.441          3.042
;    1998-09-24/23:30:06.465 UT          0.253          1.444          3.043
;    1998-09-24/23:30:42.542 UT          0.263          1.458          3.059
;    1998-09-24/23:30:45.542 UT          0.256          1.457          3.060
;    1998-09-24/23:30:48.542 UT          0.259          1.455          3.062
;    1998-09-24/23:30:51.542 UT          0.257          1.453          3.064
;    1998-09-24/23:30:54.542 UT          0.255          1.452          3.066
;    1998-09-24/23:43:12.951 UT          0.350          1.005          3.746
;    1998-09-24/23:43:15.951 UT          0.346          0.995          3.762
;    1998-09-24/23:43:18.951 UT          0.361          0.984          3.778
;    1998-09-24/23:43:21.951 UT          0.353          0.974          3.793
;    1998-09-24/23:43:24.951 UT          0.361          0.964          3.809
;    1998-09-24/23:45:46.184 UT          0.312          1.001          3.460
;    1998-09-24/23:45:47.379 UT          0.307          1.004          3.459
;    1998-09-24/23:45:49.184 UT          0.330          1.007          3.458
;    1998-09-24/23:45:50.379 UT          0.312          1.009          3.457
;    1998-09-24/23:45:52.184 UT          0.290          1.013          3.456
;    1998-09-24/23:45:53.379 UT          0.283          1.015          3.455
;    1998-09-24/23:45:55.184 UT          0.254          1.019          3.454
;    1998-09-24/23:45:56.379 UT          0.257          1.022          3.453
;    1998-09-24/23:45:58.184 UT          0.257          1.025          3.452
;    1998-09-24/23:45:59.379 UT          0.254          1.028          3.451
;    1998-09-24/23:48:33.020 UT          0.364          0.835          4.126
;    1998-09-24/23:48:36.020 UT          0.384          0.826          4.149
;    1998-09-24/23:48:36.131 UT          0.379          0.825          4.150
;    1998-09-24/23:48:39.020 UT          0.362          0.816          4.172
;    1998-09-24/23:48:39.131 UT          0.373          0.816          4.173
;    1998-09-24/23:48:42.020 UT          0.331          0.807          4.194
;    1998-09-24/23:48:42.131 UT          0.346          0.807          4.195
;    1998-09-24/23:48:45.020 UT          0.381          0.798          4.216
;    1998-09-24/23:48:45.131 UT          0.395          0.798          4.217
;    1998-09-24/23:48:45.622 UT          0.392          0.797          4.221
;    1998-09-24/23:48:48.131 UT          0.390          0.789          4.239
;    1998-09-24/23:48:48.622 UT          0.380          0.788          4.243
;    1998-09-24/23:48:51.622 UT          0.388          0.780          4.264
;    1998-09-24/23:48:54.622 UT          0.386          0.781          4.260
;    1998-09-24/23:48:57.622 UT          0.387          0.785          4.246
;    1998-09-25/00:03:58.545 UT          0.553          1.017          3.625
;    1998-09-25/00:04:01.545 UT          0.685          1.017          3.625
;    1998-09-25/00:04:04.545 UT          0.740          1.016          3.626
;    1998-09-25/00:04:07.545 UT          0.830          1.016          3.626
;    1998-09-25/00:04:10.545 UT          0.892          1.016          3.627
;    1998-09-25/00:05:17.432 UT          1.688          1.013          3.636
;    1998-09-25/00:05:20.432 UT          1.407          1.013          3.637
;    1998-09-25/00:05:23.432 UT          0.851          1.013          3.637
;    1998-09-25/00:05:26.432 UT          0.851          1.013          3.638
;    1998-09-25/00:05:29.432 UT          0.961          1.013          3.638
;    1998-09-25/00:14:44.603 UT          0.424          1.136          3.760
;    1998-09-25/00:14:47.603 UT          0.446          1.139          3.759
;    1998-09-25/00:14:50.603 UT          0.434          1.143          3.758
;    1998-09-25/00:14:53.603 UT          0.464          1.146          3.756
;    1998-09-25/00:14:56.603 UT          0.431          1.150          3.755
;    1998-09-25/00:28:36.305 UT            NaN            NaN            NaN
;    1998-09-25/00:28:39.305 UT            NaN            NaN            NaN
;    1998-09-25/00:28:42.305 UT            NaN            NaN            NaN
;    1998-09-25/00:28:45.305 UT            NaN            NaN            NaN
;    1998-09-25/00:28:48.305 UT            NaN            NaN            NaN
;----------------------------------------------------------------------------------------------
;      Date        Time                Betaparc        Teh_ani      Th/Tc [para]
;==============================================================================================
;    2000-02-11/23:33:50.491 UT          1.948          0.516         10.653
;    2000-02-11/23:33:52.351 UT          2.937          0.502          9.313
;    2000-02-11/23:33:53.491 UT          3.028          0.555          8.762
;    2000-02-11/23:33:54.731 UT          2.453          0.703          8.084
;    2000-02-11/23:33:55.351 UT          1.007          0.793          7.718
;    2000-02-11/23:33:56.491 UT          0.823          0.930          7.214
;    2000-02-11/23:33:57.731 UT          1.006          0.990          6.988
;    2000-02-11/23:33:58.351 UT          0.865          1.023          6.872
;    2000-02-11/23:33:59.491 UT          1.082          1.075          6.727
;    2000-02-11/23:34:00.731 UT          0.957          1.105          6.742
;    2000-02-11/23:34:01.351 UT          0.894          1.121          6.750
;    2000-02-11/23:34:02.491 UT          0.703          1.150          6.755
;    2000-02-11/23:34:03.731 UT          0.733          1.180          6.725
;    2000-02-11/23:34:04.351 UT          0.700          1.195          6.710
;    2000-02-11/23:34:06.731 UT          0.631          1.244          6.529
;    2000-02-11/23:34:21.503 UT          0.454          1.547          5.176
;    2000-02-11/23:34:23.065 UT          0.435          1.593          5.078
;    2000-02-11/23:34:24.503 UT          0.420          1.624          5.022
;    2000-02-11/23:34:26.065 UT          0.406          1.641          5.015
;    2000-02-11/23:34:27.503 UT          0.398          1.645          5.052
;    2000-02-11/23:34:29.065 UT          0.390          1.627          5.180
;    2000-02-11/23:34:30.503 UT          0.374          1.625          5.266
;    2000-02-11/23:34:32.065 UT          0.363          1.663          5.261
;    2000-02-11/23:34:33.503 UT          0.352          1.668          5.324
;    2000-02-11/23:34:35.065 UT          0.347          1.560          5.660
;    2000-02-12/00:14:15.709 UT          0.746          0.842          8.761
;    2000-02-12/00:14:18.709 UT          0.748          0.842          8.766
;    2000-02-12/00:14:21.709 UT          0.749          0.842          8.771
;    2000-02-12/00:14:24.709 UT          0.748          0.842          8.776
;    2000-02-12/00:14:27.709 UT          0.744          0.842          8.782
;    2000-02-12/00:26:11.217 UT          1.000          0.760          8.416
;    2000-02-12/00:26:14.217 UT          1.005          0.760          8.356
;    2000-02-12/00:26:17.217 UT          1.013          0.760          8.297
;    2000-02-12/00:26:20.217 UT          0.999          0.760          8.239
;    2000-02-12/00:26:23.217 UT          1.022          0.760          8.182
;    2000-02-12/00:27:13.142 UT          1.021          0.765          7.324
;    2000-02-12/00:27:16.142 UT          1.025          0.771          7.296
;    2000-02-12/00:27:19.142 UT          1.031          0.777          7.267
;    2000-02-12/00:27:22.142 UT          0.978          0.783          7.238
;    2000-02-12/00:27:25.142 UT          0.976          0.789          7.209
;----------------------------------------------------------------------------------------------

gary_test_5 = (tanih GT 1.01)
gary_test_6 = (beta_cpar LE 0.25)

stab_str    = '  => STABLE'
unst_str    = '  => UNSTABLE'

mform0     = '(";",a30,2I12.1,a11)'
mform1     = '(";",a30,2I12.1,a13)'
FOR j=0L, N_ELEMENTS(nscets) - 1L DO BEGIN  $
  IF (gary_test_5[j]) THEN extra = unst_str & $
  IF (gary_test_6[j]) THEN extra = stab_str & $
  IF (NOT gary_test_5[j] AND NOT gary_test_6[j]) THEN extra = stab_str & $
  IF (gary_test_5[j]) THEN mform = mform1 & $
  IF (gary_test_6[j]) THEN mform = mform0 & $
  IF (NOT gary_test_5[j] AND NOT gary_test_6[j]) THEN mform = mform0 & $
  PRINT,FORMAT=mform,nscets[j],gary_test_5[j],gary_test_6[j],extra[0]
;-----------------------------------------------------------------------------------------
;      Date        Time                 Test 5      Test 6
;=========================================================================================
;    1998-08-26/06:40:20.120 UT           0           0  => STABLE
;    1998-08-26/06:40:23.120 UT           0           0  => STABLE
;    1998-08-26/06:40:26.120 UT           1           0  => UNSTABLE
;    1998-08-26/06:40:29.120 UT           1           0  => UNSTABLE
;    1998-08-26/06:40:32.120 UT           1           0  => UNSTABLE
;    1998-08-26/06:40:48.941 UT           0           0  => STABLE
;    1998-08-26/06:40:51.941 UT           1           0  => UNSTABLE
;    1998-08-26/06:40:54.941 UT           1           0  => UNSTABLE
;    1998-08-26/06:40:57.941 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:00.941 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:04.001 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:07.001 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:10.001 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:13.001 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:16.001 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:31.623 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:34.623 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:37.623 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:38.013 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:40.623 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:41.013 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:43.623 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:44.013 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:47.013 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:47.249 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:50.013 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:50.249 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:50.315 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:51.909 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:53.233 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:53.249 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:53.315 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:54.909 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:56.233 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:56.249 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:56.315 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:57.909 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:59.233 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:59.249 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:59.315 UT           1           0  => UNSTABLE
;    1998-08-26/06:41:59.763 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:00.909 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:02.233 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:02.315 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:02.763 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:03.131 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:03.909 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:05.233 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:05.763 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:06.131 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:08.763 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:09.131 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:11.763 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:12.131 UT           1           0  => UNSTABLE
;    1998-08-26/06:42:15.131 UT           1           0  => UNSTABLE
;-----------------------------------------------------------------------------------------
;      Date        Time                 Test 5      Test 6
;=========================================================================================
;    1998-09-24/23:20:32.842 UT           0           0  => STABLE
;    1998-09-24/23:20:35.842 UT           0           0  => STABLE
;    1998-09-24/23:20:38.842 UT           0           1  => STABLE
;    1998-09-24/23:20:41.842 UT           0           1  => STABLE
;    1998-09-24/23:20:44.842 UT           0           1  => STABLE
;    1998-09-24/23:22:20.632 UT           1           1  => STABLE
;    1998-09-24/23:22:23.632 UT           1           1  => STABLE
;    1998-09-24/23:22:26.632 UT           1           1  => STABLE
;    1998-09-24/23:22:29.632 UT           1           1  => STABLE
;    1998-09-24/23:22:32.632 UT           1           1  => STABLE
;    1998-09-24/23:22:42.150 UT           1           1  => STABLE
;    1998-09-24/23:22:45.150 UT           1           1  => STABLE
;    1998-09-24/23:22:48.150 UT           1           1  => STABLE
;    1998-09-24/23:22:51.150 UT           1           1  => STABLE
;    1998-09-24/23:22:54.150 UT           1           1  => STABLE
;    1998-09-24/23:29:54.465 UT           1           0  => UNSTABLE
;    1998-09-24/23:29:57.465 UT           1           0  => UNSTABLE
;    1998-09-24/23:30:00.465 UT           1           0  => UNSTABLE
;    1998-09-24/23:30:03.465 UT           1           0  => UNSTABLE
;    1998-09-24/23:30:06.465 UT           1           0  => UNSTABLE
;    1998-09-24/23:30:42.542 UT           1           0  => UNSTABLE
;    1998-09-24/23:30:45.542 UT           1           0  => UNSTABLE
;    1998-09-24/23:30:48.542 UT           1           0  => UNSTABLE
;    1998-09-24/23:30:51.542 UT           1           0  => UNSTABLE
;    1998-09-24/23:30:54.542 UT           1           0  => UNSTABLE
;    1998-09-24/23:43:12.951 UT           0           0  => STABLE
;    1998-09-24/23:43:15.951 UT           0           0  => STABLE
;    1998-09-24/23:43:18.951 UT           0           0  => STABLE
;    1998-09-24/23:43:21.951 UT           0           0  => STABLE
;    1998-09-24/23:43:24.951 UT           0           0  => STABLE
;    1998-09-24/23:45:46.184 UT           0           0  => STABLE
;    1998-09-24/23:45:47.379 UT           0           0  => STABLE
;    1998-09-24/23:45:49.184 UT           0           0  => STABLE
;    1998-09-24/23:45:50.379 UT           0           0  => STABLE
;    1998-09-24/23:45:52.184 UT           1           0  => UNSTABLE
;    1998-09-24/23:45:53.379 UT           1           0  => UNSTABLE
;    1998-09-24/23:45:55.184 UT           1           0  => UNSTABLE
;    1998-09-24/23:45:56.379 UT           1           0  => UNSTABLE
;    1998-09-24/23:45:58.184 UT           1           0  => UNSTABLE
;    1998-09-24/23:45:59.379 UT           1           0  => UNSTABLE
;    1998-09-24/23:48:33.020 UT           0           0  => STABLE
;    1998-09-24/23:48:36.020 UT           0           0  => STABLE
;    1998-09-24/23:48:36.131 UT           0           0  => STABLE
;    1998-09-24/23:48:39.020 UT           0           0  => STABLE
;    1998-09-24/23:48:39.131 UT           0           0  => STABLE
;    1998-09-24/23:48:42.020 UT           0           0  => STABLE
;    1998-09-24/23:48:42.131 UT           0           0  => STABLE
;    1998-09-24/23:48:45.020 UT           0           0  => STABLE
;    1998-09-24/23:48:45.131 UT           0           0  => STABLE
;    1998-09-24/23:48:45.622 UT           0           0  => STABLE
;    1998-09-24/23:48:48.131 UT           0           0  => STABLE
;    1998-09-24/23:48:48.622 UT           0           0  => STABLE
;    1998-09-24/23:48:51.622 UT           0           0  => STABLE
;    1998-09-24/23:48:54.622 UT           0           0  => STABLE
;    1998-09-24/23:48:57.622 UT           0           0  => STABLE
;    1998-09-25/00:03:58.545 UT           1           0  => UNSTABLE
;    1998-09-25/00:04:01.545 UT           1           0  => UNSTABLE
;    1998-09-25/00:04:04.545 UT           1           0  => UNSTABLE
;    1998-09-25/00:04:07.545 UT           1           0  => UNSTABLE
;    1998-09-25/00:04:10.545 UT           1           0  => UNSTABLE
;    1998-09-25/00:05:17.432 UT           1           0  => UNSTABLE
;    1998-09-25/00:05:20.432 UT           1           0  => UNSTABLE
;    1998-09-25/00:05:23.432 UT           1           0  => UNSTABLE
;    1998-09-25/00:05:26.432 UT           1           0  => UNSTABLE
;    1998-09-25/00:05:29.432 UT           1           0  => UNSTABLE
;    1998-09-25/00:14:44.603 UT           1           0  => UNSTABLE
;    1998-09-25/00:14:47.603 UT           1           0  => UNSTABLE
;    1998-09-25/00:14:50.603 UT           1           0  => UNSTABLE
;    1998-09-25/00:14:53.603 UT           1           0  => UNSTABLE
;    1998-09-25/00:14:56.603 UT           1           0  => UNSTABLE
;    1998-09-25/00:28:36.305 UT           0           0  => STABLE
;    1998-09-25/00:28:39.305 UT           0           0  => STABLE
;    1998-09-25/00:28:42.305 UT           0           0  => STABLE
;    1998-09-25/00:28:45.305 UT           0           0  => STABLE
;    1998-09-25/00:28:48.305 UT           0           0  => STABLE
;-----------------------------------------------------------------------------------------
;      Date        Time                 Test 5      Test 6
;=========================================================================================
;    2000-02-11/23:33:50.491 UT           0           0  => STABLE
;    2000-02-11/23:33:52.351 UT           0           0  => STABLE
;    2000-02-11/23:33:53.491 UT           0           0  => STABLE
;    2000-02-11/23:33:54.731 UT           0           0  => STABLE
;    2000-02-11/23:33:55.351 UT           0           0  => STABLE
;    2000-02-11/23:33:56.491 UT           0           0  => STABLE
;    2000-02-11/23:33:57.731 UT           0           0  => STABLE
;    2000-02-11/23:33:58.351 UT           1           0  => UNSTABLE
;    2000-02-11/23:33:59.491 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:00.731 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:01.351 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:02.491 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:03.731 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:04.351 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:06.731 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:21.503 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:23.065 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:24.503 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:26.065 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:27.503 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:29.065 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:30.503 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:32.065 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:33.503 UT           1           0  => UNSTABLE
;    2000-02-11/23:34:35.065 UT           1           0  => UNSTABLE
;    2000-02-12/00:14:15.709 UT           0           0  => STABLE
;    2000-02-12/00:14:18.709 UT           0           0  => STABLE
;    2000-02-12/00:14:21.709 UT           0           0  => STABLE
;    2000-02-12/00:14:24.709 UT           0           0  => STABLE
;    2000-02-12/00:14:27.709 UT           0           0  => STABLE
;    2000-02-12/00:26:11.217 UT           0           0  => STABLE
;    2000-02-12/00:26:14.217 UT           0           0  => STABLE
;    2000-02-12/00:26:17.217 UT           0           0  => STABLE
;    2000-02-12/00:26:20.217 UT           0           0  => STABLE
;    2000-02-12/00:26:23.217 UT           0           0  => STABLE
;    2000-02-12/00:27:13.142 UT           0           0  => STABLE
;    2000-02-12/00:27:16.142 UT           0           0  => STABLE
;    2000-02-12/00:27:19.142 UT           0           0  => STABLE
;    2000-02-12/00:27:22.142 UT           0           0  => STABLE
;    2000-02-12/00:27:25.142 UT           0           0  => STABLE
;-----------------------------------------------------------------------------------------






;-----------------------------------------------------------------------------------------
; => Look at threshold conditions for Gary et. al. [1994,1999]
;-----------------------------------------------------------------------------------------
f          = !VALUES.F_NAN
d          = !VALUES.D_NAN
scet       = ['1997/12/10 04:33:15.605',$
              '1998/08/26 06:40:26.120','1998/08/26 06:40:54.941',$
              '1998/08/26 06:41:10.001','1998/08/26 06:41:37.623',$
              '1998/08/26 06:41:44.013','1998/08/26 06:41:53.249',$
              '1998/08/26 06:41:56.315','1998/08/26 06:41:57.909',$
              '1998/08/26 06:41:59.233','1998/08/26 06:42:05.763',$
              '1998/08/26 06:42:09.131','1998/09/24 23:20:38.842',$
              '1998/09/24 23:22:26.632','1998/09/24 23:22:48.150',$
              '1998/09/24 23:30:00.465','1998/09/24 23:30:48.542',$
              '1998/09/24 23:43:18.951','1998/09/24 23:45:52.184',$
              '1998/09/24 23:45:53.379','1998/09/24 23:48:39.020',$
              '1998/09/24 23:48:42.131','1998/09/24 23:48:51.622',$
              '1998/09/25 00:04:04.545','1998/09/25 00:05:23.432',$
              '1998/09/25 00:14:50.603','1998/09/25 00:28:42.305',$
              '2000/02/11 23:33:56.491','2000/02/11 23:33:58.351',$
              '2000/02/11 23:34:00.731','2000/02/11 23:34:27.503',$
              '2000/02/11 23:34:29.065','2000/02/12 00:14:21.709',$
              '2000/02/12 00:26:17.217','2000/02/12 00:27:19.142' ]+' UT'


tds_teape  = [18.646,53.677,59.559,56.915,64.624,63.979,64.423,64.110,63.567,62.537,59.118,55.588, $
              22.126,51.235,50.958,49.685,50.113,41.255,41.089,41.044,44.409,44.636,        $
              45.328,57.325,57.002,56.967,     f,58.283,54.055,50.949,47.573,47.557,25.664, $
              26.803,28.784]
tds_tecpe  = [16.728,43.227,50.713,47.449,53.846,53.601,54.101,54.321,54.071,53.201,50.491,47.184, $
              18.650,39.874,39.716,39.669,39.922,35.140,34.887,34.860,36.401,36.521,36.888, $
              44.683,44.266,43.590,     f,35.257,33.700,33.413,37.032,37.038,23.571,24.150, $
              25.894]
tds_tehpe  = [113.518,298.253,311.799,315.482,313.515,311.823,309.819,307.444,306.429,306.106,304.914, $
              299.216, 95.875,205.461,205.120,195.479,197.093,167.579,165.597,165.577,163.829, $
              163.813,163.763,173.665,174.005,181.512,      f,253.926,258.140,256.529,248.430, $
              248.903,183.453,175.870,175.486]

tds_teapa  = [19.055,48.557,55.051,58.544,59.395,60.785,60.932,61.339,61.525,61.838,63.350,63.704, $
              30.005,48.881,48.730,51.096,50.646,51.472,53.995,53.880,58.283,58.714,60.029, $
              59.389,59.465,53.841,     f,62.698,56.829,50.913,36.804,36.404,27.942,32.207, $
              35.485]
tds_tecpa  = [16.316,38.562,48.575,51.181,51.652,53.375,53.529,54.432,54.851,55.289,56.804,56.523, $
              22.318,42.747,42.561,44.668,44.234,45.075,47.296,47.189,48.110,48.395,49.264, $
              47.125,47.220,42.264,     f,37.846,36.719,34.440,29.902,29.537,24.837,27.893, $
              31.092]
tds_tehpa  = [137.176,278.001,240.556,263.808,240.255,240.234,238.922,235.363,234.747,235.454, $
              250.231,273.927,108.888,117.178,118.940,135.852,135.459,170.277,163.465, $
              163.059,200.700,203.014,210.073,170.862,171.751,158.818,      f,273.023, $
              252.325,232.196,151.058,153.010,217.855,231.439,225.931]

beta_cpar  = [0.711,0.736,0.809,0.841,1.003,0.894,0.772,0.774,0.747,0.723,0.778,0.938,0.148,0.205, $
              0.205,0.260,0.259,0.361,0.290,0.283,0.362,0.346,0.388,0.740,0.851,0.434,    f, $
              0.823,0.865,0.957,0.398,0.390,0.749,1.013,1.031]


tanih      = tds_tehpe/tds_tehpa
tanic      = tds_tecpe/tds_tecpa
tparhc     = tds_tehpa/tds_tecpa

gary_test_0 = (beta_cpar GT 6d-1 AND tanih GT 75d-2) OR  (beta_cpar GT 6d-1 AND tparhc GT 75d-1)
gary_test_1 = (beta_cpar GT 6d-1 AND tanih GT 75d-2) AND (beta_cpar GT 6d-1 AND tparhc GT 75d-1)
gary_test_2 = (beta_cpar GT 6d-1 AND tanih GT 75d-2)
gary_test_3 = (tparhc GT 75d-1)
gary_test_4 = (tanih GT 75d-2)

mform      = '(";",a30,5I12.1)'
FOR j=0L, N_ELEMENTS(scet) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,scet[j],gary_test_0[j],gary_test_1[j],gary_test_2[j],$
                     gary_test_3[j],gary_test_4[j]
;----------------------------------------------------------------------------------------------
;      Date        Time                 Test 0      Test 1      Test 2      Test 3      Test 4
;==============================================================================================
;    1997/12/10 04:33:15.605 UT           1           1           1           1           1
;    1998/08/26 06:40:26.120 UT           1           0           1           0           1
;    1998/08/26 06:40:54.941 UT           1           0           1           0           1
;    1998/08/26 06:41:10.001 UT           1           0           1           0           1
;    1998/08/26 06:41:37.623 UT           1           0           1           0           1
;    1998/08/26 06:41:44.013 UT           1           0           1           0           1
;    1998/08/26 06:41:53.249 UT           1           0           1           0           1
;    1998/08/26 06:41:56.315 UT           1           0           1           0           1
;    1998/08/26 06:41:57.909 UT           1           0           1           0           1
;    1998/08/26 06:41:59.233 UT           1           0           1           0           1
;    1998/08/26 06:42:05.763 UT           1           0           1           0           1
;    1998/08/26 06:42:09.131 UT           1           0           1           0           1
;    1998/09/24 23:20:38.842 UT           0           0           0           0           1
;    1998/09/24 23:22:26.632 UT           0           0           0           0           1
;    1998/09/24 23:22:48.150 UT           0           0           0           0           1
;    1998/09/24 23:30:00.465 UT           0           0           0           0           1
;    1998/09/24 23:30:48.542 UT           0           0           0           0           1
;    1998/09/24 23:43:18.951 UT           0           0           0           0           1
;    1998/09/24 23:45:52.184 UT           0           0           0           0           1
;    1998/09/24 23:45:53.379 UT           0           0           0           0           1
;    1998/09/24 23:48:39.020 UT           0           0           0           0           1
;    1998/09/24 23:48:42.131 UT           0           0           0           0           1
;    1998/09/24 23:48:51.622 UT           0           0           0           0           1
;    1998/09/25 00:04:04.545 UT           1           0           1           0           1
;    1998/09/25 00:05:23.432 UT           1           0           1           0           1
;    1998/09/25 00:14:50.603 UT           0           0           0           0           1
;    1998/09/25 00:28:42.305 UT           0           0           0           0           0
;    2000/02/11 23:33:56.491 UT           1           0           1           0           1
;    2000/02/11 23:33:58.351 UT           1           0           1           0           1
;    2000/02/11 23:34:00.731 UT           1           0           1           0           1
;    2000/02/11 23:34:27.503 UT           0           0           0           0           1
;    2000/02/11 23:34:29.065 UT           0           0           0           0           1
;    2000/02/12 00:14:21.709 UT           1           1           1           1           1
;    2000/02/12 00:26:17.217 UT           1           1           1           1           1
;    2000/02/12 00:27:19.142 UT           1           0           1           0           1
;----------------------------------------------------------------------------------------------


mform      = '(";",a30,3f15.3)'
FOR j=0L, N_ELEMENTS(scet) - 1L DO BEGIN  $
  PRINT,FORMAT=mform,scet[j],beta_cpar[j],tanih[j],tparhc[j]

;----------------------------------------------------------------------------------------------
;      Date        Time                Betaparc        Teh_ani      Th/Tc [para]
;==============================================================================================
;    1997/12/10 04:33:15.605 UT          0.711          0.828          8.407
;    1998/08/26 06:40:26.120 UT          0.736          1.073          7.209
;    1998/08/26 06:40:54.941 UT          0.809          1.296          4.952
;    1998/08/26 06:41:10.001 UT          0.841          1.196          5.154
;    1998/08/26 06:41:37.623 UT          1.003          1.305          4.651
;    1998/08/26 06:41:44.013 UT          0.894          1.298          4.501
;    1998/08/26 06:41:53.249 UT          0.772          1.297          4.463
;    1998/08/26 06:41:56.315 UT          0.774          1.306          4.324
;    1998/08/26 06:41:57.909 UT          0.747          1.305          4.280
;    1998/08/26 06:41:59.233 UT          0.723          1.300          4.259
;    1998/08/26 06:42:05.763 UT          0.778          1.219          4.405
;    1998/08/26 06:42:09.131 UT          0.938          1.092          4.846
;    1998/09/24 23:20:38.842 UT          0.148          0.880          4.879
;    1998/09/24 23:22:26.632 UT          0.205          1.753          2.741
;    1998/09/24 23:22:48.150 UT          0.205          1.725          2.795
;    1998/09/24 23:30:00.465 UT          0.260          1.439          3.041
;    1998/09/24 23:30:48.542 UT          0.259          1.455          3.062
;    1998/09/24 23:43:18.951 UT          0.361          0.984          3.778
;    1998/09/24 23:45:52.184 UT          0.290          1.013          3.456
;    1998/09/24 23:45:53.379 UT          0.283          1.015          3.455
;    1998/09/24 23:48:39.020 UT          0.362          0.816          4.172
;    1998/09/24 23:48:42.131 UT          0.346          0.807          4.195
;    1998/09/24 23:48:51.622 UT          0.388          0.780          4.264
;    1998/09/25 00:04:04.545 UT          0.740          1.016          3.626
;    1998/09/25 00:05:23.432 UT          0.851          1.013          3.637
;    1998/09/25 00:14:50.603 UT          0.434          1.143          3.758
;    1998/09/25 00:28:42.305 UT            NaN            NaN            NaN
;    2000/02/11 23:33:56.491 UT          0.823          0.930          7.214
;    2000/02/11 23:33:58.351 UT          0.865          1.023          6.872
;    2000/02/11 23:34:00.731 UT          0.957          1.105          6.742
;    2000/02/11 23:34:27.503 UT          0.398          1.645          5.052
;    2000/02/11 23:34:29.065 UT          0.390          1.627          5.180
;    2000/02/12 00:14:21.709 UT          0.749          0.842          8.771
;    2000/02/12 00:26:17.217 UT          1.013          0.760          8.297
;    2000/02/12 00:27:19.142 UT          1.031          0.777          7.267
;----------------------------------------------------------------------------------------------

; => whistler heat flux instability  = WHFI
; => whistler anisotropy instability = WAI

; => Gary et al., [1999] found the whistler heat flux instability (WHFI) to ALWAYS be 
;      unstable if Thperp/Thpara > 1.01 and ALWAYS stable for beta_para,c < 0.25.  
;      Also, Gary et al., [1994] suggested that even when Thpara/Tcpara is small but 
;      Thperp/Thpara > 1.01, the WAI can still be unstable even in the absence of a
;      relative drift between halo and core.

gary_test_5 = (tanih GT 1.01)
gary_test_6 = (beta_cpar LE 0.25)

stab_str    = '  => STABLE'
unst_str    = '  => UNSTABLE'

mform0     = '(";",a30,2I12.1,a11)'
mform1     = '(";",a30,2I12.1,a13)'
FOR j=0L, N_ELEMENTS(scet) - 1L DO BEGIN  $
  IF (gary_test_5[j]) THEN extra = unst_str & $
  IF (gary_test_6[j]) THEN extra = stab_str & $
  IF (NOT gary_test_5[j] AND NOT gary_test_6[j]) THEN extra = stab_str & $
  IF (gary_test_5[j]) THEN mform = mform1 & $
  IF (gary_test_6[j]) THEN mform = mform0 & $
  IF (NOT gary_test_5[j] AND NOT gary_test_6[j]) THEN mform = mform0 & $
  PRINT,FORMAT=mform,scet[j],gary_test_5[j],gary_test_6[j],extra[0]
;-----------------------------------------------------------------------------------------
;      Date        Time                 Test 5      Test 6
;=========================================================================================
;    1997/12/10 04:33:15.605 UT           0           0  => STABLE
;    1998/08/26 06:40:26.120 UT           1           0  => UNSTABLE
;    1998/08/26 06:40:54.941 UT           1           0  => UNSTABLE
;    1998/08/26 06:41:10.001 UT           1           0  => UNSTABLE
;    1998/08/26 06:41:37.623 UT           1           0  => UNSTABLE
;    1998/08/26 06:41:44.013 UT           1           0  => UNSTABLE
;    1998/08/26 06:41:53.249 UT           1           0  => UNSTABLE
;    1998/08/26 06:41:56.315 UT           1           0  => UNSTABLE
;    1998/08/26 06:41:57.909 UT           1           0  => UNSTABLE
;    1998/08/26 06:41:59.233 UT           1           0  => UNSTABLE
;    1998/08/26 06:42:05.763 UT           1           0  => UNSTABLE
;    1998/08/26 06:42:09.131 UT           1           0  => UNSTABLE
;    1998/09/24 23:20:38.842 UT           0           1  => STABLE
;    1998/09/24 23:22:26.632 UT           1           1  => STABLE
;    1998/09/24 23:22:48.150 UT           1           1  => STABLE
;    1998/09/24 23:30:00.465 UT           1           0  => UNSTABLE
;    1998/09/24 23:30:48.542 UT           1           0  => UNSTABLE
;    1998/09/24 23:43:18.951 UT           0           0  => STABLE
;    1998/09/24 23:45:52.184 UT           1           0  => UNSTABLE
;    1998/09/24 23:45:53.379 UT           1           0  => UNSTABLE
;    1998/09/24 23:48:39.020 UT           0           0  => STABLE
;    1998/09/24 23:48:42.131 UT           0           0  => STABLE
;    1998/09/24 23:48:51.622 UT           0           0  => STABLE
;    1998/09/25 00:04:04.545 UT           1           0  => UNSTABLE
;    1998/09/25 00:05:23.432 UT           1           0  => UNSTABLE
;    1998/09/25 00:14:50.603 UT           1           0  => UNSTABLE
;    1998/09/25 00:28:42.305 UT           0           0  => STABLE
;    2000/02/11 23:33:56.491 UT           0           0  => STABLE
;    2000/02/11 23:33:58.351 UT           1           0  => UNSTABLE
;    2000/02/11 23:34:00.731 UT           1           0  => UNSTABLE
;    2000/02/11 23:34:27.503 UT           1           0  => UNSTABLE
;    2000/02/11 23:34:29.065 UT           1           0  => UNSTABLE
;    2000/02/12 00:14:21.709 UT           0           0  => STABLE
;    2000/02/12 00:26:17.217 UT           0           0  => STABLE
;    2000/02/12 00:27:19.142 UT           0           0  => STABLE

;-----------------------------------------------------------------------------------------
; => Calculate cold plasma parameters for waves
;-----------------------------------------------------------------------------------------

scet       = ['1998/08/26 06:40:26.120','1998/08/26 06:40:54.941',$
              '1998/08/26 06:41:10.001','1998/08/26 06:41:37.623',$
              '1998/08/26 06:41:44.013','1998/08/26 06:41:53.249',$
              '1998/08/26 06:41:56.315','1998/08/26 06:41:57.909',$
              '1998/08/26 06:41:59.233','1998/08/26 06:42:05.763',$
              '1998/08/26 06:42:09.131','1998/09/24 23:20:38.842',$
              '1998/09/24 23:22:26.632','1998/09/24 23:22:48.150',$
              '1998/09/24 23:30:00.465','1998/09/24 23:30:48.542',$
              '1998/09/24 23:43:18.951','1998/09/24 23:45:52.184',$
              '1998/09/24 23:45:53.379','1998/09/24 23:48:39.020',$
              '1998/09/24 23:48:42.131','1998/09/24 23:48:51.622',$
              '1998/09/25 00:04:04.545','1998/09/25 00:05:23.432',$
              '1998/09/25 00:14:50.603','1998/09/25 00:28:42.305',$
              '2000/02/11 23:33:56.491','2000/02/11 23:33:58.351',$
              '2000/02/11 23:34:00.731','2000/02/11 23:34:27.503',$
              '2000/02/11 23:34:29.065','2000/02/12 00:14:21.709',$
              '2000/02/12 00:26:17.217','2000/02/12 00:27:19.142' ]+' UT'

tds_idens = [14.147,22.911,21.810,20.740,19.820,18.489,18.048,17.818,17.628,16.687,16.734,16.586,$
             21.087,21.499,24.340,24.016,24.699,20.004,19.946,24.534,24.764,25.467,22.313,21.804,$
             14.165,15.225,14.821,15.463,16.053,16.849,16.895,24.601,20.398,19.291]

tds_bmag  = [17.279,23.537,23.125,20.737,21.830,22.725,22.606,22.951,23.296,22.146,20.148,31.787,$
             42.112,42.351,41.021,40.631,35.242,36.222,36.608,36.225,37.328,36.095,23.914,22.070,$
             23.574, 0.000,16.570,16.262,15.252,22.576,22.704,18.124,15.040,15.308]










;-----------------------------------------------------------------------------------------
; => For 1998-08-26
;-----------------------------------------------------------------------------------------
f      = !VALUES.F_NAN
d      = !VALUES.D_NAN
tags      = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13',$
             't14','t15','t16','t17','t18','t19','t20','t21','t22','t23','t24']
theta_kb0826_04_20   = [54.37]
theta_kb0826_07_30   = [81.18,69.13,60.84,54.07,89.27,84.18,69.31,76.27]
theta_kb0826_10_30   = [73.85,73.73,77.32,76.59,77.00,76.29,76.03]
theta_kb0826_40_400  = [77.59,79.09,77.29,79.60,15.20,15.22,15.53,14.38,23.61,39.52]
theta_kb0826_60_500  = [f]
theta_kb0826_60_150  = [16.19]
theta_kb0826_60_200  = [84.31,58.76,51.12,17.70,21.64]
theta_kb0826_150_200 = [10.12, 9.70, 9.22,17.81]
thkbstr_00 = CREATE_STRUCT(tags[0L:0L],theta_kb0826_04_20)
thkbstr_01 = CREATE_STRUCT(tags[0L:0L],theta_kb0826_07_30)
thkbstr_02 = CREATE_STRUCT(tags[0L:0L],theta_kb0826_10_30)
thkbstr_03 = CREATE_STRUCT(tags[0L:0L],theta_kb0826_40_400)
thkbstr_04 = CREATE_STRUCT(tags[0L:0L],theta_kb0826_60_500)
thkbstr_05 = CREATE_STRUCT(tags[0L:0L],theta_kb0826_60_150)
thkbstr_06 = CREATE_STRUCT(tags[0L:0L],theta_kb0826_60_200)
thkbstr_07 = CREATE_STRUCT(tags[0L:0L],theta_kb0826_150_200)
thkbstr_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4','T5','T6','T7'],thkbstr_00,$
                           thkbstr_01,thkbstr_02,thkbstr_03,thkbstr_04,thkbstr_05, $
                           thkbstr_06,thkbstr_07)
theta_kb0826_03_30    = [68.32,75.92]
thkbstr_1             = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_03_30))
theta_kb0826_03_30_2  = [68.32,75.92]
thkbstr_2             = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_03_30_2))
theta_kb0826_30_130   = [ 2.86, 8.96,11.88, 9.36]
thkbstr_3             = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_30_130))
theta_kb0826_30_130_2 = [ 9.68, 7.59,10.34, 8.98, 4.49,10.35, 9.51, 3.77, 4.14, 3.18]
thkbstr_4             = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_30_130_2))
theta_kb0826_30_150   = [ 3.76, 1.02, 3.46, 8.50,10.07, 7.45, 9.01,19.23,11.22, 9.02]
thkbstr_5             = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_30_150))
theta_kb0826_30_150_2 = [ 6.21, 5.72, 6.98, 5.10, 4.45, 7.10,11.25, 9.40, 9.06, 9.76,$
                         45.97, 8.11, 5.06, 5.13]
thkbstr_6             = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_30_150_2))
theta_kb0826_30_150_3 = [ 4.49, 4.55, 5.20, 9.77, 7.77, 5.99, 8.30, 6.17]
thkbstr_7             = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_30_150_3))
theta_kb0826_35_150   = [ 0.54, 6.17, 6.95, 9.27, 7.58, 3.55, 5.31, 5.03, 5.69,17.59,$
                         6.41]
thkbstr_8             = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_35_150))
theta_kb0826_40_200   = [ 1.96, 2.18, 5.35, 0.39, 4.91, 5.58, 3.79, 5.63,10.93, 8.79,$
                         12.11]
thkbstr_9             = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_40_200))
theta_kb0826_50_200   = [ 7.20, 8.52, 4.79,10.99,19.43,17.82]
thkbstr_10            = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0826_50_200))

thkbstr               = CREATE_STRUCT(tags[0L:10L],thkbstr_0,thkbstr_1,thkbstr_2,thkbstr_3,$
                                      thkbstr_4,thkbstr_5,thkbstr_6,thkbstr_7,thkbstr_8,   $
                                      thkbstr_9,thkbstr_10)

dens_0826  = [14.147,22.911,21.810,20.740,19.820,18.489,18.048,17.818,17.628,16.687,16.734]
bmag_0826  = [17.279,23.537,23.125,20.737,21.830,22.725,22.606,22.951,23.296,22.146,20.148]
lfc1  = [4d0,7d0,1d1,4d1,6d1,6d1,6d1,15d1]   ; => For 1998-08-26/06:40:26.120 UT
hfc1  = [2d1,3d1,3d1,4d2,5d2,2d2,15d1,20d1]  ; => For 1998-08-26/06:40:26.120 UT
lfc2  = [3d0]                                ; => For 1998-08-26/06:40:54.941 UT
hfc2  = [3d1]                                ; => For 1998-08-26/06:40:54.941 UT
lfc3  = [3d0]                                ; => For 1998-08-26/06:41:10.001 UT
hfc3  = [3d1]                                ; => For 1998-08-26/06:41:10.001 UT
lfc4  = [3d1]                                ; => For 1998-08-26/06:41:37.623 UT
hfc4  = [13d1]                               ; => For 1998-08-26/06:41:37.623 UT
lfc5  = [3d1]                                ; => For 1998-08-26/06:41:44.013 UT
hfc5  = [13d1]                               ; => For 1998-08-26/06:41:44.013 UT
lfc6  = [3.5d1]                              ; => For 1998-08-26/06:41:53.249 UT
hfc6  = [15d1]                               ; => For 1998-08-26/06:41:53.249 UT
lfc7  = [3d1]                                ; => For 1998-08-26/06:41:56.315 UT
hfc7  = [15d1]                               ; => For 1998-08-26/06:41:56.315 UT
lfc8  = [3d1]                                ; => For 1998-08-26/06:41:57.909 UT
hfc8  = [15d1]                               ; => For 1998-08-26/06:41:57.909 UT
lfc9  = [3d1]                                ; => For 1998-08-26/06:41:59.233 UT
hfc9  = [15d1]                               ; => For 1998-08-26/06:41:59.233 UT
lfc10 = [4d1]                                ; => For 1998-08-26/06:42:05.763 UT
hfc10 = [20d1]                               ; => For 1998-08-26/06:42:05.763 UT
lfc11 = [5d1]                                ; => For 1998-08-26/06:42:09.131 UT
hfc11 = [20d1]                               ; => For 1998-08-26/06:42:09.131 UT
tags  = ['t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11']
lf_str_0826 = CREATE_STRUCT(tags,lfc1,lfc2,lfc3,lfc4,lfc5,lfc6,lfc7,lfc8,lfc9,lfc10,lfc11)
hf_str_0826 = CREATE_STRUCT(tags,hfc1,hfc2,hfc3,hfc4,hfc5,hfc6,hfc7,hfc8,hfc9,hfc10,hfc11)
n_tds_0826  = N_TAGS(lf_str_0826)

ndat        = 1000L
bo          = bmag_0826
no          = dens_0826
n_uq        = n_tds_0826 - 1L
lf_str      = lf_str_0826
hf_str      = hf_str_0826
jj          = 0L
FOR j=0L, n_uq DO BEGIN                                                               $
  jstr    = 'T'+STRTRIM(j,2)                                                        & $
  lfc0    = lf_str.(j)                                                              & $
  hfc0    = hf_str.(j)                                                              & $
  n_fr    = N_ELEMENTS(lfc0) - 1L                                                   & $
  FOR k=0L, n_fr DO BEGIN                                                             $
    kstr      = 'T'+STRTRIM(k,2)                                                    & $
    flow      = lfc0[k]                                                             & $
    fhigh     = hfc0[k]                                                             & $
    test_low  = cold_plasma_params(bo[j],no[j],FREQF=flow,NDAT=ndat)                & $
    test_high = cold_plasma_params(bo[j],no[j],FREQF=fhigh,NDAT=ndat)               & $
    str_element,flow_cold0 ,kstr,test_low ,/ADD_REPLACE                             & $
    str_element,fhigh_cold0,kstr,test_high,/ADD_REPLACE                             & $
  ENDFOR                                                                            & $
  str_element,flow_cold,jstr,flow_cold0,/ADD_REPLACE                                & $
  str_element,fhigh_cold,jstr,fhigh_cold0,/ADD_REPLACE                              & $
  flow_cold0  = 0                                                                   & $
  fhigh_cold0 = 0                                                                   & $
ENDFOR                                                                              & $
jj += 1L

flow_cold_0826  = flow_cold
fhigh_cold_0826 = fhigh_cold

DELVAR,flow_cold,fhigh_cold,flow_cold0,fhigh_cold0,test_low,test_high

c           = 2.99792458d8      ; => Speed of light in vacuum (m/s)
f           = !VALUES.F_NAN
d           = !VALUES.D_NAN
nsquaredl   = 0.                ; => Index of refraction squared for f_low
nsquaredh   = 0.                ; => Index of refraction squared for f_high
vphasel     = 0.                ; => phase speed (m/s) for f_low
vphaseh     = 0.                ; => phase speed (m/s) for f_high
knumberl    = 0.                ; => wave number (m^-1) for f_low
knumberh    = 0.                ; => wave number (m^-1) for f_high
resconel    = 0.                ; => resonance cone angle (deg) for f_low
resconeh    = 0.                ; => resonance cone angle (deg) for f_high
polarlb     = 0.                ; => polarization with respect to Bo for f_low
polarhb     = 0.                ; => polarization with respect to Bo for f_high
thetasl     = 0.                ; => possible propagation angles (deg) for f_low
thetash     = 0.                ; => possible propagation angles (deg) for f_high
dummy       = REPLICATE(d,ndat)
tags        = ['Nsquared','Vphase','Theta_res','Wave_Number','Polarization','Freq_Range','Thetas']

jj          = 0L
lf_str      = lf_str_0826
hf_str      = hf_str_0826
FOR j=0L, n_uq DO BEGIN                                                               $
  jstr    = 'T'+STRTRIM(j,2)                                                        & $
  test0   = flow_cold_0826.(j)                                                      & $
  test1   = fhigh_cold_0826.(j)                                                     & $
  lfc0    = lf_str.(j)                                                              & $
  hfc0    = hf_str.(j)                                                              & $
  n_fr    = N_TAGS(test0) - 1L                                                      & $
  FOR k=0L, n_fr DO BEGIN                                                             $
    kstr      = 'T'+STRTRIM(k,2)                                                    & $
    flow      = lfc0[k]*(2d0*!DPI)                                                  & $
    fhigh     = hfc0[k]*(2d0*!DPI)                                                  & $
    nsquaredl = test0.(k).INDEX_REF_1                                               & $
    nsquaredh = test1.(k).INDEX_REF_1                                               & $
    vphasel   = SQRT(c^2/nsquaredl)                                                 & $
    vphaseh   = SQRT(c^2/nsquaredh)                                                 & $
    knumberl  = SQRT(nsquaredl*flow[0]^2/c^2)                                       & $
    knumberh  = SQRT(nsquaredh*fhigh[0]^2/c^2)                                      & $
    resconel  = test0.(k).CONE_ANG[0]                                               & $
    resconeh  = test1.(k).CONE_ANG[0]                                               & $
    polarlb   = (nsquaredl - test0.(k).S_TERM[0])/test0.(k).D_TERM[0]               & $
    polarhb   = (nsquaredh - test1.(k).S_TERM[0])/test1.(k).D_TERM[0]               & $
    thetasl   = dummy                                                               & $
    thetash   = dummy                                                               & $
    goodl     = WHERE(nsquaredl GE 0.,gdl,COMPLEMENT=badl,NCOMPLEMENT=bdl)          & $
    goodh     = WHERE(nsquaredh GE 0.,gdh,COMPLEMENT=badh,NCOMPLEMENT=bdh)          & $
    IF (gdl GT 0) THEN thetasl[goodl] = test0.(k).ANGLES[goodl]                     & $
    IF (gdh GT 0) THEN thetash[goodh] = test1.(k).ANGLES[goodh]                     & $
    IF (bdl GT 0) THEN vphasel[badl] = d                                            & $
    IF (bdh GT 0) THEN vphaseh[badh] = d                                            & $
    IF (bdl GT 0) THEN knumberl[badl] = d                                           & $
    IF (bdh GT 0) THEN knumberh[badh] = d                                           & $
    IF (bdl GT 0) THEN polarlb[badl] = d                                            & $
    IF (bdh GT 0) THEN polarhb[badh] = d                                            & $
    dumbl     = CREATE_STRUCT(tags,nsquaredl,vphasel,resconel,knumberl,polarlb,[flow,fhigh],thetasl)  & $
    dumbh     = CREATE_STRUCT(tags,nsquaredh,vphaseh,resconeh,knumberh,polarhb,[flow,fhigh],thetash)  & $
    str_element,dumbl0,kstr,dumbl,/ADD_REPLACE                                      & $
    str_element,dumbh0,kstr,dumbh,/ADD_REPLACE                                      & $
  ENDFOR                                                                            & $
  str_element,stats_low,jstr,dumbl0,/ADD_REPLACE                                    & $
  str_element,stats_high,jstr,dumbh0,/ADD_REPLACE                                   & $
  dumbl0 = 0                                                                        & $
  dumbh0 = 0                                                                        & $
ENDFOR                                                                              & $
jj += 1L

stats_low_0826  = stats_low
stats_high_0826 = stats_high
DELVAR,dumbl0,dumbh0,dumbl,dumbh,stats_low,stats_high

thbn_0826  = [82.2,78.7]
dthbn_0826 = [ 3.0, 2.5]
scet_0826  = ['1998/08/26 06:40:26.120','1998/08/26 06:40:54.941',$
              '1998/08/26 06:41:10.001','1998/08/26 06:41:37.623',$
              '1998/08/26 06:41:44.013','1998/08/26 06:41:53.249',$
              '1998/08/26 06:41:56.315','1998/08/26 06:41:57.909',$
              '1998/08/26 06:41:59.233','1998/08/26 06:42:05.763',$
              '1998/08/26 06:42:09.131'                           ]+' UT'

mform      = '(";",a30,f10.1,f14.1,a1,f4.1,f14.3,a2,f9.3,f15.3,a2,f9.3,f12.3,2a10)'
sform      = '(f12.3,"-",f12.3)'
kform      = '(f12.4,"-",f12.4)'
fform      = '(f12.3)'
pol_rl     = ['LH','RH']
FOR j=0L, n_uq DO BEGIN                                                               $
  jstr    = 'T'+STRTRIM(j,2)                                                        & $
  scet0   = scet_0826[j]                                                            & $
  test0   = stats_low_0826.(j)                                                      & $
  test1   = stats_high_0826.(j)                                                     & $
  n_fr    = N_TAGS(test0) - 1L                                                      & $
  FOR k=0L, n_fr DO BEGIN                                                             $
    vphasel   = test0.(k).VPHASE*1d-3                                               & $
    vphaseh   = test1.(k).VPHASE*1d-3                                               & $
    knumberl  = test0.(k).WAVE_NUMBER*1d3                                           & $
    knumberh  = test1.(k).WAVE_NUMBER*1d3                                           & $
    lambda_l  = ((2d0*!DPI)/knumberl)[SORT((2d0*!DPI)/knumberl)]                    & $
    lambda_h  = ((2d0*!DPI)/knumberh)[SORT((2d0*!DPI)/knumberh)]                    & $
    polarz_l  = minmax(test0.(k).POLARIZATION)                                      & $
    polarz_h  = minmax(test1.(k).POLARIZATION)                                      & $
    polarizel = pol_rl[polarz_l GT 0]                                               & $
    polarizeh = pol_rl[polarz_h GT 0]                                               & $
    mnthkb    = MIN(thkbstr.(j).(k).(0),/NAN)                                       & $
    mxthkb    = MAX(thkbstr.(j).(k).(0),/NAN)                                       & $
    deltaf    = test1.(k).FREQ_RANGE/(2d0*!DPI)                                     & $
    thetal    = test0.(k).THETAS                                                    & $
    thetah    = test1.(k).THETAS                                                    & $
    IF (FINITE(mnthkb) EQ 0) THEN mnthkb = f                                        & $
    IF (FINITE(mxthkb) EQ 0) THEN mxthkb = f                                        & $
    IF (mnthkb EQ mxthkb) THEN mxthkb = test0.(k).THETA_RES[0]                      & $
    goodl     = WHERE(thetal LE mxthkb[0] AND thetal GE mnthkb[0],gdl)              & $
    goodh     = WHERE(thetah LE mxthkb[0] AND thetah GE mnthkb[0],gdh)              & $
    IF (gdl GT 0) THEN deltathl = minmax(thetal[goodl])   ELSE deltathl = [f,f]     & $
    IF (gdh GT 0) THEN deltathh = minmax(thetah[goodh])   ELSE deltathh = [f,f]     & $
    IF (gdl GT 0) THEN vphasel  = minmax(vphasel[goodl])  ELSE vphasel  = [f,f]     & $
    IF (gdh GT 0) THEN vphaseh  = minmax(vphaseh[goodh])  ELSE vphaseh  = [f,f]     & $
    IF (gdl GT 0) THEN lambda_l = minmax(lambda_l[goodl]) ELSE lambda_l = [f,f]     & $
    IF (gdh GT 0) THEN lambda_h = minmax(lambda_h[goodh]) ELSE lambda_h = [f,f]     & $
    PRINT,FORMAT=mform,scet0,deltaf[0],deltathl[0],'-',deltathl[1],vphasel[0],' -',vphasel[1],lambda_l[0],' -',lambda_l[1],test0.(k).THETA_RES[0],polarizel  & $
    PRINT,FORMAT=mform,scet0,deltaf[1],deltathh[0],'-',deltathh[1],vphaseh[0],' -',vphaseh[1],lambda_h[0],' -',lambda_h[1],test1.(k).THETA_RES[0],polarizeh
    
;-------------------------------------------------------------------------------------------------------------------------------------------------
;      Date        Time              Freq            Theta               Vphase                     Lambda         Res. Cone       Polarization
;                                    (Hz)            (deg)               (km/s)                      (km)            (deg)
;=================================================================================================================================================
;    1998/08/26 06:40:26.120 UT       4.0          54.4-89.5        94.744 -  306.830         90.466 -  100.333      89.526        RH        RH
;    1998/08/26 06:40:26.120 UT      20.0          54.4-88.0        18.007 -  646.801         39.091 -   43.012      88.043        RH        RH
;    1998/08/26 06:40:26.120 UT       7.0          54.1-89.2        86.225 -  398.787         67.079 -   74.597      89.171        RH        RH
;    1998/08/26 06:40:26.120 UT      30.0          54.1-86.7        27.294 -  777.769         31.637 -   34.663      86.704        RH        RH
;    1998/08/26 06:40:26.120 UT      10.0          73.8-77.3       285.032 -  322.431         60.611 -   61.102      88.815        RH        RH
;    1998/08/26 06:40:26.120 UT      30.0          73.8-77.3       430.795 -  503.525         34.195 -   34.416      86.704        RH        RH
;    1998/08/26 06:40:26.120 UT      40.0          14.4-79.5       394.263 - 1165.651         15.322 -   29.570      85.448        RH        RH
;    1998/08/26 06:40:26.120 UT     400.0          14.4-34.1       104.458 - 1469.099          3.301 -    4.061      34.217        RH        RH
;    1998/08/26 06:40:26.120 UT      60.0           NaN- NaN           NaN -      NaN            NaN -      NaN      82.999        RH        RH
;    1998/08/26 06:40:26.120 UT     500.0           NaN- NaN           NaN -      NaN            NaN -      NaN        -NaN        LH        LH
;    1998/08/26 06:40:26.120 UT      60.0          16.2-83.0        32.316 - 1385.522         13.163 -   23.635      82.999        RH        RH
;    1998/08/26 06:40:26.120 UT     200.0          16.2-65.6        51.635 - 2042.300          6.736 -   10.576      65.608        RH        RH
;    1998/08/26 06:40:26.120 UT      60.0          17.7-83.0        32.316 - 1379.044         13.740 -   23.635      82.999        RH        RH
;    1998/08/26 06:40:26.120 UT     150.0          17.7-71.9        91.206 - 1917.473          8.379 -   13.248      71.980        RH        RH
;    1998/08/26 06:40:26.120 UT     150.0           9.3-17.7      1917.473 - 1968.275          6.186 -    8.379      71.980        RH        RH
;    1998/08/26 06:40:26.120 UT     200.0           9.3-17.7      2027.675 - 2091.546          5.197 -    7.014      65.608        RH        RH
;    1998/08/26 06:40:54.941 UT       3.0          68.4-75.9       172.470 -  204.549        105.197 -  107.435      89.739        RH        RH
;    1998/08/26 06:40:54.941 UT      30.0          68.4-75.9       444.018 -  562.854         31.153 -   31.756      87.758        RH        RH
;    1998/08/26 06:41:10.001 UT       3.0          68.4-75.9       174.817 -  207.472        106.767 -  109.039      89.734        RH        RH
;    1998/08/26 06:41:10.001 UT      30.0          68.4-75.9       450.069 -  571.006         31.641 -   32.250      87.704        RH        RH
;    1998/08/26 06:41:37.623 UT      30.0           2.9-11.8       936.268 -  946.242          7.285 -   14.572      87.356        RH        RH
;    1998/08/26 06:41:37.623 UT     130.0           2.9-11.8      1751.548 - 1774.441          3.425 -    6.837      77.126        RH        RH
;    1998/08/26 06:41:44.013 UT      30.0           3.2-10.3       987.010 -  994.588          8.083 -   14.280      87.523        RH        RH
;    1998/08/26 06:41:44.013 UT     130.0           3.2-10.3      1858.239 - 1875.522          3.834 -    6.733      77.788        RH        RH
;    1998/08/26 06:41:53.249 UT      35.0           1.1-19.2      1097.844 - 1131.480          4.587 -   18.903      87.143        RH        RH
;    1998/08/26 06:41:53.249 UT     150.0           1.1-19.2      2020.993 - 2098.434          2.190 -    8.857      76.424        RH        RH
;    1998/08/26 06:41:56.315 UT      30.0           4.5-45.9       876.887 - 1060.951         10.159 -   30.379      87.634        RH        RH
;    1998/08/26 06:41:56.315 UT     150.0           4.5-45.9      1641.117 - 2112.573          4.459 -   12.782      76.350        RH        RH
;    1998/08/26 06:41:57.909 UT      30.0           4.5- 9.7      1069.978 - 1076.391         10.253 -   15.021      87.681        RH        RH
;    1998/08/26 06:41:57.909 UT     150.0           4.5- 9.7      2131.444 - 2147.380          4.539 -    6.592      76.561        RH        RH
;    1998/08/26 06:41:59.233 UT      30.0           0.5-17.6      1065.521 - 1092.514          3.805 -   20.336      87.727        RH        RH
;    1998/08/26 06:41:59.233 UT     150.0           0.5-17.6      2117.277 - 2184.364          1.601 -    8.824      76.766        RH        RH
;    1998/08/26 06:42:05.763 UT      40.0           0.5-12.1      1234.940 - 1249.771          3.039 -   14.691      86.550        RH        RH
;    1998/08/26 06:42:05.763 UT     200.0           0.5-12.1      2331.040 - 2369.973          1.308 -    6.299      71.222        RH        RH
;    1998/08/26 06:42:09.131 UT      50.0           4.9-19.4      1270.771 - 1309.545          7.989 -   15.662      85.092        RH        RH
;    1998/08/26 06:42:09.131 UT     200.0           4.9-19.4      2104.526 - 2197.145          3.859 -    7.396      69.269        RH        RH
;-------------------------------------------------------------------------------------------------------------------------------------------------


;-----------------------------------------------------------------------------------------
;      Date        Time             Betaparc       Bx          By          Bz          |B|
;=========================================================================================

;-----------------------------------------------------------------------------------------
; => For 1998-09-24
;-----------------------------------------------------------------------------------------
f      = !VALUES.F_NAN
d      = !VALUES.D_NAN
tags      = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13',$
             't14','t15','t16','t17','t18','t19','t20','t21','t22','t23','t24']
theta_kb0924_03_20 = [59.91]
theta_kb0924_05_20 = [51.24,60.59,39.10]
theta_kb0924_10_45 = [f]
theta_kb0924_50_200 = [f]
theta_kb0924_100_200 = [68.66,13.88,31.18,13.80]
thkbstr_00 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_20)
thkbstr_01 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_05_20)
thkbstr_02 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_10_45)
thkbstr_03 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_50_200)
thkbstr_04 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_100_200)
thkbstr_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4'],thkbstr_00,$
                           thkbstr_01,thkbstr_02,thkbstr_03,thkbstr_04)
theta_kb0924_03_30 = [f]
theta_kb0924_06_30 = [11.56,46.66]
theta_kb0924_15_150 = [f]
theta_kb0924_30_150 = [31.11,14.93, 4.48,28.00, 4.89,32.28,24.61]
thkbstr_10 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30)
thkbstr_11 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_06_30)
thkbstr_12 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_15_150)
thkbstr_13 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_30_150)
thkbstr_1  = CREATE_STRUCT(['T0','T1','T2','T3'],thkbstr_10,$
                           thkbstr_11,thkbstr_12,thkbstr_13)
theta_kb0924_06_30_2 = [f]
theta_kb0924_06_30_2 = [28.76,35.15,37.50,15.70,29.20,56.17]
theta_kb0924_15_150 = [f]
theta_kb0924_30_150_2 = [11.25,11.52,15.54,23.11,30.44,38.02,19.30,31.46]
thkbstr_20 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_06_30_2)
thkbstr_21 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_06_30_2)
thkbstr_22 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_15_150)
thkbstr_23 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_30_150_2)
thkbstr_2  = CREATE_STRUCT(['T0','T1','T2','T3'],thkbstr_20,$
                           thkbstr_21,thkbstr_22,thkbstr_23)
theta_kb0924_03_30_0 = [f]
thkbstr_3            = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30_0))
theta_kb0924_03_40 = [82.69,16.46,17.68]
theta_kb0924_10_40_0 = [f]
theta_kb0924_40_100 = [f]
theta_kb0924_200_400 = [30.25,26.49,31.59,37.37,38.88,34.26,36.04,39.39,39.44,32.68,$
                        59.49,59.52,41.77,40.16,46.63,36.97,31.07,35.85,51.33,36.10,$
                        38.79,27.15,40.73,41.35,45.90]
thkbstr_40 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_40)
thkbstr_41 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_10_40_0)
thkbstr_42 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_40_100)
thkbstr_43 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_200_400)
thkbstr_4  = CREATE_STRUCT(['T0','T1','T2','T3'],thkbstr_40,$
                           thkbstr_41,thkbstr_42,thkbstr_43)
theta_kb0924_03_30 = [35.94,64.13, 4.35]
thkbstr_5            = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30))
theta_kb0924_03_30_2 = [43.07,27.87,33.52]
theta_kb0924_10_100 = [62.14,25.68,39.22]
theta_kb0924_30_100 = [35.45,68.03,45.93,74.00,89.16,12.61,51.47]
theta_kb0924_100_300 = [22.55,27.64,13.56,19.71, 1.82, 9.69,79.23,14.21,15.65,32.20,$
                        16.59,28.70,34.40,59.36,77.56,88.21]
thkbstr_60 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30_2)
thkbstr_61 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_10_100)
thkbstr_62 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_30_100)
thkbstr_63 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_100_300)
thkbstr_6  = CREATE_STRUCT(['T0','T1','T2','T3'],thkbstr_60,$
                           thkbstr_61,thkbstr_62,thkbstr_63)
theta_kb0924_03_30_3 = [83.80,49.20,63.53]
theta_kb0924_10_30 = [80.24,75.86,46.00,57.65,29.34,84.00,68.43]
theta_kb0924_15_60 = [f]
theta_kb0924_30_100_2 = [85.58,81.54,71.28,43.49,62.07,71.42,78.00]
thkbstr_70 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30_3)
thkbstr_71 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_10_30)
thkbstr_72 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_15_60)
thkbstr_73 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_30_100_2)
thkbstr_7  = CREATE_STRUCT(['T0','T1','T2','T3'],thkbstr_70,$
                           thkbstr_71,thkbstr_72,thkbstr_73)
theta_kb0924_03_30_4 = [66.11,63.84,68.71,76.10]
theta_kb0924_04_40 = [f]
theta_kb0924_10_40 = [71.72,39.54]
thkbstr_80 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30_4)
thkbstr_81 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_04_40)
thkbstr_82 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_10_40)
thkbstr_8  = CREATE_STRUCT(['T0','T1','T2'],thkbstr_80,$
                           thkbstr_81,thkbstr_82)
theta_kb0924_03_30_5 = [82.88]
theta_kb0924_05_30 = [f]
theta_kb0924_07_30 = [f]
theta_kb0924_65_300 = [21.55, 5.76]
thkbstr_90 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30_5)
thkbstr_91 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_05_30)
thkbstr_92 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_07_30)
thkbstr_93 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_65_300)
thkbstr_9  = CREATE_STRUCT(['T0','T1','T2','T3'],thkbstr_90,$
                           thkbstr_91,thkbstr_92,thkbstr_93)
theta_kb0924_03_30_6 = [51.20,80.44,79.79,89.43,33.20,40.11,57.26,86.90,30.69]
theta_kb0924_06_30_3 = [75.44,18.25,35.51,60.56,78.53,64.65,21.58,62.02,32.47,51.86]
theta_kb0924_10_100 = [f]
thkbstr_100 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30_6)
thkbstr_101 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_06_30_3)
thkbstr_102 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_10_100)
thkbstr_10  = CREATE_STRUCT(['T0','T1','T2'],thkbstr_100,$
                            thkbstr_101,thkbstr_102)
theta_kb0924_03_30_7 = [49.44,87.27,89.42,88.65,85.25,86.69]
theta_kb0924_05_50 = [49.44,87.27,89.42,88.65,85.25,86.69]
theta_kb0924_07_50 = [81.47,88.35,63.77,77.88,67.16,84.04]
thkbstr_110 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30_7)
thkbstr_111 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_05_50)
thkbstr_112 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_07_50)
thkbstr_11  = CREATE_STRUCT(['T0','T1','T2'],thkbstr_110,$
                            thkbstr_111,thkbstr_112)
theta_kb0924_03_30_8 = [54.44,86.83,79.70,49.20,71.85,21.66]
theta_kb0924_05_50 = [f]
theta_kb0924_40_200 = [86.71,73.85,81.59,58.36,83.34,85.65,83.69,84.48,82.98,86.89,86.85,82.97,80.79]
thkbstr_120 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30_8)
thkbstr_121 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_05_50)
thkbstr_122 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_40_200)
thkbstr_12  = CREATE_STRUCT(['T0','T1','T2'],thkbstr_120,$
                            thkbstr_121,thkbstr_122)
theta_kb0924_03_30_9 = [75.73,80.77,72.14,54.32,83.18]
theta_kb0924_07_50 = [f]
theta_kb0924_10_100 = [f]
theta_kb0924_20_100 = [f]
thkbstr_130 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_03_30_9)
thkbstr_131 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_07_50)
thkbstr_132 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_10_100)
thkbstr_133 = CREATE_STRUCT(tags[0L:0L],theta_kb0924_20_100)
thkbstr_13  = CREATE_STRUCT(['T0','T1','T2','T3'],  thkbstr_130,$
                            thkbstr_131,thkbstr_132,thkbstr_133)
thkbstr_14  = CREATE_STRUCT(['T0','T1','T2','T3'],CREATE_STRUCT(tags[0L:0L],[f]),$
                            CREATE_STRUCT(tags[0L:0L],[f]),$
                            CREATE_STRUCT(tags[0L:0L],[f]),$
                            CREATE_STRUCT(tags[0L:0L],[f]))
tags      = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13','t14']
thkbstr    = CREATE_STRUCT(tags,thkbstr_0,thkbstr_1,thkbstr_2,thkbstr_3,thkbstr_4,thkbstr_5,$
                          thkbstr_6,thkbstr_7,thkbstr_8,thkbstr_9,thkbstr_10,thkbstr_11,   $
                          thkbstr_12,thkbstr_13,thkbstr_14)

dens_0924  = [16.586,21.087,21.499,24.340,24.016,24.699,20.004,19.946,24.534,24.764,25.467,22.313,$
              21.804,14.165]
bmag_0924  = [31.787,42.112,42.351,41.021,40.631,35.242,36.222,36.608,36.225,37.328,36.095,23.914,$
              22.070,23.574]
thbn_0924  = [82.1,78.6]
dthbn_0924 = [ 2.4, 2.4]
scet_0924  = ['1998/09/24 23:20:38.842',$
              '1998/09/24 23:22:26.632','1998/09/24 23:22:48.150',$
              '1998/09/24 23:30:00.465','1998/09/24 23:30:48.542',$
              '1998/09/24 23:43:18.951','1998/09/24 23:45:52.184',$
              '1998/09/24 23:45:53.379','1998/09/24 23:48:39.020',$
              '1998/09/24 23:48:42.131','1998/09/24 23:48:51.622',$
              '1998/09/25 00:04:04.545','1998/09/25 00:05:23.432',$
              '1998/09/25 00:14:50.603'                           ]+' UT'
lfc1  = [3d0,5d0,1d1, 5d1,1d2]   ; => For 1998-09-24/23:20:38.842 UT
hfc1  = [2d1,2d1,45d0,2d2,2d2]   ; => For 1998-09-24/23:20:38.842 UT
lfc2  = [3d0,6d0,15d0, 3d1]      ; => For 1998-09-24/23:22:26.632 UT
hfc2  = [2d1,3d1,15d1,15d1]      ; => For 1998-09-24/23:22:26.632 UT
lfc3  = [3d0,6d0,15d0, 3d1]      ; => For 1998-09-24/23:22:48.150 UT
hfc3  = [2d1,3d1,15d1,15d1]      ; => For 1998-09-24/23:22:48.150 UT
lfc4  = [3d0]                    ; => For 1998-09-24/23:30:00.465 UT
hfc4  = [3d1]                    ; => For 1998-09-24/23:30:00.465 UT
lfc5  = [3d0,1d1,4d1,2d2]        ; => For 1998-09-24/23:30:48.542 UT
hfc5  = [4d1,4d1,1d2,4d2]        ; => For 1998-09-24/23:30:48.542 UT
lfc6  = [3d0]                    ; => For 1998-09-24/23:43:18.951 UT
hfc6  = [3d1]                    ; => For 1998-09-24/23:43:18.951 UT
lfc7  = [3d0,1d1,3d1,1d2]        ; => For 1998-09-24/23:45:52.184 UT
hfc7  = [3d1,1d2,1d2,3d2]        ; => For 1998-09-24/23:45:52.184 UT
lfc8  = [3d0,1d1,15d0,30d0]      ; => For 1998-09-24/23:45:53.379 UT
hfc8  = [3d1,3d1,6d1 ,1d2 ]      ; => For 1998-09-24/23:45:53.379 UT
lfc9  = [3d0,4d0,1d1]            ; => For 1998-09-24/23:48:39.020 UT
hfc9  = [3d1,4d1,4d1]            ; => For 1998-09-24/23:48:39.020 UT
lfc10 = [3d0,5d0,7d0,65d0]       ; => For 1998-09-24/23:48:42.131 UT
hfc10 = [3d1,3d1,3d1,3d2]        ; => For 1998-09-24/23:48:42.131 UT
lfc11 = [3d0,6d0,1d1]            ; => For 1998-09-24/23:48:51.622 UT
hfc11 = [3d1,3d1,1d2]            ; => For 1998-09-24/23:48:51.622 UT
lfc12 = [3d0,5d0,7d0]            ; => For 1998-09-25/00:04:04.545 UT
hfc12 = [3d1,5d1,5d1]            ; => For 1998-09-25/00:04:04.545 UT
lfc13 = [3d0,5d0,4d1]            ; => For 1998-09-25/00:05:23.432 UT
hfc13 = [3d1,5d1,2d2]            ; => For 1998-09-25/00:05:23.432 UT
lfc14 = [3d0,7d0,1d1,2d1]        ; => For 1998-09-25/00:14:50.603 UT
hfc14 = [3d1,5d1,1d2,1d2]        ; => For 1998-09-25/00:14:50.603 UT
tags  = ['t1','t2','t3','t4','t5','t6','t7','t8','t9',$
         't10','t11','t12','t13','t14']
lf_str_0924 = CREATE_STRUCT(tags,lfc1,lfc2,lfc3,lfc4,lfc5,lfc6,lfc7,lfc8,lfc9,$
                       lfc10,lfc11,lfc12,lfc13,lfc14)
hf_str_0924 = CREATE_STRUCT(tags,hfc1,hfc2,hfc3,hfc4,hfc5,hfc6,hfc7,hfc8,hfc9,$
                       hfc10,hfc11,hfc12,hfc13,hfc14)
n_tds_0924  = N_TAGS(lf_str_0924)

ndat        = 1000L
bo          = bmag_0924
no          = dens_0924
n_uq        = n_tds_0924 - 1L
lf_str      = lf_str_0924
hf_str      = hf_str_0924
jj          = 0L
FOR j=0L, n_uq DO BEGIN                                                               $
  jstr    = 'T'+STRTRIM(j,2)                                                        & $
  lfc0    = lf_str.(j)                                                              & $
  hfc0    = hf_str.(j)                                                              & $
  n_fr    = N_ELEMENTS(lfc0) - 1L                                                   & $
  FOR k=0L, n_fr DO BEGIN                                                             $
    kstr      = 'T'+STRTRIM(k,2)                                                    & $
    flow      = lfc0[k]                                                             & $
    fhigh     = hfc0[k]                                                             & $
    test_low  = cold_plasma_params(bo[j],no[j],FREQF=flow,NDAT=ndat)                & $
    test_high = cold_plasma_params(bo[j],no[j],FREQF=fhigh,NDAT=ndat)               & $
    str_element,flow_cold0 ,kstr,test_low ,/ADD_REPLACE                             & $
    str_element,fhigh_cold0,kstr,test_high,/ADD_REPLACE                             & $
  ENDFOR                                                                            & $
  str_element,flow_cold,jstr,flow_cold0,/ADD_REPLACE                                & $
  str_element,fhigh_cold,jstr,fhigh_cold0,/ADD_REPLACE                              & $
  flow_cold0  = 0                                                                   & $
  fhigh_cold0 = 0                                                                   & $
ENDFOR                                                                              & $
jj += 1L

flow_cold_0924  = flow_cold
fhigh_cold_0924 = fhigh_cold

DELVAR,flow_cold,fhigh_cold,flow_cold0,fhigh_cold0,test_low,test_high

c           = 2.99792458d8      ; => Speed of light in vacuum (m/s)
f           = !VALUES.F_NAN
d           = !VALUES.D_NAN
nsquaredl   = 0.                ; => Index of refraction squared for f_low
nsquaredh   = 0.                ; => Index of refraction squared for f_high
vphasel     = 0.                ; => phase speed (m/s) for f_low
vphaseh     = 0.                ; => phase speed (m/s) for f_high
knumberl    = 0.                ; => wave number (m^-1) for f_low
knumberh    = 0.                ; => wave number (m^-1) for f_high
resconel    = 0.                ; => resonance cone angle (deg) for f_low
resconeh    = 0.                ; => resonance cone angle (deg) for f_high
polarlb     = 0.                ; => polarization with respect to Bo for f_low
polarhb     = 0.                ; => polarization with respect to Bo for f_high
thetasl     = 0.                ; => possible propagation angles (deg) for f_low
thetash     = 0.                ; => possible propagation angles (deg) for f_high
dummy       = REPLICATE(d,ndat)
tags        = ['Nsquared','Vphase','Theta_res','Wave_Number','Polarization','Freq_Range','Thetas']

jj          = 0L
lf_str      = lf_str_0924
hf_str      = hf_str_0924
FOR j=0L, n_uq DO BEGIN                                                               $
  jstr    = 'T'+STRTRIM(j,2)                                                        & $
  test0   = flow_cold_0924.(j)                                                      & $
  test1   = fhigh_cold_0924.(j)                                                     & $
  lfc0    = lf_str.(j)                                                              & $
  hfc0    = hf_str.(j)                                                              & $
  n_fr    = N_TAGS(test0) - 1L                                                      & $
  FOR k=0L, n_fr DO BEGIN                                                             $
    kstr      = 'T'+STRTRIM(k,2)                                                    & $
    flow      = lfc0[k]*(2d0*!DPI)                                                  & $
    fhigh     = hfc0[k]*(2d0*!DPI)                                                  & $
    nsquaredl = test0.(k).INDEX_REF_1                                               & $
    nsquaredh = test1.(k).INDEX_REF_1                                               & $
    vphasel   = SQRT(c^2/nsquaredl)                                                 & $
    vphaseh   = SQRT(c^2/nsquaredh)                                                 & $
    knumberl  = SQRT(nsquaredl*flow[0]^2/c^2)                                       & $
    knumberh  = SQRT(nsquaredh*fhigh[0]^2/c^2)                                      & $
    resconel  = test0.(k).CONE_ANG[0]                                               & $
    resconeh  = test1.(k).CONE_ANG[0]                                               & $
    polarlb   = (nsquaredl - test0.(k).S_TERM[0])/test0.(k).D_TERM[0]               & $
    polarhb   = (nsquaredh - test1.(k).S_TERM[0])/test1.(k).D_TERM[0]               & $
    thetasl   = dummy                                                               & $
    thetash   = dummy                                                               & $
    goodl     = WHERE(nsquaredl GE 0.,gdl,COMPLEMENT=badl,NCOMPLEMENT=bdl)          & $
    goodh     = WHERE(nsquaredh GE 0.,gdh,COMPLEMENT=badh,NCOMPLEMENT=bdh)          & $
    IF (gdl GT 0) THEN thetasl[goodl] = test0.(k).ANGLES[goodl]                     & $
    IF (gdh GT 0) THEN thetash[goodh] = test1.(k).ANGLES[goodh]                     & $
    IF (bdl GT 0) THEN vphasel[badl] = d                                            & $
    IF (bdh GT 0) THEN vphaseh[badh] = d                                            & $
    IF (bdl GT 0) THEN knumberl[badl] = d                                           & $
    IF (bdh GT 0) THEN knumberh[badh] = d                                           & $
    IF (bdl GT 0) THEN polarlb[badl] = d                                            & $
    IF (bdh GT 0) THEN polarhb[badh] = d                                            & $
    dumbl     = CREATE_STRUCT(tags,nsquaredl,vphasel,resconel,knumberl,polarlb,[flow,fhigh],thetasl)  & $
    dumbh     = CREATE_STRUCT(tags,nsquaredh,vphaseh,resconeh,knumberh,polarhb,[flow,fhigh],thetash)  & $
    str_element,dumbl0,kstr,dumbl,/ADD_REPLACE                                      & $
    str_element,dumbh0,kstr,dumbh,/ADD_REPLACE                                      & $
  ENDFOR                                                                            & $
  str_element,stats_low,jstr,dumbl0,/ADD_REPLACE                                    & $
  str_element,stats_high,jstr,dumbh0,/ADD_REPLACE                                   & $
  dumbl0 = 0                                                                        & $
  dumbh0 = 0                                                                        & $
ENDFOR                                                                              & $
jj += 1L

stats_low_0924  = stats_low
stats_high_0924 = stats_high
DELVAR,dumbl0,dumbh0,dumbl,dumbh,stats_low,stats_high

mform      = '(";",a30,f10.1,f14.1,a1,f4.1,f14.3,a2,f9.3,f15.3,a2,f9.3,f12.3,2a10)'
sform      = '(f12.3,"-",f12.3)'
kform      = '(f12.4,"-",f12.4)'
fform      = '(f12.3)'
pol_rl     = ['LH','RH']
FOR j=0L, n_uq DO BEGIN                                                               $
  jstr    = 'T'+STRTRIM(j,2)                                                        & $
  scet0   = scet_0924[j]                                                            & $
  test0   = stats_low_0924.(j)                                                      & $
  test1   = stats_high_0924.(j)                                                     & $
  n_fr    = N_TAGS(test0) - 1L                                                      & $
  FOR k=0L, n_fr DO BEGIN                                                             $
    vphasel   = test0.(k).VPHASE*1d-3                                               & $
    vphaseh   = test1.(k).VPHASE*1d-3                                               & $
    knumberl  = test0.(k).WAVE_NUMBER*1d3                                           & $
    knumberh  = test1.(k).WAVE_NUMBER*1d3                                           & $
    lambda_l  = ((2d0*!DPI)/knumberl)[SORT((2d0*!DPI)/knumberl)]                    & $
    lambda_h  = ((2d0*!DPI)/knumberh)[SORT((2d0*!DPI)/knumberh)]                    & $
    polarz_l  = minmax(test0.(k).POLARIZATION)                                      & $
    polarz_h  = minmax(test1.(k).POLARIZATION)                                      & $
    polarizel = pol_rl[polarz_l GT 0]                                               & $
    polarizeh = pol_rl[polarz_h GT 0]                                               & $
    mnthkb    = MIN(thkbstr.(j).(k).(0),/NAN)                                       & $
    mxthkb    = MAX(thkbstr.(j).(k).(0),/NAN)                                       & $
    deltaf    = test1.(k).FREQ_RANGE/(2d0*!DPI)                                     & $
    thetal    = test0.(k).THETAS                                                    & $
    thetah    = test1.(k).THETAS                                                    & $
    IF (FINITE(mnthkb) EQ 0) THEN mnthkb = f                                        & $
    IF (FINITE(mxthkb) EQ 0) THEN mxthkb = f                                        & $
    IF (mnthkb EQ mxthkb) THEN mxthkb = test0.(k).THETA_RES[0]                      & $
    goodl     = WHERE(thetal LE mxthkb[0] AND thetal GE mnthkb[0],gdl)              & $
    goodh     = WHERE(thetah LE mxthkb[0] AND thetah GE mnthkb[0],gdh)              & $
    IF (gdl GT 0) THEN deltathl = minmax(thetal[goodl]) ELSE deltathl = [f,f]       & $
    IF (gdh GT 0) THEN deltathh = minmax(thetah[goodh]) ELSE deltathh = [f,f]       & $
    IF (gdl GT 0) THEN vphasel  = minmax(vphasel[goodl])  ELSE vphasel  = [f,f]     & $
    IF (gdh GT 0) THEN vphaseh  = minmax(vphaseh[goodh])  ELSE vphaseh  = [f,f]     & $
    IF (gdl GT 0) THEN lambda_l = minmax(lambda_l[goodl]) ELSE lambda_l = [f,f]     & $
    IF (gdh GT 0) THEN lambda_h = minmax(lambda_h[goodh]) ELSE lambda_h = [f,f]     & $
    PRINT,FORMAT=mform,scet0,deltaf[0],deltathl[0],'-',deltathl[1],vphasel[0],' -',vphasel[1],lambda_l[0],' -',lambda_l[1],test0.(k).THETA_RES[0],polarizel  & $
    PRINT,FORMAT=mform,scet0,deltaf[1],deltathh[0],'-',deltathh[1],vphaseh[0],' -',vphaseh[1],lambda_h[0],' -',lambda_h[1],test1.(k).THETA_RES[0],polarizeh

;-------------------------------------------------------------------------------------------------------------------------------------------------
;      Date        Time              Freq            Theta               Vphase                     Lambda         Res. Cone       Polarization
;                                    (Hz)            (deg)               (km/s)                      (km)            (deg)
;=================================================================================================================================================
;    1998/09/24 23:20:38.842 UT       3.0          60.0-89.7       168.485 -  328.286        141.423 -  151.874      89.807        RH        RH
;    1998/09/24 23:20:38.842 UT      20.0          60.0-89.7        56.021 -  767.308         50.825 -   54.703      88.712        RH        RH
;    1998/09/24 23:20:38.842 UT       5.0          39.2-60.5       404.511 -  503.094         91.114 -  106.565      89.678        RH        RH
;    1998/09/24 23:20:38.842 UT      20.0          39.2-60.5       760.828 -  960.430         43.257 -   50.965      88.712        RH        RH
;    1998/09/24 23:20:38.842 UT      10.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.356        RH        RH
;    1998/09/24 23:20:38.842 UT      45.0           NaN- NaN           NaN -      NaN            NaN -      NaN      87.427        RH        RH
;    1998/09/24 23:20:38.842 UT      50.0           NaN- NaN           NaN -      NaN            NaN -      NaN      87.068        RH        RH
;    1998/09/24 23:20:38.842 UT     200.0           NaN- NaN           NaN -      NaN            NaN -      NaN      77.075        RH        RH
;    1998/09/24 23:20:38.842 UT     100.0          13.9-68.6      1232.735 - 2270.711         11.892 -   22.645      83.685        RH        RH
;    1998/09/24 23:20:38.842 UT     200.0          13.9-68.6      1295.720 - 2990.017          8.255 -   15.134      77.075        RH        RH
;    1998/09/24 23:22:26.632 UT       3.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.854        RH        RH
;    1998/09/24 23:22:26.632 UT      20.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.028        RH        RH
;    1998/09/24 23:22:26.632 UT       6.0          11.6-46.6       533.401 -  634.941         51.789 -   91.302      89.708        RH        RH
;    1998/09/24 23:22:26.632 UT      30.0          11.6-46.6      1125.035 - 1349.430         20.279 -   38.783      89.417        RH        RH
;    1998/09/24 23:22:26.632 UT      15.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.271        RH        RH
;    1998/09/24 23:22:26.632 UT     150.0           NaN- NaN           NaN -      NaN            NaN -      NaN      82.809        RH        RH
;    1998/09/24 23:22:26.632 UT      30.0           4.5-32.3      1251.484 - 1361.678         12.513 -   33.206      89.417        RH        RH
;    1998/09/24 23:22:26.632 UT     150.0           4.5-32.3      2596.579 - 2856.516          5.685 -   14.565      82.809        RH        RH
;    1998/09/24 23:22:48.150 UT       3.0          15.8-56.1       359.331 -  463.726         90.770 -  143.807      89.855        RH        RH
;    1998/09/24 23:22:48.150 UT      20.0          15.8-56.1       830.625 - 1095.187         28.930 -   50.806      89.033        RH        RH
;    1998/09/24 23:22:48.150 UT       6.0          15.8-56.1       479.530 -  625.247         58.027 -   96.841      89.710        RH        RH
;    1998/09/24 23:22:48.150 UT      30.0          15.8-56.1      1003.114 - 1328.341         23.455 -   41.202      89.438        RH        RH
;    1998/09/24 23:22:48.150 UT      15.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.275        RH        RH
;    1998/09/24 23:22:48.150 UT     150.0           NaN- NaN           NaN -      NaN            NaN -      NaN      82.851        RH        RH
;    1998/09/24 23:22:48.150 UT      30.0          11.3-38.0      1198.691 - 1341.280         19.836 -   35.458      89.438        RH        RH
;    1998/09/24 23:22:48.150 UT     150.0          11.3-38.0      2474.324 - 2811.774          8.878 -   15.495      82.851        RH        RH
;    1998/09/24 23:30:00.465 UT       3.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.850        RH        RH
;    1998/09/24 23:30:00.465 UT      30.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.326        RH        RH
;    1998/09/24 23:30:48.542 UT       3.0          16.5-82.6       205.238 -  427.404         84.716 -  144.878      89.849        RH        RH
;    1998/09/24 23:30:48.542 UT      40.0          16.5-82.6       462.685 - 1407.115         19.306 -   35.854      88.491        RH        RH
;    1998/09/24 23:30:48.542 UT      10.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.496        RH        RH
;    1998/09/24 23:30:48.542 UT      40.0           NaN- NaN           NaN -      NaN            NaN -      NaN      88.491        RH        RH
;    1998/09/24 23:30:48.542 UT      40.0           NaN- NaN           NaN -      NaN            NaN -      NaN      88.491        RH        RH
;    1998/09/24 23:30:48.542 UT     100.0           NaN- NaN           NaN -      NaN            NaN -      NaN      85.134        RH        RH
;    1998/09/24 23:30:48.542 UT     200.0          26.6-59.5      1877.263 - 2757.960         10.565 -   14.193      79.957        RH        RH
;    1998/09/24 23:30:48.542 UT     400.0          26.6-59.5      1820.770 - 3386.910          7.107 -    9.147      69.444        RH        RH
;    1998/09/24 23:43:18.951 UT       3.0           4.4-64.1       270.215 -  395.574         55.104 -  125.268      89.826        RH        RH
;    1998/09/24 23:43:18.951 UT      30.0           4.4-64.1       746.689 - 1146.154         10.639 -   36.405      88.882        RH        RH
;    1998/09/24 23:45:52.184 UT       3.0          27.9-43.1       383.863 -  420.623        104.751 -  123.957      89.830        RH        RH
;    1998/09/24 23:45:52.184 UT      30.0          27.9-43.1      1100.453 - 1214.005         29.635 -   35.784      88.957        RH        RH
;    1998/09/24 23:45:52.184 UT      10.0          25.8-62.1       527.350 -  728.716         50.859 -   72.176      89.435        RH        RH
;    1998/09/24 23:45:52.184 UT     100.0          25.8-62.1      1451.070 - 2134.121         15.490 -   21.662      84.498        RH        RH
;    1998/09/24 23:45:52.184 UT      30.0          12.6-88.9        31.551 - 1277.823         20.207 -   43.133      88.957        RH        RH
;    1998/09/24 23:45:52.184 UT     100.0          12.6-84.4        90.444 - 2231.960         11.058 -   22.624      84.498        RH        RH
;    1998/09/24 23:45:52.184 UT     100.0           1.9-84.4        90.444 - 2261.748          4.398 -   22.624      84.498        RH        RH
;    1998/09/24 23:45:52.184 UT     300.0           1.9-72.8       109.567 - 3455.631          2.458 -   11.523      72.835        RH        RH
;    1998/09/24 23:45:53.379 UT       3.0          49.3-83.8       200.110 -  366.907        131.197 -  149.775      89.832        RH        RH
;    1998/09/24 23:45:53.379 UT      30.0          49.3-83.8       390.376 - 1045.116         37.961 -   43.347      88.986        RH        RH
;    1998/09/24 23:45:53.379 UT      10.0          29.4-84.0       269.750 -  721.902         54.322 -   77.146      89.441        RH        RH
;    1998/09/24 23:45:53.379 UT      30.0          29.4-84.0       383.453 - 1213.936         30.546 -   43.353      88.986        RH        RH
;    1998/09/24 23:45:53.379 UT      15.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.161        RH        RH
;    1998/09/24 23:45:53.379 UT      60.0           NaN- NaN           NaN -      NaN            NaN -      NaN      86.920        RH        RH
;    1998/09/24 23:45:53.379 UT      30.0          43.5-85.5       318.612 - 1104.028         36.189 -   43.397      88.986        RH        RH
;    1998/09/24 23:45:53.379 UT     100.0          43.5-84.5        73.900 - 1901.259         19.455 -   22.791      84.559        RH        RH
;    1998/09/24 23:48:39.020 UT       3.0          63.9-76.0       220.129 -  276.473        127.610 -  132.619      89.830        RH        RH
;    1998/09/24 23:48:39.020 UT      30.0          63.9-76.0       553.175 -  763.177         37.018 -   38.442      88.957        RH        RH
;    1998/09/24 23:48:39.020 UT       4.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.774        RH        RH
;    1998/09/24 23:48:39.020 UT      40.0           NaN- NaN           NaN -      NaN            NaN -      NaN      88.176        RH        RH
;    1998/09/24 23:48:39.020 UT      10.0          39.5-71.7       392.832 -  608.839         55.363 -   67.578      89.435        RH        RH
;    1998/09/24 23:48:39.020 UT      40.0          39.5-71.7       720.515 - 1169.293         26.974 -   32.768      88.176        RH        RH
;    1998/09/24 23:48:42.131 UT       3.0          82.9-89.8       162.349 -  187.226        135.821 -  136.348      89.835        RH        RH
;    1998/09/24 23:48:42.131 UT      30.0          82.9-89.0        26.032 -  385.005         39.267 -   39.383      89.041        RH        RH
;    1998/09/24 23:48:42.131 UT       5.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.726        RH        RH
;    1998/09/24 23:48:42.131 UT      30.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.041        RH        RH
;    1998/09/24 23:48:42.131 UT       7.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.616        RH        RH
;    1998/09/24 23:48:42.131 UT      30.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.041        RH        RH
;    1998/09/24 23:48:42.131 UT      65.0           5.8-21.5      1635.829 - 1695.667          8.521 -   16.208      86.692        RH        RH
;    1998/09/24 23:48:42.131 UT     300.0           5.8-21.5      3014.542 - 3162.514          3.865 -    7.215      73.363        RH        RH
;    1998/09/24 23:48:51.622 UT       3.0          30.7-89.4       154.982 -  367.083         96.177 -  131.855      89.830        RH        RH
;    1998/09/24 23:48:51.622 UT      30.0          30.7-88.9        24.155 - 1058.888         27.380 -   38.158      88.947        RH        RH
;    1998/09/24 23:48:51.622 UT       6.0          18.3-78.5       255.616 -  522.746         51.557 -   88.508      89.660        RH        RH
;    1998/09/24 23:48:51.622 UT      30.0          18.3-78.5       488.358 - 1114.573         21.444 -   37.831      88.947        RH        RH
;    1998/09/24 23:48:51.622 UT      10.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.433        RH        RH
;    1998/09/24 23:48:51.622 UT     100.0           NaN- NaN           NaN -      NaN            NaN -      NaN      84.478        RH        RH
;    1998/09/25 00:04:04.545 UT       3.0          49.5-89.4       108.796 -  271.039         97.398 -  111.536      89.743        RH        RH
;    1998/09/25 00:04:04.545 UT      30.0          49.5-87.7        31.782 -  784.356         28.899 -   32.822      87.806        RH        RH
;    1998/09/25 00:04:04.545 UT       5.0          49.5-89.4       105.876 -  340.672         73.577 -   84.375      89.572        RH        RH
;    1998/09/25 00:04:04.545 UT      50.0          49.5-85.9        46.258 -  984.694         22.180 -   24.963      85.929        RH        RH
;    1998/09/25 00:04:04.545 UT       7.0          63.8-88.3       113.658 -  329.040         66.757 -   70.494      89.401        RH        RH
;    1998/09/25 00:04:04.545 UT      50.0          63.8-85.9        46.258 -  787.659         23.955 -   24.963      85.929        RH        RH
;    1998/09/25 00:05:23.432 UT       3.0          21.7-86.8       111.350 -  312.065         67.409 -  107.835      89.722        RH        RH
;    1998/09/25 00:05:23.432 UT      30.0          21.7-86.8       114.656 -  918.343         19.686 -   31.818      87.558        RH        RH
;    1998/09/25 00:05:23.432 UT       5.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.536        RH        RH
;    1998/09/25 00:05:23.432 UT      50.0           NaN- NaN           NaN -      NaN            NaN -      NaN      85.554        RH        RH
;    1998/09/25 00:05:23.432 UT      40.0          58.4-86.5        32.980 -  766.005         25.507 -   27.283      86.536        RH        RH
;    1998/09/25 00:05:23.432 UT     200.0          58.4-71.1        87.758 - 1127.503         10.152 -   10.341      71.155        RH        RH
;    1998/09/25 00:14:50.603 UT       3.0          54.3-83.2       171.640 -  320.577        125.276 -  138.382      89.740        RH        RH
;    1998/09/25 00:14:50.603 UT      30.0          54.3-83.2       352.742 -  921.630         37.179 -   40.814      87.763        RH        RH
;    1998/09/25 00:14:50.603 UT       7.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.392        RH        RH
;    1998/09/25 00:14:50.603 UT      50.0           NaN- NaN           NaN -      NaN            NaN -      NaN      85.864        RH        RH
;    1998/09/25 00:14:50.603 UT      10.0           NaN- NaN           NaN -      NaN            NaN -      NaN      89.132        RH        RH
;    1998/09/25 00:14:50.603 UT     100.0           NaN- NaN           NaN -      NaN            NaN -      NaN      81.385        RH        RH
;    1998/09/25 00:14:50.603 UT      20.0           NaN- NaN           NaN -      NaN            NaN -      NaN      88.891        RH        RH
;    1998/09/25 00:14:50.603 UT     100.0           NaN- NaN           NaN -      NaN            NaN -      NaN      81.385        RH        RH
;-------------------------------------------------------------------------------------------------------------------------------------------------


;-----------------------------------------------------------------------------------------
; => For 2000-02-11
;-----------------------------------------------------------------------------------------
tags      = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13',$
             't14','t15','t16','t17','t18','t19','t20','t21','t22','t23','t24']
theta_kb0211_05_30 = [44.52, 5.83]
theta_kb0211_07_20 = [79.09]
theta_kb0211_60_200 = [81.12,81.08,23.00, 9.08,23.99]
theta_kb0211_120_200 = [ 9.24,31.49,17.39, 9.59,24.50]
thkbstr_00 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_05_30)
thkbstr_01 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_07_20)
thkbstr_02 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_60_200)
thkbstr_03 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_120_200)
thkbstr_0  = CREATE_STRUCT(['T0','T1','T2','T3'],thkbstr_00,$
                           thkbstr_01,thkbstr_02,thkbstr_03)
theta_kb0211_05_30_2 = [86.19]
theta_kb0211_07_20_2 = [84.23,35.92]
theta_kb0211_60_200_2 = [11.03, 9.00,10.75, 9.08, 3.76,22.13]
theta_kb0211_120_200_2 = [25.63,30.32,20.71,19.05,21.92, 7.47]
thkbstr_10 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_05_30_2)
thkbstr_11 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_07_20_2)
thkbstr_12 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_60_200_2)
thkbstr_13 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_120_200_2)
thkbstr_1  = CREATE_STRUCT(['T0','T1','T2','T3'],thkbstr_10,$
                           thkbstr_11,thkbstr_12,thkbstr_13)
theta_kb0211_03_20 = [68.55]
theta_kb0211_03_30 = [19.88]
theta_kb0211_30_200 = [25.93,24.37, 5.85,36.24,25.35,20.14,17.24, 9.05,11.11, 6.10,$
                        25.47,19.43,11.45, 9.50]
thkbstr_20 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_03_20)
thkbstr_21 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_03_30)
thkbstr_22 = CREATE_STRUCT(tags[0L:0L],theta_kb0211_30_200)
thkbstr_2  = CREATE_STRUCT(['T0','T1','T2'],thkbstr_20,$
                           thkbstr_21,thkbstr_22)
theta_kb0211_50_250 = [ 5.64, 9.38, 6.13,10.08,11.56, 6.40,11.01, 3.75,11.00, 6.82,$
                        3.10,14.91, 2.48, 1.04, 6.73, 6.32,22.34, 2.33,26.52, 8.21]
thkbstr_3            = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0211_50_250))
theta_kb0211_40_250 = [ 7.04, 6.63,10.33, 8.74, 7.43,12.52, 3.77, 4.10, 9.34, 8.27,$
                        4.24,12.94, 3.62, 7.34, 5.92, 9.75]
thkbstr_4            = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0211_40_250))
theta_kb0211_60_150 = [14.80, 9.04, 6.73,12.73, 3.17,16.65, 4.89,11.28, 6.25,11.01,$
                       14.92,10.51,14.67, 9.83]
thkbstr_5            = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0211_60_150))
theta_kb0211_36_100 = [14.51, 6.99,13.12]
thkbstr_6            = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0211_36_100))
theta_kb0211_30_100 = [ 2.52, 4.09, 5.41, 8.54, 4.39, 2.87, 3.08, 4.86, 2.46, 0.90,$
                        3.52]
thkbstr_7            = CREATE_STRUCT(['T0'],CREATE_STRUCT(tags[0L:0L],theta_kb0211_30_100))

tags       = ['t0','t1','t2','t3','t4','t5','t6','t7']
thkbstr    = CREATE_STRUCT(tags,thkbstr_0,thkbstr_1,thkbstr_2,thkbstr_3,thkbstr_4,thkbstr_5,$
                          thkbstr_6,thkbstr_7)


dens_0211  = [14.821,15.463,16.053,16.849,16.895,24.601,20.398,19.291]
bmag_0211  = [16.570,16.262,15.252,22.576,22.704,18.124,15.040,15.308]
thbn_0211  = [86.5,89.9]
dthbn_0211 = [ 2.2, 2.3]
scet_0211  = ['2000/02/11 23:33:56.491','2000/02/11 23:33:58.351',$
              '2000/02/11 23:34:00.731','2000/02/11 23:34:27.503',$
              '2000/02/11 23:34:29.065','2000/02/12 00:14:21.709',$
              '2000/02/12 00:26:17.217','2000/02/12 00:27:19.142' ]+' UT'
lfc1  = [7d0,5d0,6d1,12d1]                   ; => For 2000-02-11/23:33:56.491 UT
hfc1  = [2d1,3d1,2d2, 2d2]                   ; => For 2000-02-11/23:33:56.491 UT
lfc2  = [7d0,5d0,6d1,12d1]                   ; => For 2000-02-11/23:33:58.351 UT
hfc2  = [2d1,3d1,2d2, 2d2]                   ; => For 2000-02-11/23:33:58.351 UT
lfc3  = [3d0,3d0,3d1]                        ; => For 2000-02-11/23:34:00.731 UT
hfc3  = [2d1,3d1,2d2]                        ; => For 2000-02-11/23:34:00.731 UT
lfc4  = [5d1]                                ; => For 2000-02-11/23:34:27.503 UT
hfc4  = [25d1]                               ; => For 2000-02-11/23:34:27.503 UT
lfc5  = [4d1]                                ; => For 2000-02-11/23:34:29.065 UT
hfc5  = [25d1]                               ; => For 2000-02-11/23:34:29.065 UT
lfc6  = [6d1]                                ; => For 2000-02-12/00:14:21.709 UT
hfc6  = [15d1]                               ; => For 2000-02-12/00:14:21.709 UT
lfc7  = [36d0]                               ; => For 2000-02-12/00:26:17.217 UT
hfc7  = [10d1]                               ; => For 2000-02-12/00:26:17.217 UT
lfc8  = [30d0]                               ; => For 2000-02-12/00:27:19.142 UT
hfc8  = [10d1]                               ; => For 2000-02-12/00:27:19.142 UT
tags  = ['t1','t2','t3','t4','t5','t6','t7','t8']
lf_str_0211 = CREATE_STRUCT(tags,lfc1,lfc2,lfc3,lfc4,lfc5,lfc6,lfc7,lfc8)
hf_str_0211 = CREATE_STRUCT(tags,hfc1,hfc2,hfc3,hfc4,hfc5,hfc6,hfc7,hfc8)
n_tds_0211  = N_TAGS(lf_str_0211)


ndat        = 1000L
bo          = bmag_0211
no          = dens_0211
n_uq        = n_tds_0211 - 1L
lf_str      = lf_str_0211
hf_str      = hf_str_0211
jj          = 0L
FOR j=0L, n_uq DO BEGIN                                                               $
  jstr    = 'T'+STRTRIM(j,2)                                                        & $
  lfc0    = lf_str.(j)                                                              & $
  hfc0    = hf_str.(j)                                                              & $
  n_fr    = N_ELEMENTS(lfc0) - 1L                                                   & $
  FOR k=0L, n_fr DO BEGIN                                                             $
    kstr      = 'T'+STRTRIM(k,2)                                                    & $
    flow      = lfc0[k]                                                             & $
    fhigh     = hfc0[k]                                                             & $
    test_low  = cold_plasma_params(bo[j],no[j],FREQF=flow,NDAT=ndat)                & $
    test_high = cold_plasma_params(bo[j],no[j],FREQF=fhigh,NDAT=ndat)               & $
    str_element,flow_cold0 ,kstr,test_low ,/ADD_REPLACE                             & $
    str_element,fhigh_cold0,kstr,test_high,/ADD_REPLACE                             & $
  ENDFOR                                                                            & $
  str_element,flow_cold,jstr,flow_cold0,/ADD_REPLACE                                & $
  str_element,fhigh_cold,jstr,fhigh_cold0,/ADD_REPLACE                              & $
  flow_cold0  = 0                                                                   & $
  fhigh_cold0 = 0                                                                   & $
ENDFOR                                                                              & $
jj += 1L

flow_cold_0211  = flow_cold
fhigh_cold_0211 = fhigh_cold

DELVAR,flow_cold,fhigh_cold,flow_cold0,fhigh_cold0,test_low,test_high

c           = 2.99792458d8      ; => Speed of light in vacuum (m/s)
f           = !VALUES.F_NAN
d           = !VALUES.D_NAN
nsquaredl   = 0.                ; => Index of refraction squared for f_low
nsquaredh   = 0.                ; => Index of refraction squared for f_high
vphasel     = 0.                ; => phase speed (m/s) for f_low
vphaseh     = 0.                ; => phase speed (m/s) for f_high
knumberl    = 0.                ; => wave number (m^-1) for f_low
knumberh    = 0.                ; => wave number (m^-1) for f_high
resconel    = 0.                ; => resonance cone angle (deg) for f_low
resconeh    = 0.                ; => resonance cone angle (deg) for f_high
polarlb     = 0.                ; => polarization with respect to Bo for f_low
polarhb     = 0.                ; => polarization with respect to Bo for f_high
thetasl     = 0.                ; => possible propagation angles (deg) for f_low
thetash     = 0.                ; => possible propagation angles (deg) for f_high
dummy       = REPLICATE(d,ndat)
tags        = ['Nsquared','Vphase','Theta_res','Wave_Number','Polarization','Freq_Range','Thetas']

jj          = 0L
lf_str      = lf_str_0211
hf_str      = hf_str_0211
FOR j=0L, n_uq DO BEGIN                                                               $
  jstr    = 'T'+STRTRIM(j,2)                                                        & $
  test0   = flow_cold_0211.(j)                                                      & $
  test1   = fhigh_cold_0211.(j)                                                     & $
  lfc0    = lf_str.(j)                                                              & $
  hfc0    = hf_str.(j)                                                              & $
  n_fr    = N_TAGS(test0) - 1L                                                      & $
  FOR k=0L, n_fr DO BEGIN                                                             $
    kstr      = 'T'+STRTRIM(k,2)                                                    & $
    flow      = lfc0[k]*(2d0*!DPI)                                                  & $
    fhigh     = hfc0[k]*(2d0*!DPI)                                                  & $
    nsquaredl = test0.(k).INDEX_REF_1                                               & $
    nsquaredh = test1.(k).INDEX_REF_1                                               & $
    vphasel   = SQRT(c^2/nsquaredl)                                                 & $
    vphaseh   = SQRT(c^2/nsquaredh)                                                 & $
    knumberl  = SQRT(nsquaredl*flow[0]^2/c^2)                                       & $
    knumberh  = SQRT(nsquaredh*fhigh[0]^2/c^2)                                      & $
    resconel  = test0.(k).CONE_ANG[0]                                               & $
    resconeh  = test1.(k).CONE_ANG[0]                                               & $
    polarlb   = (nsquaredl - test0.(k).S_TERM[0])/test0.(k).D_TERM[0]               & $
    polarhb   = (nsquaredh - test1.(k).S_TERM[0])/test1.(k).D_TERM[0]               & $
    thetasl   = dummy                                                               & $
    thetash   = dummy                                                               & $
    goodl     = WHERE(nsquaredl GE 0.,gdl,COMPLEMENT=badl,NCOMPLEMENT=bdl)          & $
    goodh     = WHERE(nsquaredh GE 0.,gdh,COMPLEMENT=badh,NCOMPLEMENT=bdh)          & $
    IF (gdl GT 0) THEN thetasl[goodl] = test0.(k).ANGLES[goodl]                     & $
    IF (gdh GT 0) THEN thetash[goodh] = test1.(k).ANGLES[goodh]                     & $
    IF (bdl GT 0) THEN vphasel[badl] = d                                            & $
    IF (bdh GT 0) THEN vphaseh[badh] = d                                            & $
    IF (bdl GT 0) THEN knumberl[badl] = d                                           & $
    IF (bdh GT 0) THEN knumberh[badh] = d                                           & $
    IF (bdl GT 0) THEN polarlb[badl] = d                                            & $
    IF (bdh GT 0) THEN polarhb[badh] = d                                            & $
    dumbl     = CREATE_STRUCT(tags,nsquaredl,vphasel,resconel,knumberl,polarlb,[flow,fhigh],thetasl)  & $
    dumbh     = CREATE_STRUCT(tags,nsquaredh,vphaseh,resconeh,knumberh,polarhb,[flow,fhigh],thetash)  & $
    str_element,dumbl0,kstr,dumbl,/ADD_REPLACE                                      & $
    str_element,dumbh0,kstr,dumbh,/ADD_REPLACE                                      & $
  ENDFOR                                                                            & $
  str_element,stats_low,jstr,dumbl0,/ADD_REPLACE                                    & $
  str_element,stats_high,jstr,dumbh0,/ADD_REPLACE                                   & $
  dumbl0 = 0                                                                        & $
  dumbh0 = 0                                                                        & $
ENDFOR                                                                              & $
jj += 1L

stats_low_0211  = stats_low
stats_high_0211 = stats_high
DELVAR,dumbl0,dumbh0,dumbl,dumbh,stats_low,stats_high

mform      = '(";",a30,f10.1,f14.1,a1,f4.1,f14.3,a2,f9.3,f15.3,a2,f9.3,f12.3,2a10)'
sform      = '(f12.3,"-",f12.3)'
kform      = '(f12.4,"-",f12.4)'
fform      = '(f12.3)'
pol_rl     = ['LH','RH']
FOR j=0L, n_uq DO BEGIN                                                               $
  jstr    = 'T'+STRTRIM(j,2)                                                        & $
  scet0   = scet_0211[j]                                                            & $
  test0   = stats_low_0211.(j)                                                      & $
  test1   = stats_high_0211.(j)                                                     & $
  n_fr    = N_TAGS(test0) - 1L                                                      & $
  FOR k=0L, n_fr DO BEGIN                                                             $
    vphasel   = test0.(k).VPHASE*1d-3                                               & $
    vphaseh   = test1.(k).VPHASE*1d-3                                               & $
    knumberl  = test0.(k).WAVE_NUMBER*1d3                                           & $
    knumberh  = test1.(k).WAVE_NUMBER*1d3                                           & $
    lambda_l  = ((2d0*!DPI)/knumberl)[SORT((2d0*!DPI)/knumberl)]                    & $
    lambda_h  = ((2d0*!DPI)/knumberh)[SORT((2d0*!DPI)/knumberh)]                    & $
    polarz_l  = minmax(test0.(k).POLARIZATION)                                      & $
    polarz_h  = minmax(test1.(k).POLARIZATION)                                      & $
    polarizel = pol_rl[polarz_l GT 0]                                               & $
    polarizeh = pol_rl[polarz_h GT 0]                                               & $
    mnthkb    = MIN(thkbstr.(j).(k).(0),/NAN)                                       & $
    mxthkb    = MAX(thkbstr.(j).(k).(0),/NAN)                                       & $
    deltaf    = test1.(k).FREQ_RANGE/(2d0*!DPI)                                     & $
    thetal    = test0.(k).THETAS                                                    & $
    thetah    = test1.(k).THETAS                                                    & $
    IF (FINITE(mnthkb) EQ 0) THEN mnthkb = f                                        & $
    IF (FINITE(mxthkb) EQ 0) THEN mxthkb = f                                        & $
    IF (mnthkb EQ mxthkb) THEN mxthkb = test0.(k).THETA_RES[0]                      & $
    goodl     = WHERE(thetal LE mxthkb[0] AND thetal GE mnthkb[0],gdl)              & $
    goodh     = WHERE(thetah LE mxthkb[0] AND thetah GE mnthkb[0],gdh)              & $
    IF (gdl GT 0) THEN deltathl = minmax(thetal[goodl])   ELSE deltathl = [f,f]     & $
    IF (gdh GT 0) THEN deltathh = minmax(thetah[goodh])   ELSE deltathh = [f,f]     & $
    IF (gdl GT 0) THEN vphasel  = minmax(vphasel[goodl])  ELSE vphasel  = [f,f]     & $
    IF (gdh GT 0) THEN vphaseh  = minmax(vphaseh[goodh])  ELSE vphaseh  = [f,f]     & $
    IF (gdl GT 0) THEN lambda_l = minmax(lambda_l[goodl]) ELSE lambda_l = [f,f]     & $
    IF (gdh GT 0) THEN lambda_h = minmax(lambda_h[goodh]) ELSE lambda_h = [f,f]     & $
    PRINT,FORMAT=mform,scet0,deltaf[0],deltathl[0],'-',deltathl[1],vphasel[0],' -',vphasel[1],lambda_l[0],' -',lambda_l[1],test0.(k).THETA_RES[0],polarizel  & $
    PRINT,FORMAT=mform,scet0,deltaf[1],deltathh[0],'-',deltathh[1],vphaseh[0],' -',vphaseh[1],lambda_h[0],' -',lambda_h[1],test1.(k).THETA_RES[0],polarizeh
    
;-------------------------------------------------------------------------------------------------------------------------------------------------
;      Date        Time              Freq            Theta               Vphase                     Lambda         Res. Cone       Polarization
;                                    (Hz)            (deg)               (km/s)                      (km)            (deg)
;=================================================================================================================================================
;    2000/02/11 23:33:56.491 UT       7.0           5.9-44.5       420.677 -  497.767         23.051 -   59.575      89.135        RH        RH
;    2000/02/11 23:33:56.491 UT      20.0           5.9-44.5       688.261 -  819.814         13.392 -   34.773      87.921        RH        RH
;    2000/02/11 23:33:56.491 UT       5.0          79.1-89.4        85.607 -  189.498         84.354 -   85.130      89.382        RH        RH
;    2000/02/11 23:33:56.491 UT      30.0          79.1-86.5        31.288 -  366.971         32.964 -   33.111      86.540        RH        RH
;    2000/02/11 23:33:56.491 UT      60.0           9.1-81.1       240.974 - 1342.697          9.539 -   22.537      82.687        RH        RH
;    2000/02/11 23:33:56.491 UT     200.0           9.1-64.4        89.723 - 1970.801          4.912 -    9.965      64.488        RH        RH
;    2000/02/11 23:33:56.491 UT     120.0           9.3-31.4      1578.964 - 1747.438          6.662 -   11.644      75.063        RH        RH
;    2000/02/11 23:33:56.491 UT     200.0           9.3-31.4      1716.753 - 1969.912          4.957 -    8.438      64.488        RH        RH
;    2000/02/11 23:33:58.351 UT       7.0          86.2-89.1        77.274 -  127.392         69.042 -   69.114      89.119        RH        RH
;    2000/02/11 23:33:58.351 UT      20.0          86.2-87.8        17.727 -  136.808         39.835 -   39.843      87.866        RH        RH
;    2000/02/11 23:33:58.351 UT       5.0          35.9-84.1       139.672 -  371.003         63.223 -   82.305      89.371        RH        RH
;    2000/02/11 23:33:58.351 UT      30.0          35.9-84.1       199.189 -  859.133         25.102 -   32.077      86.465        RH        RH
;    2000/02/11 23:33:58.351 UT      60.0           3.8-22.1      1253.401 - 1308.221          5.985 -   14.100      82.544        RH        RH
;    2000/02/11 23:33:58.351 UT     200.0           3.8-22.1      1789.241 - 1915.250          3.095 -    7.080      63.967        RH        RH
;    2000/02/11 23:33:58.351 UT     120.0           7.5-30.3      1538.538 - 1694.399          5.839 -   11.114      74.771        RH        RH
;    2000/02/11 23:33:58.351 UT     200.0           7.5-30.3      1669.576 - 1904.381          4.310 -    8.031      63.967        RH        RH
;    2000/02/11 23:34:00.731 UT       3.0          68.6-89.5        79.598 -  189.469         99.170 -  102.803      89.597        RH        RH
;    2000/02/11 23:34:00.731 UT      20.0          68.6-87.7        11.732 -  438.974         36.692 -   37.798      87.671        RH        RH
;    2000/02/11 23:34:00.731 UT       3.0          19.9-89.5        79.598 -  299.016         61.130 -  102.803      89.597        RH        RH
;    2000/02/11 23:34:00.731 UT      30.0          19.9-86.1        33.392 -  882.864         18.254 -   30.422      86.198        RH        RH
;    2000/02/11 23:34:00.731 UT      30.0           5.9-36.2       812.455 -  910.101         10.070 -   23.912      86.198        RH        RH
;    2000/02/11 23:34:00.731 UT     200.0           5.9-36.2      1417.141 - 1767.209          3.612 -    8.001      62.094        RH        RH
;    2000/02/11 23:34:27.503 UT      50.0           1.1-26.5      1310.288 - 1391.802          4.101 -   19.145      85.662        RH        RH
;    2000/02/11 23:34:27.503 UT     250.0           1.1-26.5      2285.970 - 2514.208          1.748 -    7.855      66.730        RH        RH
;    2000/02/11 23:34:29.065 UT      40.0           3.7-12.9      1241.811 - 1257.428          8.275 -   15.265      86.647        RH        RH
;    2000/02/11 23:34:29.065 UT     250.0           3.7-12.9      2470.042 - 2518.591          3.139 -    5.725      66.869        RH        RH
;    2000/02/12 00:14:21.709 UT      60.0           3.2-16.6      1078.758 - 1104.096          4.636 -   10.333      83.340        RH        RH
;    2000/02/12 00:14:21.709 UT     150.0           3.2-16.6      1512.840 - 1557.751          2.891 -    6.327      72.852        RH        RH
;    2000/02/12 00:26:17.217 UT      36.0           7.0-14.5       857.554 -  869.299          8.837 -   12.587      85.280        RH        RH
;    2000/02/12 00:26:17.217 UT     100.0           7.0-14.5      1297.719 - 1319.163          5.196 -    7.369      76.323        RH        RH
;    2000/02/12 00:27:19.142 UT      30.0           0.9- 8.5       829.306 -  834.152          3.765 -   11.040      86.214        RH        RH
;    2000/02/12 00:27:19.142 UT     100.0           0.9- 8.5      1369.241 - 1378.966          2.031 -    5.930      76.569        RH        RH
;-------------------------------------------------------------------------------------------------------------------------------------------------






;---------------------------------------------------------------------------------------------------
;      Date        Time                Ni          Ti            Vx              Vy             Vz
;===================================================================================================
;    1998/08/26 06:40:26.120 UT      14.147      48.250       -555.071         -2.777        -69.159
;    1998/08/26 06:40:54.941 UT      22.911     100.266       -627.834         -1.037       -147.112
;    1998/08/26 06:41:10.001 UT      21.810      75.230       -611.358          8.253       -167.555
;    1998/08/26 06:41:37.623 UT      20.740      97.926       -624.523         28.156       -172.991
;    1998/08/26 06:41:44.013 UT      19.820      94.920       -622.222         26.771       -171.121
;    1998/08/26 06:41:53.249 UT      18.489      90.192       -617.180         35.365       -172.132
;    1998/08/26 06:41:56.315 UT      18.048      90.428       -618.909         38.376       -172.310
;    1998/08/26 06:41:57.909 UT      17.818      92.303       -620.820         39.779       -171.913
;    1998/08/26 06:41:59.233 UT      17.628      90.878       -617.455         45.240       -175.425
;    1998/08/26 06:42:05.763 UT      16.687      89.882       -622.537         58.923       -179.050
;    1998/08/26 06:42:09.131 UT      16.734      89.497       -626.764         45.472       -179.093

thbn_0211  = [86.5,89.9]
dthbn_0211 = [ 2.2, 2.3]
thbn_0924  = [82.1,78.6]
dthbn_0924 = [ 2.4, 2.4]
thbn_0826  = [82.2,78.7]
dthbn_0826 = [ 3.0, 2.5]


; => Bell and Ngo, [1990]
;   => Example for 1998/08/26 06:40:26.120 UT
;   theta_kb0826_04_20  = [54.37]
;   theta_kn0826_04_20  = [39.17]
;   theta_kv0826_04_20  = [37.90]
f           = !VALUES.F_NAN
d           = !VALUES.D_NAN
c           = 2.99792458d8      ; -Speed of light in vacuum (m/s)
thbn_0826  = [82.2,78.7]
dthbn_0826 = [ 3.0, 2.5]


no        = 14.147
bo        = 17.279
f0        = 150.0
f1        = 200.0
ndat      = 1000L
kvec      = [-0.07895,-0.99658, 0.02448]
bvec      = [0.053,0.979,-0.197]
nvec      = [-0.655,0.040,-0.754]
test      = excited_cold_lhw(bo,no,f0,f1,NDAT=ndat,NVEC=nvec,BVEC=bvec,KVEC=kvec)

kvec      = kvec/NORM(kvec)
bvec      = bvec/NORM(bvec)
thkb      = ACOS(my_dot_prod(kvec,bvec,/NOM))
nsurf0    = test.NSURF_STIX92.FLOW
nsurf1    = test.NSURF_STIX92.FHIGH

; => remember the angle is from z-axis, NOT x-axis!
anglew    = DINDGEN(ndat)*(2d0*!DPI)/(ndat - 1L) + !DPI/2d0

mn0       = MIN(ABS(thkb[0] - anglew),/NAN,ln0)
PRINT, REFORM(REAL_PART(nsurf0[ln0,0]))*COS(anglew[ln0]),$
       REFORM(REAL_PART(nsurf0[ln0,0]))*SIN(anglew[ln0])

WINDOW,0,RETAIN=2,XSIZE=850,YSIZE=800
xyra = [-1.1*MAX(ABS(nsurf0),/NAN),1.1*MAX(ABS(nsurf0),/NAN)]
pstr = {POLAR:1,NODATA:1,YRANGE:xyra,XRANGE:xyra,XSTYLE:1,YSTYLE:1}
PLOT,REFORM(ABS(nsurf0[*,0])),anglew,_EXTRA=pstr
  OPLOT,REFORM(ABS(nsurf0[*,0])),anglew,/POLAR,COLOR=30
  OPLOT,REFORM(ABS(nsurf0[*,3])),anglew,/POLAR,COLOR=150,LINESTYLE=2
  OPLOT,[0d0,xyra[1]],[0d0,!DPI/2d0 - thkb[0]],/POLAR,COLOR=250

WINDOW,1,RETAIN=2,XSIZE=850,YSIZE=800
xyra = [-1.1*MAX(ABS(nsurf0),/NAN),1.1*MAX(ABS(nsurf0),/NAN)]
pstr = {POLAR:1,NODATA:1,YRANGE:xyra,XRANGE:xyra,XSTYLE:1,YSTYLE:1}
PLOT,REFORM(ABS(nsurf0[*,0])),anglew,_EXTRA=pstr
  OPLOT,REFORM(ABS(nsurf0[*,1])),anglew,/POLAR,COLOR=70
  OPLOT,REFORM(ABS(nsurf0[*,2])),anglew,/POLAR,COLOR=110,LINESTYLE=2
  OPLOT,[0d0,xyra[1]],[0d0,!DPI/2d0 - thkb[0]],/POLAR,COLOR=250


no        = 20.740
bo        = 20.645
f0        = 30.0
f1        = 130.0
ndat      = 1000L
kvec      = [-0.54803, 0.39120, 0.73934]
bvec      = [-0.548,0.391,0.739]
nvec      = [-0.655,0.040,-0.754]
test      = excited_cold_lhw(bo,no,f0,f1,NDAT=ndat,NVEC=nvec,BVEC=bvec,KVEC=kvec)

kvec      = kvec/NORM(kvec)
bvec      = bvec/NORM(bvec)
nvec      = nvec/NORM(nvec)
thkb      = ACOS(my_dot_prod(kvec,bvec,/NOM))
nsurf0    = test.NSURF_STIX92.FLOW
nsurf1    = test.NSURF_STIX92.FHIGH
; => remember the angle is from z-axis, NOT x-axis!
anglew    = DINDGEN(ndat)*(2d0*!DPI)/(ndat - 1L) + !DPI/2d0

kkxx      = 1d0*COS(!DPI/2d0 - thkb)
kkyy      = 1d0*SIN(!DPI/2d0 - thkb)
slopek    = kkyy[0]/kkxx[0]

xx        = FINDGEN(ndat)/(ndat - 1L)
line0     = slopek[0]*xx
linek     = slopek[0]*xx
xxi       = xx*1d-2
lineki    = interp(linek,xx,xxi,/NO_EXTRAP)

xx0       = REFORM(ABS(nsurf0[*,0]))*COS(anglew)
yy0       = REFORM(ABS(nsurf0[*,0]))*SIN(anglew)
xx1       = xxi[1L:(ndat-1L)]
yy1       = lineki[1L:(ndat-1L)]
res       = curveint(xx0,yy0,xx1,yy1)
print, res

WINDOW,0,RETAIN=2,XSIZE=850,YSIZE=800
xyra = [-1.1*MAX(ABS(nsurf0),/NAN),1.1*MAX(ABS(nsurf0),/NAN)]
pstr = {POLAR:0,NODATA:1,YRANGE:xyra,XRANGE:xyra,XSTYLE:1,YSTYLE:1}
PLOT,xx0,yy0,_EXTRA=pstr
  OPLOT,xx0,yy0,COLOR=30
  OPLOT,xx1,yy1,COLOR=250

; => Jesse's example
xa = 2d0*!dpi*dindgen(50)/49
xb = 4d0*dindgen(100)/99
ya = sin(xa)
zb = -1d-1 + 5d-1*xb - 5d-2*xb^2 + 25d-4*xb^3
res = curveint(xa,ya,xb,zb)
print, res
;       2.0098247

WINDOW,0,RETAIN=2,XSIZE=850,YSIZE=800
xyra = [0d0,1.1*MAX(ABS([xa,xb]),/NAN)]
yyra = [-1.1,1.1*MAX(ABS([ya,zb]),/NAN)]
pstr = {POLAR:0,NODATA:1,YRANGE:yyra,XRANGE:xyra,XSTYLE:1,YSTYLE:1}
PLOT,xa,ya,_EXTRA=pstr
  OPLOT,xa,ya,COLOR=30
  OPLOT,xb,zb,COLOR=250



vswu   = [-624.523,28.156,-172.991]         ; => My 3DP estimates (km/s) For 1998-08-26/06:41:37.623 UT
vswuv  = vswu/(NORM(vswu))[0]
thvb      = ACOS(my_dot_prod(vswuv,bvec,/NOM))
thnb      = ACOS(my_dot_prod(nvec,bvec,/NOM))


WINDOW,0,RETAIN=2,XSIZE=850,YSIZE=800
xyra = [-1.1*MAX(ABS(nsurf0),/NAN),1.1*MAX(ABS(nsurf0),/NAN)]
pstr = {POLAR:1,NODATA:1,YRANGE:xyra,XRANGE:xyra,XSTYLE:1,YSTYLE:1}
PLOT,REFORM(ABS(nsurf0[*,0])),anglew,_EXTRA=pstr
  OPLOT,REFORM(ABS(nsurf0[*,0])),anglew,/POLAR,COLOR=30
  OPLOT,REFORM(ABS(nsurf0[*,3])),anglew,/POLAR,COLOR=150,LINESTYLE=2
  OPLOT,[0d0,xyra[1]],[0d0,!DPI/2d0 - thkb[0]],/POLAR,COLOR=250
  OPLOT,[0d0,xyra[1]],[0d0,!DPI/2d0 - thvb[0]],/POLAR,COLOR=220
  OPLOT,[0d0,xyra[1]],[0d0,!DPI/2d0 - thnb[0]],/POLAR,COLOR=190

WINDOW,1,RETAIN=2,XSIZE=850,YSIZE=800
xyra = [-1.1*MAX(ABS(nsurf0),/NAN),1.1*MAX(ABS(nsurf0),/NAN)]
pstr = {POLAR:1,NODATA:1,YRANGE:xyra,XRANGE:xyra,XSTYLE:1,YSTYLE:1}
PLOT,REFORM(ABS(nsurf0[*,0])),anglew,_EXTRA=pstr
  OPLOT,REFORM(ABS(nsurf0[*,1])),anglew,/POLAR,COLOR=70
  OPLOT,REFORM(ABS(nsurf0[*,2])),anglew,/POLAR,COLOR=110,LINESTYLE=2
  OPLOT,[0d0,xyra[1]],[0d0,!DPI/2d0 - thkb[0]],/POLAR,COLOR=250
  OPLOT,[0d0,xyra[1]],[0d0,!DPI/2d0 - thvb[0]],/POLAR,COLOR=220
  OPLOT,[0d0,xyra[1]],[0d0,!DPI/2d0 - thnb[0]],/POLAR,COLOR=190


nroots0    = ABS(test.NROOTS_STIX92.FLOW)^2
nroots1    = ABS(test.NROOTS_STIX92.FHIGH)^2
test0      = cold_plasma_params(bo[0],no[0],FREQF=f0,NDAT=ndat)
test1      = cold_plasma_params(bo[0],no[0],FREQF=f1,NDAT=ndat)
; => Polarization of transverse E-field components  Eq. (1-42), Stix [1992]
polar0     = (nroots0 - test0.S_TERM[0])/(test0.D_TERM[0])
polar1     = (nroots1 - test1.S_TERM[0])/(test1.D_TERM[0])



no        = 14.147
bo        = 19.781
f0        = 7.0
f1        = 30.0
ndat      = 1000L
kvec      = [ 0.89282, 0.03908, 0.44872]
bvec      = [0.009,0.987,-0.133]
nvec      = [-0.655,0.040,-0.754]
test      = excited_cold_lhw(bo,no,f0,f1,NDAT=ndat,NVEC=nvec,BVEC=bvec,KVEC=kvec)

nroots0    = test.NROOTS_STIX92.FLOW^2
nroots1    = test.NROOTS_STIX92.FHIGH^2
test0      = cold_plasma_params(bo[0],no[0],FREQF=f0,NDAT=ndat)
test1      = cold_plasma_params(bo[0],no[0],FREQF=f1,NDAT=ndat)
; => Polarization of transverse E-field components  Eq. (1-42), Stix [1992]
;     polar0 < 0 = LH polarized
;     polar0 > 0 = RH polarized
polar0     = (nroots0 - test0.S_TERM[0])/(test0.D_TERM[0])
polar1     = (nroots1 - test1.S_TERM[0])/(test1.D_TERM[0])

goodrh     = WHERE(REAL_PART(polar0[*,0]) LE 5.1)
goodrh1    = WHERE(REAL_PART(polar1[*,0]) LE 5.1)
angle      = DINDGEN(ndat)*(2d0*!DPI)/(ndat - 1L)
ang_d      = (angle[goodrh]*18d1/!DPI MOD 18d1)
ang_ds     = 18d1 - ang_d
ang_d1     = (angle[goodrh1]*18d1/!DPI MOD 18d1)
ang_ds1    = 18d1 - ang_d1
gang_d     = ang_d  < ang_ds
gang_d1    = ang_d1 < ang_ds1

PRINT, MAX(gang_d,/NAN),  MEAN(gang_d,/NAN,/DOUBLE), $
       MAX(gang_d1,/NAN), MEAN(gang_d1,/NAN,/DOUBLE)

;-----------------------------------------------------------------------------------------
; => create structures of start/end times to over plot on waveforms
;-----------------------------------------------------------------------------------------
tags      = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13',$
             't14','t15','t16','t17','t18','t19','t20','t21','t22','t23','t24']
prefd     = '1998-08-26/'

jj        = 0L
; => For  4 Hz < f < 20 Hz  at  1998/08/26 06:40:26.120 UT
tr0       = time_double([prefd[0]+'06:40:26.2501',prefd[0]+'06:40:26.5269'])
kvec0     = [-0.75528, 0.55880,-0.34249]
bvec0     = [-0.09312, 0.98823, 0.11685]
bmag0     = [17.64474]
tr_str_00 = CREATE_STRUCT(tags[0L:0L],tr0)
kv_str_00 = CREATE_STRUCT(tags[0L:0L],kvec0)
bv_str_00 = CREATE_STRUCT(tags[0L:0L],bvec0)
bm_str_00 = CREATE_STRUCT(tags[0L:0L],bmag0)
tkbstr_00 = CREATE_STRUCT(tags[0L:0L],54.37)

; => For  7 Hz < f < 30 Hz  at  1998/08/26 06:40:26.120 UT
tr0       = time_double([prefd[0]+'06:40:26.2704',prefd[0]+'06:40:26.7296'])
tr1       = time_double([prefd[0]+'06:40:26.2720',prefd[0]+'06:40:26.6245'])
tr2       = time_double([prefd[0]+'06:40:26.2731',prefd[0]+'06:40:26.5776'])
tr3       = time_double([prefd[0]+'06:40:26.2741',prefd[0]+'06:40:26.5248'])
tr4       = time_double([prefd[0]+'06:40:26.6053',prefd[0]+'06:40:26.7899'])
tr5       = time_double([prefd[0]+'06:40:26.4251',prefd[0]+'06:40:26.7845'])
tr6       = time_double([prefd[0]+'06:40:26.7904',prefd[0]+'06:40:26.8896'])
tr7       = time_double([prefd[0]+'06:40:26.9253',prefd[0]+'06:40:27.0661'])
kvec0   = [ 0.88528,-0.11080, 0.45167]
kvec1   = [ 0.88917,-0.30740, 0.33895]
kvec2   = [-0.81224, 0.45489,-0.36516]
kvec3   = [-0.74506, 0.56526,-0.35408]
kvec4   = [ 0.89282, 0.03908, 0.44872]
kvec5   = [ 0.90320,-0.05326, 0.42590]
kvec6   = [-0.92841,-0.36634, 0.06200]
kvec7   = [ 0.95386, 0.21550, 0.20907]
bvec0   = [-0.07556, 0.98903, 0.05111]
bvec1   = [-0.09954, 0.98837, 0.10659]
bvec2   = [-0.09956, 0.98753, 0.11718]
bvec3   = [-0.09312, 0.98823, 0.11646]
bvec4   = [ 0.00914, 0.98721,-0.13268]
bvec5   = [-0.05223, 0.98609,-0.00412]
bvec6   = [-0.01856, 0.99266,-0.11068]
bvec7   = [ 0.02999, 0.99886,-0.03120]
bmag0   = [18.70196]
bmag1   = [18.33008]
bmag2   = [18.07262]
bmag3   = [17.71259]
bmag4   = [19.78089]
bmag5   = [19.48486]
bmag6   = [18.30282]
bmag7   = [19.01694]
tr_str_01 = CREATE_STRUCT(tags[0L:7L],tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7)
kv_str_01 = CREATE_STRUCT(tags[0L:7L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7)
bv_str_01 = CREATE_STRUCT(tags[0L:7L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6,bvec7)
bm_str_01 = CREATE_STRUCT(tags[0L:7L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6,bmag7)
tkbstr_01 = CREATE_STRUCT(tags[0L:7L],81.18,69.13,60.84,54.07,89.27,84.18,69.31,76.27)

; => For 10 Hz < f < 30 Hz  at  1998/08/26 06:40:26.120 UT
tr0       = time_double([prefd[0]+'06:40:26.3237',prefd[0]+'06:40:26.5264'])
tr1       = time_double([prefd[0]+'06:40:26.3744',prefd[0]+'06:40:26.4997'])
tr2       = time_double([prefd[0]+'06:40:26.3920',prefd[0]+'06:40:26.6000'])
tr3       = time_double([prefd[0]+'06:40:26.3920',prefd[0]+'06:40:26.5899'])
tr4       = time_double([prefd[0]+'06:40:26.6656',prefd[0]+'06:40:27.2117'])
tr5       = time_double([prefd[0]+'06:40:26.6656',prefd[0]+'06:40:27.0400'])
tr6       = time_double([prefd[0]+'06:40:26.6656',prefd[0]+'06:40:27.0197'])
kvec0   = [ 0.97753,-0.19375, 0.08310]
kvec1   = [ 0.98265,-0.18422, 0.02172]
kvec2   = [ 0.98946,-0.09520,-0.10915]
kvec3   = [-0.98757, 0.10656, 0.11557]
kvec4   = [ 0.93488,-0.22788, 0.27217]
kvec5   = [-0.93604, 0.22445,-0.27100]
kvec6   = [-0.93492, 0.22550,-0.27399]
bvec0   = [-0.09959, 0.98680, 0.12427]
bvec1   = [-0.10322, 0.98548, 0.13300]
bvec2   = [-0.11300, 0.98505, 0.12696]
bvec3   = [-0.11326, 0.98465, 0.13068]
bvec4   = [ 0.02046, 0.99382,-0.06466]
bvec5   = [ 0.01502, 0.99164,-0.10498]
bvec6   = [ 0.01290, 0.99125,-0.10946]
bmag0   = [17.95993]
bmag1   = [18.05028]
bmag2   = [18.90074]
bmag3   = [18.84022]
bmag4   = [18.93319]
bmag5   = [19.00311]
bmag6   = [19.00202]
tr_str_02 = CREATE_STRUCT(tags[0L:6L],tr0,tr1,tr2,tr3,tr4,tr5,tr6)
kv_str_02 = CREATE_STRUCT(tags[0L:6L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6)
bv_str_02 = CREATE_STRUCT(tags[0L:6L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6)
bm_str_02 = CREATE_STRUCT(tags[0L:6L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6)
tkbstr_02 = CREATE_STRUCT(tags[0L:6L],73.85,73.73,77.32,76.59,77.00,76.29,76.03)

; => For 40 Hz < f < 400 Hz  at  1998/08/26 06:40:26.120 UT
tr0       = time_double([prefd[0]+'06:40:26.5301',prefd[0]+'06:40:26.6309'])
tr1       = time_double([prefd[0]+'06:40:26.5301',prefd[0]+'06:40:26.6245'])
tr2       = time_double([prefd[0]+'06:40:26.5536',prefd[0]+'06:40:26.6245'])
tr3       = time_double([prefd[0]+'06:40:26.5547',prefd[0]+'06:40:26.6197'])
tr4       = time_double([prefd[0]+'06:40:27.0645',prefd[0]+'06:40:27.1019'])
tr5       = time_double([prefd[0]+'06:40:27.0645',prefd[0]+'06:40:27.1008'])
tr6       = time_double([prefd[0]+'06:40:27.0672',prefd[0]+'06:40:27.1008'])
tr7       = time_double([prefd[0]+'06:40:27.0693',prefd[0]+'06:40:27.0896'])
tr8       = time_double([prefd[0]+'06:40:27.0891',prefd[0]+'06:40:27.0992'])
tr9       = time_double([prefd[0]+'06:40:27.1109',prefd[0]+'06:40:27.1189'])
kvec0   = [-0.94571,-0.32443, 0.01933]
kvec1   = [-0.95320,-0.30214, 0.01062]
kvec2   = [-0.94307,-0.33022, 0.03975]
kvec3   = [-0.95488,-0.29440, 0.03924]
kvec4   = [ 0.22309,-0.97434,-0.02993]
kvec5   = [ 0.22294,-0.97431,-0.03192]
kvec6   = [ 0.22949,-0.97296,-0.02617]
kvec7   = [-0.20060, 0.97763, 0.06322]
kvec8   = [ 0.36635,-0.92961, 0.04006]
kvec9   = [ 0.59689,-0.79017, 0.13910]
bvec0   = [-0.11065, 0.98948, 0.07512]
bvec1   = [-0.11394, 0.98892, 0.08174]
bvec2   = [-0.11069, 0.99045, 0.06727]
bvec3   = [-0.11325, 0.99007, 0.07160]
bvec4   = [ 0.03830, 0.99924,-0.00150]
bvec5   = [ 0.03849, 0.99923,-0.00180]
bvec6   = [ 0.03801, 0.99925,-0.00103]
bvec7   = [ 0.03964, 0.99920,-0.00365]
bvec8   = [ 0.03426, 0.99940, 0.00498]
bvec9   = [ 0.02693, 0.99950, 0.01675]
bmag0   = [19.95038]
bmag1   = [19.94608]
bmag2   = [20.05509]
bmag3   = [20.06384]
bmag4   = [18.88103]
bmag5   = [18.88249]
bmag6   = [18.87871]
bmag7   = [18.89113]
bmag8   = [18.84988]
bmag9   = [18.79719]
tr_str_03 = CREATE_STRUCT(tags[0L:9L],tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9)
kv_str_03 = CREATE_STRUCT(tags[0L:9L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9)
bv_str_03 = CREATE_STRUCT(tags[0L:9L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6,bvec7,bvec8,bvec9)
bm_str_03 = CREATE_STRUCT(tags[0L:9L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6,bmag7,bmag8,bmag9)
tkbstr_03 = CREATE_STRUCT(tags[0L:9L],77.59,79.09,77.29,79.60,15.20,15.22,15.53,14.38,23.61,39.52)

; => For 60 Hz < f < 500 Hz  at  1998/08/26 06:40:26.120 UT
tr_str_04 = 0
kv_str_04 = 0
bv_str_04 = 0
bm_str_04 = 0
tkbstr_04 = 0

; => For 60 Hz < f < 200 Hz  at  1998/08/26 06:40:26.120 UT
tr0       = time_double([prefd[0]+'06:40:26.5813',prefd[0]+'06:40:26.6197'])
tr1       = time_double([prefd[0]+'06:40:26.6768',prefd[0]+'06:40:26.7147'])
tr2       = time_double([prefd[0]+'06:40:26.8784',prefd[0]+'06:40:26.9248'])
tr3       = time_double([prefd[0]+'06:40:27.0640',prefd[0]+'06:40:27.0992'])
tr4       = time_double([prefd[0]+'06:40:27.1056',prefd[0]+'06:40:27.1184'])
kvec0   = [-0.97078,-0.01012, 0.23974]
kvec1   = [-0.65773, 0.44369,-0.60872]
kvec2   = [-0.73401,-0.65436,-0.18178]
kvec3   = [ 0.25802,-0.96360,-0.06999]
kvec4   = [ 0.33709,-0.93821,-0.07830]
bvec0   = [-0.10111, 0.99330, 0.04603]
bvec1   = [ 0.01916, 0.98800,-0.15250]
bvec2   = [-0.02029, 0.99807,-0.05769]
bvec3   = [ 0.03887, 0.99922,-0.00242]
bvec4   = [ 0.02790, 0.99949, 0.01520]
bmag0   = [20.07243]
bmag1   = [19.93110]
bmag2   = [18.53309]
bmag3   = [18.88544]
bmag4   = [18.80395]
tr_str_05 = CREATE_STRUCT(tags[0L:4L],tr0,tr1,tr2,tr3,tr4)
kv_str_05 = CREATE_STRUCT(tags[0L:4L],kvec0,kvec1,kvec2,kvec3,kvec4)
bv_str_05 = CREATE_STRUCT(tags[0L:4L],bvec0,bvec1,bvec2,bvec3,bvec4)
bm_str_05 = CREATE_STRUCT(tags[0L:4L],bmag0,bmag1,bmag2,bmag3,bmag4)
tkbstr_05 = CREATE_STRUCT(tags[0L:4L],84.31,58.76,51.12,17.70,21.64)

; => For 60 Hz < f < 150 Hz  at  1998/08/26 06:40:26.120 UT
tr0       = time_double([prefd[0]+'06:40:27.0528',prefd[0]+'06:40:27.1051'])
kvec0   = [ 0.23114,-0.97065,-0.06637]
bvec0   = [ 0.03983, 0.99915,-0.00396]
bmag0   = [18.89349]
tr_str_06 = CREATE_STRUCT(tags[0L:0L],tr0)
kv_str_06 = CREATE_STRUCT(tags[0L:0L],kvec0)
bv_str_06 = CREATE_STRUCT(tags[0L:0L],bvec0)
bm_str_06 = CREATE_STRUCT(tags[0L:0L],bmag0)
tkbstr_06 = CREATE_STRUCT(tags[0L:0L],16.19)

; => For 150 Hz < f < 200 Hz  at  1998/08/26 06:40:26.120 UT
tr0       = time_double([prefd[0]+'06:40:26.7200',prefd[0]+'06:40:26.8000'])
tr1       = time_double([prefd[0]+'06:40:26.7301',prefd[0]+'06:40:26.7899'])
tr2       = time_double([prefd[0]+'06:40:26.7301',prefd[0]+'06:40:26.7659'])
tr3       = time_double([prefd[0]+'06:40:27.0325',prefd[0]+'06:40:27.0725'])
kvec0   = [-0.07895,-0.99658, 0.02448]
kvec1   = [-0.06465,-0.99725, 0.03609]
kvec2   = [-0.02118,-0.99832, 0.05399]
kvec3   = [-0.23192,-0.97041,-0.06713]
bvec0   = [ 0.05342, 0.97874,-0.19698]
bvec1   = [ 0.05889, 0.97723,-0.20328]
bvec2   = [ 0.06308, 0.97619,-0.20715]
bvec3   = [ 0.04915, 0.99858,-0.01916]
bmag0   = [19.33826]
bmag1   = [19.36724]
bmag2   = [19.53251]
bmag3   = [18.97081]
tr_str_07 = CREATE_STRUCT(tags[0L:3L],tr0,tr1,tr2,tr3)
kv_str_07 = CREATE_STRUCT(tags[0L:3L],kvec0,kvec1,kvec2,kvec3)
bv_str_07 = CREATE_STRUCT(tags[0L:3L],bvec0,bvec1,bvec2,bvec3)
bm_str_07 = CREATE_STRUCT(tags[0L:3L],bmag0,bmag1,bmag2,bmag3)
tkbstr_07 = CREATE_STRUCT(tags[0L:3L],10.12, 9.70, 9.22,17.81)


tr_str_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4','T5','T6','T7'],tr_str_00,$
                           tr_str_01,tr_str_02,tr_str_03,tr_str_04,tr_str_05, $
                           tr_str_06,tr_str_07)
kv_str_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4','T5','T6','T7'],kv_str_00,$
                           kv_str_01,kv_str_02,kv_str_03,kv_str_04,kv_str_05, $
                           kv_str_06,kv_str_07)
bv_str_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4','T5','T6','T7'],bv_str_00,$
                           bv_str_01,bv_str_02,bv_str_03,bv_str_04,bv_str_05, $
                           bv_str_06,bv_str_07)
bm_str_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4','T5','T6','T7'],bm_str_00,$
                           bm_str_01,bm_str_02,bm_str_03,bm_str_04,bm_str_05, $
                           bm_str_06,bm_str_07)
tkbstr_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4','T5','T6','T7'],tkbstr_00,$
                           tkbstr_01,tkbstr_02,tkbstr_03,tkbstr_04,tkbstr_05, $
                           tkbstr_06,tkbstr_07)

tags      = ['t0']

tr_str    = CREATE_STRUCT(tags,tr_str_0)
kv_str    = CREATE_STRUCT(tags,kv_str_0)
bv_str    = CREATE_STRUCT(tags,bv_str_0)
bm_str    = CREATE_STRUCT(tags,bm_str_0)
tkbstr    = CREATE_STRUCT(tags,tkbstr_0)
lfc1      = [4d0,7d0,1d1,4d1,6d1,6d1,6d1,15d1]   ; => For 1998-08-26/06:40:26.120 UT
hfc1      = [2d1,3d1,3d1,4d2,5d2,2d2,15d1,20d1]  ; => For 1998-08-26/06:40:26.120 UT
lf_str    = CREATE_STRUCT(tags,lfc1)
hf_str    = CREATE_STRUCT(tags,hfc1)


n_uq      = N_TAGS(tr_str) - 1L
no        = REPLICATE(14.147,n_uq+1)
f         = !VALUES.F_NAN
d         = !VALUES.D_NAN
c         = 2.99792458d8      ; -Speed of light in vacuum (m/s)
thbn_0826 = [82.2,78.7]
chi       = (9d1 - thbn_0826[0])*!DPI/18d1
cchi      = COS(chi)
schi      = SIN(chi)
cchi2     = cchi^2
schi2     = schi^2
c2chi     = COS(2d0*chi)
s2chi     = SIN(2d0*chi)
ndat      = 1000L
dummy     = REPLICATE(d,ndat)

; =>  j = abcissa for each TDSS event
; =>  k = abcissa for each frequency range for filters
; =>  p = " " theta_kB
ndat      = 1000L
anglew    = DINDGEN(ndat)*(2d0*!DPI)/(ndat - 1L) + !DPI/2d0
jj        = 0L
FOR j=0L, n_uq DO BEGIN                                                           $
  jstr       = 'T'+STRTRIM(j,2)                                                 & $
  lfc0       = lf_str.(j)                                                       & $
  hfc0       = hf_str.(j)                                                       & $
  tr_00      = tr_str.(j)                                                       & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                            & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    kstr       = 'T'+STRTRIM(k,2)                                               & $
    tr_0       = tr_00.(k)                                                      & $
    nsurfs0    = DCOMPLEX(0,0)                                                  & $
    nsurfs1    = DCOMPLEX(0,0)                                                  & $
    k_perp     = 0d0                                                            & $
    k_para     = 0d0                                                            & $
    IF (SIZE(tr_0,/TYPE) NE 8L) THEN GOTO,JUMP_FREE                             & $
    n_tras     = N_TAGS(tr_0)                                                   & $
    f0         = lfc0[k]                                                        & $
    f1         = hfc0[k]                                                        & $
    nsurfs0    = DCOMPLEXARR(n_tras,ndat,4L)                                    & $
    nsurfs1    = DCOMPLEXARR(n_tras,ndat,4L)                                    & $
    k_perp     = DBLARR(n_tras)                                                 & $
    k_para     = DBLARR(n_tras)                                                 & $
    FOR p=0L, n_tras - 1L DO BEGIN                                                $
      kvec0      = kv_str.(j).(k).(p)                                           & $
      bvec0      = bv_str.(j).(k).(p)                                           & $
      bo         = bm_str.(j).(k).(p)                                           & $
      kvec0      = kvec0/NORM(kvec0)                                            & $
      bvec0      = bvec0/NORM(bvec0)                                            & $
      thkb       = !DPI/2d0 - ACOS(my_dot_prod(kvec0,bvec0,/NOM))               & $
      kkperp     = COS(thkb[0])                                                 & $
      kkpara     = SIN(thkb[0])                                                 & $
      test       = excited_cold_lhw(bo,no,f0,f1,NDAT=ndat,NVEC=nvec,BVEC=bvec0,KVEC=kvec0)  & $
      nsurf0     = test.NSURF_STIX92.FLOW                                       & $
      nsurf1     = test.NSURF_STIX92.FHIGH                                      & $
      k_perp[p]  = kkperp                                                       & $
      k_para[p]  = kkpara                                                       & $
      nsurfs0[p,*,*] = nsurf0                                                   & $
      nsurfs1[p,*,*] = nsurf1                                                   & $
    ENDFOR                                                                      & $
    JUMP_FREE:                                                                  & $
    str_element,nsurf_0,kstr,nsurfs0,/ADD_REPLACE                               & $
    str_element,nsurf_1,kstr,nsurfs1,/ADD_REPLACE                               & $
    str_element,kvect_0,kstr,[[k_para],[k_perp]],/ADD_REPLACE                   & $
  ENDFOR                                                                        & $
  str_element,nsurf_sl,jstr,nsurf_0,/ADD_REPLACE                                & $
  str_element,nsurf_sh,jstr,nsurf_1,/ADD_REPLACE                                & $
  str_element,kvect_s,kstr,kvect_0,/ADD_REPLACE                                 & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    str_element,nsurf_0,kstr,/DELETE                                            & $
    str_element,nsurf_1,kstr,/DELETE                                            & $
    str_element,kvect_0,kstr,/DELETE                                            & $
  ENDFOR                                                                        & $
ENDFOR                                                                          & $
jj += 1L


DELVAR,k_perp,k_para,nsurfs0,nsurfs1,nsurf_0,nsurf_1,kvect_0

xx        = FINDGEN(ndat)/(ndat - 1L)
anglew    = ((DINDGEN(ndat)*(2d0*!DPI)/(ndat - 1L) + !DPI/2d0) # REPLICATE(1d0,4))
jj        = 0L
FOR j=0L, n_uq DO BEGIN                                                           $
  jstr       = 'T'+STRTRIM(j,2)                                                 & $
  tr_00      = tr_str.(j)                                                       & $
  lfc0       = lf_str.(j)                                                       & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                            & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    kstr       = 'T'+STRTRIM(k,2)                                               & $
    tr_0       = tr_00.(k)                                                      & $
    nsurfs0    = DCOMPLEX(0,0)                                                  & $
    nsurfs1    = DCOMPLEX(0,0)                                                  & $
    k_perp     = 0d0                                                            & $
    k_para     = 0d0                                                            & $
    IF (SIZE(tr_0,/TYPE) NE 8L) THEN GOTO,JUMP_FREE                             & $
    n_tras     = N_TAGS(tr_0)                                                   & $
    nnsxx0     = DBLARR(n_tras,ndat,4L)                                         & $
    nnsyy0     = DBLARR(n_tras,ndat,4L)                                         & $
    nnsxx1     = DBLARR(n_tras,ndat,4L)                                         & $
    nnsyy1     = DBLARR(n_tras,ndat,4L)                                         & $
    k_line0    = DBLARR(n_tras,ndat)                                            & $
    x_vals     = DBLARR(n_tras,ndat)                                            & $
    FOR p=0L, n_tras - 1L DO BEGIN                                                $
      nsurf0   = REFORM(nsurf_sl.(j).(k)[p,*,*])                                & $
      nsurf1   = REFORM(nsurf_sh.(j).(k)[p,*,*])                                & $
      xx0      = xx*MAX([ABS(nsurf0),ABS(nsurf1)]*1.1,/NAN)                     & $
      kx0      = REFORM(kvect_s.(j).(k)[p,1])                                   & $
      ky0      = REFORM(kvect_s.(j).(k)[p,0])                                   & $
      nx00     = REFORM(ABS(nsurf0))*COS(anglew)                                & $
      ny00     = REFORM(ABS(nsurf0))*SIN(anglew)                                & $
      nx10     = REFORM(ABS(nsurf1))*COS(anglew)                                & $
      ny10     = REFORM(ABS(nsurf1))*SIN(anglew)                                & $
      slope0   = ky0[0]/kx0[0]                                                  & $
      line00   = slope0[0]*xx                                                   & $
      line0k   = interp(line00,xx,xx0,/NO_EXTRAP)                               & $
      k_line0[p,*]  = line0k                                                    & $
      x_vals[p,*]   = xx0                                                       & $
      nnsxx0[p,*,*] = nx00                                                      & $
      nnsxx1[p,*,*] = nx10                                                      & $
      nnsyy0[p,*,*] = ny00                                                      & $
      nnsyy1[p,*,*] = ny10                                                      & $
    ENDFOR                                                                      & $
    JUMP_FREE:                                                                  & $
    str_element,nsurf_0x,kstr,nnsxx0,/ADD_REPLACE                               & $
    str_element,nsurf_1x,kstr,nnsxx1,/ADD_REPLACE                               & $
    str_element,nsurf_0y,kstr,nnsyy0,/ADD_REPLACE                               & $
    str_element,nsurf_1y,kstr,nnsyy1,/ADD_REPLACE                               & $
    str_element,xvals_0,kstr,x_vals,/ADD_REPLACE                                & $
    str_element,kline_0,kstr,k_line0,/ADD_REPLACE                               & $
  ENDFOR                                                                        & $
  str_element,nsurf_lx,jstr,nsurf_0x,/ADD_REPLACE                               & $
  str_element,nsurf_hx,jstr,nsurf_1x,/ADD_REPLACE                               & $
  str_element,nsurf_ly,jstr,nsurf_0y,/ADD_REPLACE                               & $
  str_element,nsurf_hy,jstr,nsurf_1y,/ADD_REPLACE                               & $
  str_element,xvals_s,kstr,xvals_0,/ADD_REPLACE                                 & $
  str_element,kline_s,kstr,kline_0,/ADD_REPLACE                                 & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    str_element,nsurf_0x,kstr,/DELETE                                           & $
    str_element,nsurf_1x,kstr,/DELETE                                           & $
    str_element,nsurf_0y,kstr,/DELETE                                           & $
    str_element,nsurf_1y,kstr,/DELETE                                           & $
    str_element,kline_0,kstr,/DELETE                                            & $
    str_element,xvals_0,kstr,/DELETE                                            & $
  ENDFOR                                                                        & $
ENDFOR                                                                          & $
jj += 1L

DELVAR,nsurf_0x,nsurf_1x,nsurf_0y,nsurf_1y,kline_0,k_line0,nnsxx0,nnsxx1,nnsyy0,nnsyy1
DELVAR,line00,line0k,xx,xx0,xvals_0

; => Calculate intercept of N-surface and k-vector
jj        = 0L
FOR j=0L, n_uq DO BEGIN                                                           $
  jstr       = 'T'+STRTRIM(j,2)                                                 & $
  tr_00      = tr_str.(j)                                                       & $
  lfc0       = lf_str.(j)                                                       & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                            & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    kstr       = 'T'+STRTRIM(k,2)                                               & $
    tr_0       = tr_00.(k)                                                      & $
    ns0xy      = 0d0                                                            & $
    ns1xy      = 0d0                                                            & $
    kxy        = 0d0                                                            & $
    IF (SIZE(tr_0,/TYPE) NE 8L) THEN GOTO,JUMP_FREE                             & $
    n_tras     = N_TAGS(tr_0)                                                   & $
    ns0xy      = DBLARR(n_tras,2L,4L)                                           & $
    ns1xy      = DBLARR(n_tras,2L,4L)                                           & $
    kxy0       = DBLARR(n_tras,2L,4L)                                           & $
    kxy1       = DBLARR(n_tras,2L,4L)                                           & $
    FOR p=0L, n_tras - 1L DO BEGIN                                                $
      xx0      = REFORM(xvals_s.(j).(k)[p,*])                                   & $
      kk0      = REFORM(kline_s.(j).(k)[p,*])                                   & $
      FOR i=0L, 3L DO BEGIN                                                       $
        nsxx    = REFORM(nsurf_lx.(j).(k)[p,*,i])                               & $
        nsyy    = REFORM(nsurf_ly.(j).(k)[p,*,i])                               & $
        result0 = curveint(xx0,kk0,nsxx,nsyy)                                   & $
        nsxx    = REFORM(nsurf_hx.(j).(k)[p,*,i])                               & $
        nsyy    = REFORM(nsurf_hy.(j).(k)[p,*,i])                               & $
        result1 = curveint(xx0,kk0,nsxx,nsyy)                                   & $
        kxy0[p,*,i]  = result0[*,0]                                             & $
        kxy1[p,*,i]  = result1[*,0]                                             & $
        ns0xy[p,*,i] = result0[*,1]                                             & $
        ns1xy[p,*,i] = result1[*,1]                                             & $
      ENDFOR                                                                    & $
    ENDFOR                                                                      & $
    JUMP_FREE:                                                                  & $
    str_element,ns_0xy,kstr,ns0xy,/ADD_REPLACE                                  & $
    str_element,ns_1xy,kstr,ns1xy,/ADD_REPLACE                                  & $
    str_element,kxy_0,kstr,kxy0,/ADD_REPLACE                                    & $
    str_element,kxy_1,kstr,kxy1,/ADD_REPLACE                                    & $
  ENDFOR                                                                        & $
  str_element,ns_xyl,jstr,ns_0xy,/ADD_REPLACE                                   & $
  str_element,ns_xyh,jstr,ns_1xy,/ADD_REPLACE                                   & $
  str_element,kxy_ls,jstr,kxy_0,/ADD_REPLACE                                    & $
  str_element,kxy_hs,jstr,kxy_1,/ADD_REPLACE                                    & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    str_element,ns_0xy,kstr,/DELETE                                             & $
    str_element,ns_1xy,kstr,/DELETE                                             & $
    str_element,kxy_0,kstr,/DELETE                                              & $
    str_element,kxy_1,kstr,/DELETE                                              & $
  ENDFOR                                                                        & $
ENDFOR                                                                          & $
jj += 1L

DELVAR,result0,result1,nsxx,nsyy,kxy0,kxy1,ns0xy,ns1xy,ns_0xy,ns_1xy,kxy_0,kxy_1



; => Plot intercept of N-surface and k-vector
jj        = 0L
FOR j=0L, n_uq DO BEGIN                                                           $
  jstr       = 'T'+STRTRIM(j,2)                                                 & $
  tr_00      = tr_str.(j)                                                       & $
  lfc0       = lf_str.(j)                                                       & $
  hfc0       = hf_str.(j)                                                       & $
  fwl_str    = STRTRIM(STRING(FORMAT='(f15.1)',lfc0),2)                         & $
  fwh_str    = STRTRIM(STRING(FORMAT='(f15.1)',hfc0),2)                         & $
  fil_strl   = fwl_str[*]+'Hz_'                                                 & $
  fil_strh   = fwh_str[*]+'Hz_'                                                 & $
  fil_str    = fwl_str[*]+'-'+fwh_str[*]+'Hz_'                                  & $
  fil_stl    = STRARR(N_ELEMENTS(fil_strl))                                     & $
  fil_sth    = STRARR(N_ELEMENTS(fil_strh))                                     & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                            & $
  FOR m=0L, n_fr DO fil_stl[m] = STRMID(fil_strl[m],0L,STRLEN(fil_strl[m])-1L)  & $
  FOR m=0L, n_fr DO fil_sth[m] = STRMID(fil_strh[m],0L,STRLEN(fil_strh[m])-1L)  & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    kstr       = 'T'+STRTRIM(k,2)                                               & $
    tr_0       = tr_00.(k)                                                      & $
    IF (SIZE(tr_0,/TYPE) NE 8L) THEN GOTO,JUMP_FREE                             & $
    n_tras     = N_TAGS(tr_0)                                                   & $
    FOR p=0L, n_tras - 1L DO BEGIN                                                $
      tr0      = file_name_times(tr_0.(p),PREC=4)                               & $
      sfname   = tr0.F_TIME[0]+'_'+tr0.F_TIME[1]                                & $
      ttname   = tr0.UT_TIME[0]+'-'+tr0.UT_TIME[1]                              & $
      xx0      = REFORM(xvals_s.(j).(k)[p,*])                                   & $
      kk0      = REFORM(kline_s.(j).(k)[p,*])                                   & $
      FOR i=0L, 3L DO BEGIN                                                       $
        istr    = 'N!D'+STRTRIM(i,2)+'!N'+'-Surface'                            & $
        ifstr   = 'N'+STRTRIM(i,2)+'-Surface'                                   & $
        ttle    = istr[0]+' For '+ttname[0]                                     & $
        xttle   = istr[0]+' For'+' Freq: '+fil_stl[k]                           & $
        pname   = ifstr[0]+'_'+sfname[0]+'_'+fil_stl[k]                         & $
        nsxx    = REFORM(nsurf_lx.(j).(k)[p,*,i])                               & $
        nsyy    = REFORM(nsurf_ly.(j).(k)[p,*,i])                               & $
        xyil    = REFORM(ns_xyl.(j).(k)[p,*,i])                                 & $
        maxxy   = MAX(ABS([nsxx,nsyy]),/NAN)                                    & $
        xyra    = 1.1*[-1*maxxy,maxxy]                                          & $
        xyoutx  = STRTRIM(STRING(FORMAT='(f15.7)',xyil[0]),2)                   & $
        xyouty  = STRTRIM(STRING(FORMAT='(f15.7)',xyil[1]),2)                   & $
        pstr    = {NODATA:1,YRANGE:xyra,XRANGE:xyra,XSTYLE:1,YSTYLE:1}          & $
        popen,pname,/PORT                                                       & $
          PLOT,nsxx,nsyy,_EXTRA=pstr,TITLE=ttle,XTITLE=xttle                    & $
            OPLOT,nsxx,nsyy,COLOR=50L                                           & $
            OPLOT,xx0,kk0,COLOR=250L                                            & $
            OPLOT,[xyil[0],xyil[0]],[xyil[1],xyil[1]],COLOR=150L,PSYM=2         & $
            XYOUTS,.15,.75,/NORMAL,'x = '+xyoutx[0],COLOR=150L                  & $
            XYOUTS,.15,.70,/NORMAL,'y = '+xyouty[0],COLOR=150L                  & $
        pclose                                                                  & $
        ttle    = istr[0]+' For '+ttname[0]                                     & $
        xttle   = istr[0]+' For'+' Freq: '+fil_sth[k]                           & $
        pname   = ifstr[0]+'_'+sfname[0]+'_'+fil_sth[k]                         & $
        nsxx    = REFORM(nsurf_hx.(j).(k)[p,*,i])                               & $
        nsyy    = REFORM(nsurf_hy.(j).(k)[p,*,i])                               & $
        xyih    = REFORM(ns_xyh.(j).(k)[p,*,i])                                 & $
        maxxy   = MAX(ABS([nsxx,nsyy]),/NAN)                                    & $
        xyra    = 1.1*[-1*maxxy,maxxy]                                          & $
        xyoutx  = STRTRIM(STRING(FORMAT='(f15.7)',xyih[0]),2)                   & $
        xyouty  = STRTRIM(STRING(FORMAT='(f15.7)',xyih[1]),2)                   & $
        pstr    = {NODATA:1,YRANGE:xyra,XRANGE:xyra,XSTYLE:1,YSTYLE:1}          & $
        popen,pname,/PORT                                                       & $
          PLOT,nsxx,nsyy,_EXTRA=pstr,TITLE=ttle,XTITLE=xttle                    & $
            OPLOT,nsxx,nsyy,COLOR=50L                                           & $
            OPLOT,xx0,kk0,COLOR=250L                                            & $
            OPLOT,[xyih[0],xyih[0]],[xyih[1],xyih[1]],COLOR=150L,PSYM=2         & $
            XYOUTS,.15,.75,/NORMAL,'x = '+xyoutx[0],COLOR=150L                  & $
            XYOUTS,.15,.70,/NORMAL,'y = '+xyouty[0],COLOR=150L                  & $
        pclose                                                                  & $
      ENDFOR                                                                    & $
    ENDFOR                                                                      & $
    JUMP_FREE:                                                                  & $
  ENDFOR                                                                        & $
ENDFOR                                                                          & $
jj += 1L












;-----------------------------------------------------------------------------------------
; => Bell and Ngo, [1990]
;-----------------------------------------------------------------------------------------

; => Calculate n_z (i.e. parallel to Bo)
jj        = 0L
FOR j=0L, n_uq DO BEGIN                                                           $
  jstr       = 'T'+STRTRIM(j,2)                                                 & $
  lfc0       = lf_str.(j)                                                       & $
  hfc0       = hf_str.(j)                                                       & $
  tkb_00     = tkbstr.(j)                                                       & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                            & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    kstr       = 'T'+STRTRIM(k,2)                                               & $
    thkb_0     = tkb_00.(k)                                                     & $
    IF (SIZE(thkb_0,/TYPE) NE 8L) THEN GOTO,JUMP_FREE                           & $
    n_tras     = N_TAGS(thkb_0)                                                 & $
    f0         = lfc0[k]                                                        & $
    f1         = hfc0[k]                                                        & $
    test0      = cold_plasma_params(bo[j],no[j],FREQF=f0,NDAT=ndat)             & $
    test1      = cold_plasma_params(bo[j],no[j],FREQF=f1,NDAT=ndat)             & $
    angs0      = dummy                                                          & $
    angs1      = dummy                                                          & $
    nsquared0  = test0.INDEX_REF_1                                              & $
    pp0        = test0.P_TERM[0]                                                & $
    ss0        = test0.S_TERM[0]                                                & $
    rr0        = test0.R_TERM[0]                                                & $
    ll0        = test0.L_TERM[0]                                                & $
    nsquared1  = test1.INDEX_REF_1                                              & $
    pp1        = test1.P_TERM[0]                                                & $
    ss1        = test1.S_TERM[0]                                                & $
    rr1        = test1.R_TERM[0]                                                & $
    ll1        = test1.L_TERM[0]                                                & $
    good0      = WHERE(nsquared0 GE 0.,gd0,COMPLEMENT=bad0,NCOMPLEMENT=bd0)     & $
    good1      = WHERE(nsquared1 GE 0.,gd1,COMPLEMENT=bad1,NCOMPLEMENT=bd1)     & $
    IF (gd0 GT 0) THEN angs0[good0] = test0.ANGLES[good0]                       & $
    IF (gd1 GT 0) THEN angs1[good1] = test1.ANGLES[good1]                       & $
    IF (bd0 GT 0) THEN nsquared0[bad0] = d                                      & $
    IF (bd1 GT 0) THEN nsquared1[bad1] = d                                      & $
    nzz0       = DBLARR(n_tras)                                                   & $
    nzz1       = DBLARR(n_tras)                                                   & $
    FOR p=0L, n_tras - 1L DO BEGIN                                                  $
      pstr       = 'T'+STRTRIM(p,2)                                               & $
      thkb       = thkb_0.(p)[0]                                                  & $
      mn0        = MIN(ABS(thkb[0] - angs0),/NAN,ln0)                             & $
      mn1        = MIN(ABS(thkb[0] - angs1),/NAN,ln1)                             & $
      nz0        = SQRT(nsquared0[ln0])*COS(angs0[ln0]*!DPI/18d1)                 & $
      nz1        = SQRT(nsquared1[ln1])*COS(angs1[ln1]*!DPI/18d1)                 & $
      nzz0[p]    = nz0[0]                                                         & $
      nzz1[p]    = nz1[0]                                                         & $
    ENDFOR                                                                        & $
    JUMP_FREE:                                                                    & $
    str_element,nz_00,kstr,nzz0,/ADD_REPLACE                                      & $
    str_element,nz_01,kstr,nzz1,/ADD_REPLACE                                      & $
  ENDFOR                                                                          & $
  str_element,nz_0,jstr,nz_00,/ADD_REPLACE                                        & $
  str_element,nz_1,jstr,nz_01,/ADD_REPLACE                                        & $
  FOR k=0L, n_fr DO BEGIN                                                           $
    kstr       = 'T'+STRTRIM(k,2)                                                 & $
    str_element,nz_00,kstr,/DELETE                                                & $
    str_element,nz_01,kstr,/DELETE                                                & $
  ENDFOR                                                                          & $
ENDFOR                                                                            & $
jj += 1L

; => Calculate coefficients of n_x polynomial (E.q. 16)
jj        = 0L
FOR j=0L, n_uq DO BEGIN                                                           $
  jstr       = 'T'+STRTRIM(j,2)                                                 & $
  lfc0       = lf_str.(j)                                                       & $
  hfc0       = hf_str.(j)                                                       & $
  tkb_00     = tkbstr.(j)                                                       & $
  nz_00      = nz_0.(j)                                                         & $
  nz_01      = nz_1.(j)                                                         & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                            & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    kstr       = 'T'+STRTRIM(k,2)                                               & $
    thkb_0     = tkb_00.(k)                                                     & $
    nzz0       = nz_00.(k)                                                      & $
    nzz1       = nz_01.(k)                                                      & $
    IF (SIZE(thkb_0,/TYPE) NE 8L) THEN GOTO,JUMP_FREE                           & $
    n_tras     = N_TAGS(thkb_0)                                                 & $
    f0         = lfc0[k]                                                        & $
    f1         = hfc0[k]                                                        & $
    test0      = cold_plasma_params(bo[j],no[j],FREQF=f0,NDAT=ndat)             & $
    test1      = cold_plasma_params(bo[j],no[j],FREQF=f1,NDAT=ndat)             & $
    angs0      = dummy                                                          & $
    angs1      = dummy                                                          & $
    pp0        = test0.P_TERM[0]                                                & $
    ss0        = test0.S_TERM[0]                                                & $
    rr0        = test0.R_TERM[0]                                                & $
    ll0        = test0.L_TERM[0]                                                & $
    pp1        = test1.P_TERM[0]                                                & $
    ss1        = test1.S_TERM[0]                                                & $
    rr1        = test1.R_TERM[0]                                                & $
    ll1        = test1.L_TERM[0]                                                & $
    dba0       = DBLARR(n_tras,5)                                                 & $
    dba1       = DBLARR(n_tras,5)                                                 & $
    FOR p=0L, n_tras - 1L DO BEGIN                                                  $
      pstr       = 'T'+STRTRIM(p,2)                                               & $
      nz0        = nzz0[p]                                                        & $
      nz1        = nzz1[p]                                                        & $
      aa40       = ss0[0]*cchi2 + pp0[0]*schi2                                    & $
      aa30       = (pp0[0] - ss0[0])*nz0[0]*s2chi                                 & $
      aa200      = (ss0[0] + pp0[0])*nz0[0]^2 - rr0[0]*ll0[0]*cchi2               & $
      aa20       = aa200 - pp0[0]*ss0[0]*(1d0 + schi2)                            & $
      aa100      = ((pp0[0] - ss0[0])*nz0[0]^2 + rr0[0]*ll0[0] - pp0[0]*ss0[0])   & $
      aa10       = (nz0[0]*s2chi)*aa100                                           & $
      aa000      = ss0[0]*nz0[0]^4*schi2 + pp0[0]*nz0[0]^4*cchi2                  & $
      aa001      = -1d0*pp0[0]*ss0[0]*nz0[0]^2*(1d0 + cchi2)                      & $
      aa002      = pp0[0]*rr0[0]*ll0[0] - rr0[0]*ll0[0]*nz0[0]^2*schi2            & $
      aa00       = aa000 + aa001 + aa002                                          & $
      aa41       = ss1[0]*cchi2 + pp1[0]*schi2                                    & $
      aa31       = (pp1[0] - ss1[0])*nz1[0]*s2chi                                 & $
      aa210      = (ss1[0] + pp1[0])*nz1[0]^2 - rr1[0]*ll1[0]*cchi2               & $
      aa21       = aa210 - pp1[0]*ss1[0]*(1d0 + schi2)                            & $
      aa110      = ((pp1[0] - ss1[0])*nz1[0]^2 + rr1[0]*ll1[0] - pp1[0]*ss1[0])   & $
      aa11       = (nz1[0]*s2chi)*aa110                                           & $
      aa010      = ss1[0]*nz1[0]^4*schi2 + pp1[0]*nz1[0]^4*cchi2                  & $
      aa011      = -1d0*pp1[0]*ss1[0]*nz1[0]^2*(1d0 + cchi2)                      & $
      aa012      = pp1[0]*rr1[0]*ll1[0] - rr1[0]*ll1[0]*nz1[0]^2*schi2            & $
      aa01       = aa010 + aa011 + aa012                                          & $
      dba0[p,*]  = [aa00,aa10,aa20,aa30,aa40]                                     & $
      dba1[p,*]  = [aa01,aa11,aa21,aa31,aa41]                                     & $
    ENDFOR                                                                        & $
    JUMP_FREE:                                                                    & $
    str_element,aa_00,kstr,dba0,/ADD_REPLACE                                      & $
    str_element,aa_01,kstr,dba1,/ADD_REPLACE                                      & $
  ENDFOR                                                                          & $
  str_element,aa_0,jstr,aa_00,/ADD_REPLACE                                        & $
  str_element,aa_1,jstr,aa_01,/ADD_REPLACE                                        & $
  FOR k=0L, n_fr DO BEGIN                                                           $
    kstr       = 'T'+STRTRIM(k,2)                                                 & $
    str_element,aa_00,kstr,/DELETE                                                & $
    str_element,aa_01,kstr,/DELETE                                                & $
  ENDFOR                                                                          & $
ENDFOR                                                                            & $
jj += 1L

DELVAR,roots_00,roots_01,aa_00,aa_01,nz_00,nz_01


; => Calculate roots of n_x polynomial (E.q. 16)
jj        = 0L
FOR j=0L, n_uq DO BEGIN                                                           $
  jstr       = 'T'+STRTRIM(j,2)                                                 & $
  lfc0       = lf_str.(j)                                                       & $
  hfc0       = hf_str.(j)                                                       & $
  tkb_00     = tkbstr.(j)                                                       & $
  nz_00      = nz_0.(j)                                                         & $
  nz_01      = nz_1.(j)                                                         & $
  aa_00      = aa_0.(j)                                                         & $
  aa_01      = aa_1.(j)                                                         & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                            & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    kstr       = 'T'+STRTRIM(k,2)                                               & $
    thkb_0     = tkb_00.(k)                                                     & $
    IF (SIZE(thkb_0,/TYPE) NE 8L) THEN GOTO,JUMP_FREE                           & $
    n_tras     = N_TAGS(thkb_0)                                                 & $
    rts0       = DCOMPLEXARR(n_tras,4)                                            & $
    rts1       = DCOMPLEXARR(n_tras,4)                                            & $
    FOR p=0L, n_tras - 1L DO BEGIN                                                  $
      pstr       = 'T'+STRTRIM(p,2)                                               & $
      aa_s0      = REFORM(aa_00.(k)[p,*])                                         & $
      aa_s1      = REFORM(aa_01.(k)[p,*])                                         & $
      roots00    = FZ_ROOTS(aa_s0,/DOUBLE,/NO_POLISH)                             & $
      roots01    = FZ_ROOTS(aa_s1,/DOUBLE,/NO_POLISH)                             & $
      rts0[p,*]  = roots00                                                        & $
      rts1[p,*]  = roots01                                                        & $
    ENDFOR                                                                        & $
    JUMP_FREE:                                                                    & $
    str_element,roots_00,kstr,rts0,/ADD_REPLACE                                   & $
    str_element,roots_01,kstr,rts1,/ADD_REPLACE                                   & $
  ENDFOR                                                                          & $
  str_element,roots_0,jstr,roots_00,/ADD_REPLACE                                  & $
  str_element,roots_1,jstr,roots_01,/ADD_REPLACE                                  & $
  FOR k=0L, n_fr DO BEGIN                                                           $
    kstr       = 'T'+STRTRIM(k,2)                                                 & $
    str_element,roots_00,kstr,/DELETE                                             & $
    str_element,roots_01,kstr,/DELETE                                             & $
  ENDFOR                                                                          & $
ENDFOR                                                                            & $
jj += 1L

DELVAR,roots_00,roots_01,aa_00,aa_01,nz_00,nz_01















;-----------------------------------------------------------------------------------------
; => Bell and Ngo, [1990]
;-----------------------------------------------------------------------------------------
;   => Example for 1998/08/26 06:40:26.120 UT
;   theta_kb0826_04_20  = [54.37]
;   theta_kn0826_04_20  = [39.17]
;   theta_kv0826_04_20  = [37.90]
f           = !VALUES.F_NAN
d           = !VALUES.D_NAN
c           = 2.99792458d8      ; -Speed of light in vacuum (m/s)
thbn_0826  = [82.2,78.7]
dthbn_0826 = [ 3.0, 2.5]

thkb      = 54.37d0
no        = 14.147
bo        = 17.279
f0        = 4.0
f1        = 20.0
ndat      = 1000L
test0     = cold_plasma_params(bo[0],no[0],FREQF=f0,NDAT=ndat)
test1     = cold_plasma_params(bo[0],no[0],FREQF=f1,NDAT=ndat)

dummy     = REPLICATE(d,ndat)
angs0     = dummy
angs1     = dummy
nsquared0 = test0.INDEX_REF_1
nsquared1 = test1.INDEX_REF_1
good0     = WHERE(nsquared0 GE 0.,gd0,COMPLEMENT=bad0,NCOMPLEMENT=bd0)
good1     = WHERE(nsquared1 GE 0.,gd1,COMPLEMENT=bad1,NCOMPLEMENT=bd1)
IF (gd0 GT 0) THEN angs0[good0] = test0.ANGLES[good0]
IF (gd1 GT 0) THEN angs1[good1] = test1.ANGLES[good1]
IF (bd0 GT 0) THEN nsquared0[bad0] = d
IF (bd1 GT 0) THEN nsquared1[bad1] = d

mn0       = MIN(ABS(thkb[0] - angs0),/NAN,ln0)
mn1       = MIN(ABS(thkb[0] - angs1),/NAN,ln1)
nz0       = SQRT(nsquared0[ln0])*COS(angs0[ln0]*!DPI/18d1)
nz1       = SQRT(nsquared1[ln1])*COS(angs1[ln1]*!DPI/18d1)
PRINT, nz0, nz1
;       568.57097       269.71928

chi       = (9d1 - thbn_0826[0])*!DPI/18d1
cchi      = COS(chi)
schi      = SIN(chi)
cchi2     = cchi^2
schi2     = schi^2
c2chi      = COS(2d0*chi)
s2chi      = SIN(2d0*chi)

pp0       = test0.P_TERM[0]
ss0       = test0.S_TERM[0]
rr0       = test0.R_TERM[0]
ll0       = test0.L_TERM[0]
PRINT, pp0, ss0, rr0, ll0
;      -71318837.      -34113.147       557973.06      -626199.35

aa40      = ss0[0]*cchi2 + pp0[0]*schi2
aa30      = (pp0[0] - ss0[0])*nz0[0]*s2chi
aa20      = (ss0[0] + pp0[0])*nz0[0]^2 - rr0[0]*ll0[0]*cchi2 - pp0[0]*ss0[0]*(1d0 + schi2)
aa10      = (nz0[0]*s2chi)*((pp0[0] - ss0[0])*nz0[0]^2 + rr0[0]*ll0[0] - pp0[0]*ss0[0])
aa000     = ss0[0]*nz0[0]^4*schi2 + pp0[0]*nz0[0]^4*cchi2 
aa001     = -1d0*pp0[0]*ss0[0]*nz0[0]^2*(1d0 + cchi2) + pp0[0]*rr0[0]*ll0[0]
aa002     = -1d0*rr0[0]*ll0[0]*nz0[0]^2*schi2
aa00      = aa000 + aa001 + aa002
PRINT, aa40, aa30, aa20, aa10, aa00
;      -1347087.3  -1.0899439e+10  -2.5201233e+13  -3.9489094e+15   1.6046559e+19

nnx00es   = (-1d0*aa30[0] + SQRT(aa30[0]^2 - 4d0*aa40[0]*aa20[0]))/(2d0*aa40[0])
nnx01es   = (-1d0*aa30[0] - SQRT(aa30[0]^2 - 4d0*aa40[0]*aa20[0]))/(2d0*aa40[0])
nnx00em   = (-1d0*aa10[0] + SQRT(aa10[0]^2 - 4d0*aa20[0]*aa00[0]))/(2d0*aa20[0])
nnx01em   = (-1d0*aa10[0] - SQRT(aa10[0]^2 - 4d0*aa20[0]*aa00[0]))/(2d0*aa20[0])
PRINT, nnx00es, nnx01es, nnx00em, nnx01em
;            -NaN            -NaN      -880.14265       723.44756
PRINT, nnx00es*(f0*2d0*!DPI)/c, nnx01es*(f0*2d0*!DPI)/c, $
       nnx00em*(f0*2d0*!DPI)/c, nnx01em*(f0*2d0*!DPI)/c
;            -NaN            -NaN  -7.3785704e-05   6.0649359e-05
PRINT, (2d-3*!DPI)/(nnx00es*(f0*2d0*!DPI)/c), (2d-3*!DPI)/(nnx01es*(f0*2d0*!DPI)/c), $
       (2d-3*!DPI)/(nnx00em*(f0*2d0*!DPI)/c), (2d-3*!DPI)/(nnx01em*(f0*2d0*!DPI)/c)
;            -NaN            -NaN      -85.154508       103.59854

roots00   = FZ_ROOTS([aa00,aa10,aa20,aa30,aa40],/DOUBLE,/NO_POLISH)
PRINT, roots00
;(      -3752.3170,       1007.8858)(      -3752.3170,      -1007.8858)(      -1228.7035,       0.0000000)
;(       642.22224,       0.0000000)
PRINT, roots00/DCOMPLEX(nz0[0],0d0)
;(      -6.5995579,       1.7726648)(      -6.5995579,      -1.7726648)(      -2.1610380,       0.0000000)
;(       1.1295375,       0.0000000)


pp1       = test1.P_TERM[0]
ss1       = test1.S_TERM[0]
rr1       = test1.R_TERM[0]
ll1       = test1.L_TERM[0]
PRINT, pp1, ss1, rr1, ll1
;      -2852752.5       3331.1903       121449.21      -114786.83

aa41      = ss1[0]*cchi2 + pp1[0]*schi2
aa31      = (pp1[0] - ss1[0])*nz1[0]*s2chi
aa21      = (ss1[0] + pp1[0])*nz1[0]^2 - rr1[0]*ll1[0]*cchi2 - pp1[0]*ss1[0]*(1d0 + schi2)
aa11      = (nz1[0]*s2chi)*((pp1[0] - ss1[0])*nz1[0]^2 + rr1[0]*ll1[0] - pp1[0]*ss1[0])
aa100     = ss1[0]*nz1[0]^4*schi2 + pp1[0]*nz1[0]^4*cchi2 
aa101     = -1d0*pp1[0]*ss1[0]*nz1[0]^2*(1d0 + cchi2) + pp1[0]*rr1[0]*ll1[0]
aa102     = -1d0*rr1[0]*ll1[0]*nz1[0]^2*schi2
aa01      = aa100 + aa101 + aa102
PRINT, aa41, aa31, aa21, aa11, aa01
;      -49274.247  -2.0716000e+08  -1.8392900e+11  -1.5392456e+13   2.6338843e+16

nnx10es   = (-1d0*aa31[0] + SQRT(aa31[0]^2 - 4d0*aa41[0]*aa21[0]))/(2d0*aa41[0])
nnx11es   = (-1d0*aa31[0] - SQRT(aa31[0]^2 - 4d0*aa41[0]*aa21[0]))/(2d0*aa41[0])
nnx10em   = (-1d0*aa11[0] + SQRT(aa11[0]^2 - 4d0*aa21[0]*aa01[0]))/(2d0*aa21[0])
nnx11em   = (-1d0*aa11[0] - SQRT(aa11[0]^2 - 4d0*aa21[0]*aa01[0]))/(2d0*aa21[0])
PRINT, nnx10es, nnx11es, nnx10em, nnx11em
;      -2930.4327      -1273.7918      -422.56912       338.88218
PRINT, nnx10es*(f1*2d0*!DPI)/c, nnx11es*(f1*2d0*!DPI)/c, $
       nnx10em*(f1*2d0*!DPI)/c, nnx11em*(f1*2d0*!DPI)/c
;   -0.0012283465  -0.00053393406  -0.00017712788   0.00014204890
PRINT, (2d-3*!DPI)/(nnx10es*(f1*2d0*!DPI)/c), (2d-3*!DPI)/(nnx11es*(f1*2d0*!DPI)/c), $
       (2d-3*!DPI)/(nnx10em*(f1*2d0*!DPI)/c), (2d-3*!DPI)/(nnx11em*(f1*2d0*!DPI)/c)
;      -5.1151569      -11.767718      -35.472594       44.232550

roots01   = FZ_ROOTS([aa01,aa11,aa21,aa31,aa41],/DOUBLE,/NO_POLISH)
PRINT, roots01
;(      -3022.9522,       0.0000000)(      -738.40947,      -230.33006)(      -738.40947,       230.33006)
;(       295.54666,       0.0000000)
PRINT, roots01/DCOMPLEX(nz1[0],0d0)
;(      -11.207772,       0.0000000)(      -2.7376963,     -0.85396218)(      -2.7376963,      0.85396218)
;(       1.0957565,       0.0000000)



; => For small chi and |nx| >> |nz|

nnx0      = nz0[0]*(ss0[0] - pp0[0])*s2chi/(aa40[0])
nnx1      = nz1[0]*(ss1[0] - pp1[0])*s2chi/(aa41[0])
PRINT, nnx0, nnx1
;      -8091.1153      -4204.2245
PRINT, (2d-3*!DPI)/(nnx0*(f1*2d0*!DPI)/c), (2d-3*!DPI)/(nnx1*(f1*2d0*!DPI)/c)
;      -1.8526028      -3.5653717






; => Example for     1998/08/26 06:40:26.120 UT
no        = 14.147
bo        = 17.279
f0        = 4.0
vsw       = [-482.355,28.057,57.841]
vmag      = SQRT(TOTAL(vsw^2))
ndat      = 1000L
test0     = cold_plasma_params(bo[0],no[0],FREQF=f0,NDAT=ndat)


help, test0,/str
;** Structure <305c804>, 14 tags, length=48064, data length=48064, refs=1:
;   S_TERM          DOUBLE    Array[1]
;   D_TERM          DOUBLE    Array[1]
;   P_TERM          DOUBLE    Array[1]
;   R_TERM          DOUBLE    Array[1]
;   L_TERM          DOUBLE    Array[1]
;   A_TERM          DOUBLE    Array[1000]
;   B_TERM          DOUBLE    Array[1000]
;   F_TERM          DOUBLE    Array[1000]
;   INDEX_REF_0     DOUBLE    Array[1000]
;   INDEX_REF_1     DOUBLE    Array[1000]
;   INDEX_ALFVEN    DOUBLE           8955978.8
;   ANGLES          DOUBLE    Array[1000]
;   W_FREQS         DOUBLE    Array[1]
;   CONE_ANG        DOUBLE    Array[1]
;

c        = 2.99792458d8      ; -Speed of light in vacuum (m/s)
ksquared = (test0.INDEX_REF_1)*(test0.W_FREQS[0]*(2d0*!DPI))^2/c^2
knumber  = SQRT(ksquared)
PRINT, minmax(knumber), minmax(2d0*!DPI/knumber)*1d-3
;   6.2621832e-05   0.00026830032
;       23.418479       100.33538
PRINT, minmax(knumber)*(vmag*1d3)/(2d0*!DPI)
;       4.8499355       20.779322


; => IF Sign(P) NE Sign(S) THEN $
;       CONE_ANG = ATAN(SQRT(-P/S)) ELSE CONE_ANG = ACOS(f_w/f_ce)


; => polarization w/ respect to Bo
polarization  = (test0.INDEX_REF_1 - test0.S_TERM[0])/test0.D_TERM[0]

; => polarization w/ respect to k-vector
term0         = (test0.S_TERM[0]*test0.INDEX_REF_1 - test0.R_TERM[0]*test0.L_TERM[0])
term1         = (test0.D_TERM[0]*test0.INDEX_REF_1*COS(test0.CONE_ANG[0]*!DPI/18d1))
polarization  = term0/term1





f      = !VALUES.F_NAN
d      = !VALUES.D_NAN
kB     = 1.3806504d-23     ; -Boltzmann Constant (J/K)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
K_eV   = 1.160474d4        ; -Conversion = degree Kelvin/eV
epo    = 8.854187817d-12   ; -Permittivity of free space (F/m)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
me     = 9.1093897d-31     ; -Electron mass (kg)
mp     = 1.6726231d-27     ; -Proton mass (kg)
qq     = 1.60217733d-19    ; -Fundamental charge (C)
c      = 2.99792458d8      ; -Speed of light in vacuum (m/s)
fcefac  = qq/me*1d-9/(2d0*!DPI)
fpefac  = SQRT(1d6*qq^2/me/epo)/(2d0*!DPI)

fcpfac  = qq/mp*1d-9/(2d0*!DPI)
fppfac  = SQRT(1d6*qq^2/mp/epo)/(2d0*!DPI)

