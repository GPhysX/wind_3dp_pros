;-----------------------------------------------------------------------------------------
; => create structures of start/end times to over plot on waveforms
;-----------------------------------------------------------------------------------------
tags      = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13',$
             't14','t15','t16','t17','t18','t19','t20','t21','t22','t23','t24']
prefd     = '1998-09-24/'


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 0L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:20:31.496      -0.690       0.723       0.015      122909.21
;  1998-09-24/23:22:11.549      -0.789       0.547       0.280      509243.59
;  1998-09-24/23:23:51.603      -0.813       0.551       0.188      473331.62
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.690,0.723,0.015]
qvec1     = [-0.789,0.547,0.280]
qvec2     = [-0.813,0.551,0.188]
qmag0     = [122909.21]
qmag1     = [509243.59]
qmag2     = [473331.62]

;
; => For  3 Hz < f < 20 Hz  at  1998-09-24/23:20:38.842 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:20:38.9636',prefd[0]+'23:20:39.1204'])
kvec0   = [ 0.98245,-0.06481,-0.17490]
elam0   = [22.211779,1.4924634]
bvec0   = [-0.44466, 0.89448, 0.03813]
bmag0   = [32.45339]
tr_str_00 = CREATE_STRUCT(tags[0L:0L],tr0)
kv_str_00 = CREATE_STRUCT(tags[0L:0L],kvec0)
bv_str_00 = CREATE_STRUCT(tags[0L:0L],bvec0)
bm_str_00 = CREATE_STRUCT(tags[0L:0L],bmag0)
eg_str_00 = CREATE_STRUCT(tags[0L:0L],elam0)

kv_str = kv_str_00
bv_str = bv_str_00
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [17.43]
thqb_during = [31.70]
thqb_after  = [30.51]
thqk_before = [43.33]
thqk_during = [30.73]
thqk_after  = [29.85]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         17.428         31.702         30.511         43.334         30.731         29.851

;
; => For  5 Hz < f < 20 Hz  at  1998-09-24/23:20:38.842 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:20:38.8420',prefd[0]+'23:20:38.9945'])
tr1     = time_double([prefd[0]+'23:20:38.9951',prefd[0]+'23:20:39.1476'])
tr2     = time_double([prefd[0]+'23:20:39.6953',prefd[0]+'23:20:39.7999'])
kvec0   = [-0.96622, 0.25768, 0.00417]
kvec1   = [-0.93003, 0.05771, 0.36291]
kvec2   = [ 0.83241,-0.53206, 0.15495]
elam0   = [46.245752,1.4360068]
elam1   = [26.226143,1.9333287]
elam2   = [15.446947,3.7815021]
bvec0   = [-0.40480, 0.91022, 0.08413]
bvec1   = [-0.45594, 0.88818, 0.04329]
bvec2   = [-0.33727, 0.93930, 0.02883]
bmag0   = [31.93903]
bmag1   = [32.56262]
bmag2   = [29.98178]
tr_str_01 = CREATE_STRUCT(tags[0L:2L],tr0,tr1,tr2)
kv_str_01 = CREATE_STRUCT(tags[0L:2L],kvec0,kvec1,kvec2)
bv_str_01 = CREATE_STRUCT(tags[0L:2L],bvec0,bvec1,bvec2)
bm_str_01 = CREATE_STRUCT(tags[0L:2L],bmag0,bmag1,bmag2)
eg_str_01 = CREATE_STRUCT(tags[0L:2L],elam0,elam1,elam2)

kv_str = kv_str_01
bv_str = bv_str_01
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [20.17,16.78,24.18]
thqb_during = [32.77,30.94,38.00]
thqb_after  = [32.17,29.75,37.14]
thqk_before = [31.45,46.46,16.92]
thqk_during = [25.25,29.89,25.25]
thqk_after  = [21.83,31.11,19.82]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         20.172         32.772         32.172         31.454         25.249         21.828
;         16.784         30.942         29.749         46.458         29.891         31.114
;         24.180         38.003         37.139         16.919         25.254         19.816

;
; => For  10 Hz < f < 45 Hz  at  1998-09-24/23:20:38.842 UT
;
tr_str_02 = 0
kv_str_02 = 0
bv_str_02 = 0
bm_str_02 = 0
eg_str_02 = 0

;
; => For  50 Hz < f < 200 Hz  at  1998-09-24/23:20:38.842 UT
;
tr_str_03 = 0
kv_str_03 = 0
bv_str_03 = 0
bm_str_03 = 0
eg_str_03 = 0

;
; => For  100 Hz < f < 200 Hz  at  1998-09-24/23:20:38.842 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:20:39.0761',prefd[0]+'23:20:39.0985'])
tr1     = time_double([prefd[0]+'23:20:39.4303',prefd[0]+'23:20:39.4559'])
tr2     = time_double([prefd[0]+'23:20:39.4804',prefd[0]+'23:20:39.5071'])
tr3     = time_double([prefd[0]+'23:20:39.7236',prefd[0]+'23:20:39.7524'])
kvec0   = [-0.93772,-0.09010, 0.33551]
kvec1   = [-0.40512, 0.88622,-0.22471]
kvec2   = [-0.07652, 0.86164,-0.50172]
kvec3   = [-0.38297, 0.90500,-0.18520]
elam0   = [34.847261,6.8065886]
elam1   = [37.324974,3.3453533]
elam2   = [52.233217,2.8496824]
elam3   = [16.348417,2.2699986]
bvec0   = [-0.46003, 0.88709, 0.03686]
bvec1   = [-0.35493, 0.93484, 0.00657]
bvec2   = [-0.31217, 0.94961,-0.02675]
bvec3   = [-0.33825, 0.93971, 0.04764]
bmag0   = [32.66495]
bmag1   = [31.36147]
bmag2   = [30.05675]
bmag3   = [29.83430]
tr_str_04 = CREATE_STRUCT(tags[0L:3L],tr0,tr1,tr2,tr3)
kv_str_04 = CREATE_STRUCT(tags[0L:3L],kvec0,kvec1,kvec2,kvec3)
bv_str_04 = CREATE_STRUCT(tags[0L:3L],bvec0,bvec1,bvec2,bvec3)
bm_str_04 = CREATE_STRUCT(tags[0L:3L],bmag0,bmag1,bmag2,bmag3)
eg_str_04 = CREATE_STRUCT(tags[0L:3L],elam0,elam1,elam2,elam3)

kv_str = kv_str_04
bv_str = bv_str_04
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [16.39,22.94,25.64,24.00]
thqb_during = [30.85,37.51,40.69,37.42]
thqb_after  = [29.57,36.40,39.47,36.70]
thqk_before = [54.06,23.52,48.07,23.68]
thqk_during = [38.32,42.14,66.97,41.81]
thqk_after  = [39.12,39.16,63.73,39.18]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         16.395         30.849         29.574         54.061         38.324         39.123
;         22.944         37.511         36.400         23.523         42.142         39.156
;         25.636         40.690         39.466         48.069         66.970         63.727
;         24.004         37.416         36.704         23.682         41.811         39.178

tr_str_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4'],tr_str_00,tr_str_01,tr_str_02,tr_str_03,tr_str_04)
kv_str_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4'],kv_str_00,kv_str_01,kv_str_02,kv_str_03,kv_str_04)
bv_str_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4'],bv_str_00,bv_str_01,bv_str_02,bv_str_03,bv_str_04)
bm_str_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4'],bm_str_00,bm_str_01,bm_str_02,bm_str_03,bm_str_04)
eg_str_0  = CREATE_STRUCT(['T0','T1','T2','T3','T4'],eg_str_00,eg_str_01,eg_str_02,eg_str_03,eg_str_04)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 1L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:20:31.496      -0.690       0.723       0.015      122909.21
;  1998-09-24/23:22:11.549      -0.789       0.547       0.280      509243.59
;  1998-09-24/23:23:51.603      -0.813       0.551       0.188      473331.62
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.690,0.723,0.015]
qvec1     = [-0.789,0.547,0.280]
qvec2     = [-0.813,0.551,0.188]
qmag0     = [122909.21]
qmag1     = [509243.59]
qmag2     = [473331.62]

;
; => For  3 Hz < f < 20 Hz  at  1998-09-24/23:22:26.632 UT
;
tr_str_10 = 0
kv_str_10 = 0
bv_str_10 = 0
bm_str_10 = 0
eg_str_10 = 0

;
; => For  6 Hz < f < 30 Hz  at  1998-09-24/23:22:26.632 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:22:27.2005',prefd[0]+'23:22:27.2875'])
tr1     = time_double([prefd[0]+'23:22:27.6037',prefd[0]+'23:22:27.6437'])
kvec0   = [-0.21261, 0.93610, 0.28021]
kvec1   = [ 0.12887, 0.49341, 0.86020]
elam0   = [22.594221,1.1930579]
elam1   = [16.226427,1.5508503]
bvec0   = [-0.30468, 0.84697, 0.43565]
bvec1   = [-0.36636, 0.85765, 0.36085]
bmag0   = [42.37826]
bmag1   = [42.11877]
tr_str_11 = CREATE_STRUCT(tags[0L:1L],tr0,tr1)
kv_str_11 = CREATE_STRUCT(tags[0L:1L],kvec0,kvec1)
bv_str_11 = CREATE_STRUCT(tags[0L:1L],bvec0,bvec1)
bm_str_11 = CREATE_STRUCT(tags[0L:1L],bmag0,bmag1)
eg_str_11 = CREATE_STRUCT(tags[0L:1L],elam0,elam1)

kv_str = kv_str_11
bv_str = bv_str_11
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [33.99,28.56]
thqb_during = [34.34,30.77]
thqb_after  = [37.22,33.04]
thqk_before = [34.14,73.70]
thqk_during = [40.69,65.85]
thqk_after  = [42.16,70.80]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         33.991         34.344         37.223         34.136         40.689         42.156
;         28.564         30.770         33.044         73.697         65.853         70.803

;
; => For  15 Hz < f < 150 Hz  at  1998-09-24/23:22:26.632 UT
;
tr_str_12 = 0
kv_str_12 = 0
bv_str_12 = 0
bm_str_12 = 0
eg_str_12 = 0

;
; => For  30 Hz < f < 150 Hz  at  1998-09-24/23:22:26.632 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:22:26.7173',prefd[0]+'23:22:26.7536'])
tr1     = time_double([prefd[0]+'23:22:27.1584',prefd[0]+'23:22:27.2160'])
tr2     = time_double([prefd[0]+'23:22:27.2304',prefd[0]+'23:22:27.2528'])
tr3     = time_double([prefd[0]+'23:22:27.2624',prefd[0]+'23:22:27.2955'])
tr4     = time_double([prefd[0]+'23:22:27.2960',prefd[0]+'23:22:27.3296'])
tr5     = time_double([prefd[0]+'23:22:27.3813',prefd[0]+'23:22:27.4117'])
tr6     = time_double([prefd[0]+'23:22:27.4123',prefd[0]+'23:22:27.4464'])
kvec0   = [ 0.71280,-0.69465,-0.09679]
kvec1   = [-0.52456, 0.79264, 0.31075]
kvec2   = [ 0.34924,-0.85848,-0.37556]
kvec3   = [-0.44432, 0.89542,-0.02824]
kvec4   = [-0.32069, 0.88028, 0.34966]
kvec5   = [ 0.76191,-0.63565,-0.12426]
kvec6   = [-0.66600, 0.73099, 0.14869]
elam0   = [10.506212,1.8029687]
elam1   = [31.226731,1.1158382]
elam2   = [12.160326,1.2067213]
elam3   = [16.545702,1.2760096]
elam4   = [24.801793,1.4979471]
elam5   = [109.30998,1.6059219]
elam6   = [98.827240,1.0302008]
bvec0   = [-0.28970, 0.88420, 0.36642]
bvec1   = [-0.30146, 0.85067, 0.43067]
bvec2   = [-0.30327, 0.84642, 0.43773]
bvec3   = [-0.30940, 0.84618, 0.43387]
bvec4   = [-0.31625, 0.84668, 0.42791]
bvec5   = [-0.33350, 0.85107, 0.40551]
bvec6   = [-0.34033, 0.85328, 0.39506]
bmag0   = [42.41395]
bmag1   = [42.23297]
bmag2   = [42.39689]
bmag3   = [42.41665]
bmag4   = [42.41032]
bmag5   = [42.49598]
bmag6   = [42.54431]
tr_str_13 = CREATE_STRUCT(tags[0L:6L],tr0,tr1,tr2,tr3,tr4,tr5,tr6)
kv_str_13 = CREATE_STRUCT(tags[0L:6L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6)
bv_str_13 = CREATE_STRUCT(tags[0L:6L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6)
bm_str_13 = CREATE_STRUCT(tags[0L:6L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6)
eg_str_13 = CREATE_STRUCT(tags[0L:6L],elam0,elam1,elam2,elam3,elam4,elam5,elam6)

kv_str = kv_str_13
bv_str = bv_str_13
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [32.36,33.95,34.13,33.72,33.20,31.62,30.94]
thqb_during = [35.43,34.54,34.43,34.06,33.65,32.63,32.23]
thqb_after  = [37.66,37.37,37.32,36.93,36.48,35.28,34.80]
thqk_before = [ 5.43,20.00,29.85,17.53,30.35, 9.19, 8.00]
thqk_during = [14.19,20.86,31.76,33.65,33.65,10.38,14.77]
thqk_after  = [11.35,22.83,34.15,31.86,35.76, 6.77,13.54]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         32.364         35.430         37.664          5.428         14.193         11.347
;         33.952         34.537         37.366         20.001         20.859         22.834
;         34.128         34.428         37.323         29.855         31.756         34.151
;         33.718         34.059         36.931         17.533         33.648         31.864
;         33.198         33.647         36.479         30.349         33.650         35.758
;         31.622         32.626         35.283          9.193         10.378          6.765
;         30.943         32.234         34.803          7.997         14.770         13.545


tr_str_1  = CREATE_STRUCT(['T0','T1','T2','T3'],tr_str_10,tr_str_11,tr_str_12,tr_str_13)
kv_str_1  = CREATE_STRUCT(['T0','T1','T2','T3'],kv_str_10,kv_str_11,kv_str_12,kv_str_13)
bv_str_1  = CREATE_STRUCT(['T0','T1','T2','T3'],bv_str_10,bv_str_11,bv_str_12,bv_str_13)
bm_str_1  = CREATE_STRUCT(['T0','T1','T2','T3'],bm_str_10,bm_str_11,bm_str_12,bm_str_13)
eg_str_1  = CREATE_STRUCT(['T0','T1','T2','T3'],eg_str_10,eg_str_11,eg_str_12,eg_str_13)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 2L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:20:31.496      -0.690       0.723       0.015      122909.21
;  1998-09-24/23:22:11.549      -0.789       0.547       0.280      509243.59
;  1998-09-24/23:23:51.603      -0.813       0.551       0.188      473331.62
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.690,0.723,0.015]
qvec1     = [-0.789,0.547,0.280]
qvec2     = [-0.813,0.551,0.188]
qmag0     = [122909.21]
qmag1     = [509243.59]
qmag2     = [473331.62]

;
; => For  3 Hz < f < 20 Hz  at  1998-09-24/23:22:48.150 UT
;
tr_str_20 = 0
kv_str_20 = 0
bv_str_20 = 0
bm_str_20 = 0
eg_str_20 = 0

;
; => For  6 Hz < f < 30 Hz  at  1998-09-24/23:22:48.150 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:22:48.1500',prefd[0]+'23:22:48.2396'])
tr1     = time_double([prefd[0]+'23:22:48.2401',prefd[0]+'23:22:48.2855'])
tr2     = time_double([prefd[0]+'23:22:48.3351',prefd[0]+'23:22:48.3831'])
tr3     = time_double([prefd[0]+'23:22:48.5244',prefd[0]+'23:22:48.6380'])
tr4     = time_double([prefd[0]+'23:22:48.7788',prefd[0]+'23:22:48.8412'])
tr5     = time_double([prefd[0]+'23:22:49.0124',prefd[0]+'23:22:49.0748'])
kvec0   = [-0.01574,-0.76014,-0.64956]
kvec1   = [-0.07880,-0.70006,-0.70972]
kvec2   = [-0.19814,-0.74365,-0.63853]
kvec3   = [-0.20663, 0.82608, 0.52431]
kvec4   = [ 0.19920, 0.95497, 0.21990]
kvec5   = [ 0.58830,-0.17706,-0.78902]
elam0   = [111.82964,2.1455052]
elam1   = [42.189306,1.8269140]
elam2   = [778.13114,1.3627853]
elam3   = [12.742375,1.2129027]
elam4   = [48.934482,1.9241530]
elam5   = [24.942817,2.2288402]
bvec0   = [-0.33802, 0.88378, 0.32349]
bvec1   = [-0.33598, 0.88827, 0.31320]
bvec2   = [-0.33019, 0.89351, 0.30432]
bvec3   = [-0.32260, 0.90142, 0.28872]
bvec4   = [-0.30031, 0.91380, 0.27344]
bvec5   = [-0.27801, 0.91480, 0.29299]
bmag0   = [42.32958]
bmag1   = [42.30051]
bmag2   = [42.25578]
bmag3   = [42.54726]
bmag4   = [42.32404]
bmag5   = [42.44916]
tr_str_21 = CREATE_STRUCT(tags[0L:5L],tr0,tr1,tr2,tr3,tr4,tr5)
kv_str_21 = CREATE_STRUCT(tags[0L:5L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5)
bv_str_21 = CREATE_STRUCT(tags[0L:5L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5)
bm_str_21 = CREATE_STRUCT(tags[0L:5L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5)
eg_str_21 = CREATE_STRUCT(tags[0L:5L],elam0,elam1,elam2,elam3,elam4,elam5)

kv_str = kv_str_21
bv_str = bv_str_21
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [28.71,28.51,28.55,28.52,29.31,30.95]
thqb_during = [32.79,33.00,33.44,34.06,35.57,36.70]
thqb_after  = [34.66,34.77,35.12,35.59,36.96,38.26]
thqk_before = [56.74,62.46,65.76,41.61,56.20,56.92]
thqk_during = [54.18,58.70,64.58,40.39,64.74,38.56]
thqk_after  = [58.12,62.93,68.36,43.80,66.07,43.60]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         28.710         32.786         34.655         56.738         54.179         58.119
;         28.509         33.000         34.768         62.457         58.703         62.929
;         28.550         33.438         35.117         65.762         64.581         68.364
;         28.520         34.060         35.587         41.609         40.385         43.802
;         29.309         35.575         36.959         56.200         64.737         66.073
;         30.949         36.699         38.265         56.922         38.561         43.599

;
; => For  15 Hz < f < 150 Hz  at  1998-09-24/23:22:48.150 UT
;
tr_str_22 = 0
kv_str_22 = 0
bv_str_22 = 0
bm_str_22 = 0
eg_str_22 = 0

;
; => For  30 Hz < f < 150 Hz  at  1998-09-24/23:22:48.150 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:22:48.1836',prefd[0]+'23:22:48.2508'])
tr1     = time_double([prefd[0]+'23:22:48.3473',prefd[0]+'23:22:48.3713'])
tr2     = time_double([prefd[0]+'23:22:48.3996',prefd[0]+'23:22:48.4220'])
tr3     = time_double([prefd[0]+'23:22:48.5068',prefd[0]+'23:22:48.5447'])
tr4     = time_double([prefd[0]+'23:22:48.6225',prefd[0]+'23:22:48.6577'])
tr5     = time_double([prefd[0]+'23:22:48.6583',prefd[0]+'23:22:48.7127'])
tr6     = time_double([prefd[0]+'23:22:48.9489',prefd[0]+'23:22:48.9729'])
tr7     = time_double([prefd[0]+'23:22:49.0817',prefd[0]+'23:22:49.1057'])
kvec0   = [ 0.30632,-0.81107,-0.49834]
kvec1   = [ 0.39593,-0.79206,-0.46462]
kvec2   = [-0.06917, 0.92173, 0.38161]
kvec3   = [ 0.66870,-0.70251,-0.24357]
kvec4   = [ 0.59137,-0.56090,-0.57938]
kvec5   = [ 0.40501,-0.48346,-0.77603]
kvec6   = [-0.04915,-0.94556,-0.32172]
kvec7   = [-0.72440, 0.61616, 0.30918]
elam0   = [27.160724,1.5877689]
elam1   = [36.690574,1.1342159]
elam2   = [19.944872,1.2697517]
elam3   = [31.924088,1.6022743]
elam4   = [12.620580,1.5001507]
elam5   = [21.035347,1.0558565]
elam6   = [67.094544,1.0558747]
elam7   = [21.044902,1.5351499]
bvec0   = [-0.33760, 0.88533, 0.31971]
bvec1   = [-0.33021, 0.89350, 0.30433]
bvec2   = [-0.32621, 0.89574, 0.30205]
bvec3   = [-0.32344, 0.89947, 0.29383]
bvec4   = [-0.32080, 0.90274, 0.28662]
bvec5   = [-0.31811, 0.90388, 0.28603]
bvec6   = [-0.28310, 0.91451, 0.28900]
bvec7   = [-0.27319, 0.91639, 0.29258]
bmag0   = [42.31942]
bmag1   = [42.25590]
bmag2   = [42.23702]
bmag3   = [42.52070]
bmag4   = [42.50772]
bmag5   = [42.44091]
bmag6   = [42.14798]
bmag7   = [42.49588]
tr_str_23 = CREATE_STRUCT(tags[0L:7L],tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7)
kv_str_23 = CREATE_STRUCT(tags[0L:7L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7)
bv_str_23 = CREATE_STRUCT(tags[0L:7L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6,bvec7)
bm_str_23 = CREATE_STRUCT(tags[0L:7L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6,bmag7)
eg_str_23 = CREATE_STRUCT(tags[0L:7L],elam0,elam1,elam2,elam3,elam4,elam5,elam6,elam7)

kv_str = kv_str_23
bv_str = bv_str_23
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [28.62,28.55,28.69,28.61,28.56,28.68,30.59,31.19]
thqb_during = [32.84,33.44,33.70,33.95,34.19,34.36,36.44,36.99]
thqb_after  = [34.68,35.12,35.36,35.53,35.70,35.86,37.96,38.55]
thqk_before = [36.37,31.48,43.96,13.35,34.69,50.16,49.11,18.20]
thqk_during = [34.42,28.87,48.27,11.46,20.67,36.75,55.35, 5.64]
thqk_after  = [37.85,32.26,50.52,12.44,26.00,42.14,57.21, 9.40]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         28.618         32.843         34.675         36.367         34.424         37.849
;         28.549         33.437         35.116         31.480         28.867         32.257
;         28.689         33.703         35.359         43.957         48.271         50.517
;         28.610         33.955         35.531         13.352         11.456         12.439
;         28.558         34.192         35.698         34.688         20.670         26.004
;         28.683         34.361         35.862         50.161         36.746         42.136
;         30.586         36.436         37.965         49.114         55.353         57.212
;         31.192         36.991         38.552         18.203          5.639          9.402

tr_str_2  = CREATE_STRUCT(['T0','T1','T2','T3'],tr_str_20,tr_str_21,tr_str_22,tr_str_23)
kv_str_2  = CREATE_STRUCT(['T0','T1','T2','T3'],kv_str_20,kv_str_21,kv_str_22,kv_str_23)
bv_str_2  = CREATE_STRUCT(['T0','T1','T2','T3'],bv_str_20,bv_str_21,bv_str_22,bv_str_23)
bm_str_2  = CREATE_STRUCT(['T0','T1','T2','T3'],bm_str_20,bm_str_21,bm_str_22,bm_str_23)
eg_str_2  = CREATE_STRUCT(['T0','T1','T2','T3'],eg_str_20,eg_str_21,eg_str_22,eg_str_23)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 3L

;
; => For  3 Hz < f < 30 Hz  at  1998-09-24/23:30:00.465 UT
;
tr_str_30 = 0
kv_str_30 = 0
bv_str_30 = 0
bm_str_30 = 0
eg_str_30 = 0

tr_str_3  = CREATE_STRUCT(['T0'],tr_str_30)
kv_str_3  = CREATE_STRUCT(['T0'],kv_str_30)
bv_str_3  = CREATE_STRUCT(['T0'],bv_str_30)
bm_str_3  = CREATE_STRUCT(['T0'],bm_str_30)
eg_str_3  = CREATE_STRUCT(['T0'],eg_str_30)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 4L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:28:51.763      -0.816       0.554       0.167      499393.31
;  1998-09-24/23:30:31.816      -0.920       0.251       0.301      503668.16
;  1998-09-24/23:32:11.870      -0.963       0.230       0.139      604874.12
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.816,0.554,0.167]
qvec1     = [-0.920,0.251,0.301]
qvec2     = [-0.963,0.230,0.139]
qmag0     = [499393.31]
qmag1     = [503668.16]
qmag2     = [604874.12]

;
; => For  3 Hz < f < 40 Hz  at  1998-09-24/23:30:48.542 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:30:48.8737',prefd[0]+'23:30:49.0177'])
tr1     = time_double([prefd[0]+'23:30:49.3260',prefd[0]+'23:30:49.4988'])
tr2     = time_double([prefd[0]+'23:30:49.3692',prefd[0]+'23:30:49.4988'])
kvec0   = [ 0.78336, 0.62028, 0.03993]
kvec1   = [ 0.69672,-0.60070,-0.39209]
kvec2   = [ 0.71066,-0.58173,-0.39567]
elam0   = [38.810429,3.2816307]
elam1   = [61.373437,1.6935611]
elam2   = [46.618949,2.6676104]
bvec0   = [-0.44455, 0.73332, 0.51438]
bvec1   = [-0.46540, 0.75193, 0.46689]
bvec2   = [-0.46517, 0.75298, 0.46544]
bmag0   = [40.47744]
bmag1   = [41.20196]
bmag2   = [41.21673]
tr_str_40 = CREATE_STRUCT(tags[0L:2L],tr0,tr1,tr2)
kv_str_40 = CREATE_STRUCT(tags[0L:2L],kvec0,kvec1,kvec2)
bv_str_40 = CREATE_STRUCT(tags[0L:2L],bvec0,bvec1,bvec2)
bm_str_40 = CREATE_STRUCT(tags[0L:2L],bmag0,bmag1,bmag2)
eg_str_40 = CREATE_STRUCT(tags[0L:2L],elam0,elam1,elam2)

kv_str = kv_str_40
bv_str = bv_str_40
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [31.25,29.04,29.02]
thqb_during = [41.59,40.76,40.80]
thqb_after  = [48.07,46.68,46.70]
thqk_before = [73.21,14.81,14.48]
thqk_during = [56.43,24.53,23.23]
thqk_after  = [52.69,30.28,29.17]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         31.250         41.593         48.067         73.207         56.428         52.688
;         29.037         40.761         46.684         14.807         24.525         30.276
;         29.019         40.795         46.698         14.476         23.232         29.172

;
; => For  10 Hz < f < 40 Hz  at  1998-09-24/23:30:48.542 UT
;
tr_str_41 = 0
kv_str_41 = 0
bv_str_41 = 0
bm_str_41 = 0
eg_str_41 = 0

;
; => For  40 Hz < f < 100 Hz  at  1998-09-24/23:30:48.542 UT
;
tr_str_42 = 0
kv_str_42 = 0
bv_str_42 = 0
bm_str_42 = 0
eg_str_42 = 0

;
; => For  200 Hz < f < 400 Hz  at  1998-09-24/23:30:48.542 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:30:48.5500',prefd[0]+'23:30:48.5697'])
tr1     = time_double([prefd[0]+'23:30:48.5799',prefd[0]+'23:30:48.5991'])
tr2     = time_double([prefd[0]+'23:30:48.6188',prefd[0]+'23:30:48.6508'])
tr3     = time_double([prefd[0]+'23:30:48.6524',prefd[0]+'23:30:48.6668'])
tr4     = time_double([prefd[0]+'23:30:48.6679',prefd[0]+'23:30:48.6999'])
tr5     = time_double([prefd[0]+'23:30:48.7004',prefd[0]+'23:30:48.7244'])
tr6     = time_double([prefd[0]+'23:30:48.8055',prefd[0]+'23:30:48.8497'])
tr7     = time_double([prefd[0]+'23:30:48.8503',prefd[0]+'23:30:48.9265'])
tr8     = time_double([prefd[0]+'23:30:48.9265',prefd[0]+'23:30:48.9996'])
tr9     = time_double([prefd[0]+'23:30:49.0001',prefd[0]+'23:30:49.0396'])
tr10    = time_double([prefd[0]+'23:30:49.0449',prefd[0]+'23:30:49.0609'])
tr11    = time_double([prefd[0]+'23:30:49.0615',prefd[0]+'23:30:49.0967'])
tr12    = time_double([prefd[0]+'23:30:49.1100',prefd[0]+'23:30:49.1196'])
tr13    = time_double([prefd[0]+'23:30:49.1201',prefd[0]+'23:30:49.1457'])
tr14    = time_double([prefd[0]+'23:30:49.1463',prefd[0]+'23:30:49.2023'])
tr15    = time_double([prefd[0]+'23:30:49.2028',prefd[0]+'23:30:49.2268'])
tr16    = time_double([prefd[0]+'23:30:49.2353',prefd[0]+'23:30:49.2673'])
tr17    = time_double([prefd[0]+'23:30:49.2679',prefd[0]+'23:30:49.3143'])
tr18    = time_double([prefd[0]+'23:30:49.3148',prefd[0]+'23:30:49.3255'])
tr19    = time_double([prefd[0]+'23:30:49.3313',prefd[0]+'23:30:49.3799'])
tr20    = time_double([prefd[0]+'23:30:49.3804',prefd[0]+'23:30:49.4327'])
tr21    = time_double([prefd[0]+'23:30:49.4503',prefd[0]+'23:30:49.4972'])
tr22    = time_double([prefd[0]+'23:30:49.4977',prefd[0]+'23:30:49.5228'])
tr23    = time_double([prefd[0]+'23:30:49.5271',prefd[0]+'23:30:49.5585'])
tr24    = time_double([prefd[0]+'23:30:49.5591',prefd[0]+'23:30:49.5815'])
kvec0   = [ 0.73044,-0.33271,-0.59646]
kvec1   = [ 0.67852,-0.37579,-0.63119]
kvec2   = [ 0.72408,-0.29306,-0.62436]
kvec3   = [ 0.67540,-0.17251,-0.71699]
kvec4   = [ 0.72033,-0.15381,-0.67637]
kvec5   = [ 0.75824,-0.25189,-0.60135]
kvec6   = [ 0.69150,-0.19666,-0.69509]
kvec7   = [ 0.73929,-0.14663,-0.65723]
kvec8   = [ 0.70436,-0.13724,-0.69645]
kvec9   = [ 0.69449,-0.25131,-0.67419]
kvec10  = [-0.00132,-0.00100,-1.00000]
kvec11  = [ 0.00049,-0.00278,-1.00000]
kvec12  = [ 0.76387,-0.10524,-0.63674]
kvec13  = [ 0.74922,-0.13205,-0.64902]
kvec14  = [ 0.70280,-0.01649,-0.71120]
kvec15  = [ 0.72118,-0.18955,-0.66631]
kvec16  = [ 0.70746,-0.29336,-0.64299]
kvec17  = [ 0.70623,-0.21445,-0.67473]
kvec18  = [ 0.72313, 0.05159,-0.68878]
kvec19  = [ 0.71911,-0.21629,-0.66038]
kvec20  = [ 0.73942,-0.17522,-0.65004]
kvec21  = [ 0.69126,-0.37399,-0.61829]
kvec22  = [ 0.66885,-0.14658,-0.72880]
kvec23  = [ 0.71783,-0.13677,-0.68265]
kvec24  = [ 0.73450,-0.05978,-0.67597]
elam0   = [32.757588,5.1725034]
elam1   = [62.194347,4.7739488]
elam2   = [48.937657,5.1513222]
elam3   = [23.549643,3.7793534]
elam4   = [77.206839,4.1681879]
elam5   = [101.18191,6.5764968]
elam6   = [29.282799,3.9740805]
elam7   = [49.101080,5.0518233]
elam8   = [28.073362,4.1683115]
elam9   = [97.902561,4.9495011]
elam10  = [476.73567,3.2062222]
elam11  = [866.20227,4.7873677]
elam12  = [78.061251,8.0932010]
elam13  = [98.450390,6.2249150]
elam14  = [25.594481,3.7443254]
elam15  = [53.183527,4.6590059]
elam16  = [22.054444,5.0732422]
elam17  = [86.002268,4.4865663]
elam18  = [20.103518,5.6225363]
elam19  = [73.235820,4.7609461]
elam20  = [35.416067,5.1683691]
elam21  = [27.318875,5.5871040]
elam22  = [36.201868,3.3711832]
elam23  = [63.946748,4.8253759]
elam24  = [412.23440,5.3330883]
bvec0   = [-0.40252, 0.73549, 0.54501]
bvec1   = [-0.40679, 0.73415, 0.54364]
bvec2   = [-0.41308, 0.73212, 0.54163]
bvec3   = [-0.41614, 0.73127, 0.54043]
bvec4   = [-0.41834, 0.73097, 0.53914]
bvec5   = [-0.42087, 0.73061, 0.53765]
bvec6   = [-0.43090, 0.73223, 0.52741]
bvec7   = [-0.43826, 0.73367, 0.51927]
bvec8   = [-0.44652, 0.73327, 0.51276]
bvec9   = [-0.45160, 0.73168, 0.51058]
bvec10  = [-0.45369, 0.73247, 0.50760]
bvec11  = [-0.45526, 0.73333, 0.50493]
bvec12  = [-0.45731, 0.73458, 0.50127]
bvec13  = [-0.45822, 0.73559, 0.49894]
bvec14  = [-0.46034, 0.73794, 0.49348]
bvec15  = [-0.46241, 0.74032, 0.48796]
bvec16  = [-0.46440, 0.74281, 0.48224]
bvec17  = [-0.46628, 0.74547, 0.47628]
bvec18  = [-0.46644, 0.74719, 0.47343]
bvec19  = [-0.46603, 0.74922, 0.47063]
bvec20  = [-0.46549, 0.75183, 0.46697]
bvec21  = [-0.46470, 0.75468, 0.46315]
bvec22  = [-0.46295, 0.75587, 0.46296]
bvec23  = [-0.46096, 0.75686, 0.46333]
bvec24  = [-0.45911, 0.75781, 0.46362]
bmag0   = [40.62561]
bmag1   = [40.62074]
bmag2   = [40.61554]
bmag3   = [40.61911]
bmag4   = [40.63281]
bmag5   = [40.64889]
bmag6   = [40.47960]
bmag7   = [40.43920]
bmag8   = [40.48725]
bmag9   = [40.58921]
bmag10  = [40.67957]
bmag11  = [40.75786]
bmag12  = [40.85480]
bmag13  = [40.87585]
bmag14  = [40.92627]
bmag15  = [40.98466]
bmag16  = [41.05859]
bmag17  = [41.13369]
bmag18  = [41.15280]
bmag19  = [41.15898]
bmag20  = [41.18728]
bmag21  = [41.25762]
bmag22  = [41.26371]
bmag23  = [41.26001]
bmag24  = [41.26249]
tr_str_43  = CREATE_STRUCT(tags[0L:24L],tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,tr10,tr11,tr12,$
                           tr13,tr14,tr15,tr16,tr17,tr18,tr19,tr20,tr21,tr22,tr23,tr24)
kv_str_43  = CREATE_STRUCT(tags[0L:24L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                           kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15,kvec16,kvec17,$
                           kvec18,kvec19,kvec20,kvec21,kvec22,kvec23,kvec24)
bv_str_43  = CREATE_STRUCT(tags[0L:24L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6,bvec7,bvec8,$
                           bvec9,bvec10,bvec11,bvec12,bvec13,bvec14,bvec15,bvec16,bvec17,$
                           bvec18,bvec19,bvec20,bvec21,bvec22,bvec23,bvec24)
bm_str_43  = CREATE_STRUCT(tags[0L:24L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6,bmag7,bmag8,$
                           bmag9,bmag10,bmag11,bmag12,bmag13,bmag14,bmag15,bmag16,bmag17,$
                           bmag18,bmag19,bmag20,bmag21,bmag22,bmag23,bmag24)
eg_str_43  = CREATE_STRUCT(tags[0L:24L],elam0,elam1,elam2,elam3,elam4,elam5,elam6,elam7,elam8,$
                           elam9,elam10,elam11,elam12,elam13,elam14,elam15,elam16,elam17,$
                           elam18,elam19,elam20,elam21,elam22,elam23,elam24)

kv_str = kv_str_43
bv_str = bv_str_43
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [34.21,33.96,33.58,33.39,33.24,33.07,32.29,31.70,31.10,30.78,30.60,$
               30.45,30.25,30.15,29.90,29.66,29.42,29.19,29.12,29.08,29.03,29.00,$
               29.09,29.21,29.32]
thqb_during = [44.03,43.77,43.38,43.19,43.06,42.91,42.36,41.96,41.48,41.17,41.06,$
               40.98,40.89,40.85,40.78,40.70,40.64,40.58,40.61,40.67,40.75,40.86,$
               40.98,41.10,41.22]
thqb_after  = [50.76,50.49,50.10,49.91,49.76,49.60,48.95,48.47,47.94,47.61,47.47,$
               47.37,47.23,47.17,47.03,46.89,46.76,46.63,46.62,46.64,46.68,46.73,$
               46.84,46.97,47.09]
thqk_before = [28.36,29.86,30.97,39.97,38.19,30.83,37.88,37.42,39.91,35.06,80.42,$
               80.27,38.01,37.54,45.46,36.41,32.09,36.12,47.43,35.22,36.00,29.01,$
               41.52,39.15,41.81]
thqk_during = [20.76,24.69,21.93,28.30,25.19,19.64,26.52,23.83,26.86,25.18,72.54,$
               72.41,22.95,23.40,30.14,24.27,23.36,24.95,30.72,23.84,23.09,23.66,$
               29.37,25.81,26.59]
thqk_after  = [30.36,34.15,31.63,37.84,34.61,29.34,36.12,33.17,36.23,34.88,82.07,$
               81.95,31.97,32.64,38.79,33.83,33.06,34.59,38.72,33.48,32.57,33.11,$
               38.82,35.15,35.41]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         34.215         44.030         50.762         28.361         20.764         30.362
;         33.958         43.767         50.494         29.857         24.694         34.149
;         33.579         43.379         50.098         30.966         21.930         31.627
;         33.390         43.192         49.905         39.965         28.299         37.838
;         33.242         43.061         49.765         38.191         25.191         34.607
;         33.073         42.911         49.604         30.829         19.642         29.342
;         32.291         42.356         48.953         37.880         26.522         36.122
;         31.702         41.957         48.473         37.415         23.826         33.174
;         31.105         41.480         47.939         39.906         26.863         36.228
;         30.782         41.166         47.612         35.063         25.185         34.884
;         30.597         41.059         47.474         80.417         72.540         82.070
;         30.449         40.984         47.370         80.274         72.413         81.946
;         30.250         40.888         47.233         38.005         22.952         31.971
;         30.146         40.854         47.172         37.542         23.396         32.639
;         29.903         40.776         47.029         45.461         30.142         38.790
;         29.663         40.702         46.890         36.412         24.270         33.828
;         29.425         40.637         46.757         32.093         23.359         33.057
;         29.189         40.584         46.631         36.121         24.953         34.593
;         29.118         40.609         46.619         47.428         30.722         38.717
;         29.080         40.671         46.644         35.224         23.845         33.484
;         29.033         40.754         46.678         36.002         23.087         32.572
;         28.998         40.856         46.728         29.013         23.661         33.108
;         29.093         40.976         46.841         41.522         29.366         38.820
;         29.212         41.104         46.970         39.148         25.814         35.153
;         29.322         41.224         47.089         41.810         26.593         35.409


tr_str_4  = CREATE_STRUCT(['T0','T1','T2','T3'],tr_str_40,tr_str_41,tr_str_42,tr_str_43)
kv_str_4  = CREATE_STRUCT(['T0','T1','T2','T3'],kv_str_40,kv_str_41,kv_str_42,kv_str_43)
bv_str_4  = CREATE_STRUCT(['T0','T1','T2','T3'],bv_str_40,bv_str_41,bv_str_42,bv_str_43)
bm_str_4  = CREATE_STRUCT(['T0','T1','T2','T3'],bm_str_40,bm_str_41,bm_str_42,bm_str_43)
eg_str_4  = CREATE_STRUCT(['T0','T1','T2','T3'],eg_str_40,eg_str_41,eg_str_42,eg_str_43)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 5L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:42:12.190      -0.833       0.550       0.054      435179.19
;  1998-09-24/23:43:52.243      -0.894       0.445      -0.055      517020.22
;  1998-09-24/23:45:32.297      -0.800       0.581       0.150      369204.84
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.833,0.550,0.054]
qvec1     = [-0.894,0.445,-0.055]
qvec2     = [-0.800,0.581,0.150]
qmag0     = [435179.19]
qmag1     = [517020.22]
qmag2     = [369204.84]

;
; => For  3 Hz < f < 30 Hz  at  1998-09-24/23:43:18.951 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:43:19.0694',prefd[0]+'23:43:19.2214'])
tr1     = time_double([prefd[0]+'23:43:19.6502',prefd[0]+'23:43:19.7110'])
tr2     = time_double([prefd[0]+'23:43:19.9270',prefd[0]+'23:43:19.9995'])
kvec0   = [-0.35115,-0.92369, 0.15326]
kvec1   = [-0.59098, 0.26256, 0.76276]
kvec2   = [ 0.31415,-0.94866,-0.03686]
elam0   = [40.543304,1.4272298]
elam1   = [20.759092,19.873908]
elam2   = [14.219221,1.8227521]
bvec0   = [-0.21307, 0.97271, 0.09178]
bvec1   = [-0.23299, 0.97078, 0.05740]
bvec2   = [-0.24149, 0.96958, 0.03952]
bmag0   = [35.06914]
bmag1   = [35.94601]
bmag2   = [35.86503]
tr_str_50 = CREATE_STRUCT(tags[0L:2L],tr0,tr1,tr2)
kv_str_50 = CREATE_STRUCT(tags[0L:2L],kvec0,kvec1,kvec2)
bv_str_50 = CREATE_STRUCT(tags[0L:2L],bvec0,bvec1,bvec2)
bm_str_50 = CREATE_STRUCT(tags[0L:2L],bmag0,bmag1,bmag2)
eg_str_50 = CREATE_STRUCT(tags[0L:2L],elam0,elam1,elam2)

kv_str = kv_str_50
bv_str = bv_str_50
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [44.16,43.02,42.56]
thqb_during = [51.81,50.42,49.82]
thqb_after  = [41.46,40.62,40.32]
thqk_before = [78.04,47.32,38.24]
thqk_during = [83.94,52.90,45.49]
thqk_after  = [76.54,42.29,36.10]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         44.157         51.808         41.464         78.039         83.942         76.541
;         43.021         50.422         40.622         47.322         52.899         42.290
;         42.560         49.821         40.320         38.239         45.495         36.097

tr_str_5  = CREATE_STRUCT(['T0'],tr_str_50)
kv_str_5  = CREATE_STRUCT(['T0'],kv_str_50)
bv_str_5  = CREATE_STRUCT(['T0'],bv_str_50)
bm_str_5  = CREATE_STRUCT(['T0'],bm_str_50)
eg_str_5  = CREATE_STRUCT(['T0'],eg_str_50)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 6L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:43:52.243      -0.894       0.445      -0.055      517020.22
;  1998-09-24/23:45:32.297      -0.800       0.581       0.150      369204.84
;  1998-09-24/23:47:12.350      -0.765       0.377       0.522      503347.00
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.894,0.445,-0.055]
qvec1     = [-0.800,0.581,0.150]
qvec2     = [-0.765,0.377,0.522]
qmag0     = [517020.22]
qmag1     = [369204.84]
qmag2     = [503347.00]

;
; => For  3 Hz < f < 30 Hz  at  1998-09-24/23:45:52.184 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:45:52.4485',prefd[0]+'23:45:52.5099'])
tr1     = time_double([prefd[0]+'23:45:52.5504',prefd[0]+'23:45:52.6272'])
tr2     = time_double([prefd[0]+'23:45:53.1765',prefd[0]+'23:45:53.2757'])
kvec0   = [ 0.30986, 0.93395, 0.17814]
kvec1   = [ 0.40732,-0.89024, 0.20388]
kvec2   = [-0.74647, 0.60257, 0.28228]
elam0   = [13.853695,3.2561507]
elam1   = [111.40141,2.4391355]
elam2   = [10.556916,4.0535800]
bvec0   = [-0.40030, 0.84940, 0.34392]
bvec1   = [-0.41103, 0.86811, 0.27573]
bvec2   = [-0.32137, 0.94226, 0.09228]
bmag0   = [36.98357]
bmag1   = [37.39432]
bmag2   = [37.65568]
tr_str_60 = CREATE_STRUCT(tags[0L:2L],tr0,tr1,tr2)
kv_str_60 = CREATE_STRUCT(tags[0L:2L],kvec0,kvec1,kvec2)
bv_str_60 = CREATE_STRUCT(tags[0L:2L],bvec0,bvec1,bvec2)
bm_str_60 = CREATE_STRUCT(tags[0L:2L],bmag0,bmag1,bmag2)
eg_str_60 = CREATE_STRUCT(tags[0L:2L],elam0,elam1,elam2)

kv_str = kv_str_60
bv_str = bv_str_60
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [44.20,42.39,45.45]
thqb_during = [30.08,29.01,35.08]
thqb_after  = [36.30,38.22,49.51]
thqk_before = [82.60,39.51,23.08]
thqk_during = [71.25,35.66, 8.27]
thqk_after  = [77.99,57.26,18.99]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         44.198         30.080         36.295         82.600         71.249         77.992
;         42.387         29.008         38.219         39.510         35.659         57.262
;         45.450         35.076         49.515         23.079          8.266         18.991

;
; => For  10 Hz < f < 100 Hz  at  1998-09-24/23:45:52.184 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:45:52.4560',prefd[0]+'23:45:52.5045'])
tr1     = time_double([prefd[0]+'23:45:52.5403',prefd[0]+'23:45:52.6683'])
tr2     = time_double([prefd[0]+'23:45:53.0869',prefd[0]+'23:45:53.1013'])
kvec0   = [ 0.61631, 0.76502, 0.18685]
kvec1   = [-0.26467, 0.95178,-0.15513]
kvec2   = [ 0.21001, 0.77953, 0.59011]
elam0   = [14.575075,3.2713029]
elam1   = [12.309177,2.5921494]
elam2   = [31.044317,2.6369960]
bvec0   = [-0.40027, 0.84930, 0.34420]
bvec1   = [-0.41357, 0.87300, 0.25217]
bvec2   = [-0.32230, 0.92363, 0.20741]
bmag0   = [36.97547]
bmag1   = [37.52479]
bmag2   = [38.47757]
tr_str_61 = CREATE_STRUCT(tags[0L:2L],tr0,tr1,tr2)
kv_str_61 = CREATE_STRUCT(tags[0L:2L],kvec0,kvec1,kvec2)
bv_str_61 = CREATE_STRUCT(tags[0L:2L],bvec0,bvec1,bvec2)
bm_str_61 = CREATE_STRUCT(tags[0L:2L],bmag0,bmag1,bmag2)
eg_str_61 = CREATE_STRUCT(tags[0L:2L],elam0,elam1,elam2)

kv_str = kv_str_61
bv_str = bv_str_61
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [44.21,41.90,46.55]
thqb_during = [30.08,28.85,34.35]
thqb_after  = [36.29,39.00,45.33]
thqk_before = [77.24,48.03,82.72]
thqk_during = [88.82,42.14,68.07]
thqk_after  = [85.09,61.29,63.82]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         44.205         30.084         36.287         77.243         88.823         85.094
;         41.897         28.849         39.001         48.034         42.145         61.294
;         46.548         34.353         45.329         82.722         68.074         63.816

;
; => For  30 Hz < f < 100 Hz  at  1998-09-24/23:45:52.184 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:45:52.2805',prefd[0]+'23:45:52.3189'])
tr1     = time_double([prefd[0]+'23:45:52.4144',prefd[0]+'23:45:52.4299'])
tr2     = time_double([prefd[0]+'23:45:52.6053',prefd[0]+'23:45:52.6181'])
tr3     = time_double([prefd[0]+'23:45:52.9051',prefd[0]+'23:45:52.9200'])
tr4     = time_double([prefd[0]+'23:45:52.9888',prefd[0]+'23:45:53.0085'])
tr5     = time_double([prefd[0]+'23:45:53.0091',prefd[0]+'23:45:53.0421'])
tr6     = time_double([prefd[0]+'23:45:53.0592',prefd[0]+'23:45:53.0752'])
kvec0   = [ 0.12098, 0.99264, 0.00599]
kvec1   = [-0.50622,-0.80133, 0.31875]
kvec2   = [-0.38381, 0.75559,-0.53082]
kvec3   = [ 0.48207, 0.15612,-0.86211]
kvec4   = [-0.91343,-0.28841,-0.28717]
kvec5   = [-0.13019, 0.95333, 0.27241]
kvec6   = [-0.00459, 0.45789, 0.88900]
elam0   = [17.020331,2.3618471]
elam1   = [11.045271,4.1551802]
elam2   = [105.62444,3.3581263]
elam3   = [14.628501,2.2880040]
elam4   = [23.218763,1.9591213]
elam5   = [69.760363,2.7773742]
elam6   = [177.88869,1.7117800]
bvec0   = [-0.39363, 0.86680, 0.30613]
bvec1   = [-0.40175, 0.85313, 0.33282]
bvec2   = [-0.41674, 0.87697, 0.23921]
bvec3   = [-0.37812, 0.88589, 0.26874]
bvec4   = [-0.35177, 0.89643, 0.26956]
bvec5   = [-0.34326, 0.90304, 0.25813]
bvec6   = [-0.33056, 0.91603, 0.22716]
bmag0   = [36.96551]
bmag1   = [37.33871]
bmag2   = [37.62800]
bmag3   = [38.00787]
bmag4   = [37.89287]
bmag5   = [37.96736]
bmag6   = [38.26227]
tr_str_62 = CREATE_STRUCT(tags[0L:6L],tr0,tr1,tr2,tr3,tr4,tr5,tr6)
kv_str_62 = CREATE_STRUCT(tags[0L:6L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6)
bv_str_62 = CREATE_STRUCT(tags[0L:6L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6)
bm_str_62 = CREATE_STRUCT(tags[0L:6L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6)
eg_str_62 = CREATE_STRUCT(tags[0L:6L],elam0,elam1,elam2,elam3,elam4,elam5,elam6)

kv_str = kv_str_62
bv_str = bv_str_62
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [43.88,43.90,41.44,44.15,45.69,46.01,46.32]
thqb_during = [30.18,29.89,28.50,30.96,32.58,33.07,33.83]
thqb_after  = [38.03,36.61,39.26,40.22,41.60,42.46,44.21]
thqk_before = [70.53,85.50,44.88,71.69,45.25,58.29,80.85]
thqk_during = [61.26,89.27,48.21,64.90,58.66,45.66,66.23]
thqk_after  = [73.45,75.43,72.46,40.54,63.89,53.04,50.19]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         43.880         30.182         38.028         70.535         61.260         73.453
;         43.904         29.889         36.611         85.501         89.268         75.431
;         41.439         28.503         39.259         44.882         48.208         72.459
;         44.153         30.962         40.224         71.695         64.896         40.540
;         45.688         32.576         41.603         45.246         58.661         63.887
;         46.010         33.071         42.457         58.289         45.661         53.044
;         46.318         33.826         44.209         80.853         66.231         50.194

;
; => For  100 Hz < f < 300 Hz  at  1998-09-24/23:45:52.184 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:45:52.2720',prefd[0]+'23:45:52.2965'])
tr1     = time_double([prefd[0]+'23:45:52.3051',prefd[0]+'23:45:52.3168'])
tr2     = time_double([prefd[0]+'23:45:52.5173',prefd[0]+'23:45:52.5392'])
tr3     = time_double([prefd[0]+'23:45:52.5504',prefd[0]+'23:45:52.5680'])
tr4     = time_double([prefd[0]+'23:45:52.6064',prefd[0]+'23:45:52.6443'])
tr5     = time_double([prefd[0]+'23:45:52.6560',prefd[0]+'23:45:52.6768'])
tr6     = time_double([prefd[0]+'23:45:52.6864',prefd[0]+'23:45:52.7136'])
tr7     = time_double([prefd[0]+'23:45:52.7381',prefd[0]+'23:45:52.7643'])
tr8     = time_double([prefd[0]+'23:45:52.7648',prefd[0]+'23:45:52.7797'])
tr9     = time_double([prefd[0]+'23:45:52.7883',prefd[0]+'23:45:52.8048'])
tr10    = time_double([prefd[0]+'23:45:52.8160',prefd[0]+'23:45:52.8432'])
tr11    = time_double([prefd[0]+'23:45:52.8501',prefd[0]+'23:45:52.8688'])
tr12    = time_double([prefd[0]+'23:45:52.9072',prefd[0]+'23:45:52.9307'])
tr13    = time_double([prefd[0]+'23:45:53.0757',prefd[0]+'23:45:53.1019'])
tr14    = time_double([prefd[0]+'23:45:53.1312',prefd[0]+'23:45:53.1483'])
tr15    = time_double([prefd[0]+'23:45:53.2080',prefd[0]+'23:45:53.2192'])
kvec0   = [-0.26831, 0.96178,-0.05470]
kvec1   = [-0.15521, 0.98393,-0.08824]
kvec2   = [-0.44551, 0.88835, 0.11117]
kvec3   = [-0.37382, 0.92745,-0.00937]
kvec4   = [-0.43834, 0.87636, 0.19961]
kvec5   = [-0.56609, 0.80905, 0.15807]
kvec6   = [-0.01452, 0.03111, 0.99941]
kvec7   = [-0.24328, 0.96967,-0.02354]
kvec8   = [-0.17117, 0.98360, 0.05690]
kvec9   = [-0.11893, 0.95587,-0.26864]
kvec10  = [-0.50855, 0.86087,-0.01666]
kvec11  = [-0.30145, 0.92449,-0.23332]
kvec12  = [-0.39123, 0.86238,-0.32129]
kvec13  = [-0.89916, 0.14206, 0.41392]
kvec14  = [-0.95488,-0.04277,-0.29390]
kvec15  = [ 0.95346, 0.29549,-0.05992]
elam0   = [10.491600,3.5389407]
elam1   = [21.914105,3.4254733]
elam2   = [30.109949,2.0537280]
elam3   = [53.748889,3.8948033]
elam4   = [75.312227,2.9754440]
elam5   = [24.034594,3.1534748]
elam6   = [28.038376,12.250312]
elam7   = [38.539052,2.0964882]
elam8   = [14.175149,3.6809604]
elam9   = [13.241567,2.4419507]
elam10  = [45.270082,2.4018341]
elam11  = [20.998343,2.1831746]
elam12  = [29.284075,1.7958114]
elam13  = [62.121487,3.6812325]
elam14  = [15.798078,2.3363247]
elam15  = [50.222982,1.2351845]
bvec0   = [-0.39118, 0.86844, 0.30462]
bvec1   = [-0.39549, 0.86553, 0.30733]
bvec2   = [-0.40051, 0.85089, 0.33997]
bvec3   = [-0.40321, 0.85583, 0.32389]
bvec4   = [-0.41965, 0.88121, 0.21688]
bvec5   = [-0.41930, 0.89091, 0.17448]
bvec6   = [-0.41365, 0.89748, 0.15295]
bvec7   = [-0.40422, 0.90199, 0.15142]
bvec8   = [-0.40003, 0.89909, 0.17774]
bvec9   = [-0.39469, 0.89479, 0.20863]
bvec10  = [-0.38779, 0.88891, 0.24379]
bvec11  = [-0.38415, 0.88761, 0.25410]
bvec12  = [-0.37678, 0.88622, 0.26953]
bvec13  = [-0.32387, 0.92222, 0.21115]
bvec14  = [-0.31817, 0.93359, 0.16477]
bvec15  = [-0.31875, 0.94267, 0.09886]
bmag0   = [36.74172]
bmag1   = [37.13659]
bmag2   = [37.02854]
bmag3   = [37.11294]
bmag4   = [37.81704]
bmag5   = [37.65031]
bmag6   = [37.07808]
bmag7   = [36.62094]
bmag8   = [36.77810]
bmag9   = [37.00132]
bmag10  = [37.33335]
bmag11  = [37.57768]
bmag12  = [38.02568]
bmag13  = [38.43571]
bmag14  = [38.25774]
bmag15  = [37.75819]
tr_str_63 = CREATE_STRUCT(tags[0L:15L],tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,$
                          tr10,tr11,tr12,tr13,tr14,tr15)
kv_str_63  = CREATE_STRUCT(tags[0L:15L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                           kvec9,kvec10,kvec11,kvec12,kvec13,kvec14,kvec15)
bv_str_63  = CREATE_STRUCT(tags[0L:15L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6,bvec7,bvec8,$
                           bvec9,bvec10,bvec11,bvec12,bvec13,bvec14,bvec15)
bm_str_63  = CREATE_STRUCT(tags[0L:15L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6,bmag7,bmag8,$
                           bmag9,bmag10,bmag11,bmag12,bmag13,bmag14,bmag15)
eg_str_63  = CREATE_STRUCT(tags[0L:15L],elam0,elam1,elam2,elam3,elam4,elam5,elam6,elam7,elam8,$
                           elam9,elam10,elam11,elam12,elam13,elam14,elam15)

kv_str = kv_str_63
bv_str = bv_str_63
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [43.99,43.79,44.11,43.66,40.94,40.38,40.47,41.02,41.59,42.31,43.21,$
               43.58,44.24,46.50,46.30,45.65]
thqb_during = [30.32,30.08,30.03,29.73,28.33,28.45,28.92,29.52,29.65,29.90,30.32,$
               30.56,31.05,34.25,34.75,35.16]
thqb_after  = [38.22,37.88,36.42,36.85,39.96,41.61,42.72,43.25,42.46,41.57,40.62,$
               40.43,40.27,45.12,47.05,49.40]
thqk_before = [47.87,54.45,38.05,41.63,39.57,30.97,88.39,49.44,54.01,56.88,33.00,$
               46.07,41.31,32.40,31.70,44.14]
thqk_during = [40.07,46.95,27.23,33.23,27.15,18.80,79.65,41.02,44.20,52.40,25.24,$
               41.99,40.02,30.24,45.98,53.12]
thqk_after  = [57.36,63.67,42.80,50.90,39.65,34.86,57.01,57.36,57.90,71.87,45.18,$
               62.78,62.83,16.77,55.88,49.51]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         43.994         30.322         38.218         47.866         40.072         57.364
;         43.795         30.076         37.882         54.447         46.953         63.665
;         44.110         30.029         36.424         38.049         27.225         42.798
;         43.656         29.728         36.853         41.632         33.228         50.896
;         40.942         28.329         39.963         39.567         27.155         39.654
;         40.385         28.450         41.607         30.972         18.802         34.857
;         40.468         28.920         42.724         88.387         79.653         57.008
;         41.024         29.524         43.254         49.437         41.021         57.358
;         41.587         29.651         42.459         54.013         44.197         57.896
;         42.306         29.897         41.567         56.875         52.395         71.874
;         43.211         30.316         40.621         33.002         25.243         45.179
;         43.578         30.556         40.435         46.074         41.988         62.784
;         44.243         31.047         40.267         41.306         40.019         62.826
;         46.503         34.251         45.117         32.403         30.237         16.768
;         46.304         34.748         47.049         31.702         45.975         55.879
;         45.652         35.163         49.395         44.143         53.125         49.513

tr_str_6  = CREATE_STRUCT(['T0','T1','T2','T3'],tr_str_60,tr_str_61,tr_str_62,tr_str_63)
kv_str_6  = CREATE_STRUCT(['T0','T1','T2','T3'],kv_str_60,kv_str_61,kv_str_62,kv_str_63)
bv_str_6  = CREATE_STRUCT(['T0','T1','T2','T3'],bv_str_60,bv_str_61,bv_str_62,bv_str_63)
bm_str_6  = CREATE_STRUCT(['T0','T1','T2','T3'],bm_str_60,bm_str_61,bm_str_62,bm_str_63)
eg_str_6  = CREATE_STRUCT(['T0','T1','T2','T3'],eg_str_60,eg_str_61,eg_str_62,eg_str_63)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 7L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:43:52.243      -0.894       0.445      -0.055      517020.22
;  1998-09-24/23:45:32.297      -0.800       0.581       0.150      369204.84
;  1998-09-24/23:47:12.350      -0.765       0.377       0.522      503347.00
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.894,0.445,-0.055]
qvec1     = [-0.800,0.581,0.150]
qvec2     = [-0.765,0.377,0.522]
qmag0     = [517020.22]
qmag1     = [369204.84]
qmag2     = [503347.00]

;
; => For  3 Hz < f < 30 Hz  at  1998-09-24/23:45:53.379 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:45:53.3790',prefd[0]+'23:45:53.4830'])
tr1     = time_double([prefd[0]+'23:45:53.9603',prefd[0]+'23:45:54.0563'])
tr2     = time_double([prefd[0]+'23:45:54.1977',prefd[0]+'23:45:54.3625'])
kvec0   = [ 0.84150, 0.42724,-0.33067]
kvec1   = [-0.61395,-0.78848, 0.03698]
kvec2   = [-0.81915,-0.56581, 0.09404]
elam0   = [36.294570,3.4691180]
elam1   = [18.098118,2.7334335]
elam2   = [11.662294,4.6997212]
bvec0   = [-0.33137, 0.94228, 0.04754]
bvec1   = [-0.17263, 0.97093, 0.16525]
bvec2   = [-0.13380, 0.98966, 0.04879]
bmag0   = [36.55270]
bmag1   = [37.31338]
bmag2   = [37.31278]
tr_str_70 = CREATE_STRUCT(tags[0L:2L],tr0,tr1,tr2)
kv_str_70 = CREATE_STRUCT(tags[0L:2L],kvec0,kvec1,kvec2)
bv_str_70 = CREATE_STRUCT(tags[0L:2L],bvec0,bvec1,bvec2)
bm_str_70 = CREATE_STRUCT(tags[0L:2L],bmag0,bmag1,bmag2)
eg_str_70 = CREATE_STRUCT(tags[0L:2L],elam0,elam1,elam2)

kv_str = kv_str_70
bv_str = bv_str_70
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [44.52,54.74,56.13]
thqb_during = [34.95,43.36,46.42]
thqb_after  = [50.69,54.24,59.94]
thqk_before = [57.04,78.70,61.62]
thqk_during = [61.67,87.79,70.08]
thqk_after  = [49.06,78.95,62.46]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         44.525         34.946         50.687         57.044         61.668         49.059
;         54.739         43.364         54.242         78.699         87.788         78.947
;         56.128         46.421         59.939         61.617         70.081         62.456

;
; => For  10 Hz < f < 30 Hz  at  1998-09-24/23:45:53.379 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:45:53.4105',prefd[0]+'23:45:53.4670'])
tr1     = time_double([prefd[0]+'23:45:53.5315',prefd[0]+'23:45:53.5662'])
tr2     = time_double([prefd[0]+'23:45:53.5795',prefd[0]+'23:45:53.6318'])
tr3     = time_double([prefd[0]+'23:45:53.6510',prefd[0]+'23:45:53.7017'])
tr4     = time_double([prefd[0]+'23:45:53.7443',prefd[0]+'23:45:53.8147'])
tr5     = time_double([prefd[0]+'23:45:54.2206',prefd[0]+'23:45:54.2830'])
tr6     = time_double([prefd[0]+'23:45:54.4238',prefd[0]+'23:45:54.4707'])
kvec0   = [ 0.83506, 0.48611,-0.25763]
kvec1   = [ 0.83370, 0.52747,-0.16346]
kvec2   = [ 0.13241,-0.71833, 0.68298]
kvec3   = [-0.66941,-0.73580,-0.10243]
kvec4   = [ 0.23506, 0.96530, 0.11377]
kvec5   = [ 0.96623, 0.23769,-0.09950]
kvec6   = [ 0.98563,-0.16033,-0.05316]
elam0   = [12.422212,2.9564838]
elam1   = [3207.9226,6.6885591]
elam2   = [21.865255,1.4370167]
elam3   = [12.129272,3.1620564]
elam4   = [62.979651,5.1292091]
elam5   = [72.433134,3.4183791]
elam6   = [1579.4425,1.3766043]
bvec0   = [-0.33056, 0.94251, 0.04900]
bvec1   = [-0.29953, 0.95266, 0.05196]
bvec2   = [-0.27956, 0.95902, 0.04580]
bvec3   = [-0.26621, 0.96266, 0.04860]
bvec4   = [-0.26988, 0.95990, 0.07561]
bvec5   = [-0.12963, 0.98994, 0.05621]
bvec6   = [-0.21097, 0.97530, 0.06354]
bmag0   = [36.54142]
bmag1   = [36.66088]
bmag2   = [36.54723]
bmag3   = [36.25351]
bmag4   = [36.19436]
bmag5   = [37.62001]
bmag6   = [35.57579]
tr_str_71 = CREATE_STRUCT(tags[0L:6L],tr0,tr1,tr2,tr3,tr4,tr5,tr6)
kv_str_71 = CREATE_STRUCT(tags[0L:6L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6)
bv_str_71 = CREATE_STRUCT(tags[0L:6L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6)
bm_str_71 = CREATE_STRUCT(tags[0L:6L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6)
eg_str_71 = CREATE_STRUCT(tags[0L:6L],elam0,elam1,elam2,elam3,elam4,elam5,elam6)

kv_str = kv_str_71
bv_str = bv_str_71
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [44.58,46.46,47.61,48.42,48.37,56.40,51.75]
thqb_during = [34.98,36.78,38.03,38.78,38.28,46.58,41.84]
thqb_after  = [50.67,52.02,53.18,53.71,52.57,59.89,55.79]
thqk_before = [58.93,59.89,61.60,73.94,77.69,41.19,18.27]
thqk_during = [64.90,67.36,65.11,84.68,67.05,49.47,27.17]
thqk_after  = [53.84,58.38,89.11,79.56,75.91,45.45,32.63]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         44.582         34.976         50.670         58.932         64.896         53.840
;         46.460         36.783         52.018         59.893         67.355         58.382
;         47.610         38.028         53.179         61.602         65.113         89.107
;         48.417         38.779         53.705         73.939         84.683         79.558
;         48.374         38.284         52.569         77.693         67.054         75.908
;         56.405         46.584         59.886         41.187         49.473         45.453
;         51.748         41.845         55.789         18.272         27.173         32.627

;
; => For  15 Hz < f < 60 Hz  at  1998-09-24/23:45:53.379 UT
;
tr_str_72 = 0
kv_str_72 = 0
bv_str_72 = 0
bm_str_72 = 0
eg_str_72 = 0

;
; => For  30 Hz < f < 100 Hz  at  1998-09-24/23:45:53.379 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:45:53.8787',prefd[0]+'23:45:53.8990'])
tr1     = time_double([prefd[0]+'23:45:53.9134',prefd[0]+'23:45:53.9342'])
tr2     = time_double([prefd[0]+'23:45:53.9721',prefd[0]+'23:45:54.0009'])
tr3     = time_double([prefd[0]+'23:45:54.0014',prefd[0]+'23:45:54.0409'])
tr4     = time_double([prefd[0]+'23:45:54.0414',prefd[0]+'23:45:54.0595'])
tr5     = time_double([prefd[0]+'23:45:54.1182',prefd[0]+'23:45:54.1577'])
tr6     = time_double([prefd[0]+'23:45:54.2830',prefd[0]+'23:45:54.3022'])
kvec0   = [ 0.94764, 0.28012, 0.15335]
kvec1   = [-0.83295,-0.26101,-0.48793]
kvec2   = [ 0.86884, 0.46138, 0.17959]
kvec3   = [ 0.55075, 0.80295, 0.22792]
kvec4   = [ 0.78905, 0.61418,-0.01347]
kvec5   = [ 0.63555, 0.49466,-0.59278]
kvec6   = [ 0.85932, 0.30861, 0.40783]
elam0   = [41.533379,4.0895355]
elam1   = [38.376669,1.6240703]
elam2   = [34.812951,4.2771430]
elam3   = [38.793612,4.5146921]
elam4   = [56.005101,4.4059436]
elam5   = [38.873166,1.7444184]
elam6   = [15.980759,5.5799013]
bvec0   = [-0.22172, 0.96990, 0.10052]
bvec1   = [-0.19922, 0.97237, 0.12157]
bvec2   = [-0.17888, 0.97108, 0.15801]
bvec3   = [-0.16901, 0.97014, 0.17391]
bvec4   = [-0.16011, 0.97218, 0.17096]
bvec5   = [-0.13697, 0.98135, 0.13447]
bvec6   = [-0.13185, 0.99053, 0.03811]
bmag0   = [36.76622]
bmag1   = [36.74579]
bmag2   = [37.15865]
bmag3   = [37.42200]
bmag4   = [37.58584]
bmag5   = [37.88613]
bmag6   = [37.41882]
tr_str_73 = CREATE_STRUCT(tags[0L:6L],tr0,tr1,tr2,tr3,tr4,tr5,tr6)
kv_str_73 = CREATE_STRUCT(tags[0L:6L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6)
bv_str_73 = CREATE_STRUCT(tags[0L:6L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6)
bm_str_73 = CREATE_STRUCT(tags[0L:6L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6)
eg_str_73 = CREATE_STRUCT(tags[0L:6L],elam0,elam1,elam2,elam3,elam4,elam5,elam6)

kv_str = kv_str_73
bv_str = bv_str_73
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [51.37,52.83,54.31,55.02,55.50,56.51,56.18]
thqb_during = [40.89,42.05,43.03,43.54,44.06,45.58,46.63]
thqb_after  = [54.00,54.38,54.17,54.14,54.67,56.98,60.38]
thqk_before = [43.03,49.05,54.46,81.51,64.45,71.61,49.21]
thqk_during = [55.09,63.80,66.42,86.55,73.95,71.94,63.45]
thqk_after  = [57.36,73.49,66.61,89.98,67.72,52.47,70.84]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         51.370         40.890         54.003         43.032         55.085         57.365
;         52.834         42.050         54.377         49.054         63.799         73.495
;         54.313         43.029         54.167         54.458         66.417         66.611
;         55.023         43.536         54.139         81.513         86.554         89.979
;         55.504         44.064         54.673         64.446         73.953         67.722
;         56.512         45.580         56.979         71.612         71.943         52.473
;         56.182         46.631         60.384         49.207         63.450         70.844


tr_str_7  = CREATE_STRUCT(['T0','T1','T2','T3'],tr_str_70,tr_str_71,tr_str_72,tr_str_73)
kv_str_7  = CREATE_STRUCT(['T0','T1','T2','T3'],kv_str_70,kv_str_71,kv_str_72,kv_str_73)
bv_str_7  = CREATE_STRUCT(['T0','T1','T2','T3'],bv_str_70,bv_str_71,bv_str_72,bv_str_73)
bm_str_7  = CREATE_STRUCT(['T0','T1','T2','T3'],bm_str_70,bm_str_71,bm_str_72,bm_str_73)
eg_str_7  = CREATE_STRUCT(['T0','T1','T2','T3'],eg_str_70,eg_str_71,eg_str_72,eg_str_73)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 8L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:47:12.350      -0.765       0.377       0.522      503347.00
;  1998-09-24/23:48:52.404      -0.965       0.078       0.252      348453.34
;  1998-09-24/23:50:32.457      -0.986      -0.160       0.040      407451.53
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.765,0.377,0.522]
qvec1     = [-0.965,0.078,0.252]
qvec2     = [-0.986,-0.160,0.040]
qmag0     = [503347.00]
qmag1     = [348453.34]
qmag2     = [407451.53]

;
; => For  3 Hz < f < 30 Hz  at  1998-09-24/23:48:39.020 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:48:39.0893',prefd[0]+'23:48:39.1592'])
tr1     = time_double([prefd[0]+'23:48:39.4568',prefd[0]+'23:48:39.5896'])
tr2     = time_double([prefd[0]+'23:48:39.8269',prefd[0]+'23:48:39.8808'])
tr3     = time_double([prefd[0]+'23:48:39.9443',prefd[0]+'23:48:40.0003'])
kvec0   = [-0.69954,-0.70333, 0.12641]
kvec1   = [-0.99818, 0.02093,-0.05653]
kvec2   = [ 0.19072, 0.85902, 0.47508]
kvec3   = [-0.94753, 0.06257,-0.31350]
elam0   = [154.74879,1.2726007]
elam1   = [45.537709,2.4461524]
elam2   = [11.657016,4.1448612]
elam3   = [22.399406,1.3734763]
bvec0   = [-0.57094, 0.13760, 0.80938]
bvec1   = [-0.48937, 0.06926, 0.86869]
bvec2   = [-0.52446, 0.06980, 0.84855]
bvec3   = [-0.53003, 0.05332, 0.84630]
bmag0   = [35.77160]
bmag1   = [33.45378]
bmag2   = [35.60096]
bmag3   = [36.19178]
tr_str_80 = CREATE_STRUCT(tags[0L:3L],tr0,tr1,tr2,tr3)
kv_str_80 = CREATE_STRUCT(tags[0L:3L],kvec0,kvec1,kvec2,kvec3)
bv_str_80 = CREATE_STRUCT(tags[0L:3L],bvec0,bvec1,bvec2,bvec3)
bm_str_80 = CREATE_STRUCT(tags[0L:3L],bmag0,bmag1,bmag2,bmag3)
eg_str_80 = CREATE_STRUCT(tags[0L:3L],elam0,elam1,elam2,elam3)

kv_str = kv_str_80
bv_str = bv_str_80
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [24.34,31.36,29.49,29.85]
thqb_during = [40.03,45.85,43.50,43.21]
thqb_after  = [55.02,59.59,57.32,56.77]
thqk_before = [70.37,42.10,64.79,54.21]
thqk_during = [49.30,18.08,89.85,32.83]
thqk_after  = [36.16,11.88,72.15,24.26]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         24.337         40.035         55.019         70.368         49.304         36.164
;         31.358         45.849         59.590         42.099         18.079         11.876
;         29.487         43.499         57.324         64.790         89.847         72.152
;         29.849         43.205         56.775         54.211         32.834         24.257

;
; => For  4 Hz < f < 40 Hz  at  1998-09-24/23:48:39.020 UT
;
tr_str_81 = 0
kv_str_81 = 0
bv_str_81 = 0
bm_str_81 = 0
eg_str_81 = 0

;
; => For  10 Hz < f < 40 Hz  at  1998-09-24/23:48:39.020 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:48:39.0200',prefd[0]+'23:48:39.1555'])
tr1     = time_double([prefd[0]+'23:48:39.9987',prefd[0]+'23:48:40.0808'])
kvec0   = [ 0.47453,-0.38843, 0.78990]
kvec1   = [ 0.93018, 0.16024,-0.33029]
elam0   = [32.196043,2.3319916]
elam1   = [27.053090,2.2106113]
bvec0   = [-0.57287, 0.13625, 0.80823]
bvec1   = [-0.53793, 0.04520, 0.84176]
bmag0   = [35.97463]
bmag1   = [36.30701]
tr_str_82 = CREATE_STRUCT(tags[0L:1L],tr0,tr1)
kv_str_82 = CREATE_STRUCT(tags[0L:1L],kvec0,kvec1)
bv_str_82 = CREATE_STRUCT(tags[0L:1L],bvec0,bvec1)
bm_str_82 = CREATE_STRUCT(tags[0L:1L],bmag0,bmag1)
eg_str_82 = CREATE_STRUCT(tags[0L:1L],elam0,elam1)

kv_str = kv_str_82
bv_str = bv_str_82
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [24.29,29.78]
thqb_during = [39.90,42.71]
thqb_after  = [54.87,56.16]
thqk_before = [84.43,34.55]
thqk_during = [73.19,14.45]
thqk_after  = [68.03,17.06]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         24.285         39.904         54.874         84.426         73.192         68.029
;         29.778         42.714         56.163         34.554         14.452         17.058


tr_str_8  = CREATE_STRUCT(['T0','T1','T2'],tr_str_80,tr_str_81,tr_str_82)
kv_str_8  = CREATE_STRUCT(['T0','T1','T2'],kv_str_80,kv_str_81,kv_str_82)
bv_str_8  = CREATE_STRUCT(['T0','T1','T2'],bv_str_80,bv_str_81,bv_str_82)
bm_str_8  = CREATE_STRUCT(['T0','T1','T2'],bm_str_80,bm_str_81,bm_str_82)
eg_str_8  = CREATE_STRUCT(['T0','T1','T2'],eg_str_80,eg_str_81,eg_str_82)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 9L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:47:12.350      -0.765       0.377       0.522      503347.00
;  1998-09-24/23:48:52.404      -0.965       0.078       0.252      348453.34
;  1998-09-24/23:50:32.457      -0.986      -0.160       0.040      407451.53
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.765,0.377,0.522]
qvec1     = [-0.965,0.078,0.252]
qvec2     = [-0.986,-0.160,0.040]
qmag0     = [503347.00]
qmag1     = [348453.34]
qmag2     = [407451.53]

;
; => For  3 Hz < f < 30 Hz  at  1998-09-24/23:48:42.131 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:48:43.1358',prefd[0]+'23:48:43.2227'])
kvec0   = [-0.87410, 0.03281,-0.48464]
elam0   = [53.356093,2.1415350]
bvec0   = [-0.36657, 0.10617, 0.92429]
bmag0   = [36.70069]
tr_str_90 = CREATE_STRUCT(tags[0L:0L],tr0)
kv_str_90 = CREATE_STRUCT(tags[0L:0L],kvec0)
bv_str_90 = CREATE_STRUCT(tags[0L:0L],bvec0)
bm_str_90 = CREATE_STRUCT(tags[0L:0L],bmag0)
eg_str_90 = CREATE_STRUCT(tags[0L:0L],elam0)

kv_str = kv_str_90
bv_str = bv_str_90
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [36.59]
thqb_during = [53.49]
thqb_after  = [67.58]
thqk_before = [64.65]
thqk_during = [43.62]
thqk_after  = [33.15]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         36.589         53.491         67.578         64.655         43.620         33.152

;
; => For  5 Hz < f < 30 Hz  at  1998-09-24/23:48:42.131 UT
;
tr_str_91 = 0
kv_str_91 = 0
bv_str_91 = 0
bm_str_91 = 0
eg_str_91 = 0

;
; => For  7 Hz < f < 30 Hz  at  1998-09-24/23:48:42.131 UT
;
tr_str_92 = 0
kv_str_92 = 0
bv_str_92 = 0
bm_str_92 = 0
eg_str_92 = 0

;
; => For  65 Hz < f < 300 Hz  at  1998-09-24/23:48:42.131 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:48:42.9134',prefd[0]+'23:48:42.9486'])
tr1     = time_double([prefd[0]+'23:48:43.0430',prefd[0]+'23:48:43.1177'])
kvec0   = [ 0.50505,-0.35900,-0.78488]
kvec1   = [-0.37503, 0.18313, 0.90874]
elam0   = [41.869068,1.5556371]
elam1   = [17.150403,1.4015240]
bvec0   = [-0.35979, 0.04736, 0.93183]
bvec1   = [-0.35951, 0.08646, 0.92908]
bmag0   = [36.62919]
bmag1   = [36.61893]
tr_str_93 = CREATE_STRUCT(tags[0L:1L],tr0,tr1)
kv_str_93 = CREATE_STRUCT(tags[0L:1L],kvec0,kvec1)
bv_str_93 = CREATE_STRUCT(tags[0L:1L],bvec0,bvec1)
bm_str_93 = CREATE_STRUCT(tags[0L:1L],bmag0,bmag1)
eg_str_93 = CREATE_STRUCT(tags[0L:1L],elam0,elam1)

kv_str = kv_str_93
bv_str = bv_str_93
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [38.78,37.57]
thqb_during = [54.15,54.00]
thqb_after  = [67.39,67.80]
thqk_before = [21.34,33.87]
thqk_during = [44.51,52.76]
thqk_after  = [61.84,67.86]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         38.784         54.147         67.390         21.344         44.507         61.840
;         37.571         53.999         67.802         33.870         52.757         67.863

tr_str_9  = CREATE_STRUCT(['T0','T1','T2','T3'],tr_str_90,tr_str_91,tr_str_92,tr_str_93)
kv_str_9  = CREATE_STRUCT(['T0','T1','T2','T3'],kv_str_90,kv_str_91,kv_str_92,kv_str_93)
bv_str_9  = CREATE_STRUCT(['T0','T1','T2','T3'],bv_str_90,bv_str_91,bv_str_92,bv_str_93)
bm_str_9  = CREATE_STRUCT(['T0','T1','T2','T3'],bm_str_90,bm_str_91,bm_str_92,bm_str_93)
eg_str_9  = CREATE_STRUCT(['T0','T1','T2','T3'],eg_str_90,eg_str_91,eg_str_92,eg_str_93)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj        = 10L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-24/23:47:12.350      -0.765       0.377       0.522      503347.00
;  1998-09-24/23:48:52.404      -0.965       0.078       0.252      348453.34
;  1998-09-24/23:50:32.457      -0.986      -0.160       0.040      407451.53
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.765,0.377,0.522]
qvec1     = [-0.965,0.078,0.252]
qvec2     = [-0.986,-0.160,0.040]
qmag0     = [503347.00]
qmag1     = [348453.34]
qmag2     = [407451.53]

;
; => For  3 Hz < f < 30 Hz  at  1998-09-24/23:48:51.622 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:48:51.7292',prefd[0]+'23:48:51.7676'])
tr1     = time_double([prefd[0]+'23:48:51.8305',prefd[0]+'23:48:51.8700'])
tr2     = time_double([prefd[0]+'23:48:51.9985',prefd[0]+'23:48:52.0465'])
tr3     = time_double([prefd[0]+'23:48:52.1255',prefd[0]+'23:48:52.2140'])
tr4     = time_double([prefd[0]+'23:48:52.2140',prefd[0]+'23:48:52.2828'])
tr5     = time_double([prefd[0]+'23:48:52.4204',prefd[0]+'23:48:52.5100'])
tr6     = time_double([prefd[0]+'23:48:52.5745',prefd[0]+'23:48:52.6188'])
tr7     = time_double([prefd[0]+'23:48:52.6193',prefd[0]+'23:48:52.6700'])
tr8     = time_double([prefd[0]+'23:48:52.6705',prefd[0]+'23:48:52.7137'])
kvec0   = [ 0.97104,-0.07546,-0.22668]
kvec1   = [ 0.33812, 0.93928, 0.05848]
kvec2   = [ 0.80539,-0.09212, 0.58554]
kvec3   = [ 0.78323,-0.53048, 0.32427]
kvec4   = [ 0.11369,-0.25738, 0.95960]
kvec5   = [ 0.21867,-0.55855,-0.80013]
kvec6   = [-0.12104, 0.79854,-0.58965]
kvec7   = [ 0.87821,-0.35410, 0.32150]
kvec8   = [-0.19853, 0.39234, 0.89814]
elam0   = [17.035350,1.1485499]
elam1   = [21.521769,7.0496031]
elam2   = [24.369127,9.5501529]
elam3   = [27.153925,2.0031317]
elam4   = [76.307833,2.7608438]
elam5   = [14.580223,4.1599116]
elam6   = [42.643769,2.3939870]
elam7   = [26.732400,11.262658]
elam8   = [97.883290,4.5885985]
bvec0   = [-0.44006,-0.05226, 0.89645]
bvec1   = [-0.43928,-0.07447, 0.89525]
bvec2   = [-0.43960,-0.08303, 0.89435]
bvec3   = [-0.43170,-0.06896, 0.89937]
bvec4   = [-0.42504,-0.07594, 0.90195]
bvec5   = [-0.43640,-0.08465, 0.89575]
bvec6   = [-0.42788,-0.07712, 0.90054]
bvec7   = [-0.42489,-0.08280, 0.90145]
bvec8   = [-0.42234,-0.08726, 0.90223]
bmag0   = [35.99808]
bmag1   = [36.22013]
bmag2   = [36.40689]
bmag3   = [36.82518]
bmag4   = [36.70990]
bmag5   = [37.06684]
bmag6   = [36.77235]
bmag7   = [36.79766]
bmag8   = [36.84108]
tr_str_100  = CREATE_STRUCT(tags[0L:8L],tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8)
kv_str_100  = CREATE_STRUCT(tags[0L:8L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8)
bv_str_100  = CREATE_STRUCT(tags[0L:8L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6,bvec7,bvec8)
bm_str_100  = CREATE_STRUCT(tags[0L:8L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6,bmag7,bmag8)
eg_str_100  = CREATE_STRUCT(tags[0L:8L],elam0,elam1,elam2,elam3,elam4,elam5,elam6,elam7,elam8)

kv_str = kv_str_100
bv_str = bv_str_100
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [38.29,39.17,39.48,39.31,39.88,39.69,39.80,40.15,40.43]
thqb_during = [49.72,49.93,49.98,50.37,50.84,50.19,50.67,50.90,51.09]
thqb_after  = [61.44,61.26,61.15,61.79,62.14,61.34,61.95,62.08,62.19]
thqk_before = [27.17,82.76,69.81,50.96,71.52,37.30,85.08,50.39,39.77]
thqk_during = [ -NaN,76.21,50.44,44.32,83.57,62.86,88.25,37.43,63.35]
thqk_after  = [17.36,61.23,40.89,47.59,88.14,80.89,88.17,37.21,80.28]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         38.289         49.723         61.437         27.174           -NaN         17.362
;         39.168         49.932         61.259         82.763         76.215         61.228
;         39.480         49.976         61.151         69.806         50.444         40.891
;         39.311         50.368         61.793         50.958         44.318         47.591
;         39.884         50.837         62.140         71.524         83.567         88.136
;         39.690         50.189         61.337         37.295         62.857         80.895
;         39.795         50.667         61.949         85.075         88.252         88.166
;         40.148         50.896         62.079         50.394         37.432         37.212
;         40.434         51.089         62.194         39.770         63.352         80.276

;
; => For  6 Hz < f < 30 Hz  at  1998-09-24/23:48:51.622 UT
;
prefd   = '1998-09-24/'
tr0     = time_double([prefd[0]+'23:48:51.7292',prefd[0]+'23:48:51.7708'])
tr1     = time_double([prefd[0]+'23:48:51.8012',prefd[0]+'23:48:51.8396'])
tr2     = time_double([prefd[0]+'23:48:51.8396',prefd[0]+'23:48:51.8727'])
tr3     = time_double([prefd[0]+'23:48:51.8988',prefd[0]+'23:48:51.9772'])
tr4     = time_double([prefd[0]+'23:48:51.9969',prefd[0]+'23:48:52.0407'])
tr5     = time_double([prefd[0]+'23:48:52.1121',prefd[0]+'23:48:52.1452'])
tr6     = time_double([prefd[0]+'23:48:52.1628',prefd[0]+'23:48:52.1980'])
tr7     = time_double([prefd[0]+'23:48:52.2407',prefd[0]+'23:48:52.2860'])
tr8     = time_double([prefd[0]+'23:48:52.5793',prefd[0]+'23:48:52.6060'])
tr9     = time_double([prefd[0]+'23:48:52.6449',prefd[0]+'23:48:52.6833'])
kvec0   = [ 0.97591,-0.10233, 0.19267]
kvec1   = [-0.26654, 0.19362, 0.94417]
kvec2   = [-0.87608,-0.10477, 0.47065]
kvec3   = [-0.94313, 0.31190, 0.11497]
kvec4   = [ 0.78947, 0.03079, 0.61301]
kvec5   = [-0.91682, 0.39446, 0.06195]
kvec6   = [-0.08897, 0.05393, 0.99457]
kvec7   = [-0.53149, 0.42313,-0.73381]
kvec8   = [ 0.52519, 0.56150,-0.63945]
kvec9   = [-0.85805, 0.40195, 0.31967]
elam0   = [59.084627,2.2420611]
elam1   = [42.325833,4.2162804]
elam2   = [29.079338,1.8947801]
elam3   = [96.270569,11.498885]
elam4   = [152.72944,6.1228892]
elam5   = [122.13862,16.406894]
elam6   = [31.633553,16.152013]
elam7   = [57.354470,11.282906]
elam8   = [109.46513,2.4674859]
elam9   = [60.743539,4.9412592]
bvec0   = [-0.44005,-0.05247, 0.89644]
bvec1   = [-0.43961,-0.06764, 0.89563]
bvec2   = [-0.43918,-0.07548, 0.89522]
bvec3   = [-0.43586,-0.07279, 0.89707]
bvec4   = [-0.43938,-0.08250, 0.89450]
bvec5   = [-0.43742,-0.07189, 0.89638]
bvec6   = [-0.43009,-0.06838, 0.90019]
bvec7   = [-0.42618,-0.08185, 0.90091]
bvec8   = [-0.42812,-0.07656, 0.90047]
bvec9   = [-0.42372,-0.08535, 0.90176]
bmag0   = [35.99711]
bmag1   = [36.13456]
bmag2   = [36.23442]
bmag3   = [36.29160]
bmag4   = [36.40070]
bmag5   = [36.87651]
bmag6   = [36.80124]
bmag7   = [36.72199]
bmag8   = [36.76735]
bmag9   = [36.81766]
tr_str_101  = CREATE_STRUCT(tags[0L:9L],tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9)
kv_str_101  = CREATE_STRUCT(tags[0L:9L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,kvec9)
bv_str_101  = CREATE_STRUCT(tags[0L:9L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6,bvec7,bvec8,bvec9)
bm_str_101  = CREATE_STRUCT(tags[0L:9L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6,bmag7,bmag8,bmag9)
eg_str_101  = CREATE_STRUCT(tags[0L:9L],elam0,elam1,elam2,elam3,elam4,elam5,elam6,elam7,elam8,elam9)

kv_str = kv_str_101
bv_str = bv_str_101
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [38.30,38.89,39.21,39.26,39.47,39.16,39.36,40.05,39.76,40.30]
thqb_during = [49.72,49.86,49.95,50.13,49.99,50.03,50.46,50.81,50.65,50.99]
thqb_after  = [61.44,61.31,61.25,61.49,61.17,61.40,61.90,62.01,61.94,62.13]
thqk_before = [46.80,39.67,28.79,25.96,74.20,28.06,52.59,79.45,58.41,12.89]
thqk_during = [25.69,59.32,17.09,15.54,52.77,21.39,70.08,68.84,51.38,19.96]
thqk_after  = [20.25,74.36,25.92,27.80,40.64,32.50,83.17,64.72,50.71,37.39]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         38.298         49.725         61.436         46.798         25.686         20.254
;         38.893         49.861         61.308         39.668         59.320         74.360
;         39.211         49.945         61.255         28.791         17.089         25.920
;         39.262         50.134         61.492         25.961         15.545         27.795
;         39.470         49.986         61.170         74.196         52.774         40.639
;         39.156         50.030         61.402         28.065         21.391         32.505
;         39.363         50.465         61.900         52.587         70.081         83.173
;         40.053         50.809         62.008         79.452         68.840         64.723
;         39.763         50.648         61.940         58.407         51.380         50.709
;         40.298         50.989         62.127         12.887         19.961         37.391

;
; => For  10 Hz < f < 100 Hz  at  1998-09-24/23:48:51.622 UT
;
tr_str_102 = 0
kv_str_102 = 0
bv_str_102 = 0
bm_str_102 = 0
eg_str_102 = 0


tr_str_10  = CREATE_STRUCT(['T0','T1','T2'],tr_str_100,tr_str_101,tr_str_102)
kv_str_10  = CREATE_STRUCT(['T0','T1','T2'],kv_str_100,kv_str_101,kv_str_102)
bv_str_10  = CREATE_STRUCT(['T0','T1','T2'],bv_str_100,bv_str_101,bv_str_102)
bm_str_10  = CREATE_STRUCT(['T0','T1','T2'],bm_str_100,bm_str_101,bm_str_102)
eg_str_10  = CREATE_STRUCT(['T0','T1','T2'],eg_str_100,eg_str_101,eg_str_102)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 11L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-25/00:03:53.396      -0.818      -0.560      -0.135      321150.75
;  1998-09-25/00:05:33.451      -0.951      -0.306      -0.054      296470.44
;  1998-09-25/00:07:13.506      -0.894      -0.043      -0.446      319071.34
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.818,-0.560,-0.135]
qvec1     = [-0.951,-0.306,-0.054]
qvec2     = [-0.894,-0.043,-0.446]
qmag0     = [321150.75]
qmag1     = [296470.44]
qmag2     = [319071.34]

;
; => For  3 Hz < f < 30 Hz  at  1998-09-25/00:04:04.545 UT
;
prefd   = '1998-09-25/'
tr0     = time_double([prefd[0]+'00:04:04.6714',prefd[0]+'00:04:04.7482'])
tr1     = time_double([prefd[0]+'00:04:04.9002',prefd[0]+'00:04:04.9690'])
tr2     = time_double([prefd[0]+'00:04:05.0522',prefd[0]+'00:04:05.0954'])
tr3     = time_double([prefd[0]+'00:04:05.2682',prefd[0]+'00:04:05.3530'])
tr4     = time_double([prefd[0]+'00:04:05.3311',prefd[0]+'00:04:05.3866'])
tr5     = time_double([prefd[0]+'00:04:05.4527',prefd[0]+'00:04:05.5098'])
kvec0   = [-0.07775,-0.78702,-0.61201]
kvec1   = [-0.97773,-0.06902, 0.19821]
kvec2   = [-0.89497,-0.19178,-0.40280]
kvec3   = [ 0.84838, 0.24190, 0.47090]
kvec4   = [ 0.99316, 0.10809,-0.04425]
kvec5   = [ 0.93980, 0.28381, 0.19032]
elam0   = [44.67490,7.648347]
elam1   = [37.91687,3.085668]
elam2   = [76.34742,29.75200]
elam3   = [50.19652,1.461794]
elam4   = [80.99939,4.727877]
elam5   = [1636.188,4.059537]
bvec0   = [-0.10802, 0.97756,-0.18084]
bvec1   = [-0.14572, 0.97975,-0.13716]
bvec2   = [-0.17636, 0.97927,-0.09965]
bvec3   = [-0.18466, 0.97561,-0.11852]
bvec4   = [-0.19465, 0.97332,-0.12142]
bvec5   = [-0.20073, 0.96818,-0.14933]
bmag0   = [23.77359]
bmag1   = [23.31873]
bmag2   = [23.31872]
bmag3   = [23.24363]
bmag4   = [23.18337]
bmag5   = [23.18519]
tr_str_110  = CREATE_STRUCT(tags[0L:5L],tr0,tr1,tr2,tr3,tr4,tr5)
kv_str_110  = CREATE_STRUCT(tags[0L:5L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5)
bv_str_110  = CREATE_STRUCT(tags[0L:5L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5)
bm_str_110  = CREATE_STRUCT(tags[0L:5L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5)
eg_str_110  = CREATE_STRUCT(tags[0L:5L],elam0,elam1,elam2,elam3,elam4,elam5)

kv_str = kv_str_110
bv_str = bv_str_110
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [64.24,65.74,67.00,67.71,68.32,69.03]
thqb_during = [79.24,81.15,82.73,83.31,83.91,84.42]
thqb_after  = [82.23,81.41,80.79,79.86,79.26,78.20]
thqk_before = [54.06,35.74,26.64,26.75,29.89,17.56]
thqk_during = [69.65,19.91,21.32,25.01,12.79, 7.75]
thqk_after  = [67.89,37.94, 8.89,11.80,29.21,20.40]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         64.236         79.243         82.230         54.059         69.646         67.895
;         65.736         81.152         81.413         35.740         19.908         37.940
;         67.003         82.729         80.793         26.638         21.322          8.886
;         67.710         83.308         79.863         26.746         25.007         11.798
;         68.319         83.906         79.262         29.893         12.792         29.215
;         69.033         84.416         78.204         17.563          7.747         20.402

;
; => For  5 Hz < f < 50 Hz  at  1998-09-25/00:04:04.545 UT
;
tr_str_111 = 0
kv_str_111 = 0
bv_str_111 = 0
bm_str_111 = 0
eg_str_111 = 0

;
; => For  7 Hz < f < 50 Hz  at  1998-09-25/00:04:04.545 UT
;
prefd   = '1998-09-25/'
tr0     = time_double([prefd[0]+'00:04:05.0666',prefd[0]+'00:04:05.1130'])
tr1     = time_double([prefd[0]+'00:04:05.2815',prefd[0]+'00:04:05.3354'])
tr2     = time_double([prefd[0]+'00:04:05.3498',prefd[0]+'00:04:05.3914'])
tr3     = time_double([prefd[0]+'00:04:05.4559',prefd[0]+'00:04:05.4874'])
tr4     = time_double([prefd[0]+'00:04:05.4879',prefd[0]+'00:04:05.5418'])
tr5     = time_double([prefd[0]+'00:04:05.5823',prefd[0]+'00:04:05.6106'])
kvec0   = [ 0.95221, 0.05256, 0.30090]
kvec1   = [ 0.85275, 0.24633, 0.46058]
kvec2   = [-0.94919, 0.23615,-0.20804]
kvec3   = [-0.89935,-0.36793, 0.23623]
kvec4   = [-0.81977, 0.14215,-0.55476]
kvec5   = [-0.99147,-0.07696, 0.10516]
elam0   = [16.01954,5.404104]
elam1   = [536.5472,5.093474]
elam2   = [46.49745,2.695802]
elam3   = [41.23364,3.844631]
elam4   = [41.94646,3.269069]
elam5   = [89.75117,1.702374]
bvec0   = [-0.17864, 0.97896,-0.09857]
bvec1   = [-0.18435, 0.97576,-0.11787]
bvec2   = [-0.19663, 0.97269,-0.12332]
bvec3   = [-0.20134, 0.96850,-0.14653]
bvec4   = [-0.19905, 0.96719,-0.15781]
bvec5   = [-0.19773, 0.96529,-0.17061]
bmag0   = [23.41982]
bmag1   = [23.23606]
bmag2   = [23.19373]
bmag3   = [23.19260]
bmag4   = [23.16525]
bmag5   = [23.15012]
tr_str_112  = CREATE_STRUCT(tags[0L:5L],tr0,tr1,tr2,tr3,tr4,tr5)
kv_str_112  = CREATE_STRUCT(tags[0L:5L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5)
bv_str_112  = CREATE_STRUCT(tags[0L:5L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5)
bm_str_112  = CREATE_STRUCT(tags[0L:5L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5)
eg_str_112  = CREATE_STRUCT(tags[0L:5L],elam0,elam1,elam2,elam3,elam4,elam5)

kv_str = kv_str_112
bv_str = bv_str_112
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [67.12,67.68,68.46,69.03,69.05,69.16]
thqb_during = [82.86,83.29,84.03,84.44,84.37,84.37]
thqb_after  = [80.70,79.90,79.11,78.25,78.07,77.80]
thqk_before = [31.90,26.15,47.76,24.52,48.25,32.87]
thqk_during = [20.30,24.33,32.69,17.23,40.00,16.10]
thqk_after  = [ 8.98,11.94,21.38,44.40,13.05,32.56]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         67.121         82.857         80.702         31.901         20.301          8.982
;         67.684         83.287         79.897         26.146         24.326         11.939
;         68.456         84.031         79.108         47.757         32.685         21.376
;         69.030         84.435         78.246         24.520         17.232         44.399
;         69.053         84.368         78.068         48.252         39.999         13.047
;         69.158         84.369         77.798         32.868         16.104         32.565

tr_str_11  = CREATE_STRUCT(['T0','T1','T2'],tr_str_110,tr_str_111,tr_str_112)
kv_str_11  = CREATE_STRUCT(['T0','T1','T2'],kv_str_110,kv_str_111,kv_str_112)
bv_str_11  = CREATE_STRUCT(['T0','T1','T2'],bv_str_110,bv_str_111,bv_str_112)
bm_str_11  = CREATE_STRUCT(['T0','T1','T2'],bm_str_110,bm_str_111,bm_str_112)
eg_str_11  = CREATE_STRUCT(['T0','T1','T2'],eg_str_110,eg_str_111,eg_str_112)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 12L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-25/00:03:53.396      -0.818      -0.560      -0.135      321150.75
;  1998-09-25/00:05:33.451      -0.951      -0.306      -0.054      296470.44
;  1998-09-25/00:07:13.506      -0.894      -0.043      -0.446      319071.34
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.818,-0.560,-0.135]
qvec1     = [-0.951,-0.306,-0.054]
qvec2     = [-0.894,-0.043,-0.446]
qmag0     = [321150.75]
qmag1     = [296470.44]
qmag2     = [319071.34]

;
; => For  3 Hz < f < 30 Hz  at  1998-09-25/00:05:23.432 UT
;
prefd   = '1998-09-25/'
tr0     = time_double([prefd[0]+'00:05:23.5024',prefd[0]+'00:05:23.6352'])
tr1     = time_double([prefd[0]+'00:05:23.8000',prefd[0]+'00:05:23.8832'])
tr2     = time_double([prefd[0]+'00:05:23.8832',prefd[0]+'00:05:24.0026'])
tr3     = time_double([prefd[0]+'00:05:24.0448',prefd[0]+'00:05:24.1232'])
tr4     = time_double([prefd[0]+'00:05:24.2629',prefd[0]+'00:05:24.3472'])
tr5     = time_double([prefd[0]+'00:05:24.3472',prefd[0]+'00:05:24.4512'])
kvec0   = [-0.11640, 0.21932, 0.96869]
kvec1   = [ 0.52467, 0.55136,-0.64863]
kvec2   = [-0.75587,-0.64998, 0.07862]
kvec3   = [ 0.33095, 0.94358,-0.01133]
kvec4   = [-0.90514,-0.19579, 0.37735]
kvec5   = [-0.67826, 0.66451, 0.31368]
elam0   = [28.30867,2.740280]
elam1   = [50.15574,10.98032]
elam2   = [48.82638,3.673204]
elam3   = [56.84211,12.16274]
elam4   = [16.72766,3.656796]
elam5   = [16.60950,1.863353]
bvec0   = [-0.46626, 0.80732, 0.36156]
bvec1   = [-0.49286, 0.83919, 0.22942]
bvec2   = [-0.47873, 0.85567, 0.19650]
bvec3   = [-0.46905, 0.85942, 0.20335]
bvec4   = [-0.44775, 0.87069, 0.20319]
bvec5   = [-0.44929, 0.88446, 0.11779]
bmag0   = [22.78819]
bmag1   = [24.16436]
bmag2   = [23.88314]
bmag3   = [23.40712]
bmag4   = [24.16453]
bmag5   = [24.03419]
tr_str_120  = CREATE_STRUCT(tags[0L:5L],tr0,tr1,tr2,tr3,tr4,tr5)
kv_str_120  = CREATE_STRUCT(tags[0L:5L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5)
bv_str_120  = CREATE_STRUCT(tags[0L:5L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5)
bm_str_120  = CREATE_STRUCT(tags[0L:5L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5)
eg_str_120  = CREATE_STRUCT(tags[0L:5L],elam0,elam1,elam2,elam3,elam4,elam5)

kv_str = kv_str_120
bv_str = bv_str_120
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [83.14,84.39,83.45,82.82,81.45,81.74]
thqb_during = [79.81,78.49,79.47,80.09,81.47,81.36]
thqb_after  = [77.24,72.41,72.33,73.04,74.20,71.87]
thqk_before = [80.89,49.43,13.67,37.10,36.96,81.93]
thqk_during = [89.50,50.75,24.01,52.93,25.80,64.87]
thqk_after  = [70.28,78.26,48.04,70.65,49.51,64.03]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         83.136         79.814         77.240         80.887         89.500         70.281
;         84.390         78.491         72.410         49.430         50.754         78.260
;         83.448         79.466         72.329         13.669         24.009         48.038
;         82.817         80.090         73.041         37.099         52.925         70.647
;         81.445         81.465         74.203         36.955         25.799         49.510
;         81.739         81.357         71.875         81.932         64.865         64.031

;
; => For  5 Hz < f < 50 Hz  at  1998-09-25/00:05:23.432 UT
;
tr_str_121 = 0
kv_str_121 = 0
bv_str_121 = 0
bm_str_121 = 0
eg_str_121 = 0

;
; => For  40 Hz < f < 200 Hz  at  1998-09-25/00:05:23.432 UT
;
prefd   = '1998-09-25/'
tr0     = time_double([prefd[0]+'00:05:23.4592',prefd[0]+'00:05:23.4816'])
tr1     = time_double([prefd[0]+'00:05:23.5008',prefd[0]+'00:05:23.5162'])
tr2     = time_double([prefd[0]+'00:05:23.5328',prefd[0]+'00:05:23.5658'])
tr3     = time_double([prefd[0]+'00:05:23.6128',prefd[0]+'00:05:23.6234'])
tr4     = time_double([prefd[0]+'00:05:23.7376',prefd[0]+'00:05:23.7658'])
tr5     = time_double([prefd[0]+'00:05:23.7728',prefd[0]+'00:05:23.7904'])
tr6     = time_double([prefd[0]+'00:05:23.8208',prefd[0]+'00:05:23.8528'])
tr7     = time_double([prefd[0]+'00:05:23.9408',prefd[0]+'00:05:23.9834'])
tr8     = time_double([prefd[0]+'00:05:24.0405',prefd[0]+'00:05:24.0592'])
tr9     = time_double([prefd[0]+'00:05:24.0928',prefd[0]+'00:05:24.1088'])
tr10    = time_double([prefd[0]+'00:05:24.1520',prefd[0]+'00:05:24.1680'])
tr11    = time_double([prefd[0]+'00:05:24.1744',prefd[0]+'00:05:24.1920'])
tr12    = time_double([prefd[0]+'00:05:24.3920',prefd[0]+'00:05:24.4160'])
kvec0   = [ 0.74360, 0.52564,-0.41324]
kvec1   = [ 0.86050, 0.31942,-0.39688]
kvec2   = [-0.89009,-0.41376, 0.19116]
kvec3   = [-0.99850, 0.04916, 0.02395]
kvec4   = [ 0.83505, 0.46736,-0.29028]
kvec5   = [-0.77294,-0.61234, 0.16615]
kvec6   = [ 0.80826, 0.54728, 0.21726]
kvec7   = [-0.82616,-0.56179,-0.04289]
kvec8   = [-0.81419,-0.54185,-0.20858]
kvec9   = [-0.85966,-0.45820, 0.22593]
kvec10  = [-0.61446,-0.53876, 0.57634]
kvec11  = [ 0.73035, 0.06084, 0.68036]
kvec12  = [ 0.92761, 0.31431,-0.20189]
elam0   = [46.37128,6.088881]
elam1   = [39.93233,3.328742]
elam2   = [69.55151,3.968775]
elam3   = [113.8069,4.732501]
elam4   = [16.63271,1.794867]
elam5   = [192.6935,1.209217]
elam6   = [22.42992,1.856203]
elam7   = [42.68345,3.854229]
elam8   = [34.09875,1.501903]
elam9   = [19.95830,6.366848]
elam10   = [18.91188,7.481237]
elam11   = [16.84900,3.517154]
elam12   = [30.64021,3.922757]
bvec0   = [-0.44980, 0.81470, 0.36598]
bvec1   = [-0.45408, 0.81098, 0.36894]
bvec2   = [-0.46143, 0.80812, 0.36609]
bvec3   = [-0.47723, 0.80474, 0.35306]
bvec4   = [-0.49707, 0.81869, 0.28746]
bvec5   = [-0.49867, 0.82524, 0.26513]
bvec6   = [-0.49376, 0.83808, 0.23194]
bvec7   = [-0.47667, 0.85745, 0.19380]
bvec8   = [-0.47226, 0.85910, 0.19727]
bvec9   = [-0.46694, 0.85972, 0.20699]
bvec10  = [-0.45506, 0.86160, 0.22489]
bvec11  = [-0.45103, 0.86311, 0.22718]
bvec12  = [-0.44884, 0.88664, 0.11090]
bmag0   = [22.28275]
bmag1   = [22.49725]
bmag2   = [22.69914]
bmag3   = [23.00872]
bmag4   = [23.96739]
bmag5   = [24.12446]
bmag6   = [24.17150]
bmag7   = [23.80768]
bmag8   = [23.46935]
bmag9   = [23.39295]
bmag10  = [23.48533]
bmag11  = [23.55203]
bmag12  = [23.96985]
tr_str_122  = CREATE_STRUCT(tags[0L:12L],tr0,tr1,tr2,tr3,tr4,tr5,tr6,tr7,tr8,tr9,$
                            tr10,tr11,tr12)
kv_str_122  = CREATE_STRUCT(tags[0L:12L],kvec0,kvec1,kvec2,kvec3,kvec4,kvec5,kvec6,kvec7,kvec8,$
                            kvec9,kvec10,kvec11,kvec12)
bv_str_122  = CREATE_STRUCT(tags[0L:12L],bvec0,bvec1,bvec2,bvec3,bvec4,bvec5,bvec6,bvec7,bvec8,$
                            bvec9,bvec10,bvec11,bvec12)
bm_str_122  = CREATE_STRUCT(tags[0L:12L],bmag0,bmag1,bmag2,bmag3,bmag4,bmag5,bmag6,bmag7,bmag8,$
                            bmag9,bmag10,bmag11,bmag12)
eg_str_122  = CREATE_STRUCT(tags[0L:12L],elam0,elam1,elam2,elam3,elam4,elam5,elam6,elam7,elam8,$
                            elam9,elam10,elam11,elam12)

kv_str = kv_str_122
bv_str = bv_str_122
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [82.09,82.38,82.85,83.80,84.80,84.84,84.45,83.31,83.03,82.68,81.92,81.66,81.70]
thqb_during = [80.87,80.58,80.11,79.13,78.07,78.03,78.43,79.60,79.89,80.22,80.97,81.23,81.40]
thqb_after  = [78.24,78.08,77.61,76.43,73.68,73.02,72.43,72.37,72.71,73.25,74.37,74.65,71.72]
thqk_before = [32.13,33.98,20.93,38.19,25.10,17.68, 4.47, 5.00, 3.97,21.68,43.40,43.67,24.83]
thqk_during = [32.25,26.54,15.68,21.05,22.86,24.01,18.58,16.28,17.94,19.00,44.10,41.42,14.66]
thqk_after  = [59.80,52.70,43.26,28.37,50.42,49.97,32.54,38.57,32.41,46.57,71.61,16.47,41.17]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         82.085         80.869         78.237         32.131         32.254         59.796
;         82.385         80.576         78.081         33.985         26.537         52.698
;         82.847         80.109         77.614         20.934         15.685         43.258
;         83.803         79.133         76.433         38.186         21.055         28.374
;         84.798         78.073         73.682         25.095         22.858         50.419
;         84.836         78.030         73.018         17.684         24.011         49.966
;         84.448         78.429         72.426          4.466         18.584         32.540
;         83.315         79.603         72.372          5.002         16.280         38.568
;         83.026         79.887         72.706          3.969         17.943         32.412
;         82.679         80.223         73.252         21.675         18.995         46.570
;         81.916         80.969         74.367         43.404         44.103         71.612
;         81.659         81.225         74.646         43.669         41.417         16.466
;         81.701         81.399         71.719         24.832         14.662         41.170

tr_str_12  = CREATE_STRUCT(['T0','T1','T2'],tr_str_120,tr_str_121,tr_str_122)
kv_str_12  = CREATE_STRUCT(['T0','T1','T2'],kv_str_120,kv_str_121,kv_str_122)
bv_str_12  = CREATE_STRUCT(['T0','T1','T2'],bv_str_120,bv_str_121,bv_str_122)
bm_str_12  = CREATE_STRUCT(['T0','T1','T2'],bm_str_120,bm_str_121,bm_str_122)
eg_str_12  = CREATE_STRUCT(['T0','T1','T2'],eg_str_120,eg_str_121,eg_str_122)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 13L
;---------------------------------------------------------------------------------------------------
;      Date       Time            Qx          Qy          Qz           |Q|
;                                 GSE         GSE         GSE    [eV km/s cm^(-3)]
;===================================================================================================
;  1998-09-25/00:13:53.725      -0.828      -0.531       0.182      279494.59
;  1998-09-25/00:15:33.780      -0.587      -0.809       0.031      231217.73
;  1998-09-25/00:17:13.834      -0.778      -0.609      -0.154      222925.72
;---------------------------------------------------------------------------------------------------
qvec0     = [-0.828,-0.531,0.182]
qvec1     = [-0.587,-0.809,0.031]
qvec2     = [-0.778,-0.609,-0.154]
qmag0     = [279494.59]
qmag1     = [231217.73]
qmag2     = [222925.72]

;
; => For  3 Hz < f < 30 Hz  at  1998-09-25/00:14:50.603 UT
;
prefd   = '1998-09-25/'
tr0     = time_double([prefd[0]+'00:14:50.6478',prefd[0]+'00:14:50.7032'])
tr1     = time_double([prefd[0]+'00:14:50.9112',prefd[0]+'00:14:51.0158'])
tr2     = time_double([prefd[0]+'00:14:51.3822',prefd[0]+'00:14:51.4424'])
tr3     = time_double([prefd[0]+'00:14:51.4899',prefd[0]+'00:14:51.5678'])
tr4     = time_double([prefd[0]+'00:14:51.6467',prefd[0]+'00:14:51.6947'])
kvec0   = [ 0.74314,-0.33136,-0.58133]
kvec1   = [-0.97299,-0.20495, 0.10626]
kvec2   = [ 0.76670, 0.56290,-0.30871]
kvec3   = [-0.82809,-0.00588,-0.56056]
kvec4   = [ 0.76815, 0.62058, 0.15759]
elam0   = [51.32791,2.290718]
elam1   = [43.49175,1.476469]
elam2   = [16.63086,1.498320]
elam3   = [60.74822,1.520173]
elam4   = [211.9974,7.537972]
bvec0   = [-0.38238, 0.77342,-0.50559]
bvec1   = [-0.38277, 0.76930,-0.51153]
bvec2   = [-0.37472, 0.78302,-0.49644]
bvec3   = [-0.37477, 0.78392,-0.49498]
bvec4   = [-0.37646, 0.78298,-0.49519]
bmag0   = [23.57741]
bmag1   = [23.49861]
bmag2   = [23.38134]
bmag3   = [23.16161]
bmag4   = [22.82554]
tr_str_130  = CREATE_STRUCT(tags[0L:4L],tr0,tr1,tr2,tr3,tr4)
kv_str_130  = CREATE_STRUCT(tags[0L:4L],kvec0,kvec1,kvec2,kvec3,kvec4)
bv_str_130  = CREATE_STRUCT(tags[0L:4L],bvec0,bvec1,bvec2,bvec3,bvec4)
bm_str_130  = CREATE_STRUCT(tags[0L:4L],bmag0,bmag1,bmag2,bmag3,bmag4)
eg_str_130  = CREATE_STRUCT(tags[0L:4L],elam0,elam1,elam2,elam3,elam4)

kv_str = kv_str_130
bv_str = bv_str_130
thqb0  = DBLARR(n_tags(kv_str))
thqb1  = DBLARR(n_tags(kv_str))
thqb2  = DBLARR(n_tags(kv_str))
thqk0  = DBLARR(n_tags(kv_str))
thqk1  = DBLARR(n_tags(kv_str))
thqk2  = DBLARR(n_tags(kv_str))
for j=0L, n_tags(kv_str) - 1L do begin $
  kvec     = kv_str.(j) & $
  bvec     = bv_str.(j) & $
  thqb00   = acos(my_dot_prod(bvec,qvec0,/NOM))*18d1/!DPI & $
  thqb10   = acos(my_dot_prod(bvec,qvec1,/NOM))*18d1/!DPI & $
  thqb20   = acos(my_dot_prod(bvec,qvec2,/NOM))*18d1/!DPI & $
  thqk00   = acos(my_dot_prod(kvec,qvec0,/NOM))*18d1/!DPI & $
  thqk10   = acos(my_dot_prod(kvec,qvec1,/NOM))*18d1/!DPI & $
  thqk20   = acos(my_dot_prod(kvec,qvec2,/NOM))*18d1/!DPI & $
  thqb0[j] = thqb00 < (18d1 - thqb00) & $
  thqb1[j] = thqb10 < (18d1 - thqb10) & $
  thqb2[j] = thqb20 < (18d1 - thqb20) & $
  thqk0[j] = thqk00 < (18d1 - thqk00) & $
  thqk1[j] = thqk10 < (18d1 - thqk10) & $
  thqk2[j] = thqk20 < (18d1 - thqk20) 

tkqb   = '(a14,"[",'
FOR k=0L, n_tags(kv_str) - 1L DO BEGIN                                 $
  tkqb += 'f5.2,",",' & $
  IF (k EQ n_tags(kv_str) - 1L) THEN tkqb = STRMID(tkqb,0L,STRLEN(tkqb)-4L)+'"]")'

pref0  = 'thqb_before = '
pref1  = 'thqb_during = '
pref2  = 'thqb_after  = '
pref3  = 'thqk_before = '
pref4  = 'thqk_during = '
pref5  = 'thqk_after  = '

PRINT,FORMAT=tkqb,pref0,thqb0
PRINT,FORMAT=tkqb,pref1,thqb1
PRINT,FORMAT=tkqb,pref2,thqb2
PRINT,FORMAT=tkqb,pref3,thqk0
PRINT,FORMAT=tkqb,pref4,thqk1
PRINT,FORMAT=tkqb,pref5,thqk2

thqb_before = [79.28,79.36,78.70,78.69,78.80]
thqb_during = [65.36,65.57,64.60,64.56,64.67]
thqb_after  = [84.51,84.73,83.75,83.71,83.82]
thqk_before = [56.96,20.96, 8.14,54.07,20.47]
thqk_during = [79.27,42.25,23.79,61.74,18.55]
thqk_after  = [73.33,30.07,26.91,42.76, 1.08]


mform  = '(";",6f15.3)'
for j=0L, n_tags(kv_str) - 1L do begin $
  PRINT,FORMAT=mform,thqb0[j], thqb1[j], thqb2[j], thqk0[j], thqk1[j], thqk2[j]
;         79.275         65.360         84.511         56.964         79.270         73.331
;         79.359         65.573         84.725         20.964         42.248         30.067
;         78.705         64.603         83.750          8.145         23.793         26.905
;         78.695         64.561         83.707         54.073         61.740         42.764
;         78.803         64.672         83.818         20.467         18.546          1.079

;
; => For  7 Hz < f < 50 Hz  at  1998-09-25/00:14:50.603 UT
;
tr_str_131 = 0
kv_str_131 = 0
bv_str_131 = 0
bm_str_131 = 0
eg_str_131 = 0

;
; => For  10 Hz < f < 100 Hz  at  1998-09-25/00:14:50.603 UT
;
tr_str_132 = 0
kv_str_132 = 0
bv_str_132 = 0
bm_str_132 = 0
eg_str_132 = 0

;
; => For  20 Hz < f < 100 Hz  at  1998-09-25/00:14:50.603 UT
;
tr_str_133 = 0
kv_str_133 = 0
bv_str_133 = 0
bm_str_133 = 0
eg_str_133 = 0

tr_str_13  = CREATE_STRUCT(['T0','T1','T2','T3'],tr_str_130,tr_str_131,tr_str_132,tr_str_133)
kv_str_13  = CREATE_STRUCT(['T0','T1','T2','T3'],kv_str_130,kv_str_131,kv_str_132,kv_str_133)
bv_str_13  = CREATE_STRUCT(['T0','T1','T2','T3'],bv_str_130,bv_str_131,bv_str_132,bv_str_133)
bm_str_13  = CREATE_STRUCT(['T0','T1','T2','T3'],bm_str_130,bm_str_131,bm_str_132,bm_str_133)
eg_str_13  = CREATE_STRUCT(['T0','T1','T2','T3'],eg_str_130,eg_str_131,eg_str_132,eg_str_133)
;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
jj      = 14L

tr_str_140 = 0
kv_str_140 = 0
bv_str_140 = 0
bm_str_140 = 0
eg_str_140 = 0

tr_str_141 = 0
kv_str_141 = 0
bv_str_141 = 0
bm_str_141 = 0
eg_str_141 = 0

tr_str_142 = 0
kv_str_142 = 0
bv_str_142 = 0
bm_str_142 = 0
eg_str_142 = 0


tr_str_14  = CREATE_STRUCT(['T0','T1','T2'],tr_str_140,tr_str_141,tr_str_142)
kv_str_14  = CREATE_STRUCT(['T0','T1','T2'],kv_str_140,kv_str_141,kv_str_142)
bv_str_14  = CREATE_STRUCT(['T0','T1','T2'],bv_str_140,bv_str_141,bv_str_142)
bm_str_14  = CREATE_STRUCT(['T0','T1','T2'],bm_str_140,bm_str_141,bm_str_142)
eg_str_14  = CREATE_STRUCT(['T0','T1','T2'],eg_str_140,eg_str_141,eg_str_142)

;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
tags      = ['t0','t1','t2','t3','t4','t5','t6','t7','t8','t9','t10','t11','t12','t13','t14']
tr_str    = CREATE_STRUCT(tags,tr_str_0,tr_str_1,tr_str_2,tr_str_3,tr_str_4,tr_str_5,$
                          tr_str_6,tr_str_7,tr_str_8,tr_str_9,tr_str_10,tr_str_11,   $
                          tr_str_12,tr_str_13,tr_str_14)
kv_str    = CREATE_STRUCT(tags,kv_str_0,kv_str_1,kv_str_2,kv_str_3,kv_str_4,kv_str_5,$
                          kv_str_6,kv_str_7,kv_str_8,kv_str_9,kv_str_10,kv_str_11,   $
                          kv_str_12,kv_str_13,kv_str_14)
bv_str    = CREATE_STRUCT(tags,bv_str_0,bv_str_1,bv_str_2,bv_str_3,bv_str_4,bv_str_5,$
                          bv_str_6,bv_str_7,bv_str_8,bv_str_9,bv_str_10,bv_str_11,   $
                          bv_str_12,bv_str_13,bv_str_14)
bm_str    = CREATE_STRUCT(tags,bm_str_0,bm_str_1,bm_str_2,bm_str_3,bm_str_4,bm_str_5,$
                          bm_str_6,bm_str_7,bm_str_8,bm_str_9,bm_str_10,bm_str_11,   $
                          bm_str_12,bm_str_13,bm_str_14)
eg_str    = CREATE_STRUCT(tags,eg_str_0,eg_str_1,eg_str_2,eg_str_3,eg_str_4,eg_str_5,$
                          eg_str_6,eg_str_7,eg_str_8,eg_str_9,eg_str_10,eg_str_11,   $
                          eg_str_12,eg_str_13,eg_str_14)


lfc1  = [3d0,5d0,1d1, 5d1,1d2]   ; => For 1998-09-24/23:20:38.842 UT
hfc1  = [2d1,2d1,45d0,2d2,2d2]   ; => For 1998-09-24/23:20:38.842 UT
lfc2  = [3d0,6d0,15d0, 3d1]      ; => For 1998-09-24/23:22:26.632 UT
hfc2  = [2d1,3d1,15d1,15d1]      ; => For 1998-09-24/23:22:26.632 UT
lfc3  = [3d0,6d0,15d0, 3d1]      ; => For 1998-09-24/23:22:48.150 UT
hfc3  = [2d1,3d1,15d1,15d1]      ; => For 1998-09-24/23:22:48.150 UT
lfc4  = [3d0]                    ; => For 1998-09-24/23:30:00.465 UT
hfc4  = [3d1]                    ; => For 1998-09-24/23:30:00.465 UT
lfc5  = [3d0,1d1,4d1,2d2]        ; => For 1998-09-24/23:30:48.542 UT
hfc5  = [4d1,4d1,1d2,4d2]        ; => For 1998-09-24/23:30:48.542 UT
lfc6  = [3d0]                    ; => For 1998-09-24/23:43:18.951 UT
hfc6  = [3d1]                    ; => For 1998-09-24/23:43:18.951 UT
lfc7  = [3d0,1d1,3d1,1d2]        ; => For 1998-09-24/23:45:52.184 UT
hfc7  = [3d1,1d2,1d2,3d2]        ; => For 1998-09-24/23:45:52.184 UT
lfc8  = [3d0,1d1,15d0,30d0]      ; => For 1998-09-24/23:45:53.379 UT
hfc8  = [3d1,3d1,6d1 ,1d2 ]      ; => For 1998-09-24/23:45:53.379 UT
lfc9  = [3d0,4d0,1d1]            ; => For 1998-09-24/23:48:39.020 UT
hfc9  = [3d1,4d1,4d1]            ; => For 1998-09-24/23:48:39.020 UT
lfc10 = [3d0,5d0,7d0,65d0]       ; => For 1998-09-24/23:48:42.131 UT
hfc10 = [3d1,3d1,3d1,3d2]        ; => For 1998-09-24/23:48:42.131 UT
lfc11 = [3d0,6d0,1d1]            ; => For 1998-09-24/23:48:51.622 UT
hfc11 = [3d1,3d1,1d2]            ; => For 1998-09-24/23:48:51.622 UT
lfc12 = [3d0,5d0,7d0]            ; => For 1998-09-25/00:04:04.545 UT
hfc12 = [3d1,5d1,5d1]            ; => For 1998-09-25/00:04:04.545 UT
lfc13 = [3d0,5d0,4d1]            ; => For 1998-09-25/00:05:23.432 UT
hfc13 = [3d1,5d1,2d2]            ; => For 1998-09-25/00:05:23.432 UT
lfc14 = [3d0,7d0,1d1,2d1]        ; => For 1998-09-25/00:14:50.603 UT
hfc14 = [3d1,5d1,1d2,1d2]        ; => For 1998-09-25/00:14:50.603 UT
lfc15 = [3d0,1d1,3d1]            ; => For 1998-09-25/00:28:42.305 UT
hfc15 = [3d1,5d1,2d2]            ; => For 1998-09-25/00:28:42.305 UT

tags  = ['t1','t2','t3','t4','t5','t6','t7','t8','t9',$
         't10','t11','t12','t13','t14','t15']

lf_str = CREATE_STRUCT(tags,lfc1,lfc2,lfc3,lfc4,lfc5,lfc6,lfc7,lfc8,lfc9,$
                       lfc10,lfc11,lfc12,lfc13,lfc14,lfc15)
hf_str = CREATE_STRUCT(tags,hfc1,hfc2,hfc3,hfc4,hfc5,hfc6,hfc7,hfc8,hfc9,$
                       hfc10,hfc11,hfc12,hfc13,hfc14,hfc15)
no_str = CREATE_STRUCT(tags,16.586,21.087,21.499,24.340,24.016,24.699,20.004,19.946,$
                            24.534,24.764,25.467,22.313,21.804,14.165,15.225)
n_uq   = N_TAGS(tr_str) - 1L


latexform = '(a17," & $<$",f6.3,",",f6.3,",",f6.3,"$>$ & ",f6.3," & $<$",'
latexform += 'f6.3,",",f6.3,",",f6.3,"$>$ & ",f6.2,"$^{o}$",'
latexform += '" & ",f6.2,"$^{o}$ '
latexform += '& ",f7.3," & ",f7.3,"  \ML")'


gnorm      = [-0.914,-0.220,-0.341]   ; => Using RH08 from JCK's site
dgnorm     = [ 0.004, 0.009, 0.327]
jj        = 0L
FOR j=0L, n_uq DO BEGIN                                                           $
  lfc0       = lf_str.(j)                                                       & $
  hfc0       = hf_str.(j)                                                       & $
  fwl_str    = STRTRIM(STRING(FORMAT='(f15.1)',lfc0),2)                         & $
  fwh_str    = STRTRIM(STRING(FORMAT='(f15.1)',hfc0),2)                         & $
  fil_str    = fwl_str[*]+'-'+fwh_str[*]+'Hz'                                   & $
  n_fr       = N_ELEMENTS(lfc0) - 1L                                            & $
  FOR k=0L, n_fr DO BEGIN                                                         $
    tr_0       = tr_str.(j).(k)                                                 & $
    kv_0       = kv_str.(j).(k)                                                 & $
    bv_0       = bv_str.(j).(k)                                                 & $
    bm_0       = bm_str.(j).(k)                                                 & $
    eg_0       = eg_str.(j).(k)                                                 & $
    IF (SIZE(tr_0,/TYPE) NE 8L) THEN GOTO,JUMP_FREE                             & $
    n_tras     = N_TAGS(tr_0)                                                   & $
    tt_00      = STRMID((time_string(tr_0.(0)[0],PREC=4))[*],0L,17L)+'00'       & $
    PRINT,'Time From:  '+tt_00[0]                                               & $
    PRINT,'For Frequencies between:  '+fil_str[k]                               & $
    FOR p=0L, n_tras - 1L DO BEGIN                                                $
      tr0   = STRMID((time_string(tr_0.(p),PREC=4))[*],17L)                     & $
      tra   = tr0[0]+' - '+tr0[1]                                               & $
      thkb  = ACOS(my_dot_prod(kv_0.(p),bv_0.(p),/NOM))*18d1/!DPI               & $
      thkn  = ACOS(my_dot_prod(kv_0.(p),gnorm,/NOM))*18d1/!DPI                  & $
      thkbs = 18d1 - thkb[0]                                                    & $
      thkns = 18d1 - thkn[0]                                                    & $
      thkbg = thkbs < thkb                                                      & $
      thkng = thkns < thkn                                                      & $
      PRINT,tra[0],kv_0.(p),bm_0.(p),bv_0.(p),thkbg[0],thkng[0],eg_0.(p),FORMAT=latexform  & $
    ENDFOR                                                                      & $
    JUMP_FREE:


n_uq      = N_TAGS(tr_str) - 1L
f         = !VALUES.F_NAN
d         = !VALUES.D_NAN
c         = 2.99792458d8      ; -Speed of light in vacuum (m/s)
ndat      = 1000L
nvec      = [-0.914,-0.220,-0.341]   ; => Using RH08 from JCK's site
scet_0924  = ['1998/09/24 23:20:38.842',$
              '1998/09/24 23:22:26.632','1998/09/24 23:22:48.150',$
              '1998/09/24 23:30:00.465','1998/09/24 23:30:48.542',$
              '1998/09/24 23:43:18.951','1998/09/24 23:45:52.184',$
              '1998/09/24 23:45:53.379','1998/09/24 23:48:39.020',$
              '1998/09/24 23:48:42.131','1998/09/24 23:48:51.622',$
              '1998/09/25 00:04:04.545','1998/09/25 00:05:23.432',$
              '1998/09/25 00:14:50.603'                           ]+' UT'
scets0     = string_replace_char(STRMID(scet_0924[*],0L,23L),'/','-')
scets1     = string_replace_char(scets0,' ','/')
tr0        = file_name_times(scets1,PREC=3)   
prefx      = tr0.F_TIME

DELVAR,lf_str,hf_str,tr_str,no_str,kv_str,bv_str,bm_str,nvec,ndat,prefx
temp      = temp_excited_cold_surf(lf_str,hf_str,tr_str,no_str,kv_str,bv_str,$
                                   bm_str,NVEC=nvec,NDAT=ndat,PREFX=prefx,DATE='092498')




