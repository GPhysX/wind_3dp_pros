;-----------------------------------------------------------------------------------------
; => Constants and dummy variables
;-----------------------------------------------------------------------------------------
f      = !VALUES.F_NAN
d      = !VALUES.D_NAN
kB     = 1.380658d-23      ; -Boltzmann Constant (J/K)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
K_eV   = 1.160474d4        ; -Conversion = degree Kelvin/eV
epo    = 8.854187817d-12   ; -Permittivity of free space (F/m)
muo    = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
me     = 9.1093897d-31     ; -Electron mass (kg)
mp     = 1.6726231d-27     ; -Proton mass (kg)
qq     = 1.60217733d-19    ; -Fundamental charge (C)
c      = 2.99792458d8      ; -Speed of light in vacuum (m/s)
c2     = (c*1d-3)^2        ; -" " squared (km/s)^2
me_ev  = 0.5109906d6       ; -Electron mass in eV/c^2
me_3dp = me_ev/c2          ; -Electron mass [eV/(km/s)^2]
mp_ev  = 938.27231d6       ; -Proton mass in eV/c^2
mp_3dp = mp_ev/c2          ; -Proton mass [eV/(km/s)^2]

invdenf = 1d-6*(2d0*!DPI)^2*(me*epo/qq^2)  ; => [cm^(-3) s^2]
fpefac  = SQRT(qq^2/me/epo*1d6)/(2d0*!DPI)
fcefac  = qq/me/(2d0*!DPI)*1d-9
ctheta_kb = COS(FINDGEN(100)*!DPI/2d0/99)



'--------------------------------------------------------------------------------------------------------------------------------'
' => Whistlers on 2000/04/10'
'--------------------------------------------------------------------------------------------------------------------------------'


' => TDSF'
;---------------------------------------------------------------------------------------------
;               SCET                   Rad. Dist.      L-Shell         MLT          Inv. Lat.
;=============================================================================================
;    2000/04/10 02:45:39.736 UT          5.076          5.133         23.710         63.869
;    2000/04/10 02:49:27.780 UT          5.046          5.083         23.828         63.757
;    2000/04/10 02:50:55.652 UT          5.036          5.068         23.875         63.716
;    2000/04/10 02:50:57.440 UT          5.035          5.068         23.876         63.715
;    2000/04/10 02:52:29.005 UT          5.025          5.055         23.924         63.674
;    2000/04/10 02:52:47.911 UT          5.022          5.052         23.934         63.666
;    2000/04/10 02:55:37.951 UT          5.004          5.031          0.024         63.595
;    2000/04/10 02:55:53.362 UT          5.002          5.029          0.032         63.589
;    2000/04/10 02:56:32.084 UT          4.998          5.024          0.053         63.574
;    2000/04/10 02:56:34.562 UT          4.998          5.024          0.054         63.573
;    2000/04/10 02:56:43.654 UT          4.997          5.023          0.059         63.570
;    2000/04/10 03:11:02.788 UT          4.931          4.905          0.526         63.312
;    2000/04/10 03:11:03.216 UT          4.931          4.905          0.526         63.311
;    2000/04/10 03:11:04.462 UT          4.931          4.905          0.527         63.311
;    2000/04/10 03:11:05.114 UT          4.931          4.905          0.527         63.311
;    2000/04/10 03:11:06.333 UT          4.930          4.904          0.528         63.311
;    2000/04/10 03:11:07.636 UT          4.930          4.904          0.529         63.310
;    2000/04/10 03:11:08.783 UT          4.930          4.904          0.529         63.310
;    2000/04/10 03:11:10.422 UT          4.930          4.904          0.530         63.310
;    2000/04/10 03:11:11.272 UT          4.930          4.904          0.531         63.310
;    2000/04/10 03:20:49.379 UT          4.909          4.896          0.851         63.215
;    2000/04/10 03:44:20.795 UT          4.937          4.965          1.640         63.329
;    2000/04/10 03:47:52.891 UT          4.952          4.999          1.758         63.398
;    2000/04/10 04:00:15.167 UT          5.021          5.102          2.168         63.607
;    2000/04/10 04:14:45.376 UT          5.137          5.219          2.637         64.092
;    2000/04/10 04:14:59.775 UT          5.140          5.221          2.645         64.100
;    2000/04/10 04:32:44.807 UT          5.332          5.441          3.193         64.684
;---------------------------------------------------------------------------------------------

;--------------------------------------------------------------------------------------------------------------------------------
;               SCET                   Exrms       Eyrms       Ex_pk      Ey_pk
;================================================================================================================================
;    2000/04/10 02:45:39.736 UT       22.35       13.45      109.26       59.58
;    2000/04/10 02:49:27.780 UT       20.93       20.81       81.60       91.73
;    2000/04/10 02:50:55.652 UT       19.52       34.10      103.43      184.30
;    2000/04/10 02:50:57.440 UT       17.59       23.18      107.08      142.35
;    2000/04/10 02:52:29.005 UT       15.60       16.78      134.03      149.01
;    2000/04/10 02:52:47.911 UT       15.67       20.35      132.34      185.96
;    2000/04/10 02:55:37.951 UT       17.15       23.42      105.24      156.93
;    2000/04/10 02:55:53.362 UT       14.17       20.04      113.33      166.85
;    2000/04/10 02:56:32.084 UT       17.39       22.08      106.88      149.79
;    2000/04/10 02:56:34.562 UT       15.21       29.42      121.59      245.25
;    2000/04/10 02:56:43.654 UT       13.67       20.19      109.13      156.12
;    2000/04/10 03:11:02.788 UT       25.01       31.96      150.81      189.60
;    2000/04/10 03:11:03.216 UT       22.65       34.68      139.86      184.34
;    2000/04/10 03:11:04.462 UT       17.39       22.35      109.33      159.91
;    2000/04/10 03:11:05.114 UT       23.51       38.24      127.17      200.62
;    2000/04/10 03:11:06.333 UT       24.09       61.25      104.01      980.99
;    2000/04/10 03:11:07.636 UT       22.47       32.29      129.07      219.96
;    2000/04/10 03:11:08.783 UT       22.16       30.08      128.34      184.49
;    2000/04/10 03:11:10.422 UT       22.54       27.76      141.57      144.79
;    2000/04/10 03:11:11.272 UT       20.95       35.18      115.85      188.33
;    2000/04/10 03:20:49.379 UT        9.69       10.19       90.55      109.10
;    2000/04/10 03:44:20.795 UT       16.19       11.88      107.38      110.76
;    2000/04/10 03:47:52.891 UT       13.75        3.35       98.43       17.67
;    2000/04/10 04:00:15.167 UT       11.51        7.38       71.74       56.77
;    2000/04/10 04:14:45.376 UT       17.38       19.16      132.69      175.46
;    2000/04/10 04:14:59.775 UT        6.18        2.65       37.61       16.02
;    2000/04/10 04:32:44.807 UT        4.82        3.43       37.74       31.30
;--------------------------------------------------------------------------------------------------------------------------------


' => TDSS'
;---------------------------------------------------------------------------------------------
;               SCET                   Rad. Dist.      L-Shell         MLT          Inv. Lat.
;=============================================================================================
;    2000/04/10 02:49:47.201 UT          5.044          5.080         23.839         63.748
;    2000/04/10 02:49:47.303 UT          5.044          5.080         23.839         63.748
;    2000/04/10 02:55:03.002 UT          5.007          5.035          0.006         63.609
;    2000/04/10 03:10:43.077 UT          4.932          4.907          0.515         63.316
;    2000/04/10 03:14:11.849 UT          4.921          4.894          0.630         63.273
;    2000/04/10 03:47:32.845 UT          4.950          4.996          1.747         63.391
;    2000/04/10 03:48:25.816 UT          4.954          5.004          1.776         63.406
;--------------------------------------------------------------------------------------------------------------------------------

;--------------------------------------------------------------------------------------------------------------------------------
;               SCET                   Brms        By_pk      Exrms       Eyrms       Ezrms       Ex_pk      Ey_pk        Ez_pk
;================================================================================================================================
;    2000/04/10 02:49:47.201 UT        0.36        1.47       12.20       18.43        0.13       51.21       73.67        0.55
;    2000/04/10 02:49:47.303 UT        0.38        1.79       11.44       19.59        0.10       54.15       88.36        0.39
;    2000/04/10 02:55:03.002 UT        0.15        0.83        5.51        7.80        0.09       30.50       44.11        0.29
;    2000/04/10 03:10:43.077 UT        0.29        1.20        9.74       13.07        6.96       38.88       56.80       28.48
;    2000/04/10 03:14:11.849 UT        0.20        1.34        6.06        6.37        4.64       45.46       47.90       33.74
;    2000/04/10 03:47:32.845 UT        0.14        1.02        4.76        2.02        1.73       30.19       16.09       15.15
;    2000/04/10 03:48:25.816 UT        0.24        1.56        7.03        4.36        2.38       49.84       33.48       15.90
;--------------------------------------------------------------------------------------------------------------------------------

; => Estimated from |E|/|B_y| from TDSS measurements (km/s)
;---------------------------------------------------------------------------------------------
;               SCET                     Max Vph_RMS         Max Vph_PK
;=============================================================================================
;    2000/04/10 02:49:47.201 UT           61395.913           61035.363
;    2000/04/10 02:49:47.303 UT           59699.832           57895.713
;    2000/04/10 02:55:03.002 UT           63668.655           64612.764
;    2000/04/10 03:10:43.077 UT           61116.648           62076.369
;    2000/04/10 03:14:11.849 UT           49706.663           55341.793
;    2000/04/10 03:47:32.845 UT           38947.180           36680.907
;    2000/04/10 03:48:25.816 UT           35865.999           39814.589
;---------------------------------------------------------------------------------------------

flow       = [4e2,5e2,5.5e2,6e2,8e2,7e2,1e3]
fhigh      = [1.6e3,1.2e3,1.2e3,1.7e3,2.1e3,2.0e3,2.1e3]
bmag       = [180.143,180.149,175.288,167.754,165.653,164.606,162.511]  ; => nT
dens       = [47.816,47.818,53.472,70.921,70.845,56.493,56.647]         ; => cm^(-3)
fpeo       = fpefac[0]*sqrt(dens)                                       ; => Hz
fceo       = fcefac[0]*bmag                                             ; => Hz
e_inert    = c/fpeo                                                     ; => m

vph_low_0  = e_inert[0]*sqrt(flow[0]*fceo[0]*(2d0*!DPI)^2*(ctheta_kb - flow[0]/fceo[0]))
vph_low_1  = e_inert[1]*sqrt(flow[1]*fceo[1]*(2d0*!DPI)^2*(ctheta_kb - flow[1]/fceo[1]))
vph_low_2  = e_inert[2]*sqrt(flow[2]*fceo[2]*(2d0*!DPI)^2*(ctheta_kb - flow[2]/fceo[2]))
vph_low_3  = e_inert[3]*sqrt(flow[3]*fceo[3]*(2d0*!DPI)^2*(ctheta_kb - flow[3]/fceo[3]))
vph_low_4  = e_inert[4]*sqrt(flow[4]*fceo[4]*(2d0*!DPI)^2*(ctheta_kb - flow[4]/fceo[4]))
vph_low_5  = e_inert[5]*sqrt(flow[5]*fceo[5]*(2d0*!DPI)^2*(ctheta_kb - flow[5]/fceo[5]))
vph_low_6  = e_inert[6]*sqrt(flow[6]*fceo[6]*(2d0*!DPI)^2*(ctheta_kb - flow[6]/fceo[6]))

vph_high_0 = e_inert[0]*sqrt(fhigh[0]*fceo[0]*(2d0*!DPI)^2*(ctheta_kb - fhigh[0]/fceo[0]))
vph_high_1 = e_inert[1]*sqrt(fhigh[1]*fceo[1]*(2d0*!DPI)^2*(ctheta_kb - fhigh[1]/fceo[1]))
vph_high_2 = e_inert[2]*sqrt(fhigh[2]*fceo[2]*(2d0*!DPI)^2*(ctheta_kb - fhigh[2]/fceo[2]))
vph_high_3 = e_inert[3]*sqrt(fhigh[3]*fceo[3]*(2d0*!DPI)^2*(ctheta_kb - fhigh[3]/fceo[3]))
vph_high_4 = e_inert[4]*sqrt(fhigh[4]*fceo[4]*(2d0*!DPI)^2*(ctheta_kb - fhigh[4]/fceo[4]))
vph_high_5 = e_inert[5]*sqrt(fhigh[5]*fceo[5]*(2d0*!DPI)^2*(ctheta_kb - fhigh[5]/fceo[5]))
vph_high_6 = e_inert[6]*sqrt(fhigh[6]*fceo[6]*(2d0*!DPI)^2*(ctheta_kb - fhigh[6]/fceo[6]))

gform = '(";",2f16.5)'
print, minmax(vph_low_0)/c, minmax(vph_high_0)/c,FORMAT=gform
;         0.01803         0.13791
;         0.02842         0.23751
print, minmax(vph_low_1)/c, minmax(vph_high_1)/c,FORMAT=gform
;         0.01737         0.15252
;         0.02859         0.21731
print, minmax(vph_low_2)/c, minmax(vph_high_2)/c,FORMAT=gform
;         0.01893         0.14814
;         0.01885         0.20183
print, minmax(vph_low_3)/c, minmax(vph_high_3)/c,FORMAT=gform
;         0.01682         0.13027
;         0.02305         0.18753
print, minmax(vph_low_4)/c, minmax(vph_high_4)/c,FORMAT=gform
;         0.00537         0.14567
;         0.01898         0.19191
print, minmax(vph_low_5)/c, minmax(vph_high_5)/c,FORMAT=gform
;         0.01304         0.15399
;         0.02828         0.21263
print, minmax(vph_low_6)/c, minmax(vph_high_6)/c,FORMAT=gform
;         0.00437         0.17516
;         0.02964         0.21086

; => Estimated from Cold Plasma Dispersion Relationship (km/s)
;
;    => *_flow_*   = Used low end frequency from frequency peak
;    => *_fhigh_*  = Used high end " "
;    => *_mn       = Minimum phase speed estimated from range of theta_kB's  [Used 0-90 deg]
;    => *_mx       = Maximum " "
;---------------------------------------------------------------------------------------------
;               SCET                    Vph_flow_mn   Vph_flow_mx    Vph_fhigh_mn  Vph_fhigh_mx
;=============================================================================================
;    2000/04/10 02:49:47.201 UT           5404.592     41344.257       8519.980     71204.699
;    2000/04/10 02:49:47.303 UT           5208.008     45723.642       8569.859     65149.139
;    2000/04/10 02:55:03.002 UT           5675.655     44410.752       5649.998     60507.986
;    2000/04/10 03:10:43.077 UT           5042.587     39052.529       6910.962     56219.378
;    2000/04/10 03:14:11.849 UT           1609.673     43669.412       5689.761     57531.734
;    2000/04/10 03:47:32.845 UT           3909.632     46163.943       8478.961     63743.797
;    2000/04/10 03:48:25.816 UT           1310.876     52512.017       8886.724     63213.832
;---------------------------------------------------------------------------------------------


'--------------------------------------------------------------------------------------------------------------------------------'
' => Whistlers on 1998/11/13'
'--------------------------------------------------------------------------------------------------------------------------------'

' => TDSF'
;---------------------------------------------------------------------------------------------
;               SCET                   Rad. Dist.      L-Shell         MLT          Inv. Lat.
;=============================================================================================
;    1998/11/13 18:15:08.170 UT          3.774          3.875          2.173         59.447
;    1998/11/13 18:15:36.757 UT          3.781          3.888          2.197         59.486
;    1998/11/13 18:17:42.211 UT          3.814          3.942          2.303         59.660
;    1998/11/13 18:18:54.213 UT          3.833          3.974          2.363         59.762
;    1998/11/13 18:19:10.487 UT          3.838          3.981          2.377         59.785
;    1998/11/13 18:20:51.506 UT          3.866          4.025          2.460         59.930
;    1998/11/13 18:20:57.938 UT          3.868          4.027          2.465         59.939
;    1998/11/13 18:20:59.086 UT          3.868          4.028          2.466         59.941
;    1998/11/13 18:20:59.546 UT          3.868          4.028          2.467         59.941
;    1998/11/13 18:21:07.462 UT          3.870          4.031          2.473         59.953
;    1998/11/13 18:21:08.048 UT          3.870          4.032          2.474         59.953
;    1998/11/13 18:21:17.884 UT          3.873          4.036          2.482         59.968
;---------------------------------------------------------------------------------------------

;--------------------------------------------------------------------------------------------------------------------------------
;               SCET                   Exrms       Eyrms       Ex_pk      Ey_pk
;================================================================================================================================
;    1998/11/13 18:15:08.170 UT       13.94       14.49       87.26      120.99
;    1998/11/13 18:15:36.757 UT       28.55       32.07      143.35      180.74
;    1998/11/13 18:18:54.213 UT       14.77       10.84       88.67       92.39
;    1998/11/13 18:19:10.487 UT       23.80       18.58      138.87      137.11
;    1998/11/13 18:20:51.506 UT       12.76       16.70      119.15      202.89
;    1998/11/13 18:20:57.938 UT       21.22       18.04      120.36      139.10
;    1998/11/13 18:20:59.086 UT       16.35       18.86      119.31      199.23
;    1998/11/13 18:20:59.546 UT       22.66       24.29      137.49      185.25
;    1998/11/13 18:21:07.462 UT       18.15       14.96      106.05      108.00
;    1998/11/13 18:21:08.048 UT       15.43       22.08      122.19      295.88
;    1998/11/13 18:21:17.884 UT       14.74       10.91       99.83      102.60
;--------------------------------------------------------------------------------------------------------------------------------



' => TDSS'
;---------------------------------------------------------------------------------------------
;               SCET                   Rad. Dist.      L-Shell         MLT          Inv. Lat.
;=============================================================================================
;    1998/11/13 18:20:57.978 UT          3.868          4.027          2.465         59.939
;    1998/11/13 18:20:59.590 UT          3.868          4.028          2.467         59.941
;    1998/11/13 18:21:08.092 UT          3.870          4.032          2.474         59.953
;---------------------------------------------------------------------------------------------

;--------------------------------------------------------------------------------------------------------------------------------
;               SCET                   Brms        By_pk      Exrms       Eyrms       Ezrms       Ex_pk      Ey_pk        Ez_pk
;================================================================================================================================
;    1998/11/13 18:20:57.978 UT        0.73        4.75       19.37       14.27        6.89      121.12       96.40       54.19
;    1998/11/13 18:20:59.590 UT        0.82        4.80       24.41       19.50        8.94      159.20      145.40       69.62
;    1998/11/13 18:21:08.092 UT        0.63        5.54       15.59       16.93        7.35      174.22      221.13       80.61
;--------------------------------------------------------------------------------------------------------------------------------


; => Estimated from |E|/|B_y| from TDSS measurements (km/s)
;---------------------------------------------------------------------------------------------
;               SCET                     Max Vph_RMS         Max Vph_PK
;=============================================================================================
;    1998/11/13 18:20:57.978 UT           34282.226           34528.609
;    1998/11/13 18:20:59.590 UT           39629.862           47201.520
;    1998/11/13 18:21:08.092 UT           38348.876           52857.294
;---------------------------------------------------------------------------------------------


bmag      = 452d0   ; => nT
dens      = 168d0   ; => cm^(-3)
fpeo      = fpefac[0]*sqrt(dens)
fceo      = fcefac[0]*bmag
e_inert   = c/fpeo
flow      = [9e2,8e2,6e2]
fhigh     = [2.3e3,2.2e3,2.5e3]
vph_low_0 = e_inert[0]*sqrt(flow[0]*fceo[0]*(2d0*!DPI)^2*(ctheta_kb - flow[0]/fceo[0]))
vph_low_1 = e_inert[0]*sqrt(flow[1]*fceo[0]*(2d0*!DPI)^2*(ctheta_kb - flow[1]/fceo[0]))
vph_low_2 = e_inert[0]*sqrt(flow[2]*fceo[0]*(2d0*!DPI)^2*(ctheta_kb - flow[2]/fceo[0]))

vph_high_0 = e_inert[0]*sqrt(fhigh[0]*fceo[0]*(2d0*!DPI)^2*(ctheta_kb - fhigh[0]/fceo[0]))
vph_high_1 = e_inert[0]*sqrt(fhigh[1]*fceo[0]*(2d0*!DPI)^2*(ctheta_kb - fhigh[1]/fceo[0]))
vph_high_2 = e_inert[0]*sqrt(fhigh[2]*fceo[0]*(2d0*!DPI)^2*(ctheta_kb - fhigh[2]/fceo[0]))

gform = '(";",2f16.5)'
print, minmax(vph_low_0)/c, minmax(vph_high_0)/c,FORMAT=gform
;         0.01642         0.17559
;         0.02517         0.26345
print, minmax(vph_low_1)/c, minmax(vph_high_1)/c,FORMAT=gform
;         0.00240         0.16625
;         0.03532         0.25890
print, minmax(vph_low_2)/c, minmax(vph_high_2)/c,FORMAT=gform
;         0.00189         0.14519
;         0.02580         0.27200

; => Estimated from Cold Plasma Dispersion Relationship (km/s)
;
;    => *_flow_*   = Used low end frequency from frequency peak
;    => *_fhigh_*  = Used high end " "
;    => *_mn       = Minimum phase speed estimated from range of theta_kB's  [Used 0-90 deg]
;    => *_mx       = Maximum " "
;---------------------------------------------------------------------------------------------
;               SCET                    Vph_flow_mn   Vph_flow_mx    Vph_fhigh_mn  Vph_fhigh_mx
;=============================================================================================
;    1998/11/13 18:20:57.978 UT           4921.293     52640.803       7546.782     78981.052
;    1998/11/13 18:20:59.590 UT            720.608     49840.923      10588.357     77617.166
;    1998/11/13 18:21:08.092 UT            565.587     43526.151       7734.433     81544.171
;---------------------------------------------------------------------------------------------










scet   = ['2000/04/10 02:49:47.201 UT','2000/04/10 02:49:47.303 UT','2000/04/10 02:55:03.002 UT',$
          '2000/04/10 03:10:43.077 UT','2000/04/10 03:14:11.849 UT','2000/04/10 03:47:32.845 UT',$
          '2000/04/10 03:48:25.816 UT','1998/11/13 18:20:57.978 UT','1998/11/13 18:20:59.590 UT',$
          '1998/11/13 18:21:08.092 UT']

byrms  = [0.36,0.38,0.15,0.29,0.20,0.14,0.24,0.73,0.82,0.63]
bypeak = [1.47,1.79,0.83,1.20,1.34,1.02,1.56,4.75,4.80,5.54]

exrms  = [12.20,11.44,5.51,9.74,6.06,4.76,7.03,19.37,24.41,15.59]
eyrms  = [18.43,19.59,7.80,13.07,6.37,2.02,4.36,14.27,19.50,16.93]
ezrms  = [0.13,0.10,0.09,6.96,4.64,1.73,2.38,6.89,8.94,7.35]

expeak = [51.21,54.15,30.50,38.88,45.46,30.19,49.84,121.12,159.20,174.22]
eypeak = [73.67,88.36,44.11,56.80,47.90,16.09,33.48,96.40,145.40,221.13]
ezpeak = [0.55,0.39,0.29,28.48,33.74,15.15,15.90,54.19,69.62,80.61]


emag_rms = SQRT(exrms^2 + eyrms^2 + ezrms^2)
emag_pk  = SQRT(expeak^2 + eypeak^2 + ezpeak^2)


vph_rms_mx = (emag_rms*1d-3/(byrms*1d-9))*1d-3
vph_pk_mx  = (emag_pk*1d-3/(bypeak*1d-9))*1d-3

mform = '(";",a30,2f20.3)'
for j=0L, n_elements(scet) - 1L do print,format=mform,scet[j],vph_rms_mx[j],vph_pk_mx[j]














;-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
;
;-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
theta = Dindgen(100)*89d0/99
magf  = 167d0
dens  = 71d0
flow  = [8d2,7d2]
fhigh = [21d2,2d3]
for  k=0L, 1L do begin    $
  for j=0, 99 do begin $
    templ = cold_plasma_whistler_params(magf[0],dens[0],flow[k],theta[j])    & $
    temph = cold_plasma_whistler_params(magf[0],dens[0],fhigh[k],theta[j])   & $
    jstr  = 'T'+STRTRIM(j,2L)  & $
    str_element,eres_l,jstr,templ,/ADD_REPLACE  & $
    str_element,eres_h,jstr,temph,/ADD_REPLACE  & $
  endfor  & $
  kstr  = 'F'+STRTRIM(k,2L)  & $
  str_element,whist_l,kstr,eres_l,/ADD_REPLACE  & $
  str_element,whist_h,kstr,eres_h,/ADD_REPLACE  & $
  eres_l = 0 & $
  eres_h = 0

wave_lengths_0l = DBLARR(100L)
phase_speeds_0l = DBLARR(100L)
res_landau_0l   = DBLARR(100L)
res_ncyclo_0l   = DBLARR(100L)
res_acyclo_0l   = DBLARR(100L)

wave_lengths_0h = DBLARR(100L)
phase_speeds_0h = DBLARR(100L)
res_landau_0h   = DBLARR(100L)
res_ncyclo_0h   = DBLARR(100L)
res_acyclo_0h   = DBLARR(100L)

wave_lengths_1l = DBLARR(100L)
phase_speeds_1l = DBLARR(100L)
res_landau_1l   = DBLARR(100L)
res_ncyclo_1l   = DBLARR(100L)
res_acyclo_1l   = DBLARR(100L)

wave_lengths_1h = DBLARR(100L)
phase_speeds_1h = DBLARR(100L)
res_landau_1h   = DBLARR(100L)
res_ncyclo_1h   = DBLARR(100L)
res_acyclo_1h   = DBLARR(100L)


whist_0l = whist_l.F0
whist_1l = whist_l.F1

whist_0h = whist_h.F0
whist_1h = whist_h.F1

for j=0, 99 do begin $
  wave_lengths_0l[j] = whist_0l.(j).WAVE_LENGTH[0]  & $
  wave_lengths_0h[j] = whist_0h.(j).WAVE_LENGTH[0]  & $
  wave_lengths_1l[j] = whist_1l.(j).WAVE_LENGTH[0]  & $
  wave_lengths_1h[j] = whist_1h.(j).WAVE_LENGTH[0]  & $
  phase_speeds_0l[j] = whist_0l.(j).V_PHASE[0]      & $
  phase_speeds_0h[j] = whist_0h.(j).V_PHASE[0]      & $
  phase_speeds_1l[j] = whist_1l.(j).V_PHASE[0]      & $
  phase_speeds_1h[j] = whist_1h.(j).V_PHASE[0]      & $
  res_landau_0l[j]   = whist_0l.(j).ERES_LAND[0]    & $
  res_landau_0h[j]   = whist_0h.(j).ERES_LAND[0]    & $
  res_landau_1l[j]   = whist_1l.(j).ERES_LAND[0]    & $
  res_landau_1h[j]   = whist_1h.(j).ERES_LAND[0]    & $
  res_ncyclo_0l[j]   = whist_0l.(j).ERES_NCYC[0]    & $
  res_ncyclo_0h[j]   = whist_0h.(j).ERES_NCYC[0]    & $
  res_ncyclo_1l[j]   = whist_1l.(j).ERES_NCYC[0]    & $
  res_ncyclo_1h[j]   = whist_1h.(j).ERES_NCYC[0]    & $
  res_acyclo_0l[j]   = whist_0l.(j).ERES_ACYC[0]    & $
  res_acyclo_0h[j]   = whist_0h.(j).ERES_ACYC[0]    & $
  res_acyclo_1l[j]   = whist_1l.(j).ERES_ACYC[0]    & $
  res_acyclo_1h[j]   = whist_1h.(j).ERES_ACYC[0]


print, minmax(wave_lengths_0l), minmax(wave_lengths_0h)
;      0.46358308       8.7208010
;      0.45286574       4.3877034
print, minmax(wave_lengths_1l), minmax(wave_lengths_1h)
;      0.93071252       9.4424659
;      0.69687873       4.5825372

print, minmax(phase_speeds_0l), minmax(phase_speeds_0h)
;       370.86646       6976.6408
;       951.01805       9214.1772
print, minmax(phase_speeds_1l), minmax(phase_speeds_1h)
;       651.49877       6609.7261
;       1393.7575       9165.0743

print, minmax(res_landau_0l,/POS), minmax(res_landau_0h,/POS)
;       12.993084       243.86273
;       12.414584       243.87324
print, minmax(res_landau_1l,/POS), minmax(res_landau_1h,/POS)
;       48.334146       243.82680
;       28.387169       243.87080

print, minmax(res_ncyclo_0l,/POS), minmax(res_ncyclo_0h,/POS)
;       304.80247       5720.7326
;       18.662162       366.60123
print, minmax(res_ncyclo_1l,/POS), minmax(res_ncyclo_1h,/POS)
;       1558.3911       7861.4716
;       50.772294       436.17876

print, minmax(res_acyclo_0l,/POS), minmax(res_acyclo_0h,/POS)
;       608.49923       11420.713
;       129.20504       2538.1158
print, minmax(res_acyclo_1l,/POS), minmax(res_acyclo_1h,/POS)
;       2849.5328       14374.775
;       316.17783       2716.2463

;-----------------------------------------------------------------------------------------
; => Define dummy variables
;-----------------------------------------------------------------------------------------
f              = !VALUES.F_NAN
d              = !VALUES.D_NAN


temp       = whistler_insta_read()
fw_low     = temp.FLOW_PEAK
fw_high    = temp.FHIGH_PEAK
wscets     = STRTRIM(temp.SCETS,2)
wdates     = STRMID(wscets[*],0L,4L)+'-'+STRMID(wscets[*],5L,2L)+'-'+STRMID(wscets[*],8L,2L)

date    = '111398'
date    = '040900'
date    = '050300'
date    = '052600'
date    = '061000'
date    = '062600'
date    = '071000'
date    = '072300'
date    = '080400'
date    = '081500'
date    = '100301'
date    = '102401'
date    = '111501'
date    = '101002'
mydate  = my_str_date(DATE=date)
sdate   = mydate.S_DATE[0]  ; -('MMDDYY')
ldate   = mydate.DATE[0]    ; -('YYYYMMDD')
tdate   = mydate.TDATE[0]   ; => 'YYYY-MM-DD'
IF (tdate EQ '2000-04-09') THEN tdate = '2000-04-10'

;goodd   = WHERE(wdates EQ tdate[0],gdd)
;wdates  = wdates[goodd]
;wscets  = wscets[goodd]
;fw_low  = fw_low[goodd]
;fw_high = fw_high[goodd]


temp0      = tds_whist_ehole_times(DATE=date[0],FIXFILE=fixes)
ymdb_whist = temp0.WHISTLER_T
unix_whist = temp0.WHISTLER_UNX

; => Find good elements
test       = my_array_where(ymdb_whist,wscets,/N_UNIQ)
ymdb_whist = ymdb_whist[test[*,0]]
wscets     = wscets[test[*,1]]
fw_low     = fw_low[test[*,1]]
fw_high    = fw_high[test[*,1]]


; => Get TDSF data
my_tds     = get_wind_tds_data(DATE=date,FIXFILE=fixes,/TDSF)
; => Get TDSS data
my_tdss    = get_wind_tds_data(DATE=date,FIXFILE=fixes,/TDSS)
; => Find good elements
test       = my_array_where(ymdb_whist,my_tds.SCET,/N_UNIQ)
; => Find good elements
tests      = my_array_where(ymdb_whist,my_tdss.SCET,/N_UNIQ)
; => Get ONLY whistler TDSF
IF (test[0] NE -1) THEN scets  = my_tds.SCET[test[*,1]]             ELSE scets  = ''
IF (test[0] NE -1) THEN fields = REFORM(my_tds.EFIELD[test[*,1],*]) ELSE fields = REPLICATE(f,1,2048)
IF (test[0] NE -1) THEN times  = REFORM(my_tds.TIME[test[*,1],*])   ELSE times  = REPLICATE(f,1,2048)
IF (test[0] NE -1) THEN evnum  = my_tds.EVENT_N[test[*,1]]          ELSE evnum  = -1
IF (test[0] NE -1) THEN atype  = my_tds.A_TYPE[test[*,1]]           ELSE atype  = ''
; => Get ONLY whistler TDSS
IF (tests[0] NE -1) THEN scetss  = my_tdss.SCET[tests[*,1]]             ELSE scetss  = ''
IF (tests[0] NE -1) THEN fieldss = REFORM(my_tdss.EFIELD[tests[*,1],*]) ELSE fieldss = REPLICATE(f,1,2048)
IF (tests[0] NE -1) THEN timess  = REFORM(my_tdss.TIME[tests[*,1],*])   ELSE timess  = REPLICATE(d,1,2048)
IF (tests[0] NE -1) THEN evnums  = my_tdss.EVENT_N[tests[*,1]]          ELSE evnums  = -1
IF (tests[0] NE -1) THEN atypes  = my_tdss.A_TYPE[tests[*,1]]           ELSE atypes  = ''

ascets     = [scets,scetss]
afields    = [fields,fieldss]
atimes     = [times,timess]
aevnum     = [evnum,evnums]
aatype     = [atype,atypes]

bad        = WHERE(ascets EQ '',bd,COMPLEMENT=good,NCOMPLEMENT=gd)
IF (gd GT 0) THEN ascets  = ascets[good]
IF (gd GT 0) THEN afields = afields[good,*]
IF (gd GT 0) THEN atimes  = atimes[good,*]
IF (gd GT 0) THEN aevnum  = aevnum[good]
IF (gd GT 0) THEN aatype  = aatype[good]

mts        = my_time_string(ascets,STR=1,FORM=1,PREC=3)
ascets     = mts.DATE_TIME
aunix      = mts.UNIX
sp         = SORT(aunix)
ascets     = ascets[sp]
afields    = afields[sp,*]
atimes     = atimes[sp,*]
aevnum     = aevnum[sp]
aatype     = aatype[sp]


; => Sort list times
mts        = my_time_string(wscets,STR=1,FORM=1,PREC=3)
wunix      = mts.UNIX
sp         = SORT(wunix)
wscets     = wscets[sp]
fw_low     = fw_low[sp]
fw_high    = fw_high[sp]
; => Find good elements
test       = my_array_where(wscets,ascets,/N_UNIQ)
wscetsa    = wscets[test[*,0]]
fw_lowa    = fw_low[test[*,0]]
fw_higha   = fw_high[test[*,0]]

unq        = UNIQ(wscetsa,SORT(wscetsa))
wscets2    = wscetsa[unq]
fw_low2    = fw_lowa[unq]
fw_high2   = fw_higha[unq]
;fw_low     = fw_low[unq]
;fw_high    = fw_high[unq]

;===============================================================================================================================================================================
; => Fixed
;===============================================================================================================================================================================
nsams   = N_ELEMENTS(REFORM(my_tds.TIME[0,*]))
n_avgs  = N_ELEMENTS(aevnum) - 1L
efxyz   = DBLARR(N_ELEMENTS(wscets2),nsams,3L)  ; => Dummy array of E-fields (mV/m)
bfxyz   = DBLARR(N_ELEMENTS(wscets2),nsams,3L)  ; => Dummy array of B-fields (nT)
FOR k=0L, n_avgs DO BEGIN                                                          $
  t_type = STRMID(aatype[k],0L,2L)                                               & $
  t_sct  = ascets[k]                                                             & $
  test0  = WHERE(t_sct EQ wscets2,gt0)                                           & $
  g      = REFORM(test0[0])                                                      & $
  IF (t_type EQ 'EX' AND gt0 GT 0) THEN efxyz[g,*,0] = afields[k,*]              & $
  IF (t_type EQ 'EY' AND gt0 GT 0) THEN efxyz[g,*,1] = afields[k,*]              & $
  IF (t_type EQ 'EZ' AND gt0 GT 0) THEN efxyz[g,*,2] = afields[k,*]              & $
  IF (t_type EQ 'BX' AND gt0 GT 0) THEN bfxyz[g,*,0] = afields[k,*]              & $
  IF (t_type EQ 'BY' AND gt0 GT 0) THEN bfxyz[g,*,1] = afields[k,*]              & $
  IF (t_type EQ 'BZ' AND gt0 GT 0) THEN bfxyz[g,*,2] = afields[k,*]

;  print,'g = '+strtrim(g,2)                                                      & $
;  test0  = my_array_where(t_sct,wscets2,/N_UNIQ)                                 & $
;===============================================================================================================================================================================


unqel   = UNIQ(ascets,SORT(ascets))
nscets  = REFORM(ascets[unqel])
nevnm   = REFORM(aevnum[unqel])
ntimes  = REFORM(atimes[unqel,*])
n_uq    = N_ELEMENTS(unqel) - 1L

DELVAR,filter_ef,filter_bf
FOR k=0L, n_uq DO BEGIN                                                             $
  kstr  = 'T'+STRTRIM(k,2)                                                        & $
  evln  = (MAX(ntimes[k,*],/NAN) - MIN(ntimes[k,*],/NAN))*1d-3                    & $
  tsam  = (nsams - 1L)/evln                                                       & $
  flow  = fw_low2[k]                                                              & $
  fhigh = fw_high2[k]                                                             & $
  filte = vector_bandpass(REFORM(efxyz[k,*,*]),tsam[0],flow[0],fhigh[0],/MIDF)    & $
  filtb = vector_bandpass(REFORM(bfxyz[k,*,*]),tsam[0],flow[0],fhigh[0],/MIDF)    & $
  str_element,filter_ef,kstr,filte,/ADD_REPLACE                                   & $
  str_element,filter_bf,kstr,filtb,/ADD_REPLACE



exyz_rms  = DBLARR(n_uq+1L,3L)
exyz_pk   = DBLARR(n_uq+1L,3L)
bxyz_rms  = DBLARR(n_uq+1L,3L)
bxyz_pk   = DBLARR(n_uq+1L,3L)
FOR k=0L, n_uq DO BEGIN                                                             $
  t_efx  = filter_ef.(k)[*,0]                                                     & $
  t_efy  = filter_ef.(k)[*,1]                                                     & $
  t_efz  = filter_ef.(k)[*,2]                                                     & $
  t_bfx  = filter_bf.(k)[*,0]                                                     & $
  t_bfy  = filter_bf.(k)[*,1]                                                     & $
  t_bfz  = filter_bf.(k)[*,2]                                                     & $
  avgex  = MEAN(t_efx,/NAN,/DOUBLE)                                               & $
  stdex  = STDDEV(t_efx,/NAN,/DOUBLE)                                             & $
  pkex   = MAX(ABS(t_efx),/NAN)                                                   & $
  avgey  = MEAN(t_efy,/NAN,/DOUBLE)                                               & $
  stdey  = STDDEV(t_efy,/NAN,/DOUBLE)                                             & $
  pkey   = MAX(ABS(t_efy),/NAN)                                                   & $
  avgez  = MEAN(t_efz,/NAN,/DOUBLE)                                               & $
  stdez  = STDDEV(t_efz,/NAN,/DOUBLE)                                             & $
  pkez   = MAX(ABS(t_efz),/NAN)                                                   & $
  avgbx  = MEAN(t_bfx,/NAN,/DOUBLE)                                               & $
  stdbx  = STDDEV(t_bfx,/NAN,/DOUBLE)                                             & $
  pkbx   = MAX(ABS(t_bfx),/NAN)                                                   & $
  avgby  = MEAN(t_bfy,/NAN,/DOUBLE)                                               & $
  stdby  = STDDEV(t_bfy,/NAN,/DOUBLE)                                             & $
  pkby   = MAX(ABS(t_bfy),/NAN)                                                   & $
  avgbz  = MEAN(t_bfz,/NAN,/DOUBLE)                                               & $
  stdbz  = STDDEV(t_bfz,/NAN,/DOUBLE)                                             & $
  pkbz   = MAX(ABS(t_bfz),/NAN)                                                   & $
  e_rms  = [SQRT(avgex^2+stdex^2),SQRT(avgey^2+stdey^2),SQRT(avgez^2+stdez^2)]    & $
  b_rms  = [SQRT(avgbx^2+stdbx^2),SQRT(avgby^2+stdby^2),SQRT(avgbz^2+stdbz^2)]    & $
  e_pk   = [pkex,pkey,pkez]                                                       & $
  b_pk   = [pkbx,pkby,pkbz]                                                       & $
  exyz_rms[k,*] = e_rms                                                           & $
  bxyz_rms[k,*] = b_rms                                                           & $
  exyz_pk[k,*]  = e_pk                                                            & $
  bxyz_pk[k,*]  = b_pk


mform = '(";",a30,12f12.2)'
FOR k=0L, n_uq DO BEGIN                                                             $
  PRINT,FORMAT=mform,wscets2[k],REFORM(bxyz_rms[k,*]),REFORM(bxyz_pk[k,*]),         $
                                REFORM(exyz_rms[k,*]),REFORM(exyz_pk[k,*])






mform   = '(";",a30,18f12.2)'
gdates  = ['111398','040900','050300','052600','061000','062600','071000','072300',$
           '080400','081500','100301','102401','101002']
ndates  = N_ELEMENTS(gdates)
FOR j=0L, ndates - 1L DO BEGIN     $
  field_stats_whistler,DATE=gdates[j]

;-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
;               SCET                  Bxrms       Byrms       Bzrms       Bx_pk       By_pk       Bz_pk       Exrms       Eyrms       Ezrms       Ex_pk      Ey_pk        Ez_pk       Sxrms       Syrms       Szrms       Sx_pk      Sy_pk        Sz_pk
;=======================================================================================================================================================================================================================================================
    1998/11/13 16:24:43.178 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.360       0.310       0.000       1.269       1.272       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    1998/11/13 16:31:31.585 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.363       0.219       0.000       1.177       0.769       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    1998/11/13 16:37:50.910 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.870       0.710       0.000       2.761       2.580       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    1998/11/13 16:44:38.949 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.194       0.161       0.000       1.063       1.010       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    1998/11/13 18:10:07.461 UT       0.000       0.000       0.000       0.000       0.000       0.000      22.234      23.584       0.000      90.934     123.217       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    1998/11/13 18:10:09.781 UT       0.000       0.000       0.000       0.000       0.000       0.000      19.666      14.889       0.000      89.132      82.840       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    1998/11/13 18:10:55.754 UT       0.000       0.000       0.000       0.000       0.000       0.000       9.607       7.420       0.000      38.575      35.509       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    1998/11/13 18:15:08.170 UT       0.000       0.000       0.000       0.000       0.000       0.000      13.902      14.441       0.000      88.825     120.548       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    1998/11/13 18:15:36.757 UT       0.000       0.000       0.000       0.000       0.000       0.000      27.896      31.942       0.000     110.306     170.379       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    1998/11/13 18:17:42.211 UT       0.000       0.000       0.000       0.000       0.000       0.000       7.490       4.260       0.000      41.790      27.351       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    1998/11/13 18:18:54.213 UT       0.000       0.000       0.000       0.000       0.000       0.000      14.744      10.813       0.000      83.091      91.687       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    1998/11/13 18:19:10.487 UT       0.000       0.000       0.000       0.000       0.000       0.000      23.544      18.552       0.000     121.424     139.214       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    1998/11/13 18:20:51.506 UT       0.000       0.000       0.000       0.000       0.000       0.000      12.443      16.644       0.000     122.913     201.983       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    1998/11/13 18:20:57.938 UT       0.000       0.000       0.000       0.000       0.000       0.000      21.069      18.020       0.000     120.567     136.517       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    1998/11/13 18:20:57.978 UT       0.000       0.730       0.000       0.000       4.700       0.000      19.368      14.259       6.878     121.409      97.223      53.767      10.235       0.000      17.521     183.132       0.000     213.970
    1998/11/13 18:20:59.086 UT       0.000       0.000       0.000       0.000       0.000       0.000      15.997      18.813       0.000     115.182     193.443       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    1998/11/13 18:20:59.546 UT       0.000       0.000       0.000       0.000       0.000       0.000      21.542      24.245       0.000     107.352     184.716       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    1998/11/13 18:20:59.590 UT       0.000       0.824       0.000       0.000       4.801       0.000      24.408      19.490       8.919     158.876     142.817      68.933      16.890       0.000      33.980    -177.233      -0.000     342.562
    1998/11/13 18:21:07.462 UT       0.000       0.000       0.000       0.000       0.000       0.000      17.904      14.908       0.000      99.475     113.907       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    1998/11/13 18:21:08.048 UT       0.000       0.000       0.000       0.000       0.000       0.000      14.984      22.058       0.000     109.715     294.671       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    1998/11/13 18:21:08.092 UT       0.000       0.629       0.000       0.000       5.544       0.000      15.585      16.931       7.352     174.221     221.133      80.613      19.037       0.000      33.271    -279.309       0.000     768.658
    1998/11/13 18:21:17.884 UT       0.000       0.000       0.000       0.000       0.000       0.000      14.685      10.818       0.000     105.508     103.831       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    1998/11/13 18:30:34.243 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.295       0.516       0.000       2.193       3.267       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    1998/11/13 19:03:49.414 UT       0.000       0.000       0.000       0.000       0.000       0.000       1.822       1.066       0.000       7.141       3.797       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/04/10 02:45:39.736 UT       0.000       0.000       0.000       0.000       0.000       0.000      22.242      13.283       0.000     103.168      52.199       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 02:49:27.780 UT       0.000       0.000       0.000       0.000       0.000       0.000      20.836      20.632       0.000      78.680      88.350       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 02:49:47.201 UT       0.000       0.364       0.000       0.000       1.495       0.000      12.106      18.321       0.108      47.833      71.722       0.378       0.028       0.000       6.884       0.271      -0.000      56.911
    2000/04/10 02:49:47.303 UT       0.000       0.376       0.000       0.000       1.792       0.000      11.430      19.589       0.085      53.619      89.318       0.333       0.028       0.000       7.290      -0.201       0.000      75.990
    2000/04/10 02:50:55.652 UT       0.000       0.000       0.000       0.000       0.000       0.000      19.475      34.021       0.000     105.801     184.033       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/04/10 02:50:57.440 UT       0.000       0.000       0.000       0.000       0.000       0.000      17.545      23.105       0.000     104.470     138.245       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/04/10 02:52:29.005 UT       0.000       0.000       0.000       0.000       0.000       0.000      14.877      16.634       0.000      97.657     139.427       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 02:52:47.911 UT       0.000       0.000       0.000       0.000       0.000       0.000      15.179      20.324       0.000     111.753     179.112       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/04/10 02:55:03.002 UT       0.000       0.157       0.000       0.000       0.862       0.000       5.729       8.140       0.108      30.752      44.768       0.437       0.015       0.000       1.927      -0.196       0.000      20.392
    2000/04/10 02:55:37.951 UT       0.000       0.000       0.000       0.000       0.000       0.000      16.948      23.360       0.000     108.823     151.740       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 02:55:53.362 UT       0.000       0.000       0.000       0.000       0.000       0.000      13.774      20.007       0.000     106.973     165.843       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/04/10 02:56:32.084 UT       0.000       0.000       0.000       0.000       0.000       0.000      17.049      22.041       0.000      95.832     149.656       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/04/10 02:56:34.562 UT       0.000       0.000       0.000       0.000       0.000       0.000      14.796      29.343       0.000     101.932     249.475       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 02:56:43.654 UT       0.000       0.000       0.000       0.000       0.000       0.000      13.599      20.086       0.000     106.936     158.688       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/04/10 03:10:43.077 UT       0.000       0.301       0.000       0.000       1.143       0.000      10.185      13.944       7.234      37.613      57.492      30.447       3.348       0.000       4.887     -26.348       0.000      32.568
    2000/04/10 03:11:02.788 UT       0.000       0.000       0.000       0.000       0.000       0.000      24.370      31.886       0.000     107.158     189.188       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/04/10 03:11:03.216 UT       0.000       0.000       0.000       0.000       0.000       0.000      22.315      34.319       0.000     106.460     175.876       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/04/10 03:11:04.462 UT       0.000       0.000       0.000       0.000       0.000       0.000      17.036      22.246       0.000     102.719     162.018       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 03:11:05.114 UT       0.000       0.000       0.000       0.000       0.000       0.000      23.425      37.743       0.000     116.465     191.442       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/04/10 03:11:06.333 UT       0.000       0.000       0.000       0.000       0.000       0.000      23.940      38.612       0.000     100.662     327.930       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 03:11:07.636 UT       0.000       0.000       0.000       0.000       0.000       0.000      21.796      32.221       0.000     109.181     215.035       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/04/10 03:11:08.783 UT       0.000       0.000       0.000       0.000       0.000       0.000      21.149      29.938       0.000     107.867     181.404       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 03:11:10.422 UT       0.000       0.000       0.000       0.000       0.000       0.000      21.165      27.640       0.000     104.319     139.884       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 03:11:11.272 UT       0.000       0.000       0.000       0.000       0.000       0.000      20.658      34.704       0.000      89.822     189.486       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/04/10 03:14:11.849 UT       0.000       0.196       0.000       0.000       1.340       0.000       6.057       6.363       4.627      44.832      47.626      33.307       2.624       0.000       3.320      35.504       0.000      47.789
    2000/04/10 03:20:49.379 UT       0.000       0.000       0.000       0.000       0.000       0.000       9.612      10.098       0.000      88.793     107.282       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/04/10 03:44:20.795 UT       0.000       0.000       0.000       0.000       0.000       0.000      15.944      11.835       0.000      86.918     108.080       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 03:47:32.845 UT       0.000       0.141       0.000       0.000       1.020       0.000       5.420       2.039       1.751      37.625      16.306      13.956       0.668       0.000       2.132     -10.751       0.000     -25.938
    2000/04/10 03:47:52.891 UT       0.000       0.000       0.000       0.000       0.000       0.000      13.643       3.194       0.000      97.168      14.980       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/04/10 03:48:25.816 UT       0.000       0.247       0.000       0.000       1.687       0.000       7.208       4.437       2.423      47.922      32.396      17.023       2.003       0.000       5.510     -22.223       0.000     -62.570
    2000/04/10 04:00:15.167 UT       0.000       0.000       0.000       0.000       0.000       0.000      11.349       7.223       0.000      70.028      56.356       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 04:14:45.376 UT       0.000       0.000       0.000       0.000       0.000       0.000      16.365      19.030       0.000      92.883     170.554       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/04/10 04:14:59.775 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.165       2.618       0.000      35.000      16.224       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/04/10 04:32:44.807 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.788       3.340       0.000      36.380      28.584       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/04/10 04:57:32.019 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.175       2.868       0.000      28.098      18.427       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/03 01:23:30.919 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.887       7.135       0.000      21.934      32.678       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/05/03 01:31:27.847 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.098       0.046       0.000       0.786       0.463       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/05/03 01:34:49.511 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.671       0.599       0.000      29.088       4.634       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/03 02:22:50.215 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.267       2.587       0.000      18.971      14.144       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/03 02:22:56.471 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.732       2.288       0.000      22.357      12.457       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/03 02:22:56.839 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.856       0.888       0.000      17.311       3.964       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/03 02:23:09.351 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.071       0.789       0.000      24.798       9.600       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/03 02:45:38.071 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.824       1.958       0.000      15.488       7.571       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/03 03:08:43.223 UT       0.000       0.000       0.000       0.000       0.000       0.000       1.961       2.907       0.000      11.599      16.252       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/03 03:09:55.719 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.061       3.719       0.000      10.432      17.565       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/03 03:09:56.087 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.118       3.577       0.000      12.061      11.258       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/03 03:18:44.167 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.972       2.201       0.000      10.375       7.245       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 20:53:27.044 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.360       1.159       0.000      12.234       4.731       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 20:53:27.371 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.186       0.924       0.000      10.649       3.069       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/05/25 20:54:43.251 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.201       2.543       0.000      13.460      11.248       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 20:54:43.562 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.405       1.574       0.000      11.638       5.164       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/05/25 20:58:42.077 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.093       0.859       0.000      14.719       5.344       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 21:11:38.315 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.547       2.848       0.000      15.859      13.296       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 22:31:46.097 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.365       1.655       0.000      14.496       5.102       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 22:43:01.950 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.972       1.635       0.000      22.431       6.059       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 22:44:48.491 UT       0.000       0.000       0.000       0.000       0.000       0.000      10.103       6.842       0.000      65.284      54.498       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 22:51:17.966 UT       0.000       0.000       0.000       0.000       0.000       0.000       8.104       3.052       0.000      27.019       8.959       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 23:08:40.917 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.682       1.546       0.000      46.302       7.981       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:13:53.957 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.683       1.795       0.000      56.593      14.254       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/05/25 23:30:50.444 UT       0.000       0.000       0.000       0.000       0.000       0.000      11.468      12.057       0.000      60.082      69.863       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 23:31:07.717 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.811       3.611       0.000      49.491      24.424       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 23:31:11.130 UT       0.000       0.000       0.000       0.000       0.000       0.000       7.683       2.077       0.000      51.639       6.394       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:32:53.190 UT       0.000       0.000       0.000       0.000       0.000       0.000       9.309       1.421       0.000      76.167      11.367       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/05/25 23:33:50.476 UT       0.000       0.000       0.000       0.000       0.000       0.000       9.462       4.425       0.000      43.799      16.071       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:35:28.129 UT       0.000       0.000       0.000       0.000       0.000       0.000      12.047       2.440       0.000      67.258      12.876       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/05/25 23:35:53.925 UT       0.000       0.000       0.000       0.000       0.000       0.000       9.943      11.245       0.000      56.880      76.487       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:36:02.147 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.648       2.019       0.000      54.795       8.373       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:36:22.399 UT       0.000       0.000       0.000       0.000       0.000       0.000      12.961       3.402       0.000      78.261      13.048       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 23:36:30.056 UT       0.000       0.000       0.000       0.000       0.000       0.000      11.389       5.014       0.000      54.253      18.433       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:37:30.175 UT       0.000       0.000       0.000       0.000       0.000       0.000      16.071      15.571       0.000      64.815      70.111       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:38:52.636 UT       0.000       0.000       0.000       0.000       0.000       0.000      11.006       2.665       0.000      57.932       8.646       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:38:58.460 UT       0.000       0.000       0.000       0.000       0.000       0.000      13.035       7.716       0.000      66.575      35.005       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/05/25 23:39:01.624 UT       0.000       0.000       0.000       0.000       0.000       0.000      17.987      10.725       0.000      68.279      37.612       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/25 23:39:03.381 UT       0.000       0.000       0.000       0.000       0.000       0.000      11.069       3.287       0.000      52.651      10.448       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:54:21.121 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.554       1.860       0.000      29.553       9.335       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/25 23:56:04.664 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.752       3.697       0.000      28.629      15.663       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/26 00:05:07.441 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.048       0.025       0.000       0.223       0.107       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/05/26 00:40:41.872 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.691       1.412       0.000      18.762       7.559       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/05/26 02:18:14.778 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.154       0.105       0.000       0.940       0.681       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/05/26 02:18:15.163 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.098       0.083       0.000       0.577       0.435       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/06/10 12:48:06.950 UT       0.097       0.103       0.106       0.638       0.636       0.667       2.103       0.000       0.000      12.602       0.000       0.000       0.000       0.463       0.458       0.000      -5.976      -6.165
    2000/06/10 12:48:15.327 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.428       3.428       0.000      18.659      21.245       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/06/10 12:48:15.360 UT       0.145       0.111       0.130       0.872       0.596       0.711       3.382       0.000       0.000      18.132       0.000       0.000       0.000       0.832       0.696       0.000      10.252      -8.329
    2000/06/10 12:48:21.086 UT       0.093       0.077       0.086       0.439       0.391       0.403       2.491       0.000       0.000      12.428       0.000       0.000       0.000       0.343       0.323       0.000       3.635      -3.752
    2000/06/10 12:48:33.873 UT       0.067       0.053       0.069       0.398       0.310       0.439       1.970       0.000       0.000      12.670       0.000       0.000       0.000       0.320       0.217       0.000       4.172      -2.937
    2000/06/10 13:06:57.530 UT       0.114       0.114       0.104       0.679       0.671       0.571       3.588       0.000       0.000      18.977       0.000       0.000       0.000       0.906       0.714       0.000       8.628      -7.534
    2000/06/10 13:07:04.610 UT       0.103       0.074       0.096       0.472       0.361       0.400       3.085       0.000       0.000      16.354       0.000       0.000       0.000       0.441       0.427      -0.000      -4.646      -4.569
    2000/06/10 13:07:06.975 UT       0.111       0.143       0.133       0.603       0.781       0.741       3.043       0.000       0.000      16.418       0.000       0.000       0.000       0.862       0.708       0.000       9.483      -8.376
    2000/06/10 13:07:09.310 UT       0.110       0.078       0.093       0.586       0.399       0.455       3.412       0.000       0.000      18.311       0.000       0.000       0.000       0.581       0.563       0.000       6.163      -5.661
    2000/06/10 13:07:09.799 UT       0.113       0.108       0.106       0.546       0.456       0.537       3.351       0.000       0.000      16.230       0.000       0.000       0.000       0.699       0.476       0.000       6.932      -4.419
    2000/06/10 13:07:17.471 UT       0.152       0.116       0.114       0.620       0.518       0.454       4.004       0.000       0.000      17.399       0.000       0.000       0.000       0.772       0.734      -0.000      -5.211      -6.528
    2000/06/10 13:07:21.074 UT       0.094       0.139       0.107       0.451       0.734       0.556       2.327       0.000       0.000      12.647       0.000       0.000       0.000       0.390       0.516       0.000      -4.627      -6.439
    2000/06/10 13:07:31.037 UT       0.114       0.079       0.090       0.484       0.331       0.355       3.167       0.000       0.000      12.753       0.000       0.000       0.000       0.414       0.392       0.000       3.455      -3.325
    2000/06/10 13:07:32.401 UT       0.110       0.095       0.086       0.437       0.357       0.323       2.802       0.000       0.000      12.028       0.000       0.000       0.000       0.292       0.408       0.000      -2.567      -3.322
    2000/06/10 13:07:33.206 UT       0.117       0.136       0.099       0.728       0.912       0.636       2.794       0.000       0.000      17.840       0.000       0.000       0.000       0.694       0.711      -0.000      -8.971     -10.059
    2000/06/10 13:07:39.001 UT       0.108       0.080       0.082       0.555       0.400       0.390       3.294       0.000       0.000      16.619       0.000       0.000       0.000       0.488       0.497      -0.000      -4.884      -5.185
    2000/06/10 13:07:40.716 UT       0.137       0.107       0.104       0.744       0.598       0.554       3.749       0.000       0.000      19.955       0.000       0.000       0.000       0.764       0.655       0.000       8.739      -8.036
    2000/06/10 13:08:34.879 UT       0.074       0.062       0.073       0.389       0.309       0.365       2.863       0.000       0.000      15.754       0.000       0.000       0.000       0.426       0.276      -0.000      -4.581      -3.158
    2000/06/10 13:10:32.960 UT       0.005       0.004       0.004       0.030       0.022       0.022       0.175       0.000       0.000       1.045       0.000       0.000       0.000       0.002       0.001      -0.000      -0.017      -0.014
    2000/06/26 19:25:26.101 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.210       2.392       0.000      22.500      18.435       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/06/26 20:26:35.125 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.892       3.239       0.000      25.079      11.756       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/06/26 20:26:35.583 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.707       2.005       0.000      24.791       6.603       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/06/26 20:26:37.131 UT       0.000       0.000       0.000       0.000       0.000       0.000       8.202       3.310       0.000      37.070      13.233       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/06/26 20:27:13.290 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.729       2.672       0.000      25.412      10.235       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/06/26 20:27:13.584 UT       0.000       0.000       0.000       0.000       0.000       0.000       7.032       2.286       0.000      29.057       8.540       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/06/26 20:27:14.652 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.772       2.304       0.000      19.437      11.440       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/06/26 20:27:22.681 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.989       1.647       0.000      18.598       8.677       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/06/26 20:27:29.246 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.347       2.252       0.000      20.856       9.839       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/09 22:49:28.993 UT       0.023       0.023       0.009       0.140       0.155       0.159       0.642       0.000       0.000       4.499       0.000       0.000       0.000       0.005       0.027       0.000       0.062      -0.401
    2000/07/09 23:52:09.305 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.010       0.005       0.000       0.057       0.024       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/09 23:56:06.302 UT       0.001       0.001       0.000       0.003       0.003       0.001       0.232       0.000       0.000       1.490       0.000       0.000       0.000       0.000       0.000      -0.000      -0.001       0.003
    2000/07/10 00:19:52.521 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.051       0.078       0.000       0.244       0.284       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/10 04:39:56.878 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.015       5.900       0.000      13.960      22.521       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/10 04:39:59.313 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.173       2.133       0.000      14.630       8.283       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/10 04:40:00.394 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.703       4.662       0.000      16.905      25.650       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/10 04:47:52.208 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.122       5.724       0.000      11.655      29.705       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/10 04:47:52.711 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.646       1.995       0.000      34.808       9.926       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/10 04:47:53.723 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.160      10.860       0.000      13.846      46.055       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/10 04:47:54.281 UT       0.000       0.000       0.000       0.000       0.000       0.000      10.594      11.270       0.000      42.915      44.101       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/10 04:47:55.616 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.846       1.538       0.000      15.105       8.935       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/10 04:47:57.232 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.578       1.558       0.000      24.529       7.843       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/07/10 04:47:59.343 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.250       1.614       0.000      20.468       8.300       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/10 04:48:03.029 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.157       2.256       0.000      11.734       8.855       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/07/23 07:53:55.198 UT       0.035       0.033       0.024       0.163       0.145       0.107       1.093       0.000       0.000       4.567       0.000       0.000       0.000       0.039       0.055      -0.000      -0.371       0.510
    2000/07/23 08:07:18.002 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.661       4.739       0.000      25.936      19.874       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/07/23 08:18:53.253 UT       0.062       0.064       0.043       0.180       0.208       0.151       1.557       0.000       0.000       5.007       0.000       0.000       0.000       0.075       0.127       0.000       0.450       0.806
    2000/07/23 08:18:56.383 UT       0.075       0.077       0.051       0.241       0.256       0.417       1.793       0.000       0.000       5.580       0.000       0.000       0.000       0.102       0.184       0.000      -0.643       1.135
    2000/07/23 08:19:22.392 UT       0.039       0.037       0.022       0.144       0.114       0.075       0.929       0.000       0.000       3.507       0.000       0.000       0.000       0.026       0.046       0.000       0.210       0.318
    2000/07/23 08:19:22.720 UT       0.039       0.044       0.024       0.133       0.145       0.082       0.884       0.000       0.000       3.339       0.000       0.000       0.000       0.019       0.054      -0.000       0.115       0.374
    2000/07/23 08:25:37.845 UT       0.094       0.084       0.032       0.283       0.249       0.101       2.069       0.000       0.000       6.085       0.000       0.000       0.000       0.085       0.239      -0.000      -0.482       1.206
    2000/07/23 09:42:14.233 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.614       0.229       0.000       3.852       1.158       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:41:18.785 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.846      11.685       0.000      17.783      47.235       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:41:21.794 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.219      12.586       0.000      21.225      49.868       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:41:24.746 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.194      15.200       0.000      20.322      55.134       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/23 10:41:36.795 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.564      13.780       0.000      20.882      53.334       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:41:39.799 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.956      14.828       0.000      21.510      59.376       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/07/23 10:42:25.058 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.740      14.227       0.000      22.539      60.834       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/23 10:42:27.910 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.950      14.607       0.000      23.981      57.359       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:42:31.211 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.125      12.707       0.000      21.183      61.627       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/23 10:42:49.044 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.760      17.173       0.000      24.522      70.962       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/23 10:42:51.898 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.584      10.123       0.000      23.895      54.234       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/23 10:42:52.195 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.607      14.011       0.000      22.281      56.344       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/23 10:42:58.257 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.054       9.663       0.000      22.485      49.195       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:43:01.213 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.714      11.707       0.000      22.916      68.846       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:43:31.390 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.180      12.596       0.000      23.790      57.880       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:43:43.293 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.172      12.843       0.000      18.933      51.553       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:43:46.466 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.758      11.780       0.000      19.769      47.763       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/07/23 10:44:16.549 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.211      12.713       0.000      21.913      57.095       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/07/23 11:10:10.130 UT       0.000       0.000       0.000       0.000       0.000       0.000       1.915       4.580       0.000       6.578      16.851       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/08/03 22:04:46.697 UT       0.186       0.186       0.094       0.735       0.743       0.713       4.901       0.000       0.000      20.342       0.000       0.000       0.000       0.510       1.438      -0.000       4.361      11.824
    2000/08/03 22:37:06.914 UT       0.000       0.000       0.000       0.000       0.000       0.000       8.016       9.408       0.000      27.052      31.014       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/08/03 22:38:56.457 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.443       4.829       0.000      12.959      17.610       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/03 23:06:51.648 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.790       6.660       0.000      20.753      27.625       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/08/03 23:22:59.542 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.969       3.947       0.000      23.381      16.229       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/03 23:25:52.206 UT       0.049       0.039       0.034       0.331       0.248       0.213       0.936       0.000       0.000       3.321       0.000       0.000       0.000       0.044       0.054      -0.000       0.500       0.607
    2000/08/03 23:26:19.732 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.230       6.870       0.000      21.469      36.319       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/08/03 23:27:02.963 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.415       1.640       0.000      21.037       6.905       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/03 23:28:15.525 UT       0.000       0.000       0.000       0.000       0.000       0.000       3.351       2.387       0.000      22.403      14.796       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/08/03 23:29:13.351 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.000       5.220       0.000      22.246      22.944       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/03 23:30:32.536 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.353       1.847       0.000      22.243       8.913       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/08/03 23:30:38.472 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.711       1.536       0.000      24.753       7.461       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/03 23:31:01.521 UT       0.000       0.000       0.000       0.000       0.000       0.000       9.845       3.860       0.000      49.315      18.243       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/08/03 23:31:54.212 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.476       3.292       0.000      23.114      16.573       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/08/03 23:31:54.819 UT       0.000       0.000       0.000       0.000       0.000       0.000       4.648       1.814       0.000      27.294      10.157       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/03 23:32:30.731 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.052       2.997       0.000      36.636      16.923       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/08/03 23:32:47.913 UT       0.000       0.000       0.000       0.000       0.000       0.000       6.241       2.162       0.000      33.059       9.956       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2000/08/03 23:33:05.849 UT       0.000       0.000       0.000       0.000       0.000       0.000       7.929       6.437       0.000      38.882      32.425       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2000/08/04 03:44:40.929 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.998       1.836       0.000      16.487      10.883       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/15 19:10:21.328 UT       0.096       0.102       0.051       0.331       0.358       0.168       0.854       0.000       0.000       2.853       0.000       0.000       0.000       0.045       0.132      -0.000       0.265       0.812
    2000/08/15 19:57:34.018 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.105       0.343       0.000       0.357       1.040       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/15 21:14:06.339 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.232       3.989       0.000       7.548      12.671       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/15 21:14:06.376 UT       0.104       0.095       0.069       0.352       0.332       0.221       2.102       0.000       0.000       7.310       0.000       0.000       0.000       0.184       0.266       0.000      -1.270       1.916
    2000/08/15 21:18:08.249 UT       0.000       0.000       0.000       0.000       0.000       0.000       2.379       3.768       0.000       8.924      13.265       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2000/08/15 21:18:08.282 UT       0.106       0.096       0.079       0.381       0.361       0.480       2.172       0.000       0.000       7.659       0.000       0.000       0.000       0.227       0.305       0.000       1.450       2.202
    2000/08/16 02:13:03.331 UT       0.057       0.058       0.017       0.217       0.228       0.063       0.480       0.000       0.000       1.876       0.000       0.000       0.000       0.008       0.044      -0.000      -0.055      -0.340
    2000/08/16 02:13:04.591 UT       0.049       0.050       0.030       0.163       0.170       0.098       0.651       0.000       0.000       2.261       0.000       0.000       0.000       0.026       0.049       0.000       0.165      -0.298
    2001/10/04 00:36:06.613 UT       0.138       0.161       0.132       0.522       0.663       0.492       0.152       0.000       0.000       1.004       0.000       0.000       0.000       0.019       0.024       0.000       0.168      -0.241
    2001/10/23 21:22:13.932 UT       0.020       0.020       0.010       0.053       0.053       0.025       0.234       0.000       0.000       2.192       0.000       0.000       0.000       0.001       0.002       0.000       0.005       0.018
    2001/10/23 21:22:15.036 UT       0.020       0.022       0.010       0.060       0.066       0.031       0.146       0.000       0.000       0.698       0.000       0.000       0.000       0.001       0.002       0.000      -0.005       0.012
    2001/10/23 21:22:27.548 UT       0.015       0.017       0.006       0.039       0.042       0.017       0.124       0.000       0.000       0.718       0.000       0.000       0.000       0.000       0.002       0.000      -0.002       0.011
    2001/10/23 21:56:15.229 UT       0.037       0.038       0.016       0.071       0.070       0.051       0.011       0.000       0.000       0.064       0.000       0.000       0.000       0.000       0.000       0.000      -0.002       0.002
    2001/10/23 21:56:15.964 UT       0.024       0.021       0.011       0.056       0.050       0.026       0.257       0.000       0.000       2.327       0.000       0.000       0.000       0.003       0.005       0.000       0.031      -0.042
    2001/10/23 21:56:22.955 UT       0.015       0.015       0.004       0.034       0.034       0.009       0.090       0.000       0.000       0.552       0.000       0.000       0.000       0.000       0.001       0.000       0.001       0.006
    2001/10/23 21:56:23.323 UT       0.015       0.015       0.005       0.037       0.037       0.015       0.218       0.000       0.000       1.421       0.000       0.000       0.000       0.001       0.002      -0.000      -0.012      -0.012
    2001/10/23 22:04:32.763 UT       0.014       0.016       0.011       0.036       0.044       0.033       0.180       0.000       0.000       1.126       0.000       0.000       0.000       0.002       0.004       0.000      -0.015      -0.029
    2001/10/23 22:08:46.315 UT       0.018       0.017       0.008       0.048       0.041       0.019       0.103       0.000       0.000       0.626       0.000       0.000       0.000       0.001       0.001      -0.000       0.006       0.009
    2001/10/23 22:11:30.811 UT       0.028       0.026       0.011       0.053       0.050       0.021       0.085       0.000       0.000       0.536       0.000       0.000       0.000       0.001       0.001       0.000      -0.006       0.011
    2001/10/23 22:15:42.526 UT       0.059       0.061       0.025       0.108       0.110       0.045       0.052       0.000       0.000       0.300       0.000       0.000       0.000       0.000       0.002       0.000       0.003      -0.011
    2001/10/23 22:25:11.084 UT       0.018       0.018       0.007       0.042       0.041       0.014       0.151       0.000       0.000       0.646       0.000       0.000       0.000       0.001       0.002       0.000       0.003      -0.006
    2001/10/23 22:25:11.820 UT       0.040       0.040       0.014       0.067       0.063       0.027       0.057       0.000       0.000       0.323       0.000       0.000       0.000       0.000       0.001       0.000       0.002       0.007
    2001/10/23 22:25:29.119 UT       0.083       0.086       0.029       0.148       0.147       0.060       0.432       0.000       0.000       1.593       0.000       0.000       0.000       0.008       0.037       0.000      -0.033      -0.165
    2002/10/10 00:12:12.505 UT       0.000       0.000       0.000       0.000       0.000       0.000       9.915       9.629       0.000      30.479      28.461       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 01:00:57.367 UT       0.000       0.000       0.000       0.000       0.000       0.000       8.662       4.075       0.000      27.671      13.234       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2002/10/10 01:10:26.236 UT       0.000       0.000       0.000       0.000       0.000       0.000      11.472       7.739       0.000      26.659      15.405       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 01:11:17.983 UT       0.000       0.000       0.000       0.000       0.000       0.000       7.137      10.222       0.000      25.842      38.473       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 01:14:15.781 UT       0.000       0.000       0.000       0.000       0.000       0.000      10.583      13.308       0.000      35.491      36.118       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 01:23:42.514 UT       0.000       0.000       0.000       0.000       0.000       0.000      10.289      12.294       0.000      27.802      40.946       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 01:58:27.135 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.067       0.154       0.000       0.169       0.412       0.000       0.000       0.000       0.000       0.000       0.000       0.000
    2002/10/10 02:30:17.675 UT       0.065       0.094       0.055       0.307       0.428       0.285       5.660       0.000       0.000      31.873       0.000       0.000       0.000       0.532       1.057       0.000      -5.057     -10.617
    2002/10/10 02:33:05.076 UT       0.000       0.000       0.000       0.000       0.000       0.000      10.054      66.598       0.000      21.993     142.198       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2002/10/10 02:33:05.411 UT       0.096       0.128       0.087       0.431       0.533       0.383       8.294       0.000       0.000      40.703       0.000       0.000       0.000       0.682       1.413      -0.000       7.800     -16.347
    2002/10/10 02:33:08.966 UT       0.085       0.087       0.077       0.451       0.389       0.370       1.872       0.000       0.000      10.365       0.000       0.000       0.000       0.290       0.329      -0.000       2.961       3.134
    2002/10/10 02:33:13.393 UT       0.103       0.102       0.078       0.366       0.313       0.305       2.561       0.000       0.000       8.243       0.000       0.000       0.000       0.262       0.363       0.000      -1.946       1.974
    2002/10/10 02:33:17.306 UT       0.000       0.000       0.000       0.000       0.000       0.000      12.606      34.951       0.000      25.519      68.134       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2002/10/10 02:33:18.374 UT       0.085       0.066       0.067       0.348       0.255       0.272       1.834       0.000       0.000       7.570       0.000       0.000       0.000       0.159       0.136      -0.000       1.490       1.096
    2002/10/10 02:33:18.841 UT       0.089       0.123       0.086       0.340       0.493       0.362       2.228       0.000       0.000       8.698       0.000       0.000       0.000       0.256       0.293       0.000       2.500       2.471
    2002/10/10 02:33:35.247 UT       0.000       0.000       0.000       0.000       0.000       0.000      14.166      42.106       0.000      33.408     106.308       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 02:33:38.084 UT       0.000       0.000       0.000       0.000       0.000       0.000      11.322      76.641       0.000      26.907     182.522       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 02:33:49.950 UT       0.000       0.000       0.000       0.000       0.000       0.000      10.152      52.094       0.000      25.620     135.471       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2002/10/10 02:34:19.954 UT       0.000       0.000       0.000       0.000       0.000       0.000      22.792     104.163       0.000      54.938     248.769       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2002/10/10 02:34:55.959 UT       0.000       0.000       0.000       0.000       0.000       0.000      10.424      50.337       0.000      27.894     138.370       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 02:34:59.293 UT       0.000       0.000       0.000       0.000       0.000       0.000      15.274      22.702       0.000      36.080      54.575       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2002/10/10 02:35:04.737 UT       0.120       0.073       0.101       0.498       0.275       0.445       3.863       0.000       0.000      16.040       0.000       0.000       0.000       0.659       0.421       0.000      -5.685       3.404
    2002/10/10 02:35:31.957 UT       0.000       0.000       0.000       0.000       0.000       0.000      11.428      54.350       0.000      32.698     162.142       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 02:41:48.565 UT       0.116       0.102       0.115       0.349       0.312       0.341       1.736       0.000       0.000       5.257       0.000       0.000       0.000       0.240       0.227       0.000       1.357       1.207
    2002/10/10 02:41:50.876 UT       0.000       0.000       0.000       0.000       0.000       0.000      18.265      25.306       0.000      33.477      45.407       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 02:44:21.244 UT       0.000       0.000       0.000       0.000       0.000       0.000      10.189      31.132       0.000      27.867      81.226       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2002/10/10 02:57:43.393 UT       0.000       0.000       0.000       0.000       0.000       0.000       5.696      16.223       0.000      14.768      37.449       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 02:59:19.793 UT       0.000       0.000       0.000       0.000       0.000       0.000      13.503      76.777       0.000      27.513     154.603       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
    2002/10/10 02:59:20.233 UT       0.000       0.000       0.000       0.000       0.000       0.000      14.329      12.418       0.000      26.532      23.034       0.000       0.000       0.000       0.000       0.000       0.000      -0.000
    2002/10/10 03:24:48.019 UT       0.000       0.000       0.000       0.000       0.000       0.000       0.022       0.131       0.000       0.068       0.330       0.000       0.000       0.000       0.000      -0.000       0.000       0.000
;-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



test   = field_stats_whistler_read()
a_bpks = sqrt(test.b_pk[*,0]^2 + test.b_pk[*,1]^2 + test.b_pk[*,2]^2)
a_epks = sqrt(test.e_pk[*,0]^2 + test.e_pk[*,1]^2 + test.e_pk[*,2]^2)

temp   = whistler_insta_read()

; => Phase Velocities
Vph_fln   = temp.VPH_FLOW_MN
Vph_flx   = temp.VPH_FLOW_MX
Vph_fhn   = temp.VPH_FHIGH_MN
Vph_fhx   = temp.VPH_FHIGH_MX
; => Define L-Shell and MLT
w_lsh     = temp.WIND_L_SHELL
w_mlt     = temp.WIND_MLT
; => Define radial distance and invariant latitude
w_rad     = temp.WIND_RAD_DIST

units     = STRTRIM(temp.UNITS,2)
;-----------------------------------------------------------------------------------------
; => Define separation tests (by finite Vph and L-Shell)
;-----------------------------------------------------------------------------------------
test_f    = FINITE(Vph_fln) AND FINITE(Vph_flx) AND FINITE(Vph_fhn) AND FINITE(Vph_fhx)
test_l    = (w_lsh LE 20.)
;test_l    = (w_lsh LE 10.)
test      = test_f AND test_l
good      = WHERE(test,gd)

units     = units[good]
w_lsh     = w_lsh[good]
w_mlt     = w_mlt[good]
w_rad     = w_rad[good]

a_bpks    = a_bpks[good]
a_epks    = a_epks[good]

mlt_lon   = w_mlt*36d1/24d0 - 9d1
; => Shift MLTs to make them appropriate for Polar Coordinate outputs
bad_20   = WHERE(mlt_lon LT 0d0,bd20)
IF (bd20 GT 0) THEN mlt_lon[bad_20] = mlt_lon[bad_20] + 36d1

good_nt     = WHERE(STRLOWCASE(units) EQ 'nt',gdnt,COMPLEMENT=good_mv,NCOMPLEMENT=gdmv)
PRINT, gdnt, gdmv

w_lsh_nt    = w_lsh[good_nt]
w_rad_nt    = w_rad[good_nt]
w_mlt_nt    = mlt_lon[good_nt]
a_bpks_nt   = a_bpks[good_nt]

w_lsh_mv    = w_lsh[good_mv]
w_rad_mv    = w_rad[good_mv]
w_mlt_mv    = mlt_lon[good_mv]
a_epks_mv   = a_epks[good_mv]


WINDOW,0,XSIZE=700,YSIZE=700,RETAIN=2
!P.MULTI  = 0
ttll      = 'Wind Spacecraft Whistler Peak Amplitudes (TDSS-nT Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [3e-2,5e-1]
zttl      = 'Peak Amplitudes (nT)'
polar_histogram_plot,w_rad_nt,w_mlt_nt,TTLE=ttll,XRANGE=xra,YRANGE=yra,$
                     ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=a_bpks_nt,      $
                     ZTTL=zttl,/POLAR



ttll      = 'Wind Spacecraft Whistler Peak Amplitudes (TDS-mV/m Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [1e-1,5e1]
zttl      = 'Peak Amplitudes (mV/m)'
polar_histogram_plot,w_rad_mv,w_mlt_mv,TTLE=ttll,XRANGE=xra,YRANGE=yra,$
                     ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=a_epks_mv,     $
                     ZTTL=zttl,/POLAR


ttll      = 'Wind Spacecraft Whistler Peak Amplitudes (TDSS-nT Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [3e-2,5e-1]
zttl      = 'Peak Amplitudes (nT)'
popen,'TDS-nT_Wind-Spacecraft-Peak-Amplitudes_polarhistogram_10-Radial_15-Angle_Labels',/LAND
  polar_histogram_plot,w_rad_nt,w_mlt_nt,TTLE=ttll,XRANGE=xra,YRANGE=yra,$
                       ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=a_bpks_nt,      $
                       ZTTL=zttl,/POLAR,/LABELS
pclose



ttll      = 'Wind Spacecraft Whistler Peak Amplitudes (TDS-mV/m Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [1e-1,5e1]
zttl      = 'Peak Amplitudes (mV/m)'
popen,'TDS-mVm_Wind-Spacecraft-Peak-Amplitudes_polarhistogram_10-Radial_15-Angle_Labels',/LAND
  polar_histogram_plot,w_rad_mv,w_mlt_mv,TTLE=ttll,XRANGE=xra,YRANGE=yra,$
                       ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=a_epks_mv,     $
                       ZTTL=zttl,/POLAR,/LABELS
pclose


ttll      = 'Wind Spacecraft Whistler (TDSS-nT Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [1e0,1e1]
zttl      = 'Number of TDSS-nT Samples'
popen,'TDS-nT_Wind-Spacecraft-Location-Numbers_polarhistogram_10-Radial_15-Angle_Labels',/LAND
  polar_histogram_plot,w_rad_nt,w_mlt_nt,TTLE=ttll,XRANGE=xra,YRANGE=yra,$
                       ZRANGE=zra,NBIN_R=10,NBIN_T=15,ZTTL=zttl,/POLAR,/LABELS
pclose

ttll      = 'Wind Spacecraft Whistler (TDS-mV/m Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [1e0,1e1]
zttl      = 'Number of TDS-mV/m Samples'
popen,'TDS-mVm_Wind-Spacecraft-Location-Numbers_polarhistogram_10-Radial_15-Angle_Labels',/LAND
  polar_histogram_plot,w_rad_mv,w_mlt_mv,TTLE=ttll,XRANGE=xra,YRANGE=yra,$
                       ZRANGE=zra,NBIN_R=10,NBIN_T=15,ZTTL=zttl,/POLAR,/LABELS
pclose
;-----------------------------------------------------------------------------------------
; => Look at AE index
;-----------------------------------------------------------------------------------------
date    = '111398'
date    = '040900'
date    = '050300'
date    = '052600'
date    = '061000'
date    = '062600'
date    = '071000'
date    = '072300'
date    = '080400'
date    = '081500'
date    = '100301'
date    = '102401'
date    = '111501'
date    = '101002'
mydate  = my_str_date(DATE=date)
sdate   = mydate.S_DATE[0]  ; -('MMDDYY')
ldate   = mydate.DATE[0]    ; -('YYYYMMDD')
tdate   = mydate.TDATE[0]   ; => 'YYYY-MM-DD'
; => Load mag data
t = ['1998-11-13/13:00:00','1998-11-14/02:00:00'] 
t = ['2000-04-09/19:48:00','2000-04-10/14:43:00']
t = ['2000-05-02/20:00:00','2000-05-03/10:00:00']
t = ['2000-05-25/15:52:00','2000-05-26/11:32:00']
t = ['2000-06-10/05:48:00','2000-06-10/16:00:00']
t = ['2000-06-26/16:00:00','2000-06-26/22:00:00']
t = ['2000-07-09/20:00:00','2000-07-10/08:00:00']
t = ['2000-07-23/05:10:00','2000-07-23/12:48:00']
t = ['2000-08-03/19:58:00','2000-08-04/08:00:00']
t = ['2000-08-15/19:00:00','2000-08-16/02:00:00']
t = ['2001-10-03/09:36:00','2001-10-04/05:00:00']
t = ['2001-10-23/13:08:00','2001-10-24/09:10:00']
t = ['2001-11-14/00:00:00','2001-11-16/06:00:00']
t = ['2002-10-09/20:00:00','2002-10-10/04:00:00']
tr3 = time_double(t)
mag3  = read_wind_mfi(TRANGE=tr3)
t3x   = mag3.MAG.X
bmag4 = mag3.MAG.Y
magf4 = mag3.BGSE.Y
nt    = N_ELEMENTS(t3x) 
store_data,'wi_B3_MAG(GSE)',DATA={X:mag3.MAG.X,Y:bmag4}
store_data,'wi_B3(GSE)',DATA={X:mag3.MAG.X,Y:magf4}
nn0 =['wi_B3_MAG(GSE)','wi_B3(GSE)']
options,'wi_B3_MAG(GSE)',"YTITLE","|B| (nT)!C[GSE,3s]"
options,'wi_B3(GSE)',"YTITLE","B (nT)!C[GSE,3s]"
options,'wi_B3(GSE)','COLORS',[250,150,50]
tplot,nn0,TRANGE=tr3
; => Load orbit data
tds_magneto_orbits,DATE=date
options,'Wind_Radial_Distance','YTITLE','Radial Dist. (R!DE!N)'
tplot_options, var_label=['Wind_Radial_Distance','Wind_L-Shell','Wind_MLT']
; => Load AE Index
test  = read_ae_data(DATE=date)
aedat = [[test.AE.Y],[test.AO.Y],[test.AL.Y],[test.AU.Y]]

store_data,'AE_Index_'+date[0],DATA={X:test.AE.X,Y:aedat}
options,'AE_Index_'+date[0],'YTITLE','AE Index (nT)'
options,'AE_Index_'+date[0],'COLORS',[250,50,150,200]
options,'AE_Index_'+date[0],'LABELS',['AE','AO','AL','AU']
; => TDS times
temp       = tds_whist_ehole_times(DATE=date[0],FIXFILE=fixfile)
ymdb_whist = temp.WHISTLER_T
unix_whist = temp.WHISTLER_UNX

nnw = tnames()
options,nnw,"YSTYLE",1
options,nnw,"PANEL_SIZE",2.
options,nnw,'XMINOR',5
options,nnw,'XTICKLEN',0.04

IF (date EQ '081500') THEN t   = ['2000-08-15/19:00:00','2000-08-16/00:00:00']
IF (date EQ '081500') THEN tr3 = time_double(['2000-08-15/19:00:00','2000-08-16/00:00:00'])

nna = tnames([nn0,'AE_Index_'+date[0]])
tplot,nna,TRANGE=tr3
time_bar,unix_whist,VARNAME=nna

stime  = STRMID(t[*],0,10)+'_'+STRMID(t[*],11,2)+STRMID(t[*],14,2)
sfname = stime[0]+'_'+stime[1]+'_TDS-Locations_whistlers-red'
prefn  = 'Wind_MFI-3sGSE_AE-AO-AL-AU-Indices_'
popen,prefn[0]+sfname[0],/PORT
  tplot,nna,TRANGE=tr3
  time_bar,unix_whist,VARNAME=nna,COLOR=250L
pclose

store_data,delete=tnames()



;-----------------------------------------------------------------------------------------
; => Interpolate AE index
;-----------------------------------------------------------------------------------------
test    = field_stats_whistler_read()
mts     = my_time_string(test.SCETS,STR=1,FORM=1,PREC=3)
wunix   = mts.UNIX
wymdb   = mts.DATE_TIME


gdates  = ['111398','040900','050300','052600','061000','062600','071000','072300',$
           '080400','081500','100301','102401','101002']
ndates  = N_ELEMENTS(gdates)
FOR j=0L, ndates - 1L DO BEGIN              $
  date = gdates[j]                        & $
  t_ae = read_ae_data(DATE=date)          & $
  jstr = 'T'+STRTRIM(date[0],2)           & $
  aet  = t_ae.AE.X                        & $
  ald  = t_ae.AL.Y                        & $
  aud  = t_ae.AU.Y                        & $
  aod  = t_ae.AO.Y                        & $
  aed  = t_ae.AE.Y                        & $
  aert = [MIN(aet,/NAN),MAX(aet,/NAN)]    & $
  good = WHERE(wunix LE aert[1] AND wunix GE aert[0],gd)  & $
  IF (gd GT 0) THEN BEGIN                 $
    t_al_d = interp(ald,aet,wunix[good],/NO_EXTRAP)  & $
    t_au_d = interp(aud,aet,wunix[good],/NO_EXTRAP)  & $
    t_ao_d = interp(aod,aet,wunix[good],/NO_EXTRAP)  & $
    t_ae_d = interp(aed,aet,wunix[good],/NO_EXTRAP)  & $
    str_al = {X:wunix[good],Y:t_al_d}                & $
    str_au = {X:wunix[good],Y:t_au_d}                & $
    str_ao = {X:wunix[good],Y:t_ao_d}                & $
    str_ae = {X:wunix[good],Y:t_ae_d}                & $
    str_element,dummy_al,jstr[0]+'_AL',str_al,/ADD_REPLACE  & $
    str_element,dummy_au,jstr[0]+'_AU',str_au,/ADD_REPLACE  & $
    str_element,dummy_ao,jstr[0]+'_AO',str_ao,/ADD_REPLACE  & $
    str_element,dummy_ae,jstr[0]+'_AE',str_ae,/ADD_REPLACE


all_ae = {AL:dummy_al,AU:dummy_au,AO:dummy_ao,AE:dummy_ae}
DELVAR,dummy_al,dummy_au,dummy_ao,dummy_ae

gdates  = ['111398','040900','050300','052600','061000','062600','071000','072300',$
           '080400','081500','100301','102401','101002']
ndates  = N_ELEMENTS(gdates)
FOR j=0L, ndates - 1L DO BEGIN              $
  date = gdates[j]                        & $
  t_ae = read_ae_data(DATE=date)          & $
  jstr = 'T'+STRTRIM(date[0],2)           & $
  aet  = t_ae.AE.X                        & $
  ala  = t_ae.AL.AVG                      & $
  aua  = t_ae.AU.AVG                      & $
  aoa  = t_ae.AO.AVG                      & $
  aea  = t_ae.AE.AVG                      & $
  nav  = N_ELEMENTS(aea)                  & $
  aeta = aet[LINDGEN(nav)*60L]            & $
  aera = [MIN(aeta,/NAN),MAX(aeta,/NAN)]  & $
  good = WHERE(wunix LE aera[1] AND wunix GE aera[0],gd)  & $
  IF (gd GT 0) THEN BEGIN                 $
    t_al_d = interp(ala,aeta,wunix[good],/NO_EXTRAP)  & $
    t_au_d = interp(aua,aeta,wunix[good],/NO_EXTRAP)  & $
    t_ao_d = interp(aoa,aeta,wunix[good],/NO_EXTRAP)  & $
    t_ae_d = interp(aea,aeta,wunix[good],/NO_EXTRAP)  & $
    str_al = {X:wunix[good],Y:t_al_d}                 & $
    str_au = {X:wunix[good],Y:t_au_d}                 & $
    str_ao = {X:wunix[good],Y:t_ao_d}                 & $
    str_ae = {X:wunix[good],Y:t_ae_d}                 & $
    str_element,dummy_al,jstr[0]+'_AL_AVG',str_al,/ADD_REPLACE  & $
    str_element,dummy_au,jstr[0]+'_AU_AVG',str_au,/ADD_REPLACE  & $
    str_element,dummy_ao,jstr[0]+'_AO_AVG',str_ao,/ADD_REPLACE  & $
    str_element,dummy_ae,jstr[0]+'_AE_AVG',str_ae,/ADD_REPLACE

all_aea = {AL:dummy_al,AU:dummy_au,AO:dummy_ao,AE:dummy_ae}
DELVAR,dummy_al,dummy_au,dummy_ao,dummy_ae


; => For crib-sheet file friendly format
mform  = '(";",a30,8f15.1)'
FOR j=0L, ndates - 1L DO BEGIN            $
  al_d = all_ae.AL.(j).Y                & $
  au_d = all_ae.AU.(j).Y                & $
  ao_d = all_ae.AO.(j).Y                & $
  ae_d = all_ae.AE.(j).Y                & $
  ae_t = all_ae.AE.(j).X                & $
  al_a = all_aea.AL.(j).Y               & $
  au_a = all_aea.AU.(j).Y               & $
  ao_a = all_aea.AO.(j).Y               & $
  ae_a = all_aea.AE.(j).Y               & $
  mts  = my_time_string(ae_t,UNIX=1,PREC=3,/NOMSSG)  & $
  ymdb = mts.DATE_TIME                  & $
  nd   = N_ELEMENTS(ymdb)               & $
  FOR k=0L, nd - 1L DO PRINT,FORMAT=mform,ymdb[k],al_d[k],au_d[k],ao_d[k],ae_d[k],$
                                          al_a[k],au_a[k],ao_a[k],ae_a[k]
  


; => For ASCII file friendly
mform  = '(a30,8f15.1)'
FOR j=0L, ndates - 1L DO BEGIN            $
  al_d = all_ae.AL.(j).Y                & $
  au_d = all_ae.AU.(j).Y                & $
  ao_d = all_ae.AO.(j).Y                & $
  ae_d = all_ae.AE.(j).Y                & $
  ae_t = all_ae.AE.(j).X                & $
  al_a = all_aea.AL.(j).Y               & $
  au_a = all_aea.AU.(j).Y               & $
  ao_a = all_aea.AO.(j).Y               & $
  ae_a = all_aea.AE.(j).Y               & $
  mts  = my_time_string(ae_t,UNIX=1,PREC=3,/NOMSSG)  & $
  ymdb = mts.DATE_TIME                  & $
  nd   = N_ELEMENTS(ymdb)               & $
  FOR k=0L, nd - 1L DO PRINT,FORMAT=mform,ymdb[k],al_d[k],au_d[k],ao_d[k],ae_d[k],$
                                          al_a[k],au_a[k],ao_a[k],ae_a[k]





;-------------------------------------------------------------------------------------------------------------------------------------------------------
;               SCET                      AL             AU              AO             AE          AL_AVG         AU_AVG         AO_AVG         AE_AVG
;=======================================================================================================================================================
;       1998-11-13/16:24:43.178         -993.0           14.6         -489.3         1007.6         -768.8           11.6         -378.7          780.4
;       1998-11-13/16:31:31.585        -1046.0           16.9         -515.1         1062.9         -720.1            9.5         -355.2          729.6
;       1998-11-13/16:37:50.910         -770.6           24.9         -373.3          795.5         -674.8            7.6         -333.4          682.4
;       1998-11-13/16:44:38.949         -816.3           31.0         -393.0          847.3         -626.0            5.6         -310.0          631.6
;       1998-11-13/18:10:07.461         -533.2            1.2         -266.5          534.5         -559.9           11.8         -275.0          571.7
;       1998-11-13/18:10:09.781         -534.8            1.3         -267.3          536.2         -560.1           11.7         -275.1          571.8
;       1998-11-13/18:10:55.754         -567.0            2.9         -282.6          569.9         -563.5           11.3         -277.1          574.8
;       1998-11-13/18:15:08.170         -462.6           58.5         -202.1          521.1         -582.6            8.7         -287.8          591.3
;       1998-11-13/18:15:36.757         -447.4           63.7         -192.1          511.1         -584.8            8.4         -289.1          593.1
;       1998-11-13/18:17:42.211         -469.6           51.2         -209.6          520.8         -594.3            7.1         -294.4          601.3
;       1998-11-13/18:18:54.213         -486.3           25.3         -230.6          511.6         -599.7            6.3         -297.5          606.0
;       1998-11-13/18:19:10.487         -481.8           20.2         -230.8          502.0         -600.9            6.2         -298.2          607.1
;       1998-11-13/18:20:51.506         -372.0           -9.3         -190.7          362.7         -608.6            5.1         -302.5          613.7
;       1998-11-13/18:20:57.938         -361.4          -11.3         -186.4          350.1         -609.0            5.1         -302.8          614.1
;       1998-11-13/18:20:57.978         -361.3          -11.4         -186.3          350.0         -609.0            5.1         -302.8          614.1
;       1998-11-13/18:20:59.086         -359.5          -11.7         -185.6          347.8         -609.1            5.1         -302.9          614.2
;       1998-11-13/18:20:59.546         -358.7          -11.9         -185.3          346.9         -609.2            5.1         -302.9          614.2
;       1998-11-13/18:20:59.590         -358.7          -11.9         -185.3          346.8         -609.2            5.1         -302.9          614.2
;       1998-11-13/18:21:07.462         -354.8          -11.5         -183.1          343.3         -609.8            5.0         -303.2          614.7
;       1998-11-13/18:21:08.048         -354.5          -11.5         -183.0          343.0         -609.8            5.0         -303.2          614.8
;       1998-11-13/18:21:08.092         -354.5          -11.5         -183.0          343.0         -609.8            5.0         -303.2          614.8
;       1998-11-13/18:21:17.884         -350.3          -10.8         -180.5          339.4         -610.6            4.9         -303.7          615.4
;       1998-11-13/18:30:34.243         -369.7           26.7         -172.0          396.4         -652.6           -0.9         -327.5          651.7
;       1998-11-13/19:03:49.414         -500.2           40.5         -230.3          540.7         -777.0          -12.0         -394.9          765.0
;       2000-04-10/02:45:39.736         -254.6          335.6           40.7          590.2         -304.1          205.9          -49.4          510.1
;       2000-04-10/02:49:27.780         -275.3          348.4           36.5          623.7         -300.7          201.2          -50.1          501.8
;       2000-04-10/02:49:47.201         -276.9          349.4           36.2          626.3         -300.4          200.8          -50.1          501.1
;       2000-04-10/02:49:47.303         -276.9          349.4           36.2          626.3         -300.4          200.8          -50.1          501.1
;       2000-04-10/02:50:55.652         -278.0          363.9           43.4          641.9         -299.3          199.3          -50.3          498.7
;       2000-04-10/02:50:57.440         -278.0          364.4           43.7          642.4         -299.3          199.3          -50.3          498.6
;       2000-04-10/02:52:29.005         -271.3          371.7           50.5          642.9         -297.9          197.4          -50.6          495.3
;       2000-04-10/02:52:47.911         -266.2          368.2           51.4          634.4         -297.6          197.0          -50.7          494.6
;       2000-04-10/02:55:03.002         -260.2          321.7           30.7          581.9         -295.5          194.2          -51.1          489.7
;       2000-04-10/02:55:37.951         -251.5          306.6           27.8          558.1         -295.0          193.5          -51.2          488.5
;       2000-04-10/02:55:53.362         -247.7          299.9           26.6          547.5         -294.8          193.1          -51.2          487.9
;       2000-04-10/02:56:32.084         -248.1          285.8           19.0          533.9         -294.2          192.3          -51.4          486.5
;       2000-04-10/02:56:34.562         -248.3          284.9           18.5          533.2         -294.1          192.3          -51.4          486.4
;       2000-04-10/02:56:43.654         -248.9          281.7           16.5          530.6         -294.0          192.1          -51.4          486.1
;       2000-04-10/03:10:43.077         -388.5          185.9         -101.3          574.4         -288.3          203.5          -42.9          491.9
;       2000-04-10/03:11:02.788         -391.9          187.6         -102.2          579.5         -288.2          204.0          -42.6          492.3
;       2000-04-10/03:11:03.216         -391.8          187.6         -102.1          579.4         -288.2          204.0          -42.6          492.3
;       2000-04-10/03:11:04.462         -391.3          187.9         -101.7          579.2         -288.2          204.1          -42.6          492.3
;       2000-04-10/03:11:05.114         -391.0          188.0         -101.6          579.1         -288.2          204.1          -42.6          492.3
;       2000-04-10/03:11:06.333         -390.6          188.3         -101.2          578.8         -288.2          204.1          -42.6          492.3
;       2000-04-10/03:11:07.636         -390.1          188.5         -100.8          578.6         -288.2          204.1          -42.5          492.4
;       2000-04-10/03:11:08.783         -389.6          188.8         -100.5          578.4         -288.2          204.2          -42.5          492.4
;       2000-04-10/03:11:10.422         -389.0          189.1         -100.0          578.1         -288.2          204.2          -42.5          492.4
;       2000-04-10/03:11:11.272         -388.7          189.3          -99.8          577.9         -288.2          204.2          -42.5          492.4
;       2000-04-10/03:14:11.849         -303.6          239.5          -32.4          543.2         -287.5          208.6          -39.9          496.0
;       2000-04-10/03:20:49.379         -249.9          230.6           -9.6          480.5         -285.8          218.2          -34.3          504.0
;       2000-04-10/03:44:20.795         -279.1          161.8          -58.8          440.9         -279.9          252.3          -14.3          532.2
;       2000-04-10/03:47:32.845         -269.6          149.3          -60.4          418.9         -279.1          256.9          -11.6          536.1
;       2000-04-10/03:47:52.891         -263.3          151.3          -56.4          414.5         -279.0          257.4          -11.3          536.5
;       2000-04-10/03:48:25.816         -254.1          157.6          -48.5          411.7         -278.9          258.2          -10.8          537.1
;       2000-04-10/04:00:15.167         -177.9          242.4           32.7          420.3         -275.8          274.6           -1.1          550.4
;       2000-04-10/04:14:45.376         -248.8          325.7           38.9          574.5         -265.2          248.9           -8.6          514.1
;       2000-04-10/04:14:59.775         -252.0          323.0           36.0          575.0         -265.0          248.5           -8.7          513.5
;       2000-04-10/04:32:44.807         -356.2          323.0          -17.1          679.2         -252.0          217.1          -17.9          469.1
;       2000-04-10/04:57:32.019         -323.5          193.9          -65.0          517.4         -233.8          173.4          -30.7          407.2
;       2000-05-03/01:23:30.919          -41.5           61.1            9.5          102.6          -36.4           38.3            1.5           74.0
;       2000-05-03/01:31:27.847          -27.4           43.1            8.1           70.5          -37.1           36.7            0.3           73.4
;       2000-05-03/01:34:49.511          -29.9           38.8            4.5           68.7          -37.5           36.0           -0.2           73.1
;       2000-05-03/02:22:50.215          -37.5           26.8           -5.3           64.3          -38.1           42.0            2.5           80.5
;       2000-05-03/02:22:56.471          -37.2           26.9           -5.1           64.1          -38.1           42.1            2.5           80.6
;       2000-05-03/02:22:56.839          -37.2           26.9           -5.1           64.1          -38.1           42.1            2.5           80.6
;       2000-05-03/02:23:09.351          -36.5           26.8           -4.8           63.4          -38.1           42.2            2.6           80.6
;       2000-05-03/02:45:38.071          -46.4           46.2            0.1           92.6          -36.2           53.1            8.9           90.0
;       2000-05-03/03:08:43.223          -32.6           21.2           -5.8           53.7          -41.1           62.0           11.0          104.0
;       2000-05-03/03:09:55.719          -32.0           23.9           -4.1           55.9          -42.0           62.3           10.7          105.1
;       2000-05-03/03:09:56.087          -32.0           23.9           -4.1           55.9          -42.0           62.3           10.7          105.1
;       2000-05-03/03:18:44.167          -26.7           24.9           -1.1           51.6          -48.1           64.4            8.6          113.2
;       2000-05-25/20:53:27.044         -219.6          203.2           -8.7          422.8         -186.9          197.5            5.7          385.3
;       2000-05-25/20:53:27.371         -219.6          203.2           -8.7          422.8         -186.9          197.5            5.7          385.3
;       2000-05-25/20:54:43.251         -212.2          211.3           -0.2          423.6         -186.9          196.8            5.4          384.6
;       2000-05-25/20:54:43.562         -212.2          211.4           -0.2          423.5         -186.9          196.8            5.4          384.6
;       2000-05-25/20:58:42.077         -209.5          190.4           -9.9          399.9         -187.0          194.7            4.3          382.6
;       2000-05-25/21:11:38.315         -196.4          221.8           13.2          418.3         -201.4          196.5           -2.0          398.7
;       2000-05-25/22:31:46.097         -285.7          237.5          -24.5          523.2         -412.4          200.6         -105.9          613.1
;       2000-05-25/22:43:01.950         -322.2          229.6          -46.3          551.8         -466.1          198.4         -133.9          664.5
;       2000-05-25/22:44:48.491         -319.1          217.8          -51.2          536.9         -474.6          198.0         -138.3          672.6
;       2000-05-25/22:51:17.966         -372.0          194.6          -88.7          566.6         -505.5          196.7         -154.4          702.3
;       2000-05-25/23:08:40.917         -455.0          208.4         -123.8          663.5         -526.0          198.2         -164.0          724.2
;       2000-05-25/23:13:53.957         -580.0          207.4         -186.3          787.4         -513.4          200.1         -156.8          713.5
;       2000-05-25/23:30:50.444         -608.6          203.6         -203.0          812.2         -472.5          206.3         -133.3          678.8
;       2000-05-25/23:31:07.717         -622.5          201.7         -210.9          824.2         -471.8          206.4         -132.9          678.2
;       2000-05-25/23:31:11.130         -626.2          201.1         -213.0          827.4         -471.6          206.4         -132.9          678.1
;       2000-05-25/23:32:53.190         -719.9          183.2         -268.8          903.1         -467.5          207.1         -130.5          674.6
;       2000-05-25/23:33:50.476         -711.5          174.4         -268.6          886.0         -465.2          207.4         -129.2          672.6
;       2000-05-25/23:35:28.129         -638.1          174.8         -232.2          812.9         -461.3          208.0         -126.9          669.3
;       2000-05-25/23:35:53.925         -622.6          177.4         -223.1          800.0         -460.2          208.2         -126.3          668.4
;       2000-05-25/23:36:02.147         -619.2          178.2         -221.0          797.4         -459.9          208.2         -126.2          668.1
;       2000-05-25/23:36:22.399         -620.9          179.9         -221.0          800.7         -459.1          208.3         -125.7          667.4
;       2000-05-25/23:36:30.056         -621.5          180.5         -221.0          802.0         -458.8          208.4         -125.5          667.2
;       2000-05-25/23:37:30.175         -627.0          187.5         -220.0          814.5         -456.4          208.8         -124.1          665.1
;       2000-05-25/23:38:52.636         -621.2          190.2         -215.5          811.5         -453.0          209.3         -122.2          662.3
;       2000-05-25/23:38:58.460         -620.3          190.1         -215.1          810.3         -452.8          209.3         -122.1          662.1
;       2000-05-25/23:39:01.624         -619.4          190.0         -214.7          809.4         -452.7          209.3         -122.0          662.0
;       2000-05-25/23:39:03.381         -618.6          190.0         -214.3          808.6         -452.6          209.3         -122.0          661.9
;       2000-05-25/23:54:21.121         -555.0          147.3         -204.2          702.3         -415.6          214.9         -100.8          630.6
;       2000-05-25/23:56:04.664         -519.4          155.0         -182.2          674.4         -411.5          215.6          -98.4          627.0
;       2000-05-26/00:05:07.441         -456.3          220.4         -118.0          676.6         -403.5          213.4          -95.6          617.0
;       2000-05-26/00:40:41.872         -338.4          212.0          -63.2          550.4         -414.2          188.5         -113.3          602.7
;       2000-05-26/02:18:14.778         -341.0          122.7         -109.2          463.7         -370.5          147.6         -111.8          518.2
;       2000-05-26/02:18:15.163         -341.0          122.8         -109.3          463.8         -370.5          147.6         -111.8          518.2
;       2000-06-10/12:48:06.950         -241.3          184.9          -28.7          426.3         -439.7          288.8          -75.3          727.7
;       2000-06-10/12:48:15.327         -241.8          186.0          -28.2          427.8         -440.2          289.0          -75.5          728.4
;       2000-06-10/12:48:15.360         -241.8          186.0          -28.2          427.8         -440.2          289.0          -75.5          728.5
;       2000-06-10/12:48:21.086         -242.1          186.8          -27.9          428.9         -440.6          289.2          -75.6          729.0
;       2000-06-10/12:48:33.873         -242.7          188.5          -27.3          431.2         -441.4          289.6          -75.8          730.2
;       2000-06-10/13:06:57.530         -544.3          284.1         -130.1          828.4         -478.2          311.7          -83.3          789.0
;       2000-06-10/13:07:04.610         -543.4          284.8         -129.3          828.2         -478.0          311.7          -83.2          788.9
;       2000-06-10/13:07:06.975         -543.1          285.2         -129.0          828.2         -478.0          311.7          -83.2          788.8
;       2000-06-10/13:07:09.310         -542.8          285.6         -128.6          828.3         -477.9          311.7          -83.2          788.8
;       2000-06-10/13:07:09.799         -542.7          285.6         -128.5          828.3         -477.9          311.7          -83.1          788.8
;       2000-06-10/13:07:17.471         -541.7          286.9         -127.4          828.6         -477.8          311.8          -83.0          788.7
;       2000-06-10/13:07:21.074         -541.2          287.5         -126.8          828.7         -477.7          311.8          -83.0          788.6
;       2000-06-10/13:07:31.037         -539.9          289.2         -125.3          829.0         -477.5          311.9          -82.9          788.5
;       2000-06-10/13:07:32.401         -539.7          289.4         -125.1          829.1         -477.4          311.9          -82.8          788.5
;       2000-06-10/13:07:33.206         -539.6          289.5         -125.0          829.1         -477.4          311.9          -82.8          788.5
;       2000-06-10/13:07:39.001         -538.8          290.5         -124.1          829.3         -477.3          311.9          -82.8          788.4
;       2000-06-10/13:07:40.716         -538.6          290.8         -123.9          829.4         -477.3          311.9          -82.7          788.3
;       2000-06-10/13:08:34.879         -522.6          299.2         -111.7          821.9         -476.1          312.3          -82.0          787.6
;       2000-06-10/13:10:32.960         -498.9          287.5         -105.9          786.5         -473.6          313.0          -80.4          785.9
;       2000-06-26/19:25:26.101         -672.0          465.9         -103.3         1137.9         -431.0          402.1          -14.2          832.7
;       2000-06-26/20:26:35.125         -348.5          486.7           69.3          835.2         -370.6          344.8          -12.6          714.4
;       2000-06-26/20:26:35.583         -348.6          486.7           69.3          835.2         -370.6          344.8          -12.7          714.4
;       2000-06-26/20:26:37.131         -348.7          486.4           69.0          835.1         -370.7          344.7          -12.7          714.4
;       2000-06-26/20:27:13.290         -347.9          481.0           66.7          828.9         -371.8          343.8          -13.7          714.6
;       2000-06-26/20:27:13.584         -347.8          481.0           66.7          828.8         -371.8          343.8          -13.7          714.6
;       2000-06-26/20:27:14.652         -347.6          480.8           66.7          828.4         -371.9          343.8          -13.8          714.6
;       2000-06-26/20:27:22.681         -345.7          479.6           67.1          825.3         -372.1          343.6          -14.0          714.7
;       2000-06-26/20:27:29.246         -344.2          478.6           67.5          822.8         -372.3          343.4          -14.2          714.7
;       2000-07-09/22:49:28.993         -100.5          124.5           12.5          225.0         -179.5          138.7          -20.7          319.0
;       2000-07-09/23:52:09.305         -298.0          175.7          -61.2          473.7         -185.7          161.4          -12.2          347.2
;       2000-07-09/23:56:06.302         -300.6          165.1          -67.8          465.7         -184.8          162.7          -11.1          347.6
;       2000-07-10/00:19:52.521         -249.9          193.8          -28.5          443.6         -138.3          144.8            3.3          283.1
;       2000-07-10/04:39:56.878          -45.6           26.8           -9.9           72.5         -135.2          218.1           42.0          353.3
;       2000-07-10/04:39:59.313          -45.9           27.0          -10.0           72.9         -135.3          218.3           42.0          353.6
;       2000-07-10/04:40:00.394          -46.1           27.1          -10.0           73.1         -135.4          218.4           42.0          353.7
;       2000-07-10/04:47:52.208          -61.1          119.1           29.0          180.2         -156.1          249.3           47.1          405.3
;       2000-07-10/04:47:52.711          -61.1          119.2           29.0          180.3         -156.1          249.3           47.1          405.4
;       2000-07-10/04:47:53.723          -61.1          119.4           29.2          180.5         -156.1          249.4           47.1          405.5
;       2000-07-10/04:47:54.281          -61.1          119.6           29.2          180.7         -156.1          249.4           47.1          405.6
;       2000-07-10/04:47:55.616          -61.1          119.9           29.4          181.0         -156.2          249.5           47.2          405.7
;       2000-07-10/04:47:57.232          -61.0          120.3           29.6          181.4         -156.3          249.6           47.2          405.9
;       2000-07-10/04:47:59.343          -61.0          120.8           29.9          181.8         -156.4          249.8           47.2          406.1
;       2000-07-10/04:48:03.029          -60.8          121.3           30.3          182.2         -156.5          250.0           47.2          406.5
;       2000-07-23/07:53:55.198          -41.2           66.5           12.7          107.8          -45.0           50.6            2.8           96.5
;       2000-07-23/08:07:18.002          -43.3           48.3            3.0           91.6          -46.1           49.3            1.6           96.3
;       2000-07-23/08:18:53.253          -60.7           36.6          -12.1           97.2          -46.3           51.5            2.6           98.5
;       2000-07-23/08:18:56.383          -60.8           36.8          -12.1           97.6          -46.3           51.5            2.6           98.5
;       2000-07-23/08:19:22.392          -61.0           38.9          -11.3           99.9          -46.3           51.6            2.6           98.6
;       2000-07-23/08:19:22.720          -61.0           38.9          -11.2           99.9          -46.3           51.6            2.6           98.6
;       2000-07-23/08:25:37.845          -59.0           46.0           -6.5          105.0          -46.4           52.7            3.1           99.7
;       2000-07-23/09:42:14.233          -51.5           64.1            6.3          115.5          -51.2           70.3            9.5          121.5
;       2000-07-23/10:41:18.785          -56.6           63.7            3.9          120.3          -51.6           79.8           14.4          131.4
;       2000-07-23/10:41:21.794          -56.0           63.5            4.1          119.6          -51.6           79.8           14.4          131.4
;       2000-07-23/10:41:24.746          -55.5           63.4            4.2          118.8          -51.6           79.8           14.5          131.5
;       2000-07-23/10:41:36.795          -53.3           62.5            4.8          115.8          -51.6           79.9           14.5          131.5
;       2000-07-23/10:41:39.799          -52.7           62.3            5.0          115.1          -51.6           79.9           14.5          131.5
;       2000-07-23/10:42:25.058          -50.7           60.2            4.7          110.8          -51.6           79.9           14.5          131.5
;       2000-07-23/10:42:27.910          -50.9           60.1            4.6          110.9          -51.6           80.0           14.5          131.5
;       2000-07-23/10:42:31.211          -51.1           60.0            4.4          111.0          -51.6           80.0           14.5          131.5
;       2000-07-23/10:42:49.044          -52.3           59.4            3.5          111.6          -51.6           80.0           14.6          131.6
;       2000-07-23/10:42:51.898          -52.5           59.3            3.4          111.7          -51.6           80.0           14.6          131.6
;       2000-07-23/10:42:52.195          -52.5           59.3            3.4          111.7          -51.6           80.0           14.6          131.6
;       2000-07-23/10:42:58.257          -52.9           59.1            3.1          111.9          -51.6           80.0           14.6          131.6
;       2000-07-23/10:43:01.213          -53.0           59.2            3.1          112.2          -51.6           80.0           14.6          131.6
;       2000-07-23/10:43:31.390          -54.0           63.2            4.6          117.2          -51.5           80.1           14.6          131.6
;       2000-07-23/10:43:43.293          -54.4           64.8            5.2          119.2          -51.5           80.1           14.6          131.6
;       2000-07-23/10:43:46.466          -54.5           65.2            5.3          119.7          -51.5           80.1           14.6          131.6
;       2000-07-23/10:44:16.549          -53.9           68.4            7.4          122.3          -51.5           80.2           14.7          131.7
;       2000-07-23/11:10:10.130          -50.7           76.5           13.0          127.2          -62.7           89.1           13.6          151.6
;       2000-08-03/22:04:46.697          -30.3           72.7           21.7          103.0          -26.4           55.9           14.8           82.2
;       2000-08-03/22:37:06.914          -41.7           69.1           13.8          110.8          -22.1           48.3           13.1           70.4
;       2000-08-03/22:38:56.457          -44.2           68.1           12.0          112.3          -21.8           47.9           13.1           69.7
;       2000-08-03/23:06:51.648          -12.7           37.0           12.1           49.7          -27.7           54.3           13.4           82.0
;       2000-08-03/23:22:59.542          -30.9           43.0            6.0           73.9          -48.1           80.9           16.6          129.1
;       2000-08-03/23:25:52.206          -39.9           48.1            4.1           88.0          -51.8           85.7           17.2          137.5
;       2000-08-03/23:26:19.732          -39.0           47.7            4.3           86.7          -52.3           86.4           17.3          138.8
;       2000-08-03/23:27:02.963          -36.9           47.2            5.1           84.1          -53.3           87.6           17.4          140.9
;       2000-08-03/23:28:15.525          -35.5           51.3            8.0           86.8          -54.8           89.6           17.7          144.4
;       2000-08-03/23:29:13.351          -37.0           51.8            7.8           88.8          -56.0           91.2           17.8          147.2
;       2000-08-03/23:30:32.536          -37.0           50.5            7.0           87.5          -57.7           93.4           18.1          151.1
;       2000-08-03/23:30:38.472          -37.0           50.4            7.0           87.4          -57.8           93.6           18.1          151.4
;       2000-08-03/23:31:01.521          -37.0           50.0            7.0           87.0          -58.3           94.2           18.2          152.5
;       2000-08-03/23:31:54.212          -37.0           49.1            6.1           86.1          -59.4           95.6           18.4          155.1
;       2000-08-03/23:31:54.819          -37.0           49.1            6.1           86.1          -59.4           95.7           18.4          155.1
;       2000-08-03/23:32:30.731          -37.0           49.5            6.5           86.5          -60.2           96.6           18.5          156.8
;       2000-08-03/23:32:47.913          -37.0           49.8            6.8           86.8          -60.5           97.1           18.6          157.7
;       2000-08-03/23:33:05.849          -36.9           48.2            6.1           85.1          -60.9           97.6           18.6          158.5
;       2000-08-04/03:44:40.929         -331.9          241.0          -45.6          572.9         -240.8          252.7            6.2          493.8
;       2000-08-15/19:10:21.328         -128.1           76.9          -25.6          205.0          -77.5           75.4           -0.6          152.8
;       2000-08-15/19:57:34.018          -62.1           75.7            7.3          137.9          -57.1           68.4            5.7          124.5
;       2000-08-15/21:14:06.339          -33.5           47.7            7.6           81.2          -34.4           42.1            3.9           77.0
;       2000-08-15/21:14:06.376          -33.5           47.7            7.6           81.2          -34.4           42.1            3.9           77.0
;       2000-08-15/21:18:08.249          -38.9           46.3            3.7           85.2          -33.7           41.8            4.2           75.9
;       2000-08-15/21:18:08.282          -38.9           46.3            3.7           85.2          -33.7           41.8            4.2           75.9
;       2000-08-16/02:13:03.331          -58.4           47.2           -5.6          105.6          -66.7           79.5            6.1          146.4
;       2000-08-16/02:13:04.591          -58.2           47.2           -5.5          105.4          -66.7           79.5            6.1          146.4
;       2001-10-04/00:36:06.613         -506.9           66.0         -220.9          572.9         -302.6           41.3         -131.0          343.9
;       2001-10-23/21:22:13.932          -41.2           12.6          -14.3           53.9          -38.9           13.4          -12.6           52.3
;       2001-10-23/21:22:15.036          -41.3           12.8          -14.2           54.0          -38.9           13.4          -12.6           52.3
;       2001-10-23/21:22:27.548          -41.5           14.2          -13.6           55.7          -38.9           13.4          -12.6           52.3
;       2001-10-23/21:56:15.229          -37.0           15.7          -11.0           52.7          -32.7            9.4          -12.1           42.1
;       2001-10-23/21:56:15.964          -37.0           15.7          -11.0           52.7          -32.7            9.4          -12.1           42.1
;       2001-10-23/21:56:22.955          -37.0           15.6          -11.0           52.6          -32.7            9.4          -12.1           42.1
;       2001-10-23/21:56:23.323          -37.0           15.6          -11.0           52.6          -32.7            9.4          -12.1           42.1
;       2001-10-23/22:04:32.763          -35.5           11.5          -12.5           47.0          -31.6            8.8          -11.8           40.5
;       2001-10-23/22:08:46.315          -37.0           16.5          -10.2           53.5          -31.3            8.7          -11.7           40.0
;       2001-10-23/22:11:30.811          -36.0           21.0           -8.0           57.0          -31.0            8.6          -11.6           39.7
;       2001-10-23/22:15:42.526          -35.0           10.9          -12.4           45.9          -30.7            8.5          -11.5           39.2
;       2001-10-23/22:25:11.084          -34.0           12.3          -11.4           46.3          -29.9            8.2          -11.2           38.1
;       2001-10-23/22:25:11.820          -34.0           12.2          -11.4           46.2          -29.9            8.2          -11.2           38.1
;       2001-10-23/22:25:29.119          -34.0           11.1          -12.0           45.1          -29.9            8.2          -11.2           38.0
;       2002-10-10/00:12:12.505         -146.6          188.8           21.2          335.5         -217.9          197.4           -9.8          415.3
;       2002-10-10/01:00:57.367         -327.1          205.9          -61.1          533.0         -206.0          187.2           -8.9          393.2
;       2002-10-10/01:10:26.236         -220.1          183.3          -18.6          403.3         -205.8          189.4           -7.8          395.1
;       2002-10-10/01:11:17.983         -225.2          180.7          -22.6          405.9         -205.8          189.6           -7.7          395.3
;       2002-10-10/01:14:15.781         -240.0          177.2          -31.8          417.2         -205.8          190.3           -7.3          395.9
;       2002-10-10/01:23:42.514         -237.2          179.6          -28.8          416.8         -205.6          192.5           -6.2          397.7
;       2002-10-10/01:58:27.135         -155.3          192.0           18.6          347.3         -205.0          200.6           -2.2          404.7
;       2002-10-10/02:30:17.675         -181.2          204.0           11.5          385.2         -267.1          186.9          -40.4          453.0
;       2002-10-10/02:33:05.076         -182.1          205.4           12.2          387.5         -272.8          185.6          -43.9          457.4
;       2002-10-10/02:33:05.411         -182.0          205.4           12.2          387.4         -272.8          185.6          -43.9          457.4
;       2002-10-10/02:33:08.966         -181.4          205.0           12.3          386.3         -273.0          185.5          -44.0          457.5
;       2002-10-10/02:33:13.393         -180.5          204.4           12.4          385.0         -273.1          185.5          -44.1          457.6
;       2002-10-10/02:33:17.306         -179.8          204.0           12.6          383.8         -273.2          185.5          -44.2          457.7
;       2002-10-10/02:33:18.374         -179.6          203.9           12.6          383.5         -273.3          185.5          -44.2          457.7
;       2002-10-10/02:33:18.841         -179.5          203.8           12.6          383.3         -273.3          185.5          -44.2          457.7
;       2002-10-10/02:33:35.247         -176.5          201.9           13.2          378.4         -273.9          185.3          -44.5          458.2
;       2002-10-10/02:33:38.084         -176.0          201.6           13.3          377.6         -274.0          185.3          -44.6          458.3
;       2002-10-10/02:33:49.950         -173.8          200.2           13.7          374.0         -274.4          185.2          -44.9          458.6
;       2002-10-10/02:34:19.954         -170.0          199.7           15.3          369.7         -275.4          185.0          -45.5          459.4
;       2002-10-10/02:34:55.959         -166.4          200.9           17.7          367.3         -276.6          184.7          -46.2          460.3
;       2002-10-10/02:34:59.293         -166.1          201.0           18.0          367.0         -276.7          184.7          -46.3          460.4
;       2002-10-10/02:35:04.737         -165.8          201.9           18.6          367.8         -276.9          184.6          -46.4          460.5
;       2002-10-10/02:35:31.957         -164.9          207.4           21.7          372.3         -277.8          184.4          -47.0          461.3
;       2002-10-10/02:41:48.565         -172.9          201.0           14.5          373.9         -290.7          181.5          -55.0          471.2
;       2002-10-10/02:41:50.876         -172.3          201.0           14.8          373.3         -290.8          181.5          -55.0          471.3
;       2002-10-10/02:44:21.244         -162.5          208.6           23.1          371.2         -295.9          180.3          -58.2          475.2
;       2002-10-10/02:57:43.393         -243.6          164.3          -40.0          407.8         -323.3          174.1          -75.1          496.4
;       2002-10-10/02:59:19.793         -240.3          166.3          -37.0          406.7         -326.6          173.3          -77.2          498.9
;       2002-10-10/02:59:20.233         -240.3          166.3          -37.0          406.7         -326.6          173.3          -77.2          499.0
;       2002-10-10/03:24:48.019         -430.0          185.2         -122.8          615.2         -346.6          181.3          -83.0          526.9
;-------------------------------------------------------------------------------------------------------------------------------------------------------

'------------------------------------------------------------------------------------------------------------------'
' => Use finite Vph for test'
'------------------------------------------------------------------------------------------------------------------'
loc_test = whistler_insta_loc_read()
mts      = my_time_string(STRTRIM(loc_test.SCETS,2),STR=1,FORM=6,PREC=3,/NOMSSG)
locunix  = mts.UNIX
locymdb  = STRMID(mts.DATE_TIME,0L,23L)  ; => 'YYYY/MM/DD hh:mm:ss.xxx'

test_wh  = field_stats_whistler_read(/EXT)
mts      = my_time_string(test_wh.SCETS,STR=1,FORM=6,PREC=3,/NOMSSG)
whunix   = mts.UNIX
whymdb   = STRMID(mts.DATE_TIME,0L,23L)  ; => 'YYYY/MM/DD hh:mm:ss.xxx'

test_ae  = ae_index_stats_whistler_read()
mts      = my_time_string(test_ae.SCETS,STR=1,FORM=6,PREC=3,/NOMSSG)
aeunix   = mts.UNIX
aeymdb   = STRMID(mts.DATE_TIME,0L,23L)  ; => 'YYYY/MM/DD hh:mm:ss.xxx'


test     = my_array_where(whymdb,aeymdb,/N_UNIQ)
; => Good elements for whistler field stats
whunix   = whunix[test[*,0]]
whymdb   = whymdb[test[*,0]]
test2    = my_array_where(whymdb,locymdb,/N_UNIQ)
units    = test_wh.UNITS[test[*,0]]
whe_rms  = test_wh.E_RMS[test[*,0],*]
whb_rms  = test_wh.B_RMS[test[*,0],*]
whs_rms  = test_wh.S_RMS[test[*,0],*]
whe_pk   = test_wh.E_PK[test[*,0],*]
whb_pk   = test_wh.B_PK[test[*,0],*]
whs_pk   = test_wh.S_PK[test[*,0],*]
w_bmag   = test_wh.WI_B3_MAG[test[*,0]]
w_rad    = test_wh.WIND_RAD_DIST[test[*,0]]
w_lsh    = test_wh.WIND_L_SHELL[test[*,0]]
w_vphfln = loc_test.VPH_FLOW_MN[test2[*,1]]
w_vphflx = loc_test.VPH_FLOW_MX[test2[*,1]]
w_vphfhn = loc_test.VPH_FHIGH_MN[test2[*,1]]
w_vphfhx = loc_test.VPH_FHIGH_MX[test2[*,1]]
w_mlt    = test_wh.WIND_MLT[test[*,0]]
w_inv    = test_wh.WIND_INV_LAT[test[*,0]]
w_dens   = test_wh.N_I3[test[*,0]]
w_tanil  = test_wh.TANIS_EL[test[*,0]]
w_tanih  = test_wh.TANIS_EH[test[*,0]]
w_flow   = test_wh.FLOW_PEAK[test[*,0]]
w_fhigh  = test_wh.FHIGH_PEAK[test[*,0]]
w_gse_p  = test_wh.GSE_POS[test[*,0],*]
w_gsm_p  = test_wh.GSM_POS[test[*,0],*]
; => Good elements for whistler AE stats
aeunix  = aeunix[test[*,1]]
aeymdb  = aeymdb[test[*,1]]
al_ind  = test_ae.AL_INDEX[test[*,1]]
au_ind  = test_ae.AU_INDEX[test[*,1]]
ao_ind  = test_ae.AO_INDEX[test[*,1]]
ae_ind  = test_ae.AE_INDEX[test[*,1]]

al_inda = test_ae.AL_INDEX_AVG[test[*,1]]
au_inda = test_ae.AU_INDEX_AVG[test[*,1]]
ao_inda = test_ae.AO_INDEX_AVG[test[*,1]]
ae_inda = test_ae.AE_INDEX_AVG[test[*,1]]

;----------------------------------------------------------------
; => Define separation tests (by finite Vph and Radial Distance)
;----------------------------------------------------------------
lshell      = 15.
; => Make sure we only look at cases with finite phase velocity estimates from 
;      cold plasma dispersion estimates
test_f     = FINITE(w_vphfln) AND FINITE(w_vphflx) AND FINITE(w_vphfhn) $
               AND FINITE(w_vphfhx)
; => Make sure we only look at cases within a specific L-shell
test_l     = (w_lsh LE lshell)
; => Combine two tests
testlf     = test_f AND test_l
good0      = WHERE(testlf,gd0)

whunix   = whunix[good0]
whymdb   = whymdb[good0]
units    = units[good0]
whe_rms  = whe_rms[good0,*]
whb_rms  = whb_rms[good0,*]
whs_rms  = whs_rms[good0,*]
whe_pk   = whe_pk[good0,*]
whb_pk   = whb_pk[good0,*]
whs_pk   = whs_pk[good0,*]
w_bmag   = w_bmag[good0]
w_rad    = w_rad[good0]
w_lsh    = w_lsh[good0]
w_mlt    = w_mlt[good0]
w_inv    = w_inv[good0]
w_dens   = w_dens[good0]
w_tanil  = w_tanil[good0]
w_tanih  = w_tanih[good0]
w_flow   = w_flow[good0]
w_fhigh  = w_fhigh[good0]
w_gse_p  = w_gse_p[good0,*]
w_gsm_p  = w_gsm_p[good0,*]
; => Good elements for whistler AE stats
aeunix  = aeunix[good0]
aeymdb  = aeymdb[good0]
al_ind  = al_ind[good0]
au_ind  = au_ind[good0]
ao_ind  = ao_ind[good0]
ae_ind  = ae_ind[good0]

al_inda = al_inda[good0]
au_inda = au_inda[good0]
ao_inda = ao_inda[good0]
ae_inda = ae_inda[good0]

awhb_pk  = SQRT(whb_pk[*,0]^2 + whb_pk[*,1]^2 + whb_pk[*,2]^2)
awhe_pk  = SQRT(whe_pk[*,0]^2 + whe_pk[*,1]^2 + whe_pk[*,2]^2)
awhs_pk  = SQRT(whs_pk[*,0]^2 + whs_pk[*,1]^2 + whs_pk[*,2]^2)
awhb_rms = SQRT(whb_rms[*,0]^2 + whb_rms[*,1]^2 + whb_rms[*,2]^2)
awhe_rms = SQRT(whe_rms[*,0]^2 + whe_rms[*,1]^2 + whe_rms[*,2]^2)
awhs_rms = SQRT(whs_rms[*,0]^2 + whs_rms[*,1]^2 + whs_rms[*,2]^2)

HELP, ae_ind, WHERE(ae_ind GE 1e2), WHERE(ae_ind GE 2e2), WHERE(ae_ind GE 3e2), $
              WHERE(ae_ind GE 4e2), WHERE(ae_ind GE 5e2), WHERE(ae_ind GE 6e2), $
              WHERE(ae_ind GE 7e2), WHERE(ae_ind GE 8e2), WHERE(ae_ind GE 9e2)
;-----------------------------------------------------------------------------------------
;  AE_IND          FLOAT     = Array[241]
;  <Expression>    LONG      = Array[189]
;  <Expression>    LONG      = Array[153]
;  <Expression>    LONG      = Array[151]
;  <Expression>    LONG      = Array[118]
;  <Expression>    LONG      = Array[92]
;  <Expression>    LONG      = Array[55]
;  <Expression>    LONG      = Array[44]
;  <Expression>    LONG      = Array[39]
;  <Expression>    LONG      = Array[4]
;-----------------------------------------------------------------------------------------
HELP, ae_ind, WHERE(ae_ind GE 1e1 AND ae_ind LT 2e2), $
              WHERE(ae_ind GE 2e2 AND ae_ind LT 4e2), $
              WHERE(ae_ind GE 4e2 AND ae_ind LT 6e2), $
              WHERE(ae_ind GE 6e2 AND ae_ind LT 8e2), $
              WHERE(ae_ind GE 8e2 AND ae_ind LT 1e3), $
              WHERE(ae_ind GE 6e2 AND ae_ind LT 1e3)
;-----------------------------------------------------------------------------------------
;  AE_IND          FLOAT     = Array[241]
;  <Expression>    LONG      = Array[88]
;  <Expression>    LONG      = Array[35]
;  <Expression>    LONG      = Array[63]
;  <Expression>    LONG      = Array[16]
;  <Expression>    LONG      = Array[36]
;  <Expression>    LONG      = Array[52]
;-----------------------------------------------------------------------------------------

nums_ae = STRTRIM(STRING(N_ELEMENTS(ae_ind),FORMAT='(I3.3)'),2)
suffx   = '     => For AE > '
suffx2  = ' nT  ['
temp_ae = 1e2
temp_ae = 2e2
temp_ae = 3e2
temp_ae = 4e2
temp_ae = 5e2
temp_ae = 6e2
temp_ae = 7e2

testeae = WHERE(ae_ind GE temp_ae,gdeae)
ae_str  = STRTRIM(STRING(temp_ae,FORMAT='(I3.3)'),2)
rat_he  = STRING(gdeae,FORMAT='(I3.3)')+'/'+nums_ae[0]+']'
suff_xe = suffx[0]+ae_str[0]+suffx2[0]+rat_he[0]

indsb   = WHERE(ae_ind GE temp_ae)
PRINT, minmax(awhb_pk[indsb],/POS),MEAN(awhb_pk[indsb],/NAN),STDDEV(awhb_pk[indsb],/NAN), $
       suff_xe,FORMAT='(";",4f16.7,a34)'
PRINT, minmax(awhe_pk[indsb],/POS),MEAN(awhe_pk[indsb],/NAN),STDDEV(awhe_pk[indsb],/NAN), $
       suff_xe,FORMAT='(";",4f16.7,a34)'
;inds    = WHERE(ae_ind GE temp_ae)
;PRINT, minmax(awhb_pk[inds],/POS),MEAN(awhb_pk[inds],/NAN),STDDEV(awhb_pk[inds],/NAN), $
;       minmax(awhe_pk[inds],/POS),MEAN(awhe_pk[inds],/NAN),STDDEV(awhe_pk[inds],/NAN), $
;       FORMAT='(4f14.7)'

suffx    = '     => For '
suffx2  = ' nT < AE < '
suffx3  = ' nT  ['
temp_ael = 1e1
temp_aeh = 2e2
temp_ael = 2e2
temp_aeh = 4e2
temp_ael = 4e2
temp_aeh = 6e2
temp_ael = 6e2
temp_aeh = 8e2
temp_ael = 8e2
temp_aeh = 1e3
temp_ael = 6e2
temp_aeh = 1e3

indse    = WHERE(ae_ind GE temp_ael AND ae_ind LT temp_aeh,gdeae)
ael_str  = STRTRIM(STRING(temp_ael,FORMAT='(f8.0)'),2)
aeh_str  = STRTRIM(STRING(temp_aeh,FORMAT='(f8.0)'),2)
rat_he   = STRING(gdeae,FORMAT='(I3.3)')+'/'+nums_ae[0]+']'
suff_xe  = suffx[0]+ael_str[0]+suffx2[0]+aeh_str[0]+suffx3[0]+rat_he[0]
PRINT, minmax(awhb_pk[indse],/POS),MEAN(awhb_pk[indse],/NAN),STDDEV(awhb_pk[indse],/NAN), $
       suff_xe,FORMAT='(";",4f16.7,a45)'
PRINT, minmax(awhe_pk[indse],/POS),MEAN(awhe_pk[indse],/NAN),STDDEV(awhe_pk[indse],/NAN), $
       suff_xe,FORMAT='(";",4f16.7,a45)'

;inds     = WHERE(ae_ind GE temp_ael AND ae_ind LT temp_aeh)
;PRINT, minmax(awhb_pk[inds],/POS),MEAN(awhb_pk[inds],/NAN),STDDEV(awhb_pk[inds],/NAN), $
;       minmax(awhe_pk[inds],/POS),MEAN(awhe_pk[inds],/NAN),STDDEV(awhe_pk[inds],/NAN), $
;       FORMAT='(4f14.7)'

;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;        Min (nT)        Max (nT)       Mean (nT)     Std. Dev. (nT)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.0412311       5.5400000       0.2568470       0.7207522     => For AE > 100 nT  [189/241]
;       0.0412311       5.5400000       0.3011357       0.7875673     => For AE > 200 nT  [153/241]
;       0.0412311       5.5400000       0.2999376       0.7925994     => For AE > 300 nT  [151/241]
;       0.0412311       1.7900000       0.2126280       0.4459700     => For AE > 400 nT  [118/241]
;       0.0412311       1.7900000       0.2021641       0.4335370     => For AE > 500 nT  [092/241]
;       0.0412311       1.7900000       0.2774382       0.4867817     => For AE > 600 nT  [055/241]
;       0.0412311       1.3306390       0.2720250       0.4398495     => For AE > 700 nT  [044/241]
;===========================================================
;       0.0435890       1.2646344       0.0762736       0.1885104     => For  10. nT < AE < 200. nT  [088/241]
;       0.2660827       5.5400000       0.5995330       1.4034514     => For 200. nT < AE < 400. nT  [035/241]
;       0.6705967       1.6900001       0.1560477       0.4024462     => For 400. nT < AE < 600. nT  [063/241]
;       0.0412311       1.7900000       0.2082019       0.5634553     => For 600. nT < AE < 800. nT  [016/241]
;       0.6205643       1.3306390       0.3313297       0.4666367     => For 800. nT < AE < 1000. nT  [036/241]
;       0.0412311       1.7900000       0.2934442       0.4960907     => For 600. nT < AE < 1000. nT  [052/241]
;-----------------------------------------------------------------------------------------


;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;      Min  (mV/m)     Max  (mV/m)    Mean (mV/m)   Std. Dev. (mV/m)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.0632455     343.0313721      74.2195740      74.7501602     => For AE > 100 nT  [189/241]
;       0.0632455     343.0313721      82.2285233      80.2765121     => For AE > 200 nT  [153/241]
;       0.0632455     343.0313721      83.2689667      80.2924194     => For AE > 300 nT  [151/241]
;       0.0632455     343.0313721      74.6670685      73.9667358     => For AE > 400 nT  [118/241]
;       0.2459675     343.0313721      83.6126480      78.0808411     => For AE > 500 nT  [092/241]
;       0.2459675     212.2750092      50.8590050      49.9713173     => For AE > 600 nT  [055/241]
;       1.0400000      95.4832153      36.2621803      27.6721764     => For AE > 700 nT  [044/241]
;===========================================================
;       0.0600000      75.0769730      26.3091679      21.9780979     => For  10. nT < AE < 200. nT  [088/241]
;       0.4438468     314.4307556     107.7213745      95.4752426     => For 200. nT < AE < 400. nT  [035/241]
;       0.0632455     343.0313721      95.4518814      84.8983459     => For 400. nT < AE < 600. nT  [063/241]
;       0.2459675     212.2750092      84.4562912      72.8710709     => For 600. nT < AE < 800. nT  [016/241]
;       1.4641379      95.4832153      39.2681923      27.7585239     => For 800. nT < AE < 1000. nT  [036/241]
;       0.2459675     212.2750092      53.1722221      50.3400726     => For 600. nT < AE < 1000. nT  [052/241]
;-----------------------------------------------------------------------------------------

;-----------------------------------------------------------------------------------------
; => Remove outliers...
;-----------------------------------------------------------------------------------------
awhe_min  = 2.0
awhb_min  = 0.1
good_wemv = WHERE(awhe_pk GE awhe_min)
good_wbnt = WHERE(awhb_pk GE awhb_min)
HELP, good_wemv, good_wbnt
;  GOOD_WEMV       LONG      = Array[215]
;  GOOD_WBNT       LONG      = Array[52]
he_ae_ind = ae_ind[good_wemv]
h_awhe_pk = awhe_pk[good_wemv]
hb_ae_ind = ae_ind[good_wbnt]
h_awhb_pk = awhb_pk[good_wbnt]

HELP, hb_ae_ind, WHERE(hb_ae_ind GE 1e2), WHERE(hb_ae_ind GE 2e2), WHERE(hb_ae_ind GE 3e2), $
                 WHERE(hb_ae_ind GE 4e2), WHERE(hb_ae_ind GE 5e2), WHERE(hb_ae_ind GE 6e2), $
                 WHERE(hb_ae_ind GE 7e2), WHERE(hb_ae_ind GE 8e2), WHERE(hb_ae_ind GE 9e2)

HELP, he_ae_ind, WHERE(he_ae_ind GE 1e2), WHERE(he_ae_ind GE 2e2), WHERE(he_ae_ind GE 3e2), $
                 WHERE(he_ae_ind GE 4e2), WHERE(he_ae_ind GE 5e2), WHERE(he_ae_ind GE 6e2), $
                 WHERE(he_ae_ind GE 7e2), WHERE(he_ae_ind GE 8e2), WHERE(he_ae_ind GE 9e2)

HELP, he_ae_ind, WHERE(he_ae_ind GE 1e1 AND he_ae_ind LT 2e2), $
              WHERE(he_ae_ind GE 2e2 AND he_ae_ind LT 4e2), $
              WHERE(he_ae_ind GE 4e2 AND he_ae_ind LT 6e2), $
              WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 8e2), $
              WHERE(he_ae_ind GE 8e2 AND he_ae_ind LT 1e3), $
              WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 1e3)

HELP, hb_ae_ind, WHERE(hb_ae_ind GE 1e1 AND hb_ae_ind LT 2e2), $
              WHERE(hb_ae_ind GE 2e2 AND hb_ae_ind LT 4e2), $
              WHERE(hb_ae_ind GE 4e2 AND hb_ae_ind LT 6e2), $
              WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 8e2), $
              WHERE(hb_ae_ind GE 8e2 AND hb_ae_ind LT 1e3), $
              WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 1e3)

nums_ae = STRTRIM(STRING([N_ELEMENTS(hb_ae_ind),N_ELEMENTS(he_ae_ind)],FORMAT='(I3.3)'),2)
suffx   = '     => For AE > '
suffx2  = ' nT  ['
temp_ae = 1e2
temp_ae = 2e2
temp_ae = 3e2
temp_ae = 4e2
temp_ae = 5e2
temp_ae = 6e2
temp_ae = 7e2

testeae = WHERE(he_ae_ind GE temp_ae,gdeae)
testbae = WHERE(hb_ae_ind GE temp_ae,gdbae)
ae_str  = STRTRIM(STRING(temp_ae,FORMAT='(I3.3)'),2)
rat_he  = STRING(gdeae,FORMAT='(I3.3)')+'/'+nums_ae[1]+']'
rat_hb  = STRING(gdbae,FORMAT='(I3.3)')+'/'+nums_ae[0]+']'
suff_xe = suffx[0]+ae_str[0]+suffx2[0]+rat_he[0]
suff_xb = suffx[0]+ae_str[0]+suffx2[0]+rat_hb[0]

indse   = WHERE(he_ae_ind GE temp_ae)
indsb   = WHERE(hb_ae_ind GE temp_ae)
PRINT, minmax(h_awhb_pk[indsb],/POS),MEAN(h_awhb_pk[indsb],/NAN),STDDEV(h_awhb_pk[indsb],/NAN), $
       suff_xb,FORMAT='(";",4f16.7,a34)'
PRINT, minmax(h_awhe_pk[indse],/POS),MEAN(h_awhe_pk[indse],/NAN),STDDEV(h_awhe_pk[indse],/NAN), $
       suff_xe,FORMAT='(";",4f16.7,a34)'

suffx    = '     => For '
suffx2  = ' nT < AE < '
suffx3  = ' nT  ['
temp_ael = 1e1
temp_aeh = 2e2
temp_ael = 2e2
temp_aeh = 4e2
temp_ael = 4e2
temp_aeh = 6e2
temp_ael = 6e2
temp_aeh = 8e2
temp_ael = 8e2
temp_aeh = 1e3
temp_ael = 6e2
temp_aeh = 1e3

indse    = WHERE(he_ae_ind GE temp_ael AND he_ae_ind LT temp_aeh,gdeae)
indsb    = WHERE(hb_ae_ind GE temp_ael AND hb_ae_ind LT temp_aeh,gdbae)
ael_str  = STRTRIM(STRING(temp_ael,FORMAT='(f8.0)'),2)
aeh_str  = STRTRIM(STRING(temp_aeh,FORMAT='(f8.0)'),2)
rat_he   = STRING(gdeae,FORMAT='(I3.3)')+'/'+nums_ae[1]+']'
rat_hb   = STRING(gdbae,FORMAT='(I3.3)')+'/'+nums_ae[0]+']'
suff_xe  = suffx[0]+ael_str[0]+suffx2[0]+aeh_str[0]+suffx3[0]+rat_he[0]
suff_xb  = suffx[0]+ael_str[0]+suffx2[0]+aeh_str[0]+suffx3[0]+rat_hb[0]
PRINT, minmax(h_awhb_pk[indsb],/POS),MEAN(h_awhb_pk[indsb],/NAN),STDDEV(h_awhb_pk[indsb],/NAN), $
       suff_xb,FORMAT='(";",4f16.7,a45)'
PRINT, minmax(h_awhe_pk[indse],/POS),MEAN(h_awhe_pk[indse],/NAN),STDDEV(h_awhe_pk[indse],/NAN), $
       suff_xe,FORMAT='(";",4f16.7,a45)'
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;        Min (nT)        Max (nT)       Mean (nT)     Std. Dev. (nT)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.2393742       5.5400000       1.1548300       1.1488804     => For AE > 100 nT  [042/052]
;       0.2660827       5.5400000       1.2441227       1.1888661     => For AE > 200 nT  [037/052]
;       0.5078385       5.5400000       1.2928385       1.2043343     => For AE > 300 nT  [035/052]
;       0.6205643       1.7900000       1.0437031       0.3270161     => For AE > 400 nT  [024/052]
;       0.6205643       1.7900000       1.0309927       0.3189296     => For AE > 500 nT  [018/052]
;       0.6205643       1.7900000       1.0145246       0.3368444     => For AE > 600 nT  [015/052]
;       0.6205643       1.3306390       0.9175283       0.2289728     => For AE > 700 nT  [013/052]
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;      Min  (mV/m)     Max  (mV/m)    Mean (mV/m)   Std. Dev. (mV/m)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       2.2600000     343.0313721      79.6267548      74.6668472     => For AE > 100 nT  [176/215]
;       2.8499999     343.0313721      88.5264359      79.9465027     => For AE > 200 nT  [142/215]
;       3.7780948     343.0313721      89.7386017      79.8643875     => For AE > 300 nT  [140/215]
;       3.7780948     343.0313721      81.4902496      73.6740646     => For AE > 400 nT  [108/215]
;       3.7780948     343.0313721      88.3495178      77.6749344     => For AE > 500 nT  [087/215]
;       3.7780948     212.2750092      55.8258095      49.7495232     => For AE > 600 nT  [050/215]
;       3.7780948      95.4832153      39.7456665      26.5965462     => For AE > 700 nT  [040/215]
;-----------------------------------------------------------------------------------------

;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;        Min (nT)        Max (nT)       Mean (nT)     Std. Dev. (nT)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.1109054       1.2646344       0.3956407       0.2925048     => For  10. nT < AE < 200. nT  [015/052]
;       0.2660827       5.5400000       1.6141274       1.9510490     => For 200. nT < AE < 400. nT  [013/052]
;       0.6705967       1.6900001       1.0923342       0.3234686     => For 400. nT < AE < 600. nT  [009/052]
;       1.5000000       1.7900000       1.6450000       0.2050609     => For 600. nT < AE < 800. nT  [002/052]
;       0.6205643       1.3306390       0.9175283       0.2289728     => For 800. nT < AE < 1000. nT  [013/052]
;       0.6205643       1.7900000       1.0145246       0.3368444     => For 600. nT < AE < 1000. nT  [015/052]
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;      Min  (mV/m)     Max  (mV/m)    Mean (mV/m)   Std. Dev. (mV/m)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       2.1900001      75.0769730      31.5438690      20.5092182     => For  10. nT < AE < 200. nT  [073/215]
;       2.8499999     314.4307556     110.8765945      95.0407944     => For 200. nT < AE < 400. nT  [034/215]
;       8.0882387     343.0313721     103.6147995      83.5802155     => For 400. nT < AE < 600. nT  [058/215]
;       3.7780948     212.2750092      96.4296188      69.9429321     => For 600. nT < AE < 800. nT  [014/215]
;      12.0299997      95.4832153      40.3483086      27.3854637     => For 800. nT < AE < 1000. nT  [035/215]
;       3.7780948     212.2750092      56.3715477      50.1136322     => For 600. nT < AE < 1000. nT  [049/215]
;-----------------------------------------------------------------------------------------

; => Mean                          :  defines the average of a distribution of data
meannt0  = [1.1548300,1.2441227,1.2928385,1.0437031,1.0309927,1.0145246,0.9175283]
meannt1  = [0.3956407,1.6141274,1.0923342,1.6450000,0.9175283,1.0145246]
meanmv0  = [79.6267548,88.5264359,89.7386017,81.4902496,88.3495178,55.8258095,39.7456665]
meanmv1  = [31.5438690,110.8765945,103.6147995,96.4296188,40.3483086,56.3715477]

; => Standard Deviation            :  defines the variation(dispersion) from the mean
stdvsnt0 = [1.1488804,1.1888661,1.2043343,0.3270161,0.3189296,0.3368444,0.2289728]
stdvsnt1 = [0.2925048,1.9510490,0.3234686,0.2050609,0.2289728,0.3368444]
stdvsmv0 = [74.6668472,79.9465027,79.8643875,73.6740646,77.6749344,49.7495232,26.5965462]
stdvsmv1 = [20.5092182,95.0407944,83.5802155,69.9429321,27.3854637,50.1136322]

; => Standard Deviation of the Mean:  defines the the accuracy of the mean
;stdvsntmn0 = stdvsnt0/SQRT(N_ELEMENTS(hb_ae_ind))
;stdvsmvmn0 = stdvsmv0/SQRT(N_ELEMENTS(he_ae_ind))
;stdvsntmn1 = stdvsnt1/SQRT(N_ELEMENTS(hb_ae_ind))
;stdvsmvmn1 = stdvsmv1/SQRT(N_ELEMENTS(he_ae_ind))
stdvsntmn0 = stdvsnt0/SQRT(49.)
stdvsmvmn0 = stdvsmv0/SQRT(194.)
stdvsntmn1 = stdvsnt1/SQRT(49.)
stdvsmvmn1 = stdvsmv1/SQRT(194.)

str_nt0    = STRTRIM(STRING(meannt0,FORMAT='(f14.4)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsntmn0,FORMAT='(f14.4,";   ")'),2)
str_nt1    = STRTRIM(STRING(meannt1,FORMAT='(f14.4)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsntmn1,FORMAT='(f14.4,";   ")'),2)
str_mv0    = STRTRIM(STRING(meanmv0,FORMAT='(f14.3)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsmvmn0,FORMAT='(f14.4,";   ")'),2)
str_mv1    = STRTRIM(STRING(meanmv1,FORMAT='(f14.3)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsmvmn1,FORMAT='(f14.4,";   ")'),2)

print, str_nt0, FORMAT='(7a19)'
print, str_mv0, FORMAT='(7a19)'
;-------------------------------------------------------------------------------------------------------------------------------------
; => For AE >
;        100 nT             200 nT             300 nT             400 nT             500 nT             600 nT             700 nT
;-------------------------------------------------------------------------------------------------------------------------------------
;   1.1548+/-0.1641;   1.2441+/-0.1698;   1.2928+/-0.1720;   1.0437+/-0.0467;   1.0310+/-0.0456;   1.0145+/-0.0481;   0.9175+/-0.0327;
;   ==================================================================================================================================
;   79.627+/-5.3608;   88.526+/-5.7398;   89.739+/-5.7339;   81.490+/-5.2895;   88.350+/-5.5767;   55.826+/-3.5718;   39.746+/-1.9095;
;-------------------------------------------------------------------------------------------------------------------------------------

print, str_nt1, FORMAT='(6a19)'
print, str_mv1, FORMAT='(6a19)'
;------------------------------------------------------------------------------------------------------------------
; => For AE (nT) between
;       10 & 200           200 & 400         400 & 600         600 & 800           800 & 1000         600 & 1000
;------------------------------------------------------------------------------------------------------------------
;   0.3956+/-0.0418;   1.6141+/-0.2787;   1.0923+/-0.0462;   1.6450+/-0.0293;   0.9175+/-0.0327;   1.0145+/-0.0481;
;   ===============================================================================================================
;   31.544+/-1.4725;  110.877+/-6.8235;  103.615+/-6.0007;   96.430+/-5.0216;   40.348+/-1.9662;   56.372+/-3.5979;
;------------------------------------------------------------------------------------------------------------------

'------------------------------------------------------------------------------------------------------------------'
' => Do not use finite Vph for test'
'------------------------------------------------------------------------------------------------------------------'

test_wh  = field_stats_whistler_read(/EXT)
mts      = my_time_string(test_wh.SCETS,STR=1,FORM=6,PREC=3,/NOMSSG)
whunix   = mts.UNIX
whymdb   = STRMID(mts.DATE_TIME,0L,23L)  ; => 'YYYY/MM/DD hh:mm:ss.xxx'

test_ae  = ae_index_stats_whistler_read()
mts      = my_time_string(test_ae.SCETS,STR=1,FORM=6,PREC=3,/NOMSSG)
aeunix   = mts.UNIX
aeymdb   = STRMID(mts.DATE_TIME,0L,23L)  ; => 'YYYY/MM/DD hh:mm:ss.xxx'


test     = my_array_where(whymdb,aeymdb,/N_UNIQ)
; => Good elements for whistler field stats
whunix   = whunix[test[*,0]]
whymdb   = whymdb[test[*,0]]
units    = test_wh.UNITS[test[*,0]]
whe_rms  = test_wh.E_RMS[test[*,0],*]
whb_rms  = test_wh.B_RMS[test[*,0],*]
whs_rms  = test_wh.S_RMS[test[*,0],*]
whe_pk   = test_wh.E_PK[test[*,0],*]
whb_pk   = test_wh.B_PK[test[*,0],*]
whs_pk   = test_wh.S_PK[test[*,0],*]
w_bmag   = test_wh.WI_B3_MAG[test[*,0]]
w_rad    = test_wh.WIND_RAD_DIST[test[*,0]]
w_lsh    = test_wh.WIND_L_SHELL[test[*,0]]
w_mlt    = test_wh.WIND_MLT[test[*,0]]
w_inv    = test_wh.WIND_INV_LAT[test[*,0]]
w_dens   = test_wh.N_I3[test[*,0]]
w_tanil  = test_wh.TANIS_EL[test[*,0]]
w_tanih  = test_wh.TANIS_EH[test[*,0]]
w_flow   = test_wh.FLOW_PEAK[test[*,0]]
w_fhigh  = test_wh.FHIGH_PEAK[test[*,0]]
w_gse_p  = test_wh.GSE_POS[test[*,0],*]
w_gsm_p  = test_wh.GSM_POS[test[*,0],*]
; => Good elements for whistler AE stats
aeunix  = aeunix[test[*,1]]
aeymdb  = aeymdb[test[*,1]]
al_ind  = test_ae.AL_INDEX[test[*,1]]
au_ind  = test_ae.AU_INDEX[test[*,1]]
ao_ind  = test_ae.AO_INDEX[test[*,1]]
ae_ind  = test_ae.AE_INDEX[test[*,1]]

;----------------------------------------------------------------
; => Define separation tests (by finite Vph and Radial Distance)
;----------------------------------------------------------------
lshell      = 15.
; => Make sure we only look at cases within a specific L-shell
test_l     = (w_lsh LE lshell)
; => Combine two tests
good0      = WHERE(test_l,gd0)

whunix   = whunix[good0]
whymdb   = whymdb[good0]
units    = units[good0]
whe_rms  = whe_rms[good0,*]
whb_rms  = whb_rms[good0,*]
whs_rms  = whs_rms[good0,*]
whe_pk   = whe_pk[good0,*]
whb_pk   = whb_pk[good0,*]
whs_pk   = whs_pk[good0,*]
w_bmag   = w_bmag[good0]
w_rad    = w_rad[good0]
w_lsh    = w_lsh[good0]
w_mlt    = w_mlt[good0]
w_inv    = w_inv[good0]
w_dens   = w_dens[good0]
w_tanil  = w_tanil[good0]
w_tanih  = w_tanih[good0]
w_flow   = w_flow[good0]
w_fhigh  = w_fhigh[good0]
w_gse_p  = w_gse_p[good0,*]
w_gsm_p  = w_gsm_p[good0,*]
; => Good elements for whistler AE stats
aeunix  = aeunix[good0]
aeymdb  = aeymdb[good0]
al_ind  = al_ind[good0]
au_ind  = au_ind[good0]
ao_ind  = ao_ind[good0]
ae_ind  = ae_ind[good0]

awhb_pk  = SQRT(whb_pk[*,0]^2 + whb_pk[*,1]^2 + whb_pk[*,2]^2)
awhe_pk  = SQRT(whe_pk[*,0]^2 + whe_pk[*,1]^2 + whe_pk[*,2]^2)
awhs_pk  = SQRT(whs_pk[*,0]^2 + whs_pk[*,1]^2 + whs_pk[*,2]^2)
awhb_rms = SQRT(whb_rms[*,0]^2 + whb_rms[*,1]^2 + whb_rms[*,2]^2)
awhe_rms = SQRT(whe_rms[*,0]^2 + whe_rms[*,1]^2 + whe_rms[*,2]^2)
awhs_rms = SQRT(whs_rms[*,0]^2 + whs_rms[*,1]^2 + whs_rms[*,2]^2)

uwhs_pk   = whs_pk/(awhs_pk # REPLICATE(1d0,3L))
uwhs_rms  = whs_rms/(awhs_rms # REPLICATE(1d0,3L))
theta_spk = ATAN(uwhs_pk[*,2]/SQRT(uwhs_pk[*,0]^2 + uwhs_pk[*,1]^2))*18d1/!DPI
theta_gsm = ATAN(w_gsm_p[*,2]/SQRT(w_gsm_p[*,0]^2 + w_gsm_p[*,1]^2))*18d1/!DPI

f         = !VALUES.F_NAN
d         = !VALUES.D_NAN
badss     = WHERE(ABS(awhs_pk) EQ 0.,bdss)
IF (bdss GT 0) THEN awhs_pk[badss] = d
IF (bdss GT 0) THEN theta_spk[badss] = d

xttl = 'AE-Index [1min, nT]'
yttl = 'Peak Whistler Amplitude Poynting Flux'+'!C'+'Latitude (deg)'
ttle = 'Peak Whistler Poynting Flux Latitude vs. AE-Index [1min Avg.]'
xra  = [1e1,1.2e3]
yra  = [-9.1e1,9.1e1]
ytn  = ['-90','-80','-70','-60','-50','-40','-30','-20','-10','0','10','20','30',$
        '40','50','60','70','80','90']
ytv  = DINDGEN(19)*18d1/18 - 9d1
yts  = N_ELEMENTS(ytn) - 1L
pstr = {XRANGE:xra,YRANGE:yra,XTITLE:xttl,YTITLE:yttl,YSTYLE:1,XSTYLE:1,YLOG:0,NODATA:1,$
        TITLE:ttle,YMINOR:5,XMINOR:10,YTICKNAME:ytn,YTICKV:ytv,YTICKS:yts}
PLOT,ae_ind,theta_spk,_EXTRA=pstr
  OPLOT,ae_ind,theta_spk,PSYM=2,COLOR=50
popen,'TDS-ALL-PoyntingFluxLat_vs_AE-Index-1min',/LAND
  PLOT,ae_ind,theta_spk,_EXTRA=pstr
    OPLOT,ae_ind,theta_spk,PSYM=2,COLOR=50
pclose


yttl = '!7k!3'+'!DGSM!N'+'/!7h!3'+'!DS!N'+'!C'+'[Latitudes]'
ttle = '!7k!3'+'!DGSM!N'+'/!7h!3'+'!DS!N vs. AE-Index [1min Avg.]'
xra  = [1e1,1.2e3]
yra  = [-1e0,1e0]
pstr = {XRANGE:xra,YRANGE:yra,XTITLE:xttl,YTITLE:yttl,YSTYLE:1,XSTYLE:1,YLOG:0,NODATA:1,$
        TITLE:ttle}
PLOT,ae_ind,theta_gsm/theta_spk,_EXTRA=pstr
  OPLOT,ae_ind,theta_gsm/theta_spk,PSYM=2,COLOR=50
popen,'TDS-ALL_WindGSM-PoyntingFlux-Lat_vs_AE-Index-1min',/LAND
  PLOT,ae_ind,theta_gsm/theta_spk,_EXTRA=pstr
    OPLOT,ae_ind,theta_gsm/theta_spk,PSYM=2,COLOR=50
pclose

theta_gsm2 = theta_gsm
theta_gsm2[badss] = d
xttl = '!7k!3'+'!DGSM!N'+'!C'+'[Wind Latitudes, deg]'
ttle = '!7k!3'+'!DGSM!N vs !7h!3'+'!DS!N'
yttl = '!7h!3'+'!DS!N'+'!C'+'[Poynting Flux Lat., deg]'
xra  = [-2e1,2e1]
yra  = [-9.1e1,9.1e1]
ytn  = ['-90','-80','-70','-60','-50','-40','-30','-20','-10','0','10','20','30',$
        '40','50','60','70','80','90']
ytv  = DINDGEN(19)*18d1/18 - 9d1
yts  = N_ELEMENTS(ytn) - 1L
pstr = {XRANGE:xra,YRANGE:yra,XTITLE:xttl,YTITLE:yttl,YSTYLE:1,XSTYLE:1,YLOG:0,NODATA:1,$
        TITLE:ttle,YMINOR:5,XMINOR:10,YTICKNAME:ytn,YTICKV:ytv,YTICKS:yts}
PLOT,theta_gsm2,theta_spk,_EXTRA=pstr
  OPLOT,theta_gsm2,theta_spk,PSYM=2,COLOR=50
popen,'TDS-ALL_WindGSM_vs_PoyntingFlux-Lat',/LAND
  PLOT,theta_gsm2,theta_spk,_EXTRA=pstr
    OPLOT,theta_gsm2,theta_spk,PSYM=2,COLOR=50
pclose

yra  = [1e-1,3.5e2]
xra  = [1e1,1.2e3]
xttl = 'AE-Index [1min, nT]'
yttl = 'Peak Whistler Amplitude (mV/m)'
ttle = 'Peak Whistler Amplitude vs. AE-Index [1min Avg.]'
pstr = {XRANGE:xra,YRANGE:yra,XTITLE:xttl,YTITLE:yttl,YSTYLE:1,XSTYLE:1,YLOG:1,NODATA:1,$
        TITLE:ttle}
PLOT,ae_ind,awhe_pk,_EXTRA=pstr
  OPLOT,ae_ind,awhe_pk,PSYM=2
popen,'TDS-ALL-mVm_whistler_amp_vs_AE-Index-1min',/LAND
  PLOT,ae_ind,awhe_pk,_EXTRA=pstr
    OPLOT,ae_ind,awhe_pk,PSYM=2
pclose

yttl = 'Peak Whistler Amplitude (nT)'
yra  = [1e-2,6e0]
pstr = {XRANGE:xra,YRANGE:yra,XTITLE:xttl,YTITLE:yttl,YSTYLE:1,XSTYLE:1,YLOG:1,NODATA:1,$
        TITLE:ttle}
PLOT,ae_ind,awhb_pk,_EXTRA=pstr
  OPLOT,ae_ind,awhb_pk,PSYM=2
popen,'TDS-ALL-nT_whistler_amp_vs_AE-Index-1min',/LAND
  PLOT,ae_ind,awhb_pk,_EXTRA=pstr
    OPLOT,ae_ind,awhb_pk,PSYM=2
pclose

yttl = 'Peak Whistler Amplitude Poynting Flux (milliergs cm!U-2!N s!U-1!N'+')'
ttle = 'Peak Whistler Poynting Flux vs. AE-Index [1min Avg.]'
xra  = [1e1,1.2e3]
yra  = [1e-2,1e2]
pstr = {XRANGE:xra,YRANGE:yra,XTITLE:xttl,YTITLE:yttl,YSTYLE:1,XSTYLE:1,YLOG:1,NODATA:1,$
        TITLE:ttle}
PLOT,ae_ind,awhs_pk*1d3,_EXTRA=pstr
  OPLOT,ae_ind,awhs_pk*1d3,PSYM=2,COLOR=50
popen,'TDS-ALL-PoyntingFlux_whistler_amp_vs_AE-Index-1min',/LAND
  PLOT,ae_ind,awhs_pk*1d3,_EXTRA=pstr
    OPLOT,ae_ind,awhs_pk*1d3,PSYM=2,COLOR=50
pclose






HELP, ae_ind, WHERE(ae_ind GE 1e2), WHERE(ae_ind GE 2e2), WHERE(ae_ind GE 3e2), $
              WHERE(ae_ind GE 4e2), WHERE(ae_ind GE 5e2), WHERE(ae_ind GE 6e2), $
              WHERE(ae_ind GE 7e2), WHERE(ae_ind GE 8e2), WHERE(ae_ind GE 9e2)
;-----------------------------------------------------------------------------------------
;  AE_IND          FLOAT     = Array[244]
;  <Expression>    LONG      = Array[192]
;  <Expression>    LONG      = Array[156]
;  <Expression>    LONG      = Array[154]
;  <Expression>    LONG      = Array[121]
;  <Expression>    LONG      = Array[93]
;  <Expression>    LONG      = Array[56]
;  <Expression>    LONG      = Array[44]
;  <Expression>    LONG      = Array[39]
;  <Expression>    LONG      = Array[4]
;-----------------------------------------------------------------------------------------
HELP, ae_ind, WHERE(ae_ind GE 1e1 AND ae_ind LT 2e2), $
              WHERE(ae_ind GE 2e2 AND ae_ind LT 4e2), $
              WHERE(ae_ind GE 4e2 AND ae_ind LT 6e2), $
              WHERE(ae_ind GE 6e2 AND ae_ind LT 8e2), $
              WHERE(ae_ind GE 8e2 AND ae_ind LT 1e3), $
              WHERE(ae_ind GE 6e2 AND ae_ind LT 1e3)
;-----------------------------------------------------------------------------------------
;  AE_IND          FLOAT     = Array[244]
;  <Expression>    LONG      = Array[88]
;  <Expression>    LONG      = Array[35]
;  <Expression>    LONG      = Array[65]
;  <Expression>    LONG      = Array[17]
;  <Expression>    LONG      = Array[36]
;  <Expression>    LONG      = Array[53]
;-----------------------------------------------------------------------------------------

;---------------------------
; => Remove outliers...
;---------------------------
muo       = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)

awhe_min  = 2.0
awhb_min  = 0.1
awhs_min  = (awhe_min*1d-3)*(awhe_min*1d-9)*1d3/muo

good_wemv = WHERE(awhe_pk GE awhe_min)
good_wbnt = WHERE(awhb_pk GE awhb_min)
good_wser = WHERE(awhs_pk GE awhs_min)
HELP, good_wemv, good_wbnt, good_wser
;  GOOD_WEMV       LONG      = Array[217]
;  GOOD_WBNT       LONG      = Array[52]
;  GOOD_WSER       LONG      = Array[33]
he_ae_ind = ae_ind[good_wemv]
hb_ae_ind = ae_ind[good_wbnt]
hs_ae_ind = ae_ind[good_wser]

h_awhe_pk = awhe_pk[good_wemv]
h_awhb_pk = awhb_pk[good_wbnt]
h_awhs_pk = awhs_pk[good_wser]

HELP, hb_ae_ind, WHERE(hb_ae_ind GE 1e2), WHERE(hb_ae_ind GE 2e2), WHERE(hb_ae_ind GE 3e2), $
                 WHERE(hb_ae_ind GE 4e2), WHERE(hb_ae_ind GE 5e2), WHERE(hb_ae_ind GE 6e2), $
                 WHERE(hb_ae_ind GE 7e2), WHERE(hb_ae_ind GE 8e2), WHERE(hb_ae_ind GE 9e2)

HELP, he_ae_ind, WHERE(he_ae_ind GE 1e2), WHERE(he_ae_ind GE 2e2), WHERE(he_ae_ind GE 3e2), $
                 WHERE(he_ae_ind GE 4e2), WHERE(he_ae_ind GE 5e2), WHERE(he_ae_ind GE 6e2), $
                 WHERE(he_ae_ind GE 7e2), WHERE(he_ae_ind GE 8e2), WHERE(he_ae_ind GE 9e2)

HELP, he_ae_ind, WHERE(he_ae_ind GE 1e1 AND he_ae_ind LT 2e2), $
              WHERE(he_ae_ind GE 2e2 AND he_ae_ind LT 4e2), $
              WHERE(he_ae_ind GE 4e2 AND he_ae_ind LT 6e2), $
              WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 8e2), $
              WHERE(he_ae_ind GE 8e2 AND he_ae_ind LT 1e3), $
              WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 1e3)

HELP, hb_ae_ind, WHERE(hb_ae_ind GE 1e1 AND hb_ae_ind LT 2e2), $
              WHERE(hb_ae_ind GE 2e2 AND hb_ae_ind LT 4e2), $
              WHERE(hb_ae_ind GE 4e2 AND hb_ae_ind LT 6e2), $
              WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 8e2), $
              WHERE(hb_ae_ind GE 8e2 AND hb_ae_ind LT 1e3), $
              WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 1e3)

els_0nt  = [N_ELEMENTS(WHERE(hb_ae_ind GE 1e2)), N_ELEMENTS(WHERE(hb_ae_ind GE 2e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 3e2)), N_ELEMENTS(WHERE(hb_ae_ind GE 4e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 5e2)), N_ELEMENTS(WHERE(hb_ae_ind GE 6e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 7e2))]

els_1nt  = [N_ELEMENTS(WHERE(hb_ae_ind GE 1e1 AND hb_ae_ind LT 2e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 2e2 AND hb_ae_ind LT 4e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 4e2 AND hb_ae_ind LT 6e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 8e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 8e2 AND hb_ae_ind LT 1e3)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 1e3))  ]

els_0mv  = [N_ELEMENTS(WHERE(he_ae_ind GE 1e2)), N_ELEMENTS(WHERE(he_ae_ind GE 2e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 3e2)), N_ELEMENTS(WHERE(he_ae_ind GE 4e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 5e2)), N_ELEMENTS(WHERE(he_ae_ind GE 6e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 7e2))]

els_1mv  = [N_ELEMENTS(WHERE(he_ae_ind GE 1e1 AND he_ae_ind LT 2e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 2e2 AND he_ae_ind LT 4e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 4e2 AND he_ae_ind LT 6e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 8e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 8e2 AND he_ae_ind LT 1e3)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 1e3))  ]

nums_ae  = STRTRIM(STRING([N_ELEMENTS(hb_ae_ind),N_ELEMENTS(he_ae_ind)],FORMAT='(I3.3)'),2)
suffx    = '     => For AE > '
temp_aes = FINDGEN(7)*100 + 1e2
straes   = STRMID(STRTRIM(STRING(FORMAT='(f10.0)',temp_aes),2),0,3)
strelsnt = STRTRIM(STRING(FORMAT='(I3.3)',els_0nt),2)
strelsmv = STRTRIM(STRING(FORMAT='(I3.3)',els_0mv),2)

suffxsnt = suffx[0]+straes[*]+' nT  ['+strelsnt[*]+'/'+nums_ae[0]+']'
suffxsmv = suffx[0]+straes[*]+' nT  ['+strelsmv[*]+'/'+nums_ae[1]+']'

FOR j=0L, 6L DO BEGIN $
  indsb = WHERE(hb_ae_ind GE temp_aes[j])  & $
  PRINT, minmax(h_awhb_pk[indsb],/POS),MEAN(h_awhb_pk[indsb],/NAN),$
         STDDEV(h_awhb_pk[indsb],/NAN),suffxsnt[j],FORMAT='(";",4f16.7,a34)'

FOR j=0L, 6L DO BEGIN $
  indse = WHERE(he_ae_ind GE temp_aes[j])  & $
  PRINT, minmax(h_awhe_pk[indse],/POS),MEAN(h_awhe_pk[indse],/NAN),$
         STDDEV(h_awhe_pk[indse],/NAN),suffxsmv[j],FORMAT='(";",4f16.7,a34)'

;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;        Min (nT)        Max (nT)       Mean (nT)     Std. Dev. (nT)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.2393742       5.5400000       1.1548300       1.1488804     => For AE > 100 nT  [042/052]
;       0.2660827       5.5400000       1.2441227       1.1888661     => For AE > 200 nT  [037/052]
;       0.5078385       5.5400000       1.2928385       1.2043343     => For AE > 300 nT  [035/052]
;       0.6205643       1.7900000       1.0437031       0.3270161     => For AE > 400 nT  [024/052]
;       0.6205643       1.7900000       1.0309927       0.3189296     => For AE > 500 nT  [018/052]
;       0.6205643       1.7900000       1.0145246       0.3368444     => For AE > 600 nT  [015/052]
;       0.6205643       1.3306390       0.9175283       0.2289728     => For AE > 700 nT  [013/052]
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;      Min  (mV/m)     Max  (mV/m)    Mean (mV/m)   Std. Dev. (mV/m)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       2.2600000     343.0313721      78.8680115      74.5861893     => For AE > 100 nT  [178/217]
;       2.8499999     343.0313721      87.4649353      79.8913574     => For AE > 200 nT  [144/217]
;       3.7780948     343.0313721      88.6450806      79.8258438     => For AE > 300 nT  [142/217]
;       3.7780948     343.0313721      80.2285843      73.5869598     => For AE > 400 nT  [110/217]
;       3.7780948     343.0313721      88.3495178      77.6749344     => For AE > 500 nT  [087/217]
;       3.7780948     212.2750092      55.8258095      49.7495232     => For AE > 600 nT  [050/217]
;       3.7780948      95.4832153      39.7456665      26.5965462     => For AE > 700 nT  [040/217]
;-----------------------------------------------------------------------------------------

temp_ael = [1e1,2e2,4e2,6e2,8e2,6e2]
temp_aeh = [2e2,4e2,6e2,8e2,1e3,1e3]
straesl  = STRMID(STRTRIM(STRING(FORMAT='(f10.0)',temp_ael),2),0,3)
straesh  = STRMID(STRTRIM(STRING(FORMAT='(f10.0)',temp_aeh),2),0,3)
strelsnt = STRTRIM(STRING(FORMAT='(I3.3)',els_1nt),2)
strelsmv = STRTRIM(STRING(FORMAT='(I3.3)',els_1mv),2)
suffx    = '     => For '
suffxsnt = suffx[0]+straesl[*]+' nT < AE < '+straesh[*]+' nT  ['+strelsnt[*]+'/'+nums_ae[0]+']'
suffxsmv = suffx[0]+straesl[*]+' nT < AE < '+straesh[*]+' nT  ['+strelsmv[*]+'/'+nums_ae[1]+']'

FOR j=0L, 5L DO BEGIN $
  indsb = WHERE(hb_ae_ind GE temp_ael[j] AND hb_ae_ind LT temp_aeh[j])  & $
  PRINT, minmax(h_awhb_pk[indsb],/POS),MEAN(h_awhb_pk[indsb],/NAN),$
         STDDEV(h_awhb_pk[indsb],/NAN),suffxsnt[j],FORMAT='(";",4f16.7,a43)'

FOR j=0L, 5L DO BEGIN $
  indse = WHERE(he_ae_ind GE temp_ael[j] AND he_ae_ind LT temp_aeh[j])  & $
  PRINT, minmax(h_awhe_pk[indse],/POS),MEAN(h_awhe_pk[indse],/NAN),$
         STDDEV(h_awhe_pk[indse],/NAN),suffxsmv[j],FORMAT='(";",4f16.7,a43)'
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;        Min (nT)        Max (nT)       Mean (nT)     Std. Dev. (nT)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.1109054       1.2646344       0.3956407       0.2925048     => For 10. nT < AE < 200 nT  [015/052]
;       0.2660827       5.5400000       1.6141274       1.9510490     => For 200 nT < AE < 400 nT  [013/052]
;       0.6705967       1.6900001       1.0923342       0.3234686     => For 400 nT < AE < 600 nT  [009/052]
;       1.5000000       1.7900000       1.6450000       0.2050609     => For 600 nT < AE < 800 nT  [002/052]
;       0.6205643       1.3306390       0.9175283       0.2289728     => For 800 nT < AE < 100 nT  [013/052]
;       0.6205643       1.7900000       1.0145246       0.3368444     => For 600 nT < AE < 100 nT  [015/052]
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;      Min  (mV/m)     Max  (mV/m)    Mean (mV/m)   Std. Dev. (mV/m)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       2.1900001      75.0769730      31.5438690      20.5092182     => For 10. nT < AE < 200 nT  [073/217]
;       2.8499999     314.4307556     110.8765945      95.0407944     => For 200 nT < AE < 400 nT  [034/217]
;       8.0882387     343.0313721     100.5642395      83.8053131     => For 400 nT < AE < 600 nT  [060/217]
;       3.7780948     212.2750092      96.4296188      69.9429321     => For 600 nT < AE < 800 nT  [014/217]
;      12.0299997      95.4832153      40.3483086      27.3854637     => For 800 nT < AE < 100 nT  [035/217]
;       3.7780948     212.2750092      56.3715477      50.1136322     => For 600 nT < AE < 100 nT  [049/217]
;-----------------------------------------------------------------------------------------

; => Mean                          :  defines the average of a distribution of data
meannt0  = [1.1548300,1.2441227,1.2928385,1.0437031,1.0309927,1.0145246,0.9175283]
meanmv0  = [78.8680115,87.4649353,88.6450806,80.2285843,88.3495178,55.8258095,39.7456665]
meannt1  = [0.3956407,1.6141274,1.0923342,1.6450000,0.9175283,1.0145246]
meanmv1  = [31.5438690,110.8765945,100.5642395,96.4296188,40.3483086,56.3715477]

; => Standard Deviation            :  defines the variation(dispersion) from the mean
stdvsnt0 = [1.1488804,1.1888661,1.2043343,0.3270161,0.3189296,0.3368444,0.2289728]
stdvsmv0 = [74.5861893,79.8913574,79.8258438,73.5869598,77.6749344,49.7495232,26.5965462]
stdvsnt1 = [0.2925048,1.9510490,0.3234686,0.2050609,0.2289728,0.3368444]
stdvsmv1 = [20.5092182,95.0407944,83.805313,69.9429321,27.3854637,50.1136322]

; => Standard Deviation of the Mean:  defines the the accuracy of the mean
stdvsntmn0 = stdvsnt0/SQRT(N_ELEMENTS(hb_ae_ind))
stdvsmvmn0 = stdvsmv0/SQRT(N_ELEMENTS(he_ae_ind))
stdvsntmn1 = stdvsnt1/SQRT(N_ELEMENTS(hb_ae_ind))
stdvsmvmn1 = stdvsmv1/SQRT(N_ELEMENTS(he_ae_ind))

str_nt0    = STRTRIM(STRING(meannt0,FORMAT='(f14.4)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsntmn0,FORMAT='(f14.4,";   ")'),2)
str_nt1    = STRTRIM(STRING(meannt1,FORMAT='(f14.4)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsntmn1,FORMAT='(f14.4,";   ")'),2)
str_mv0    = STRTRIM(STRING(meanmv0,FORMAT='(f14.3)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsmvmn0,FORMAT='(f14.4,";   ")'),2)
str_mv1    = STRTRIM(STRING(meanmv1,FORMAT='(f14.3)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsmvmn1,FORMAT='(f14.4,";   ")'),2)

print, str_nt0, FORMAT='(";",7a19)'
print, str_mv0, FORMAT='(";",7a19)'
;-------------------------------------------------------------------------------------------------------------------------------------
; => For AE >
;        100 nT             200 nT             300 nT             400 nT             500 nT             600 nT             700 nT
;-------------------------------------------------------------------------------------------------------------------------------------
;   1.1548+/-0.1593;   1.2441+/-0.1649;   1.2928+/-0.1670;   1.0437+/-0.0453;   1.0310+/-0.0442;   1.0145+/-0.0467;   0.9175+/-0.0318;
;   ==================================================================================================================================
;   78.868+/-5.0632;   87.465+/-5.4234;   88.645+/-5.4189;   80.229+/-4.9954;   88.350+/-5.2729;   55.826+/-3.3772;   39.746+/-1.8055;
;-------------------------------------------------------------------------------------------------------------------------------------

print, str_nt1, FORMAT='(";",6a19)'
print, str_mv1, FORMAT='(";",6a19)'
;------------------------------------------------------------------------------------------------------------------
; => For AE (nT) between
;       10 & 200           200 & 400         400 & 600         600 & 800           800 & 1000         600 & 1000
;------------------------------------------------------------------------------------------------------------------
;   0.3956+/-0.0406;   1.6141+/-0.2706;   1.0923+/-0.0449;   1.6450+/-0.0284;   0.9175+/-0.0318;   1.0145+/-0.0467;
;   ===============================================================================================================
;   31.544+/-1.3923;  110.877+/-6.4518;  100.564+/-5.6891;   96.430+/-4.7480;   40.348+/-1.8590;   56.372+/-3.4019;
;------------------------------------------------------------------------------------------------------------------



;-----------------------------------------------------------------------------------------
; => Plot AE vs amplitudes
;-----------------------------------------------------------------------------------------
mlt_lon   = w_mlt*36d1/24d0 - 9d1
; => Shift MLTs to make them appropriate for Polar Coordinate outputs
bad_20   = WHERE(mlt_lon LT 0d0,bd20)
IF (bd20 GT 0) THEN mlt_lon[bad_20] = mlt_lon[bad_20] + 36d1

good_nt     = WHERE(STRLOWCASE(units) EQ 'nt',gdnt,COMPLEMENT=good_mv,NCOMPLEMENT=gdmv)
PRINT, gdnt, gdmv

w_lsh_nt    = w_lsh[good_nt]
w_rad_nt    = w_rad[good_nt]
w_mlt_nt    = mlt_lon[good_nt]
a_bpks_nt   = awhb_pk[good_nt]
ae_ind_nt   = ae_ind[good_nt]

w_lsh_mv    = w_lsh[good_mv]
w_rad_mv    = w_rad[good_mv]
w_mlt_mv    = mlt_lon[good_mv]
a_epks_mv   = awhe_pk[good_mv]
ae_ind_mv   = ae_ind[good_mv]


WINDOW,0,XSIZE=700,YSIZE=700,RETAIN=2
!P.MULTI  = 0

ttll      = 'Wind Spacecraft Whistler AE-Index (TDSS-nT Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [4e1,60e1]
zttl      = 'AE-Index [1min, nT]'
polar_histogram_plot,w_rad_nt,w_mlt_nt,TTLE=ttll,XRANGE=xra,YRANGE=yra,    $
                     ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=ae_ind_nt,      $
                     ZTTL=zttl,/POLAR,/LABELS

popen,'TDSS-nT_Wind-Spacecraft-Whistlers_AE-Index-1min_polarhistogram_10-Radial_15-Angle_Labels',/LAND
  polar_histogram_plot,w_rad_nt,w_mlt_nt,TTLE=ttll,XRANGE=xra,YRANGE=yra,    $
                       ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=ae_ind_nt,      $
                       ZTTL=zttl,/POLAR,/LABELS
pclose


ttll      = 'Wind Spacecraft Whistler AE-Index (TDS-mV/m Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [4e1,60e1]
zttl      = 'AE-Index [1min, nT]'
polar_histogram_plot,w_rad_mv,w_mlt_mv,TTLE=ttll,XRANGE=xra,YRANGE=yra,    $
                     ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=ae_ind_mv,      $
                     ZTTL=zttl,/POLAR,/LABELS

popen,'TDS-mVm_Wind-Spacecraft-Whistlers_AE-Index-1min_polarhistogram_10-Radial_15-Angle_Labels',/LAND
  polar_histogram_plot,w_rad_mv,w_mlt_mv,TTLE=ttll,XRANGE=xra,YRANGE=yra,    $
                       ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=ae_ind_mv,      $
                       ZTTL=zttl,/POLAR,/LABELS
pclose


ttll      = 'Wind Spacecraft Whistler Peak Amplitudes (TDSS-nT Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [5e-2,7e-1]
zttl      = 'Peak Amplitudes (nT)'
polar_histogram_plot,w_rad_nt,w_mlt_nt,TTLE=ttll,XRANGE=xra,YRANGE=yra,    $
                     ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=a_bpks_nt,      $
                     ZTTL=zttl,/POLAR,/LABELS

zra       = [1e0,1e1]
zttl      = 'Number of TDSS-nT Samples'
polar_histogram_plot,w_rad_nt,w_mlt_nt,TTLE=ttll,XRANGE=xra,YRANGE=yra,    $
                     ZRANGE=zra,NBIN_R=10,NBIN_T=15,      $
                     ZTTL=zttl,/POLAR,/LABELS




ttll      = 'Wind Spacecraft Whistler Peak Amplitudes (TDSS-mV/m Locations)'
xra       = [1e0,2e1]
yra       = [0d0,36d1]
zra       = [6e-2,6e1]
zttl      = 'Peak Amplitudes (mV/m)'
polar_histogram_plot,w_rad_mv,w_mlt_mv,TTLE=ttll,XRANGE=xra,YRANGE=yra,    $
                     ZRANGE=zra,NBIN_R=10,NBIN_T=15,DATA=a_epks_mv,      $
                     ZTTL=zttl,/POLAR,/LABELS

zra       = [1e0,1e1]
zttl      = 'Number of TDSS-mV/m Samples'
polar_histogram_plot,w_rad_mv,w_mlt_mv,TTLE=ttll,XRANGE=xra,YRANGE=yra,    $
                     ZRANGE=zra,NBIN_R=10,NBIN_T=15,      $
                     ZTTL=zttl,/POLAR,/LABELS


;-----------------------------------------------------------------------------------------
; => Determine statistics on wave amplitudes
;-----------------------------------------------------------------------------------------
test   = field_stats_whistler_read()
a_bpks = sqrt(test.b_pk[*,0]^2 + test.b_pk[*,1]^2 + test.b_pk[*,2]^2)
a_epks = sqrt(test.e_pk[*,0]^2 + test.e_pk[*,1]^2 + test.e_pk[*,2]^2)

temp   = whistler_insta_read()

; => Phase Velocities
Vph_fln   = temp.VPH_FLOW_MN
Vph_flx   = temp.VPH_FLOW_MX
Vph_fhn   = temp.VPH_FHIGH_MN
Vph_fhx   = temp.VPH_FHIGH_MX
; => Define L-Shell and MLT
w_lsh     = temp.WIND_L_SHELL
w_mlt     = temp.WIND_MLT
; => Define radial distance and invariant latitude
w_rad     = temp.WIND_RAD_DIST

units     = STRTRIM(temp.UNITS,2)

;test_f    = FINITE(Vph_fln) AND FINITE(Vph_flx) AND FINITE(Vph_fhn) AND FINITE(Vph_fhx)
test_l    = (w_lsh LE 15.)
;test_l    = (w_lsh LE 10.)
;test      = test_f AND test_l
good      = WHERE(test_l,gd)
print, gd
; => For L < 20
;         257
; => For L < 15
;         244

units     = units[good]
w_lsh     = w_lsh[good]
w_mlt     = w_mlt[good]
w_rad     = w_rad[good]

a_bpks    = a_bpks[good]
a_epks    = a_epks[good]
help, where(a_epks GT 0.), where(a_bpks GT 0.)
;  <Expression>    LONG      = Array[244]
;  <Expression>    LONG      = Array[65]

good_100  = WHERE(a_epks GE 100.,gd100)
good_1    = WHERE(a_bpks GE 1.,gd1)
print, gd100, gd1
; => For L < 15
;          48          17
print, minmax(w_lsh[good_100]), minmax(w_lsh[good_1])
; => For L < 15
;      3.76100      5.78300
;      4.02700      8.83400
good_50   = WHERE(a_epks GE 50.,gd50)
good_05   = WHERE(a_bpks GE 0.5,gd05)
print, gd50, gd05
; => For L < 15
;          97          40
print, minmax(w_lsh[good_50]), minmax(w_lsh[good_05])
; => For L < 15
;      3.71300      6.32600
;      4.02700      11.2550
good_30   = WHERE(a_epks GE 30.,gd30)
good_03   = WHERE(a_bpks GE 0.3,gd03)
print, gd30, gd03
; => For L < 15
;         129          44
print, minmax(w_lsh[good_30]), minmax(w_lsh[good_03])
; => For L < 15
;      3.69300      7.87000
;      4.02700      11.2550
badd_30   = WHERE(a_epks LT 30.,bd30)
badd_03   = WHERE(a_bpks LT 0.3 AND a_bpks GT 0.,bd03)
print, bd30, bd03
; => For L < 15
;         115          21
print, minmax(w_lsh[badd_30]), minmax(w_lsh[badd_03])
; => For L < 15
;      3.89800      11.2550
;      5.61600      11.0150


mlt_lon   = w_mlt*36d1/24d0
; => Scale MLTs to make them appropriate for Polar Coordinate outputs
;      => 0 deg is at Midnight

good_nt     = WHERE(STRLOWCASE(units) EQ 'nt',gdnt,COMPLEMENT=good_mv,NCOMPLEMENT=gdmv)
PRINT, gdnt, gdmv
; => For L < 15
;          55         189
; => For L < 20
;          68         186

w_lsh_nt    = w_lsh[good_nt]
w_rad_nt    = w_rad[good_nt]
w_mlt_lnt   = mlt_lon[good_nt]
w_mlt_nt    = w_mlt[good_nt]
a_bpks_nt   = a_bpks[good_nt]
a_epks_nt   = a_epks[good_nt]

w_lsh_mv    = w_lsh[good_mv]
w_rad_mv    = w_rad[good_mv]
w_mlt_lmv   = mlt_lon[good_mv]
w_mlt_mv    = w_mlt[good_mv]
a_epks_mv   = a_epks[good_mv]
a_bpks_mv   = a_bpks[good_mv]


good_100mv  = WHERE(a_epks_mv GE 100.,gd100mv)
good_100nt  = WHERE(a_epks_nt GE 100.,gd100nt)
good_1nT    = WHERE(a_bpks_nt GE 1.,gd1nT)
print, gd100mv, gd100nt, gd1nT
; => For L < 15
;          48           0           8
print, minmax(w_lsh_mv[good_100mv]), minmax(w_lsh_nt[good_100nt]), minmax(w_lsh_nt[good_1nT])
; => For L < 15
;      3.76100      5.78300
;      0.00000      0.00000
;      5.20300      8.83400

test_mean = [mean(w_mlt_lmv[good_100mv],/nan), mean(w_mlt_lnt[good_100nt],/nan), $
             mean(w_mlt_lnt[good_1nT],/nan)]
test_stde = [stddev(w_mlt_lmv[good_100mv],/nan), stddev(w_mlt_lnt[good_100nt],/nan), $
             stddev(w_mlt_lnt[good_1nT],/nan)]
test_str  = STRTRIM(STRING(test_mean,FORMAT='(f15.2)'),2)+$
            ' +/- '+STRTRIM(STRING(test_stde,FORMAT='(f15.2)'),2)+',  '
print, test_str
; => For L < 15
;  79.19 +/- 118.55,     0.00 +/-   0.00,   46.07 +/- 46.75,  

good_50mv   = WHERE(a_epks_mv GE 50.,gd50mv)
good_50nt   = WHERE(a_epks_nt GE 50.,gd50nt)
good_05nT   = WHERE(a_bpks_nt GE 0.5,gd05nT)
print, gd50mv, gd50nt, gd05nT
; => For L < 15
;          97           0          30
print, minmax(w_lsh_mv[good_50mv]), minmax(w_lsh_nt[good_50nt]), minmax(w_lsh_nt[good_05nT])
; => For L < 15
;      3.71300      6.32600
;      0.00000      0.00000
;      5.05700      11.2550

good_30mv   = WHERE(a_epks_mv GE 30.,gd30mv)
good_30nt   = WHERE(a_epks_nt GE 30.,gd30nt)
good_03nT   = WHERE(a_bpks_nt GE 0.3,gd03nT)
print, gd30mv, gd30nt, gd03nT
; => For L < 15
;         127           2          34
print, minmax(w_lsh_mv[good_30mv]), minmax(w_lsh_nt[good_30nt]), minmax(w_lsh_nt[good_03nT])
; => For L < 15
;      3.69300      7.87000
;      5.05700      5.12700
;      5.05700      11.2550



;-----------------------------------------------------------------------------------------
; => Determine statistics on wave locations
;-----------------------------------------------------------------------------------------
all_beam_test    = whistler_insta_loc_read(FREE_ESOURCE='beams')
all_anis_test    = whistler_insta_loc_read(FREE_ESOURCE='aniso')
magnet_beam_test = whistler_insta_loc_read(LOC_ESOURCE='magneto',FREE_ESOURCE='beams')
magnet_anis_test = whistler_insta_loc_read(LOC_ESOURCE='magneto',FREE_ESOURCE='aniso')
plasma_anis_test = whistler_insta_loc_read(LOC_ESOURCE='radbelt',FREE_ESOURCE='aniso')

; => Define L-Shell, Radial Distance, and MLT
w_lshbm     = all_beam_test.WIND_L_SHELL
w_lshan     = all_anis_test.WIND_L_SHELL
w_lshmgbm   = magnet_beam_test.WIND_L_SHELL
w_lshmgan   = magnet_anis_test.WIND_L_SHELL
w_lshplan   = plasma_anis_test.WIND_L_SHELL

;lshell      = 20.
;lshell      = 15.
lshell      = 10.

; => Make sure we only look at cases within a specific L-shell
test_lbm    = (w_lshbm LE lshell)
test_lan    = (w_lshan LE lshell)
test_lmgbm  = (w_lshmgbm LE lshell)
test_lmgan  = (w_lshmgan LE lshell)
test_lplan  = (w_lshplan LE lshell)
good0a      = WHERE(test_lan,gd_anis)
good0b      = WHERE(test_lbm,gd_beam)
good0       = WHERE(test_lmgbm,gd_magneto_beam)
good1       = WHERE(test_lmgan,gd_magneto_anis)
good2       = WHERE(test_lplan,gd_plasmas_anis)
PRINT, gd_anis, gd_beam, gd_magneto_beam, gd_magneto_anis, gd_plasmas_anis
; => For L < 10
;         211          18          16          39         172
; => For L < 15
;         214          30          28          42         172
; => For L < 20
;         214          43          29          42         172

;=======================================================================================================================================================
;=======================================================================================================================================================
wi,0
wi,1
wi,2
wi,3


xttl    = 'AE Index (nT)'+'!C'+'[Hourly Avg.]'
ttlp    = 'Whistler Wave Amplitudes versus AE Indices'+'!C'
ttls    = 'Indeces Color:  Blue = AL, Red = AU, Yellow = AO, Green = AE'
ttle    = ttlp+ttls
yttlp   = 'Whistler Amplitude'

yttls   = [' [Peak, nT]',' [Peak, mV/m]',' [RMS, nT]',' [RMS, mV/m]']

xra_e   = [-720.,1200.]
pstr_pn = {TITLE:ttle,XTITLE:xttl,YTITLE:yttlp[0]+yttls[0],XMINOR:5,YMINOR:5,$
           XSTYLE:1,YSTYLE:1,NODATA:1,YRANGE:[1e-2,3e0],YLOG:1,XRANGE:xra_e}
pstr_rn = {TITLE:ttle,XTITLE:xttl,YTITLE:yttlp[0]+yttls[2],XMINOR:5,YMINOR:5,$
           XSTYLE:1,YSTYLE:1,NODATA:1,YRANGE:[1e-3,1e0],YLOG:1,XRANGE:xra_e}
pstr_pv = {TITLE:ttle,XTITLE:xttl,YTITLE:yttlp[0]+yttls[1],XMINOR:5,YMINOR:5,$
           XSTYLE:1,YSTYLE:1,NODATA:1,YRANGE:[1e-1,3.5e2],YLOG:1,XRANGE:xra_e}
pstr_rv = {TITLE:ttle,XTITLE:xttl,YTITLE:yttlp[0]+yttls[3],XMINOR:5,YMINOR:5,$
           XSTYLE:1,YSTYLE:1,NODATA:1,YRANGE:[1e-2,1.5e2],YLOG:1,XRANGE:xra_e}

WSET,0
PLOT,al_inda,awhb_pk,_EXTRA=pstr_pn
  OPLOT,al_inda,awhb_pk,COLOR=50 ,PSYM=2
  OPLOT,au_inda,awhb_pk,COLOR=250,PSYM=2
  OPLOT,ao_inda,awhb_pk,COLOR=200,PSYM=2
  OPLOT,ae_inda,awhb_pk,COLOR=150,PSYM=2


WSET,1
PLOT,al_inda,awhe_pk,_EXTRA=pstr_pv
  OPLOT,al_inda,awhe_pk,COLOR=50 ,PSYM=2
  OPLOT,au_inda,awhe_pk,COLOR=250,PSYM=2
  OPLOT,ao_inda,awhe_pk,COLOR=200,PSYM=2
  OPLOT,ae_inda,awhe_pk,COLOR=150,PSYM=2


WSET,2
PLOT,al_inda,awhb_rms,_EXTRA=pstr_rn
  OPLOT,al_inda,awhb_rms,COLOR=50 ,PSYM=2
  OPLOT,au_inda,awhb_rms,COLOR=250,PSYM=2
  OPLOT,ao_inda,awhb_rms,COLOR=200,PSYM=2
  OPLOT,ae_inda,awhb_rms,COLOR=150,PSYM=2

WSET,3
PLOT,al_inda,awhe_rms,_EXTRA=pstr_rv
  OPLOT,al_inda,awhe_rms,COLOR=50 ,PSYM=2
  OPLOT,au_inda,awhe_rms,COLOR=250,PSYM=2
  OPLOT,ao_inda,awhe_rms,COLOR=200,PSYM=2
  OPLOT,ae_inda,awhe_rms,COLOR=150,PSYM=2











;=======================================================================================================================================================
;=======================================================================================================================================================
test_wh  = field_stats_whistler_read()
mts      = my_time_string(test_wh.SCETS,STR=1,FORM=6,PREC=3,/NOMSSG)
whunix   = mts.UNIX
whymdb   = STRMID(mts.DATE_TIME,0L,23L)  ; => 'YYYY/MM/DD hh:mm:ss.xxx'
whe_rms  = test_wh.E_RMS
whb_rms  = test_wh.B_RMS
whs_rms  = test_wh.S_RMS*1d3             ; => convert to milliergs cm^(-2) s^(-1)
whe_pk   = test_wh.E_PK
whb_pk   = test_wh.B_PK
whs_pk   = test_wh.S_PK*1d3              ; => convert to milliergs cm^(-2) s^(-1)

temp     = whistler_insta_read()
units    = temp.UNITS
w_bmag   = temp.WI_B3_MAG
w_rad    = temp.WIND_RAD_DIST
w_lsh    = temp.WIND_L_SHELL
w_mlt    = temp.WIND_MLT
w_inv    = temp.WIND_INV_LAT
w_dens   = temp.N_I3
w_tanil  = temp.TANISOTROPY_EL
w_tanih  = temp.TANISOTROPY_EH
w_flow   = temp.FLOW_PEAK
w_fhigh  = temp.FHIGH_PEAK
w_gse_p  = [[temp.X_GSE_POS],[temp.Y_GSE_POS],[temp.Z_GSE_POS]]
w_gsm_p  = [[temp.X_GSM_POS],[temp.Y_GSM_POS],[temp.Z_GSM_POS]]

line0 = '                SCET               UNITS       Bxrms       Byrms       Bzrms       Bx_pk       '
line1 = 'By_pk       Bz_pk       Exrms       Eyrms       Ezrms       Ex_pk      Ey_pk        Ez_pk        '
line2 = 'Sxrms       Syrms       Szrms       Sx_pk      Sy_pk        Sz_pk'
line3 = '    wi_B3_MAG(GSE)   Wind_Rad_Dist   Wind_L_Shell  Wind_Inv_Lat     Wind_MLT         N_i3'
line4 = '         Tanis_el       Tanis_eh     flow_Peak     fhigh_Peak'
line5 = '     X_GSE_POS      Y_GSE_POS      Z_GSE_POS      X_GSM_POS      Y_GSM_POS      Z_GSM_POS'
lines = line0+line1+line2+line3+line4+line5

fname = 'TDS_GSE_whistler_1998-11-13_to_2002-10-10_stats_amplitudes_extra.txt'
ndat  = N_ELEMENTS(w_bmag)
mform = '(a30,a9,18f12.2,16f15.3)'
OPENW,gunit,fname,/GET_LUN
  PRINTF,gunit,lines[0]
  PRINTF,gunit,''

FOR k=0L, ndat - 1L DO BEGIN                                                             $
  PRINTF,gunit,FORMAT=mform,whymdb[k],units[k],REFORM(whb_rms[k,*]),REFORM(whb_pk[k,*]), $
                                REFORM(whe_rms[k,*]),REFORM(whe_pk[k,*]),                $
                                REFORM(whs_rms[k,*]),REFORM(whs_pk[k,*]),                $
                                w_bmag[k],w_rad[k],w_lsh[k],w_inv[k],w_mlt[k],w_dens[k], $
                                w_tanil[k],w_tanih[k],w_flow[k],w_fhigh[k],              $
                                REFORM(w_gse_p[k,*]),REFORM(w_gsm_p[k,*])

FREE_LUN,gunit





