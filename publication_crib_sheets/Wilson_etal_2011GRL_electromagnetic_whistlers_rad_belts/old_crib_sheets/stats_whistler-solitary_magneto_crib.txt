; => Bad times in ASCII Files
2000/06/26 15:08:18.775 UT
2000/06/26 20:26:34.419 UT
2000/06/26 20:26:35.154 UT
2000/06/26 20:26:36.628 UT
2000/06/26 20:27:12.690 UT
2000/06/26 20:27:13.060 UT
2000/06/26 20:27:14.162 UT
2000/06/26 20:27:22.258 UT
2000/06/26 20:27:28.514 UT


2000/08/04 17:51:07.975 UT    ; => Should be     2000/08/04 17:57:07.975 UT

;-----------------------------------------------------------------------------------------
; => Determine time ranges for radiation belts, outer magnetosphere, etc.
;
;     Definitions :  ['1970-01-01/01:00:00','1970-01-01/02:00:00'] = never in region
;
; => Event # = ALL event numbers (inside and out)
;-----------------------------------------------------------------------------------------
whityp = STRLOWCASE('Whistlers')
shityp = STRLOWCASE('SolitaryW')
uhityp = STRLOWCASE('Undefined')

test   = all_stats_all_waves_read()
ascets = test.SCETS        ; => e.g. 1998-11-13/15:05:00.532
awtype = test.WAVE_TYPE    ; => e.g. SolitaryW

goodw  = WHERE(STRLOWCASE(awtype) EQ whityp,gdw)
goods  = WHERE(STRLOWCASE(awtype) EQ shityp,gds)
goodu  = WHERE(STRLOWCASE(awtype) EQ yhityp,gdu)

; => Define parameters of whistlers ONLY
wscets = ascets[goodw]
; => Electric and magnetic fields of whistlers ONLY
wbavg  = test.B_AVG[goodw,*]
wbrms  = test.B_RMS[goodw,*]
wbpkk  = test.B_PK[goodw,*]
weavg  = test.E_AVG[goodw,*]
werms  = test.E_RMS[goodw,*]
wepkk  = test.E_PK[goodw,*]

w_rad  = test.WIND_RAD_DIST[goodw]
w_lsh  = test.WIND_L_SHELL[goodw]
w_mlt  = test.WIND_MLT[goodw]

waeind = test.AE_INDEX[goodw]


;----------------------------------------------------------
; => Date :  1998-10-26
;----------------------------------------------------------
date        = '102698'
t_orbit_all = ['1998-10-26/00:00:00','1998-10-26/23:59:00']
t_outer_mag = ['1998-10-26/03:00:00','1998-10-26/16:00:00']
t_rad_belts = ['1998-10-26/07:30:00','1998-10-26/13:16:00']
tdss_w_evn  = [004519949L,004527201L]
tdsf_w_evn  = [004497105L,004498364L,004504660L,004514985L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 002 on 102698
;  # of TDSF Whistlers = 004 on 102698

date        = '102698'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [004466450L,004466783L,004480913L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 102698
;  # of TDSF Solitary Waves = 003 on 102698

;    Outer Magnetosphere = 1998-10-26/03:00:00 - 1998-10-26/16:00:00
;    Radial Distance     =   13.17211 -   11.342
;    Wind L-Shell        =   14.50000 -   12.600
;    Wind MLT            =   17.36575 -    8.821
;    Wind GSE Pos.       = <   3.42434,  12.70802,   0.53341> - <   7.09778,  -8.81675,   0.73216>
;    Wind GSM Pos.       = <   3.42434,  12.37513,  -2.93847> - <   7.09778,  -7.94542,   3.89119>

;    Radiation Belts     = 1998-10-26/07:30:00 - 1998-10-26/13:16:00
;    Radial Distance     =    6.63056 -    7.291
;    Wind L-Shell        =    7.40000 -    9.000
;    Wind MLT            =   19.95465 -    7.443
;    Wind GSE Pos.       = <  -2.14608,   6.27154,  -0.18157> - <   2.10307,  -6.97968,   0.17236>
;    Wind GSM Pos.       = <  -2.14608,   5.45675,  -3.09667> - <   2.10307,  -6.08838,   3.41721>

;----------------------------------------------------------
; => Date :  1998-11-13
;----------------------------------------------------------
date        = '111398'
t_orbit_all = ['1998-11-13/11:00:00','1998-11-14/07:00:00']
t_outer_mag = ['1998-11-13/13:00:00','1998-11-13/22:00:00']
t_rad_belts = ['1998-11-13/15:00:00','1998-11-13/21:06:00']
tdss_w_evn  = [005881592L,005881612L,005881617L,005881644L]
tdsf_w_evn  = [005859145L,005860443L,005861680L,005863014L,$
               005879464L,005879470L,005879625L,005880469L,$
               005880558L,005880971L,005881202L,005881254L,$
               005881591L,005881611L,005881614L,005881616L,$
               005881641L,005881643L,005881676L,005883521L,$
               005890067L,005927559L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 004 on 111398
;  # of TDSF Whistlers = 022 on 111398

date        = '111398'
tdss_s_evn  = [005846043L,005846269L,005846596L,005846814L,$
               005847126L]
tdsf_s_evn  = [005846268L,005846832L,005847258L,005852709L,$
               005882269L,005884856L,005885459L,005886197L,$
               005893946L,005921420L,005922655L,005923903L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 005 on 111398
;  # of TDSF Solitary Waves = 012 on 111398

;    Outer Magnetosphere = 1998-11-13/13:00:00 - 1998-11-13/22:00:00
;    Radial Distance     =    9.61172 -    9.359
;    Wind L-Shell        =   12.09996 -    9.400
;    Wind MLT            =   16.70242 -    7.138
;    Wind GSE Pos.       = <   3.66220,   8.88582,  -0.12490> - <   2.42076,  -9.00469,   0.80633>
;    Wind GSM Pos.       = <   3.66220,   8.08111,  -3.69717> - <   2.42076,  -8.91891,   1.47912>

;    Radiation Belts     = 1998-11-13/15:00:00 - 1998-11-13/21:06:00
;    Radial Distance     =    6.48517 -    7.968
;    Wind L-Shell        =    7.60000 -    8.050
;    Wind MLT            =   18.11631 -    6.616
;    Wind GSE Pos.       = <   0.17750,   6.47240,  -0.36601> - <   0.98999,  -7.88545,   0.58177>
;    Wind GSM Pos.       = <   0.17750,   5.98704,  -2.48623> - <   0.98999,  -7.80313,   1.27664>

;----------------------------------------------------------
; => Date :  1998-12-14
;----------------------------------------------------------
date        = '121498'
t_orbit_all = ['1998-12-14/03:00:00','1998-12-15/18:00:00']
t_outer_mag = ['1998-12-14/08:56:00','1998-12-15/07:44:00']
t_rad_belts = ['1970-01-01/01:00:00','1970-01-01/02:00:00']
tdss_w_evn  = [-1L]
tdsf_w_evn  = [-1L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 000 on 121498
;  # of TDSF Whistlers = 000 on 121498

date        = '121498'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [010318865L,010372605L,010373855L,010378686L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 121498
;  # of TDSF Solitary Waves = 004 on 121498

;    Outer Magnetosphere = 1998-12-14/08:56:00 - 1998-12-15/07:44:00
;    Radial Distance     =   14.96893 -   18.705
;    Wind L-Shell        =   29.26667 -  183.080
;    Wind MLT            =   20.22978 -    7.103
;    Wind GSE Pos.       = <  -0.40500,  11.57196,  -9.48670> - <  -7.48447,  -8.88094,  14.66332>
;    Wind GSM Pos.       = <  -0.40500,   8.92998, -12.00678> - <  -7.48447,  -5.73100,  16.15670>

;----------------------------------------------------------
; => Date :  2000-04-09
;----------------------------------------------------------
date        = '040900'
t_orbit_all = ['2000-04-09/00:00:00','2000-04-11/00:00:00']
t_outer_mag = ['2000-04-09/18:00:00','2000-04-10/08:00:00']
t_rad_belts = ['2000-04-10/01:33:30','2000-04-10/07:00:00']
tdss_w_evn  = [027517553L,027517555L,027518225L,027520150L,$
               027520153L,027520603L,027524827L,027524948L]
tdsf_w_evn  = [027488577L,027517033L,027517509L,027517702L,$
               027517706L,027517897L,027517935L,027518298L,$
               027518330L,027518416L,027518420L,027518438L,$
               027520198L,027520199L,027520201L,027520203L,$
               027520205L,027520209L,027520211L,027520215L,$
               027520217L,027521445L,027524416L,027524872L,$
               027526384L,027528193L,027528224L,027530538L,$
               027533667L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 008 on 040900
;  # of TDSF Whistlers = 029 on 040900

date        = '040900'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [027483370L,027483396L,027483397L,027483402L,$
               027483403L,027483522L,027483523L,027483637L,$
               027485257L,027485259L,027485325L,027485335L,$
               027499294L,027499297L,027499312L,027499313L,$
               027499317L,027499340L,027499341L,027499342L,$
               027499343L,027499346L,027508620L,027509601L,$
               027509624L,027510685L,027510686L,027510687L,$
               027510690L,027510730L,027531983L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 040900
;  # of TDSF Solitary Waves = 031 on 040900

;    Outer Magnetosphere = 2000-04-09/18:00:00 - 2000-04-10/08:00:00
;    Radial Distance     =   15.55239 -    9.380
;    Wind L-Shell        =   18.09999 -    9.699
;    Wind MLT            =   17.70578 -    7.050
;    Wind GSE Pos.       = <   2.84539,  15.21917,  -1.46890> - <   2.47686,  -9.02973,   0.56294>
;    Wind GSM Pos.       = <   2.84539,  14.36598,   5.23445> - <   2.47686,  -8.88898,  -1.68490>

;    Radiation Belts     = 2000-04-10/01:33:30 - 2000-04-10/07:00:00
;    Radial Distance     =    6.04668 -    8.066
;    Wind L-Shell        =    6.66250 -    8.400
;    Wind MLT            =   21.76226 -    6.334
;    Wind GSE Pos.       = <  -4.77795,   3.70659,   0.04027> - <   0.70997,  -8.01204,   0.60840>
;    Wind GSM Pos.       = <  -4.77795,   3.19251,   1.88368> - <   0.70997,  -7.85834,  -1.67610>

;----------------------------------------------------------
; => Date :  2000-05-03
;----------------------------------------------------------
date        = '050300'
t_orbit_all = ['2000-05-02/18:00:00','2000-05-03/13:00:00']
t_outer_mag = ['2000-05-02/19:00:00','2000-05-03/09:00:00']
t_rad_belts = ['2000-05-02/23:16:30','2000-05-03/05:12:00']
tdss_w_evn  = [-1L]
tdsf_w_evn  = [000321563L,000321692L,000321956L,000325872L,$
               000325885L,000325886L,000325912L,000327884L,$
               000328348L,000328363L,000328364L,000328435L,$
               000335562L,000335563L,000335848L,000335849L,$
               000336106L,000336236L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 000 on 050300
;  # of TDSF Whistlers = 018 on 050300

date        = '050300'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [000312308L,000313036L,000313038L,000313057L,$
               000313058L,000313059L,000313060L,000313061L,$
               000313076L,000313081L,000313082L,000313083L,$
               000313810L,000313851L,000313852L,000315590L,$
               000319504L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 050300
;  # of TDSF Solitary Waves = 017 on 050300

;    Outer Magnetosphere = 2000-05-02/19:00:00 - 2000-05-03/09:00:00
;    Radial Distance     =   12.71163 -   12.421
;    Wind L-Shell        =   16.09998 -   12.599
;    Wind MLT            =   17.07153 -    6.731
;    Wind GSE Pos.       = <   4.86369,  11.72615,  -0.65381> - <   2.06155, -12.24941,  -0.01409>
;    Wind GSM Pos.       = <   4.86369,  10.97076,   4.19195> - <   2.06155, -12.12995,  -1.70659>

;    Radiation Belts     = 2000-05-02/23:16:30 - 2000-05-03/05:12:00
;    Radial Distance     =    7.15868 -    7.468
;    Wind L-Shell        =    8.44395 -    7.900
;    Wind MLT            =   19.47394 -    4.565
;    Wind GSE Pos.       = <  -1.72035,   6.94915,   0.05631> - <  -2.81624,  -6.90674,   0.37604>
;    Wind GSM Pos.       = <  -1.72035,   6.09194,   3.34397> - <  -2.81624,  -6.73579,  -1.57275>

;----------------------------------------------------------
; => Date :  2000-05-26
;----------------------------------------------------------
date        = '052600'
t_orbit_all = ['2000-05-25/15:00:00','2000-05-26/12:00:00']
t_outer_mag = ['2000-05-25/17:18:00','2000-05-26/07:30:00']
t_rad_belts = ['2000-05-25/20:47:40','2000-05-26/01:00:30']
tdss_w_evn  = [-1L]
tdsf_w_evn  = [002326697L,002326699L,002326922L,002326924L,$
               002327566L,002329716L,002334667L,002336427L,$
               002336781L,002338070L,002341573L,002342586L,$
               002345798L,002345846L,002345848L,002346174L,$
               002346361L,002346681L,002346766L,002346793L,$
               002346856L,002346879L,002347042L,002347313L,$
               002347331L,002347341L,002347347L,002350062L,$
               002350400L,002352004L,002355626L,002367223L,$
               002367225L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 000 on 052600
;  # of TDSF Whistlers = 033 on 052600

date        = '052600'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [002362196L,002366752L,002366756L,002366757L,$
               002366759L,002367033L,002367759L,002369235L,$
               002370186L,002370354L,002370948L,002375585L,$
               002375590L,002375592L,002379363L,002380583L,$
               002382363L,002383576L,002383586L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 052600
;  # of TDSF Solitary Waves = 019 on 052600

;    Outer Magnetosphere = 2000-05-25/17:18:00 - 2000-05-26/07:30:00
;    Radial Distance     =   11.15280 -   13.877
;    Wind L-Shell        =   13.55750 -   14.100
;    Wind MLT            =   16.58569 -    5.344
;    Wind GSE Pos.       = <   5.55878,   9.66893,   0.00904> - <  -2.69542, -13.60568,  -0.44442>
;    Wind GSM Pos.       = <   5.55878,   9.44496,   2.06927> - <  -2.69542, -13.56124,  -1.18536>

;    Radiation Belts     = 2000-05-25/20:47:40 - 2000-05-26/01:00:30
;    Radial Distance     =    7.03833 -    6.353
;    Wind L-Shell        =    7.80833 -    6.909
;    Wind MLT            =   19.17736 -    1.138
;    Wind GSE Pos.       = <  -0.88536,   6.97055,   0.40826> - <  -6.09230,  -1.75532,   0.41204>
;    Wind GSM Pos.       = <  -0.88536,   6.38216,   2.83255> - <  -6.09230,  -1.79292,  -0.19058>

;----------------------------------------------------------
; => Date :  2000-06-10
;----------------------------------------------------------
date        = '061000'
t_orbit_all = ['2000-06-09/17:00:00','2000-06-12/01:00:00']
t_outer_mag = ['2000-06-10/07:00:00','2000-06-10/18:00:00']
t_rad_belts = ['2000-06-10/08:48:30','2000-06-10/15:21:30']
tdss_w_evn  = [004062345L,004070862L,004075947L,004075953L,$
               004075957L,004077788L,004077790L,004077792L,$
               004077794L,004077796L,004115359L,004115389L,$
               004115408L,004115452L,004119018L,004119043L,$
               004119052L,004119059L,004119061L,004119085L,$
               004119097L,004119131L,004119136L,004119139L,$
               004119160L,004119163L,004119344L,004119739L,$
               004178630L,004178754L,004179541L,004179653L,$
               004179677L,004188599L,004196458L,004210669L,$
               004215808L,004216985L,004217311L,004218487L,$
               004218540L,004224665L]
tdsf_w_evn  = [004072059L,004072247L,004074298L,004078201L,$
               004115388L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 042 on 061000
;  # of TDSF Whistlers = 005 on 061000

date        = '061000'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [004039407L,004118299L,004118896L,004119848L,$
               004123458L,004123460L,004123535L,004123543L,$
               004123546L,004123872L,004123945L,004127539L,$
               004127615L,004128637L,004128640L,004131597L,$
               004141280L,004141599L,004144482L,004144555L,$
               004144557L,004144559L,004144713L,004144715L,$
               004144717L,004144729L,004144733L,004144734L,$
               004144998L,004146033L,004159093L,004162927L,$
               004162931L,004165450L,004173181L,004217010L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 061000
;  # of TDSF Solitary Waves = 036 on 061000

;    Outer Magnetosphere = 2000-06-10/07:00:00 - 2000-06-10/18:00:00
;    Radial Distance     =    9.54439 -   12.781
;    Wind L-Shell        =    9.90000 -   14.199
;    Wind MLT            =   12.71848 -    5.504
;    Wind GSE Pos.       = <   9.37274,   1.76030,  -0.38542> - <  -3.48198, -12.27562,  -0.74430>
;    Wind GSM Pos.       = <   9.37274,   1.74950,  -0.43177> - <  -3.48198, -12.04449,  -2.48497>

;    Radiation Belts     = 2000-06-10/08:48:30 - 2000-06-10/15:21:30
;    Radial Distance     =    6.54207 -    8.805
;    Wind L-Shell        =    6.88514 -    9.634
;    Wind MLT            =   13.88994 -    4.361
;    Wind GSE Pos.       = <   5.78497,   3.05383,  -0.08796> - <  -4.36134,  -7.64205,  -0.34204>
;    Wind GSM Pos.       = <   5.78497,   3.03353,  -0.36235> - <  -4.36134,  -7.64302,  -0.32009>

;----------------------------------------------------------
; => Date :  2000-06-26
;----------------------------------------------------------
date        = '062600'
t_orbit_all = ['2000-06-26/08:00:00','2000-06-27/06:00:00']
t_outer_mag = ['2000-06-26/16:00:00','2000-06-27/05:00:00']
t_rad_belts = ['2000-06-26/18:07:20','2000-06-26/21:00:00']
tdss_w_evn  = [005953546L,005957666L,005957716L,005957722L,$
               005959566L,005959772L,005960306L,005961434L,$
               005961586L,005961992L,005963871L,005964059L,$
               005964065L,005964067L,005964485L,005964487L,$
               005964859L,005964861L]
tdsf_w_evn  = [005984359L,005990424L,005990425L,005990427L,$
               005990499L,005990500L,005990503L,005990519L,$
               005990533L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 018 on 062600
;  # of TDSF Whistlers = 009 on 062600

date        = '062600'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [005972609L,005973264L,005973291L,005977064L,$
               005977065L,005977086L,005977366L,005977371L,$
               005977520L,005977521L,005977522L,005977523L,$
               005977524L,005977525L,005977560L,005977561L,$
               005977562L,005977563L,005979559L,005989490L,$
               005989491L,005989542L,005995676L,005998601L,$
               006003107L,006003114L,006003355L,006004707L,$
               006008338L,006010990L,006011516L,006014487L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 062600
;  # of TDSF Solitary Waves = 032 on 062600

;    Outer Magnetosphere = 2000-06-26/16:00:00 - 2000-06-27/05:00:00
;    Radial Distance     =    7.86163 -   15.849
;    Wind L-Shell        =   10.50000 -   16.100
;    Wind MLT            =   13.39001 -    3.931
;    Wind GSE Pos.       = <   7.47744,   2.42759,   0.00153> - <  -8.36553, -13.42709,  -0.97038>
;    Wind GSM Pos.       = <   7.47744,   2.41859,  -0.20880> - <  -8.36553, -13.45961,  -0.25943>

;    Radiation Belts     = 2000-06-26/18:07:20 - 2000-06-26/21:00:00
;    Radial Distance     =    4.81992 -    4.992
;    Wind L-Shell        =    5.54931 -    5.900
;    Wind MLT            =   16.27691 -   23.340
;    Wind GSE Pos.       = <   2.60463,   4.04688,   0.28751> - <  -4.91902,   0.82429,   0.21417>
;    Wind GSM Pos.       = <   2.60463,   4.03582,   0.41497> - <  -4.91902,   0.78586,   0.32825>

;----------------------------------------------------------
; => Date :  2000-07-10
;----------------------------------------------------------
date        = '071000'
t_orbit_all = ['2000-07-09/15:00:00','2000-07-10/13:00:00']
t_outer_mag = ['2000-07-09/21:00:00','2000-07-10/12:00:00']
t_rad_belts = ['2000-07-10/00:00:00','2000-07-10/05:18:30']
tdss_w_evn  = [007490744L,007496226L,007496232L,007496886L,$
               007497032L,007501067L,007501207L,007501581L,$
               007501583L,007501587L,007501589L,007501779L,$
               007501787L,007501927L,007501929L,007502099L,$
               007502101L,007502103L,007509407L,007510926L,$
               007553628L]
tdsf_w_evn  = [007510704L,007512459L,007544041L,007544044L,$
               007544045L,007544046L,007544047L,007544049L,$
               007544050L,007544052L,007544053L,007544057L,$
               007544060L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 021 on 071000
;  # of TDSF Whistlers = 013 on 071000

date        = '071000'
tdss_s_evn  = [007521435L,007523223L,007543451L]
tdsf_s_evn  = [007521561L,007543473L,007544538L,007544539L,$
               007544619L,007545073L,007561557L,007562238L,$
               007562241L,007562696L,007563449L,007563451L,$
               007567358L,007568148L,007568182L,007568183L,$
               007568502L,007569623L,007569624L,007569627L,$
               007569628L,007570787L,007571107L,007571142L,$
               007571204L,007571300L,007571649L,007571652L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 003 on 071000
;  # of TDSF Solitary Waves = 028 on 071000

;    Outer Magnetosphere = 2000-07-09/21:00:00 - 2000-07-10/12:00:00
;    Radial Distance     =   10.95967 -   15.674
;    Wind L-Shell        =   13.10001 -   15.999
;    Wind MLT            =   11.03855 -    2.989
;    Wind GSE Pos.       = <  10.66198,  -2.51657,  -0.32161> - < -10.88351, -11.23694,  -0.97735>
;    Wind GSM Pos.       = <  10.66198,  -2.49859,  -0.43997> - < -10.88351, -10.95120,   2.70098>

;    Radiation Belts     = 2000-07-10/00:00:00 - 2000-07-10/05:18:30
;    Radial Distance     =    6.58825 -    6.553
;    Wind L-Shell        =    7.40002 -    6.762
;    Wind MLT            =   13.03765 -    0.218
;    Wind GSE Pos.       = <   6.37211,   1.67029,   0.10673> - <  -6.54351,  -0.37410,   0.01404>
;    Wind GSM Pos.       = <   6.37211,   1.66285,   0.19024> - <  -6.54351,  -0.36735,   0.07201>

;----------------------------------------------------------
; => Date :  2000-07-23
;----------------------------------------------------------
date        = '072300'
t_orbit_all = ['2000-07-23/02:00:00','2000-07-25/01:00:00']
t_outer_mag = ['2000-07-23/05:00:00','2000-07-23/20:00:00']
t_rad_belts = ['2000-07-23/07:30:00','2000-07-23/12:04:00']
tdss_w_evn  = [009145964L,009145996L,009146050L,009146054L,$
               009149818L,009151847L,009165187L,009168486L,$
               009168495L,009168549L,009168551L,009169329L]
tdsf_w_evn  = [009149472L,009151417L,009156030L,009159400L,$
               009166952L,009179909L,009187482L,009187488L,$
               009187494L,009187516L,009187521L,009187598L,$
               009187603L,009187610L,009187646L,009187652L,$
               009187653L,009187663L,009187669L,009187728L,$
               009187748L,009187754L,009187804L,009190911L,$
               009286871L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 012 on 072300
;  # of TDSF Whistlers = 025 on 072300

date        = '072300'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [009201440L,009204004L,009205245L,009205332L,$
               009205351L,009205352L,009205353L,009205385L,$
               009205499L,009205500L,009205563L,009205577L,$
               009205578L,009206414L,009206534L,009206624L,$
               009206865L,009206898L,009206907L,009209486L,$
               009209492L,009209949L,009211409L,009214812L,$
               009215316L,009215318L,009215537L,009217011L,$
               009217012L,009221762L,009222445L,009223349L,$
               009223353L,009223739L,009224236L,009224238L,$
               009226177L,009226178L,009226181L,009229521L,$
               009231041L,009231093L,009231212L,009232770L,$
               009233071L,009233559L,009239286L,009240918L,$
               009242757L,009242805L,009242814L,009243100L,$
               009243614L,009243772L,009244653L,009244866L,$
               009244913L,009246047L,009246097L,009250167L,$
               009250633L,009250640L,009251935L,009251968L,$
               009251969L,009252045L,009254079L,009255343L,$
               009255347L,009255426L,009256856L,009256880L,$
               009257245L,009257261L,009258047L,009263566L,$
               009270683L,009270686L,009275666L,009277231L,$
               009278031L,009280174L,009280234L,009284675L,$
               009284801L,009289223L,009289280L,009291631L,$
               009294567L,009297253L,009298083L,009298084L,$
               009299260L,009299436L,009300926L,009300933L,$
               009300947L,009300992L,009301013L,009301031L,$
               009303578L,009304446L,009306439L,009307401L,$
               009309735L,009313267L,009315201L,009316543L,$
               009317455L,009325591L,009331881L,009332587L,$
               009338086L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 072300
;  # of TDSF Solitary Waves = 113 on 072300

;    Outer Magnetosphere = 2000-07-23/05:00:00 - 2000-07-23/20:00:00
;    Radial Distance     =   10.19569 -   15.930
;    Wind L-Shell        =   10.70000 -   19.000
;    Wind MLT            =   10.71559 -    2.327
;    Wind GSE Pos.       = <   9.63492,  -3.32940,  -0.18883> - < -13.56704,  -8.29501,  -0.95625>
;    Wind GSM Pos.       = <   9.63492,  -3.28858,   0.55296> - < -13.56704,  -8.34270,  -0.34782>

;    Radiation Belts     = 2000-07-23/07:30:00 - 2000-07-23/12:04:00
;    Radial Distance     =    6.66634 -    5.569
;    Wind L-Shell        =    6.90000 -    7.302
;    Wind MLT            =   12.47150 -   21.826
;    Wind GSE Pos.       = <   6.61695,   0.79870,   0.15876> - <  -4.82956,   2.76960,   0.19449>
;    Wind GSM Pos.       = <   6.61695,   0.80649,  -0.11284> - <  -4.82956,   2.62019,  -0.91819>

;----------------------------------------------------------
; => Date :  2000-08-04
;----------------------------------------------------------
date        = '080400'
t_orbit_all = ['2000-08-03/14:00:00','2000-08-05/00:00:00']
t_outer_mag = ['2000-08-03/21:00:00','2000-08-04/12:00:00']
t_rad_belts = ['2000-08-03/21:35:00','2000-08-04/04:44:00']
tdss_w_evn     = [010741875L,010742019L,010746865L,010746875L,$
                  010746889L,010747449L,010748351L,010748554L,$
                  010748585L,010749059L,010749085L,010749093L,$
                  010749579L,010749981L,010750081L,010750091L,$
                  010750351L,010750993L,010766846L,010769366L,$
                  010774286L,010785106L,010885582L,010885584L,$
                  010885764L,010885937L,010886835L,010891463L,$
                  010891473L,010891475L]
tdsf_w_evn     = [010760499L,010775642L,010775983L,010781409L,$
                  010784536L,010785194L,010785335L,010785573L,$
                  010785769L,010786025L,010786045L,010786124L,$
                  010786281L,010786283L,010786402L,010786462L,$
                  010786525L,010819474L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 029 on 080400
;  # of TDSF Whistlers = 018 on 080400

date        = '080400'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [010833351L,010835190L,010835447L,010836043L,$
               010836078L,010836120L,010836207L,010837500L,$
               010863541L,010863847L,010864235L,010864290L,$
               010864308L,010864310L,010864316L,010864318L,$
               010864330L,010864426L,010864431L,010864437L,$
               010864452L,010881893L,010881894L,010889595L,$
               010895015L,010895031L,010895036L,010895045L,$
               010895053L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 080400
;  # of TDSF Solitary Waves = 029 on 080400

;    Outer Magnetosphere = 2000-08-03/21:00:00 - 2000-08-04/12:00:00
;    Radial Distance     =    9.37348 -   16.640
;    Wind L-Shell        =   10.80000 -   17.299
;    Wind MLT            =   10.00154 -    1.502
;    Wind GSE Pos.       = <   8.28933,  -4.37394,  -0.13359> - < -15.26656,  -6.55704,  -0.91507>
;    Wind GSM Pos.       = <   8.28933,  -4.36263,   0.34152> - < -15.26656,  -6.26173,   2.15009>

;    Radiation Belts     = 2000-08-03/21:35:00 - 2000-08-04/04:44:00
;    Radial Distance     =    8.54705 -    7.218
;    Wind L-Shell        =    9.73121 -    7.500
;    Wind MLT            =   10.37725 -   22.873
;    Wind GSE Pos.       = <   7.88052,  -3.30879,  -0.05126> - <  -6.89761,   2.12887,   0.04720>
;    Wind GSM Pos.       = <   7.88052,  -3.29780,   0.27427> - <  -6.89761,   2.06103,  -0.53527>

;----------------------------------------------------------
; => Date :  2000-08-15
;----------------------------------------------------------
date        = '081500'
t_orbit_all = ['2000-08-15/11:00:00','2000-08-17/17:00:00']
t_outer_mag = ['2000-08-15/19:05:00','2000-08-16/16:00:00']
t_rad_belts = ['2000-08-15/20:02:00','2000-08-16/04:01:00']
tdss_w_evn  = [012591699L,012596906L,012601330L,012602281L,$
               012607745L,012607752L,012609241L,012616652L,$
               012618223L,012618225L,012619528L,012620560L,$
               012624582L,012624587L,012624633L,012624648L,$
               012625372L,012628272L,012648231L,012649052L,$
               012687665L,012687669L]
tdsf_w_evn  = [012624632L,012624647L,012632984L,012648230L,$
               012649051L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 022 on 081500
;  # of TDSF Whistlers = 005 on 081500

date        = '081500'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [012614862L,012615007L,012621170L,012624522L,$
               012625932L,012625934L,012625952L,012695445L,$
               012700189L,012700457L,012709096L,012712866L,$
               012714189L,012714211L,012714273L,012714274L,$
               012714279L,012714293L,012714298L,012715149L,$
               012715573L,012715779L,012715869L,012715953L,$
               012718214L,012719545L,012720644L,012721565L,$
               012722180L,012722271L,012724718L,012726344L,$
               012730603L,012730795L,012732485L,012732671L,$
               012740796L,012744582L,012744720L,012745572L,$
               012749077L,012749103L,012749108L,012749117L,$
               012749516L,012749532L,012750337L,012750341L,$
               012752105L,012752107L,012752110L,012752119L,$
               012752121L,012752124L,012752136L,012752161L,$
               012752181L,012752209L,012753400L,012753420L,$
               012753485L,012753838L,012754582L,012756040L,$
               012756045L,012756060L,012756062L,012756064L,$
               012756159L,012757327L,012757329L,012757350L,$
               012757864L,012759683L,012759947L,012760603L,$
               012761433L,012761613L,012763736L,012764699L,$
               012764850L,012765573L,012766371L,012766595L,$
               012769518L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 081500
;  # of TDSF Solitary Waves = 085 on 081500

;    Outer Magnetosphere = 2000-08-15/19:05:00 - 2000-08-16/16:00:00
;    Radial Distance     =    9.56540 -   22.578
;    Wind L-Shell        =   11.43333 -   24.900
;    Wind MLT            =    9.13910 -    1.485
;    Wind GSE Pos.       = <   7.39777,  -6.06010,  -0.22002> - < -20.99418,  -8.16938,  -1.51866>
;    Wind GSM Pos.       = <   7.39777,  -5.95531,   1.14347> - < -20.99418,  -8.14849,   1.62703>

;    Radiation Belts     = 2000-08-15/20:02:00 - 2000-08-16/04:01:00
;    Radial Distance     =    8.22919 -    8.757
;    Wind L-Shell        =    9.63071 -    9.018
;    Wind MLT            =    9.78636 -   22.828
;    Wind GSE Pos.       = <   7.06327,  -4.22208,  -0.07868> - <  -8.31075,   2.75988,  -0.09643>
;    Wind GSM Pos.       = <   7.06327,  -4.16036,   0.72357> - <  -8.31075,   2.61102,  -0.89935>

;----------------------------------------------------------
; => Date :  2001-10-03
;----------------------------------------------------------
date        = '100301'
t_orbit_all = ['2001-10-02/22:00:00','2001-10-04/16:00:00']
t_outer_mag = ['2001-10-03/08:00:00','2001-10-04/01:45:00']
t_rad_belts = ['1970-01-01/01:00:00','1970-01-01/02:00:00']
tdss_w_evn  = [002111581L,002111584L,002111610L,002113256L,$
               002113893L,002114050L,002114606L,002115832L,$
               002119158L,002119166L,002119669L,002120886L,$
               002125499L,002125561L,002125566L,002125632L,$
               002125687L,002126689L,002134907L,002146395L,$
               002276025L,002288640L,002288645L,002288654L,$
               002288657L,002288662L,002288665L,002289735L,$
               002289800L,002291141L,002291164L,002291191L,$
               002291233L,002291737L,002335183L,002340064L,$
               002340405L,002340420L,002341478L,002343190L,$
               002345121L,002346764L,002366671L,002366674L,$
               002366909L,002367125L,002367172L,002367407L,$
               002367643L,002369005L,002369402L,002371719L,$
               002372487L,002376677L]
tdsf_w_evn  = [-1L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 053 on 100301
;  # of TDSF Whistlers = 000 on 100301

date        = '100301'
tdss_s_evn  = [002177713L]
tdsf_s_evn  = [002084812L,002084813L,002086042L,002090990L,$
               002091010L,002091018L,002091058L,002091078L,$
               002091096L,002091098L,002091717L,002091723L,$
               002091737L,002091745L,002091751L,002091817L,$
               002092209L,002096119L,002096146L,002096863L,$
               002103213L,002118224L,002118225L,002151934L,$
               002170927L,002170928L,002176841L,002192720L,$
               002194604L,002195288L,002197107L,002197109L,$
               002197110L,002198892L,002198900L,002201175L,$
               002201176L,002205918L,002214532L,002214742L,$
               002214743L,002214744L,002214746L,002214752L,$
               002214928L,002214970L,002215009L,002215024L,$
               002215212L,002215285L,002215286L,002215438L,$
               002217095L,002225829L,002248598L,002248621L,$
               002248627L,002249083L,002256422L,002256423L,$
               002256424L,002259530L,002268466L,002271390L,$
               002273759L,002305149L,002308126L,002314106L,$
               002375674L,002375857L,002375859L,002377406L,$
               002383184L,002385397L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 001 on 100301
;  # of TDSF Solitary Waves = 074 on 100301

;    Outer Magnetosphere = 2001-10-03/08:00:00 - 2001-10-04/01:45:00
;    Radial Distance     =   11.50399 -   17.110
;    Wind L-Shell        =   16.20004 -   19.003
;    Wind MLT            =   17.33265 -    4.529
;    Wind GSE Pos.       = <   2.78517,  11.16174,   0.01418> - <  -7.07945, -15.57507,  -0.28209>
;    Outer Magnetosphere = 2001-10-03/08:00:00 - 2001-10-04/01:45:00

;----------------------------------------------------------
; => Date :  2001-10-24
;----------------------------------------------------------
date        = '102401'
t_orbit_all = ['2001-10-23/05:00:00','2001-10-25/11:00:00']
t_outer_mag = ['2001-10-23/13:00:00','2001-10-24/18:00:00']
t_rad_belts = ['1970-01-01/01:00:00','1970-01-01/02:00:00']
tdss_w_evn     = [003341872L,003343754L,003364067L,003368524L,$
                      003368571L,003369773L,003371410L,003378192L,$
                      003378199L,003380004L,003387617L,003402573L,$
                      003404221L,003404771L,003407425L,003534932L,$
                      003534936L,003534992L,003542760L,$
                      003542790L,003542793L,003544727L,003545843L,$
                      003546483L,003547585L,003549721L,003549724L,$
                      003549799L,003642969L,003643635L]
tdsf_w_evn     = [-1L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 030 on 102401
;  # of TDSF Whistlers = 000 on 102401

date        = '102401'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [003342285L,003342339L,003342424L,003343207L,$
               003343693L,003343798L,003343838L,003353855L,$
               003353861L,003353863L,003353868L,003353871L,$
               003353876L,003353879L,003369197L,003369921L,$
               003369924L,003369958L,003369973L,003370055L,$
               003370093L,003370913L,003370943L,003371259L,$
               003371340L,003371343L,003371346L,003371348L,$
               003371436L,003375858L,003377621L,003377624L,$
               003377674L,003379616L,003388293L,003388773L,$
               003390772L,003395121L,003402069L,003402098L,$
               003402434L,003404320L,003406246L,003417339L,$
               003476045L,003477244L,003484995L,003485005L,$
               003485009L,003505915L,003508308L,003510554L,$
               003511604L,003514442L,003515407L,003517706L,$
               003519023L,003519135L,003519740L,003523792L,$
               003523928L,003524401L,003524489L,003524531L,$
               003524534L,003524591L,003524622L,003524640L,$
               003524675L,003524683L,003525563L,003525730L,$
               003525905L,003559336L,003559351L,003559352L,$
               003559355L,003559358L,003559364L,003559365L,$
               003559380L,003560504L,003560513L,003560842L,$
               003562058L,003562081L,003562095L,003564948L,$
               003565066L,003565068L,003565076L,003565138L,$
               003565139L,003565144L,003565147L,003565152L,$
               003565153L,003565937L,003566931L,003568381L,$
               003568819L,003568824L,003568826L,003569068L,$
               003569109L,003569479L,003569480L,003569693L,$
               003570099L,003571493L,003571532L,003571539L,$
               003571628L,003571651L,003571652L,003572715L,$
               003572728L,003572730L,003572731L,003572734L,$
               003572749L,003572750L,003572751L,003572765L,$
               003572766L,003572767L,003572775L,003573102L,$
               003573197L,003573222L,003573260L,003573288L,$
               003573320L,003573358L,003573359L,003573360L,$
               003573363L,003573401L,003574100L,003574303L,$
               003577893L,003578708L,003578709L,003585920L,$
               003589793L,003590840L,003596799L,003611487L,$
               003612207L,003615272L,003616277L,003616278L,$
               003627234L,003631460L,003631478L,003631567L,$
               003631568L,003631571L,003637888L,003648258L,$
               003648259L,003663792L,003663793L,003672417L,$
               003675318L,003692999L,003693651L,003698494L,$
               003698923L,003712106L,003712117L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 102401
;  # of TDSF Solitary Waves = 171 on 102401

;    Outer Magnetosphere = 2001-10-23/13:00:00 - 2001-10-24/18:00:00
;    Radial Distance     =   11.95112 -   26.738
;    Wind L-Shell        =   16.10004 -   28.900
;    Wind MLT            =   16.65355 -    3.804
;    Wind GSE Pos.       = <   4.08477,  11.22551,  -0.36301> - < -14.26941, -22.60928,   0.37616>
;    Wind GSM Pos.       = <   4.08477,   9.66062,  -5.72856> - < -14.26941, -21.58523,   6.73789>

;----------------------------------------------------------
; => Date :  2001-11-15
;----------------------------------------------------------
date        = '111501'
t_orbit_all = ['2001-11-13/22:00:00','2001-11-16/06:00:00']
t_outer_mag = ['2001-11-14/06:00:00','2001-11-15/04:00:00']
t_rad_belts = ['1970-01-01/01:00:00','1970-01-01/02:00:00']
tdss_w_evn  = [000871976L,000872022L,000873487L,000878222L,$
               000878794L,000878855L,000879075L,000879834L,$
               000880606L,000882194L,000890960L,000926196L,$
               000926926L,000928272L,000928332L,000928721L,$
               000928866L,000928886L,000928891L,000935855L,$
               000935901L,000937022L,000941562L,000965867L,$
               000975164L,001005343L,001005346L,001005646L,$
               001016246L,001020429L,001073455L,001075893L,$
               001076531L,001076607L,001076800L,001076965L,$
               001079327L,001081369L,001081970L,001109285L,$
               001116470L,001117770L,001127360L]
tdsf_w_evn  = [-1L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 043 on 111501
;  # of TDSF Whistlers = 000 on 111501

date        = '111501'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [000871876L,000871974L,000872009L,000872010L,$
               000872011L,000872013L,000872014L,000872017L,$
               000872023L,000872121L,000872154L,000883154L,$
               000883187L,000883228L,000883253L,000893141L,$
               000897675L,000898456L,000898529L,000898753L,$
               000898760L,000898764L,000898767L,000899235L,$
               000899236L,000899796L,000899798L,000900136L,$
               000900580L,000901575L,000902073L,000902257L,$
               000903739L,000908669L,000910102L,000910660L,$
               000910752L,000910753L,000910754L,000910755L,$
               000912088L,000912568L,000912569L,000912792L,$
               000913004L,000913006L,000913011L,000913600L,$
               000914127L,000914133L,000915942L,000915950L,$
               000915964L,000915970L,000915971L,000916021L,$
               000916034L,000916070L,000920516L,000920530L,$
               000920598L,000921720L,000922194L,000922823L,$
               000923450L,000923611L,000923725L,000923726L,$
               000924221L,000924373L,000924374L,000924376L,$
               000924380L,000924381L,000924383L,000924384L,$
               000924385L,000924406L,000924476L,000924485L,$
               000924487L,000924545L,000924547L,000924551L,$
               000924563L,000924564L,000924650L,000924752L,$
               000924778L,000924801L,000924804L,000924832L,$
               000924836L,000924837L,000924843L,000924965L,$
               000924966L,000925004L,000925018L,000925024L,$
               000925028L,000925059L,000925164L,000925192L,$
               000925213L,000925318L,000925321L,000925333L,$
               000925342L,000925344L,000925350L,000925380L,$
               000925381L,000925384L,000925401L,000925413L,$
               000925416L,000925431L,000925458L,000925468L,$
               000925471L,000925560L,000925594L,000960543L,$
               000961137L,000962110L,000962940L,000965829L,$
               000965830L,000965871L,000965886L,000965921L,$
               000965922L,000965955L,000965989L,000971756L,$
               000972791L,000972809L,000972848L,000975244L,$
               000975252L,000980672L,000980673L,000980677L,$
               000996372L,000998280L,000998284L,000998338L,$
               000998492L,001010507L,001010543L,001010608L,$
               001011185L,001013952L,001013967L,001013968L,$
               001017072L,001017227L,001021145L,001044974L,$
               001087876L,001087941L,001092412L,001095783L,$
               001095786L,001095853L,001096711L,001104875L,$
               001133614L,001133910L,001133911L,001133936L,$
               001133937L,001134188L,001134205L,001134219L,$
               001134220L,001134224L,001134426L,001134427L,$
               001136157L,001136611L,001139249L,001139250L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 111501
;  # of TDSF Solitary Waves = 184 on 111501

;    Outer Magnetosphere = 2001-11-14/06:00:00 - 2001-11-15/04:00:00
;    Radial Distance     =   10.68162 -   21.913
;    Wind L-Shell        =   14.70000 -   29.799
;    Wind MLT            =   16.71475 -    2.978
;    Wind GSE Pos.       = <   5.26689,   9.27967,  -0.49449> - < -17.13969, -13.64938,   0.38278>
;    Wind GSM Pos.       = <   5.26689,   8.58926,  -3.54703> - < -17.13969, -13.20886,   3.46097>


;----------------------------------------------------------
; => Date :  2002-07-20
;----------------------------------------------------------
date        = '072002'
t_orbit_all = ['2002-07-19/14:00:00','2002-07-22/11:00:00']
t_outer_mag = ['2002-07-21/02:00:00','2002-07-22/00:24:00']
t_rad_belts = ['2002-07-21/15:24:00','2002-07-21/20:23:00']
tdss_w_evn     = [006531037L,006533647L,006534770L,006535340L,$
                  006539283L,006567591L,006576690L,006578936L,$
                  006732904L,006766861L]
tdsf_w_evn     = [006766704L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 010 on 072002
;  # of TDSF Whistlers = 001 on 072002

date        = '072002'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [006500585L,006512574L,006512575L,006512637L,$
               006513713L,006532142L,006532152L,006533315L,$
               006533482L,006533637L,006533799L,006534299L,$
               006538962L,006546858L,006546863L,006546864L,$
               006546866L,006557676L,006557677L,006557965L,$
               006560991L,006560992L,006561354L,006561366L,$
               006561369L,006561400L,006561401L,006562437L,$
               006572256L,006578946L,006582617L,006585518L,$
               006587952L,006587954L,006589317L,006589353L,$
               006589354L,006589499L,006601103L,006607234L,$
               006607435L,006607487L,006607493L,006607498L,$
               006608295L,006628048L,006628374L,006628761L,$
               006628762L,006628866L,006634510L,006634619L,$
               006634841L,006635171L,006643964L,006645648L,$
               006645649L,006645682L,006645770L,006651485L,$
               006651692L,006659839L,006661272L,006670353L,$
               006671552L,006671647L,006672872L,006674812L,$
               006680565L,006682355L,006682356L,006682360L,$
               006683371L,006683414L,006684611L,006684613L,$
               006687812L,006691764L,006700387L,006706157L,$
               006821795L,006821817L,006826026L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 072002
;  # of TDSF Solitary Waves = 083 on 072002

;    Outer Magnetosphere = 2002-07-21/02:00:00 - 2002-07-22/00:24:00
;    Radial Distance     =   21.68594 -   11.475
;    Wind L-Shell        =   22.70000 -   12.500
;    Wind MLT            =   21.71439 -   11.298
;    Wind GSE Pos.       = < -18.09677,  11.94633,   0.26850> - <  11.29674,  -2.01275,   0.13080>
;    Wind GSM Pos.       = < -18.09677,  11.93261,  -0.63228> - <  11.29674,  -2.00704,   0.20007>

;    Radiation Belts     = 2002-07-21/15:24:00 - 2002-07-21/20:23:00
;    Radial Distance     =    7.94138 -    7.559
;    Wind L-Shell        =    8.69999 -    8.183
;    Wind MLT            =    2.51839 -    8.275
;    Wind GSE Pos.       = <  -6.36794,  -4.72966,  -0.38118> - <   4.58238,  -6.00873,  -0.22144>
;    Wind GSM Pos.       = <  -6.36794,  -4.64722,   0.95828> - <   4.58238,  -6.01250,   0.06089>

;----------------------------------------------------------
; => Date :  2002-10-10
;----------------------------------------------------------
date        = '101002'
t_orbit_all = ['2002-10-09/18:00:00','2002-10-10/08:00:00']
t_outer_mag = ['2002-10-09/20:00:00','2002-10-10/06:30:00']
t_rad_belts = ['2002-10-09/22:59:20','2002-10-10/03:11:40']
tdss_w_evn     = [009900719L,009901466L,009901482L,009901485L,$
               009901502L,009901524L,009901527L,009901997L,$
               009903793L]
tdsf_w_evn     = [009866555L,009877502L,009879903L,009880137L,$
               009880910L,009883409L,009892487L,009901464L,$
               009901521L,009901600L,009901613L,009901665L,$
               009901799L,009901961L,009901974L,009902120L,$
               009903803L,009904466L,009907949L,009908377L,$
               009908379L,009911619L]
IF (tdss_w_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_w_evn)
IF (tdsf_w_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_w_evn)
PRINT, ';  # of TDSS Whistlers = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Whistlers = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Whistlers = 009 on 101002
;  # of TDSF Whistlers = 022 on 101002

date        = '101002'
tdss_s_evn  = [-1L]
tdsf_s_evn  = [009912182L,009912183L,009925020L]
IF (tdss_s_evn[0] LT 0) THEN n_els = 0L ELSE n_els = N_ELEMENTS(tdss_s_evn)
IF (tdsf_s_evn[0] LT 0) THEN n_elf = 0L ELSE n_elf = N_ELEMENTS(tdsf_s_evn)
PRINT, ';  # of TDSS Solitary Waves = '+STRING(FORMAT='(I3.3)',n_els[0])+' on '+date[0]
PRINT, ';  # of TDSF Solitary Waves = '+STRING(FORMAT='(I3.3)',n_elf[0])+' on '+date[0]
;  # of TDSS Solitary Waves = 000 on 101002
;  # of TDSF Solitary Waves = 003 on 101002

;    Outer Magnetosphere = 2002-10-09/20:00:00 - 2002-10-10/06:30:00
;    Radial Distance     =   10.81647 -   10.372
;    Wind L-Shell        =   11.70001 -   11.150
;    Wind MLT            =   17.37866 -    8.946
;    Wind GSE Pos.       = <   1.68300,  10.68114,  -0.27682> - <   5.96325,  -8.45860,   0.69150>
;    Wind GSM Pos.       = <   1.68300,  10.27087,  -2.94494> - <   5.96325,  -7.16528,   4.54809>

;    Radiation Belts     = 2002-10-09/22:59:20 - 2002-10-10/03:11:40
;    Radial Distance     =    6.24760 -    5.271
;    Wind L-Shell        =    6.52302 -    6.091
;    Wind MLT            =   19.50865 -    6.049
;    Wind GSE Pos.       = <  -2.16439,   5.85028,  -0.35174> - <  -0.46992,  -5.24862,   0.16074>
;    Wind GSM Pos.       = <  -2.16439,   5.64340,  -1.58162> - <  -0.46992,  -4.91685,   1.84352>

;-----------------------------------------------------------------------------------------
; => Print out event numbers for corresponding dates
;-----------------------------------------------------------------------------------------
mydate = my_str_date(DATE=date)
date   = mydate.S_DATE[0]  ; -('MMDDYY')
mdate  = mydate.DATE[0]    ; -('YYYYMMDD')
ldate  = STRMID(mdate,4L,4L)+STRMID(mdate,0L,4L)
tdate  = mydate.TDATE[0]

; => Dates
gdates = ['102698','111398','121498','040900','050300','052600','061000',$
          '062600','071000','072300','080400','081500','100301','102401',$
          '111501','072002','101002']

mydats = my_str_date(DATE=gdates)
dates  = mydats.S_DATE     ; => 'MMDDYY'
tdates = mydats.TDATE      ; => 'YYYY-MM-DD'

; => outer magnetosphere time ranges of 
gtm         = [['1998-11-13/13:00:00','1998-11-13/20:00:00'],$
               ['1998-12-14/08:56:00','1998-12-15/07:44:00'],$
               ['2000-04-09/18:00:00','2000-04-10/08:00:00'],$
               ['2000-05-02/19:00:00','2000-05-03/09:00:00'],$
               ['2000-05-25/17:18:00','2000-05-26/07:30:00'],$
               ['2000-06-10/07:00:00','2000-06-10/18:00:00'],$
               ['2000-06-26/16:00:00','2000-06-27/05:00:00'],$
               ['2000-07-09/21:00:00','2000-07-10/12:00:00'],$
               ['2000-07-23/05:00:00','2000-07-23/20:00:00'],$
               ['2000-08-03/21:00:00','2000-08-04/12:00:00'],$
               ['2000-08-15/19:05:00','2000-08-16/16:00:00'],$
               ['2001-10-03/08:00:00','2001-10-04/01:45:00'],$
               ['2001-10-23/13:00:00','2001-10-24/18:00:00'],$
               ['2001-11-14/06:00:00','2001-11-15/04:00:00'],$
               ['2002-07-21/02:00:00','2002-07-22/00:24:00'],$
               ['2002-10-09/20:00:00','2002-10-10/06:30:00']]

; => radiation belt time ranges of 
gtr         = [['1998-11-13/15:00:00','1998-11-13/21:06:00'],$
               ['1970-01-01/01:00:00','1970-01-01/02:00:00'],$
               ['2000-04-10/01:33:30','2000-04-10/07:00:00'],$
               ['2000-05-02/23:16:30','2000-05-03/05:12:00'],$
               ['2000-05-25/19:52:30','2000-05-26/01:00:30'],$
               ['2000-06-10/08:48:30','2000-06-10/15:21:30'],$
               ['2000-06-26/18:07:20','2000-06-26/21:00:00'],$
               ['2000-07-10/00:00:00','2000-07-10/05:18:30'],$
               ['2000-07-23/07:30:00','2000-07-23/12:56:30'],$
               ['2000-08-03/21:35:00','2000-08-04/04:44:00'],$
               ['2000-08-15/20:02:00','2000-08-16/04:01:00'],$
               ['1970-01-01/01:00:00','1970-01-01/02:00:00'],$
               ['1970-01-01/01:00:00','1970-01-01/02:00:00'],$
               ['1970-01-01/01:00:00','1970-01-01/02:00:00'],$
               ['2002-07-21/15:24:00','2002-07-21/20:23:00'],$
               ['2002-10-09/22:59:20','2002-10-10/03:11:40']]
; => Convert time ranges to Unix times
trmag = time_double(gtm)
trrad = time_double(gtr)


; =>  tags  = ['WHISTLER_T','WHISTLER_UNX','SOLITARY_T','SOLITARY_UNX']
tws        = tds_whist_ehole_times(DATE=date,FIXFILE=fixfile)
ymdb_whist = tws.WHISTLER_T    ; => e.g. '1998/11/13 16:24:43.178 UT'
unix_whist = tws.WHISTLER_UNX
; => change format of SCETs to new form:  e.g. '1998-11-13/15:03:52.346'
ymdb_nw    = string_replace_char(string_replace_char(ymdb_whist,'/','-'),' ','/')
ymdb_nw    = STRMID(ymdb_nw[*],0L,23L)  ; => Remove the _UT


; => Get TDSS data
my_tdss    = get_wind_tds_data(DATE=date,FIXFILE=fixfile,/TDSS)
scet_s     = my_tdss.SCET      ; => e.g. '1998/11/13 15:03:52.346 UT'
field_s    = my_tdss.EFIELD    ; => [N,M]-element array {N = # of TDS, M = # of measurements per TDS}
evnum_s    = my_tdss.EVENT_N   ; => event numbers
atype_s    = my_tdss.A_TYPE    ; => e.g. 'BY' or 'EXDC' etc.

; => Eliminate bad elements
bad        = WHERE(scet_s EQ '',bd,COMPLEMENT=good,NCOMPLEMENT=gd)
IF (gd GT 0) THEN scet_s  = scet_s[good]
IF (gd GT 0) THEN field_s = field_s[good,*]
IF (gd GT 0) THEN evnum_s = evnum_s[good]
IF (gd GT 0) THEN atype_s = atype_s[good]

ascets     = string_replace_char(string_replace_char(scet_s,'/','-'),' ','/')
ascets     = STRMID(ascets[*],0L,23L)  ; => Remove the _UT
; => new form:  e.g. '1998-11-13/15:03:52.346'

mts        = my_time_string(ascets,STR=1,FORM=1,PREC=3,/NOMSSG)
ascet_s    = mts.DATE_TIME
aunix_s    = mts.UNIX
; => # of TDSS samples
PRINT, date[0]+'    ',N_ELEMENTS(UNIQ(evnum_s,SORT(evnum_s))), FORMAT='(";",a15,I3.3)'
; => # of TDSS samples
;     102698    011
;     111398    018
;     121498    020
;     040900    011
;     050300    018
;     052600    000
;     061000    059
;     062600    024
;     071000    032
;     072300    016
;     080400    035
;     081500    023
;     100301    064
;     102401    035
;     111501    093
;     072002    050
;     101002    009

; => Find only the whistlers
test_s     = array_where(ascet_s,ymdb_nw,/N_UNIQ)
help, test_s
wscet_s    = ascet_s[test_s[*,0]]
wunix_s    = aunix_s[test_s[*,0]]
wfeld_s    = field_s[test_s[*,0],*]
wevnm_s    = evnum_s[test_s[*,0]]
wtype_s    = atype_s[test_s[*,0]]

unqevn     = UNIQ(wevnm_s,SORT(wevnm_s))
strevn_s   = STRING(FORMAT='(I9.9)',wevnm_s[unqevn])+'L'
PRINT, TRANSPOSE(strevn_s)

; => Get TDSF data
my_tdsf    = get_wind_tds_data(DATE=date,FIXFILE=fixfile,/TDSF)
scet_f     = my_tdsf.SCET      ; => e.g. '1998/11/13 15:03:52.346 UT'
field_f    = my_tdsf.EFIELD    ; => [N,M]-element array {N = # of TDS, M = # of measurements per TDS}
evnum_f    = my_tdsf.EVENT_N   ; => event numbers
atype_f    = my_tdsf.A_TYPE    ; => e.g. 'BY' or 'EXDC' etc.

; => Eliminate bad elements
bad        = WHERE(scet_f EQ '',bd,COMPLEMENT=good,NCOMPLEMENT=gd)
IF (gd GT 0) THEN scet_f  = scet_f[good]
IF (gd GT 0) THEN field_f = field_f[good,*]
IF (gd GT 0) THEN evnum_f = evnum_f[good]
IF (gd GT 0) THEN atype_f = atype_f[good]

ascetf     = string_replace_char(string_replace_char(scet_f,'/','-'),' ','/')
ascetf     = STRMID(ascetf[*],0L,23L)  ; => Remove the _UT
; => new form:  e.g. '1998-11-13/15:03:52.346'

mts        = my_time_string(ascetf,STR=1,FORM=1,PREC=3,/NOMSSG)
ascet_f    = mts.DATE_TIME
aunix_f    = mts.UNIX
; => # of TDSF samples
PRINT, date[0]+'    ',N_ELEMENTS(UNIQ(evnum_f,SORT(evnum_f))), FORMAT='(";",a15,I3.3)'
;     102698    018
;     111398    074
;     121498    018
;     040900    134
;     050300    050
;     052600    061
;     061000    102
;     062600    088
;     071000    078
;     072300    185
;     080400    083
;     081500    117
;     100301    243
;     102401    342
;     111501    427
;     072002    330
;     101002    075

; => Find only the whistlers
test_f     = array_where(ascet_f,ymdb_nw,/N_UNIQ)
help, test_f
wscet_f    = ascet_f[test_f[*,0]]
wunix_f    = aunix_f[test_f[*,0]]
wfeld_f    = field_f[test_f[*,0],*]
wevnm_f    = evnum_f[test_f[*,0]]
wtype_f    = atype_f[test_f[*,0]]

unqevn     = UNIQ(wevnm_f,SORT(wevnm_f))
strevn_f   = STRING(FORMAT='(I9.9)',wevnm_f[unqevn])+'L'
PRINT, TRANSPOSE(strevn_f)
;-----------------------------------------------------------------------------------------
; => Print out times inside L = 15
;-----------------------------------------------------------------------------------------
gdates = ['102698','111398','121498','040900','050300','052600','061000',$
          '062600','071000','072300','080400','081500','100301','102401',$
          '111501','072002','101002']
t_orbit_all = [['1998-10-26/00:00:00','1998-10-26/23:59:00'],$
               ['1998-11-13/11:00:00','1998-11-14/07:00:00'],$
               ['1998-12-14/03:00:00','1998-12-15/18:00:00'],$
               ['2000-04-09/00:00:00','2000-04-11/00:00:00'],$
               ['2000-05-02/18:00:00','2000-05-03/13:00:00'],$
               ['2000-05-25/15:00:00','2000-05-26/12:00:00'],$
               ['2000-06-09/17:00:00','2000-06-12/01:00:00'],$
               ['2000-06-26/08:00:00','2000-06-27/06:00:00'],$
               ['2000-07-09/15:00:00','2000-07-10/13:00:00'],$
               ['2000-07-23/02:00:00','2000-07-25/01:00:00'],$
               ['2000-08-03/14:00:00','2000-08-05/00:00:00'],$
               ['2000-08-15/11:00:00','2000-08-17/17:00:00'],$
               ['2001-10-02/22:00:00','2001-10-04/16:00:00'],$
               ['2001-10-23/05:00:00','2001-10-25/11:00:00'],$
               ['2001-11-13/22:00:00','2001-11-16/06:00:00'],$
               ['2002-07-19/14:00:00','2002-07-22/11:00:00'],$
               ['2002-10-09/18:00:00','2002-10-10/08:00:00']]

t_outer_mag = [['1998-10-26/03:00:00','1998-10-26/16:00:00'],$
               ['1998-11-13/13:00:00','1998-11-13/22:00:00'],$
               ['1998-12-14/08:56:00','1998-12-15/07:44:00'],$
               ['2000-04-09/18:00:00','2000-04-10/08:00:00'],$
               ['2000-05-02/19:00:00','2000-05-03/09:00:00'],$
               ['2000-05-25/17:18:00','2000-05-26/07:30:00'],$
               ['2000-06-10/07:00:00','2000-06-10/18:00:00'],$
               ['2000-06-26/16:00:00','2000-06-27/05:00:00'],$
               ['2000-07-09/21:00:00','2000-07-10/12:00:00'],$
               ['2000-07-23/05:00:00','2000-07-23/20:00:00'],$
               ['2000-08-03/21:00:00','2000-08-04/12:00:00'],$
               ['2000-08-15/19:05:00','2000-08-16/16:00:00'],$
               ['2001-10-03/08:00:00','2001-10-04/01:45:00'],$
               ['2001-10-23/13:00:00','2001-10-24/18:00:00'],$
               ['2001-11-14/06:00:00','2001-11-15/04:00:00'],$
               ['2002-07-21/02:00:00','2002-07-22/00:24:00'],$
               ['2002-10-09/20:00:00','2002-10-10/06:30:00']]

dumb0 = 'Time period for L < 15                                                                                                    = '
dumb1 = 'Time period for L < 15 and inside Magnetosphere                                                                           = '
dur00 = ['1970-01-01/01:00:00','1970-01-01/02:00:00']

FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  t          = t_orbit_all[*,j]                                                            & $
  tom        = t_outer_mag[*,j]                                                            & $
  tr3        = time_double(t)                                                              & $
  tdm        = time_double(tom)                                                            & $
  mag3       = read_wind_mfi(TRANGE=tr3)                                                   & $
  t3x        = mag3.MAG.X                                                                  & $
  read_wind_orbit,DATE=date[0],DATA=windloc                                                & $
  gseunx     = windloc.UNIX                                                                & $
  lshell     = windloc.LSHELL                                                              & $
  testlsh    = INTERPOL(lshell,gseunx,t3x,/SPLINE)                                         & $
  goodl0     = WHERE(testlsh LE 15.,gdl0)                                                  & $
  goodl1     = WHERE(testlsh LE 15. AND t3x LE tdm[1] AND t3x GE tdm[0],gdl1)              & $
  gdmnmx0    = minmax(goodl0)                                                              & $
  gdmnmx1    = minmax(goodl1)                                                              & $
  IF (gdl0 GT 0) THEN trL150 = time_string(t3x[gdmnmx0]) ELSE trL150 = dur00               & $
  IF (gdl1 GT 0) THEN trL151 = time_string(t3x[gdmnmx1]) ELSE trL151 = dur00               & $
  PRINT,''                                                                                 & $
  PRINT,dumb0[0]+trL150[0]+' - '+trL150[1]                                                 & $
  PRINT,dumb1[0]+trL151[0]+' - '+trL151[1]                                                 & $
  PRINT,''

;-----------------------------------------------------------------------------------------
; => Print out ASCII file stats
;-----------------------------------------------------------------------------------------
gdates = ['102698','111398','121498','040900','050300','052600','061000',$
          '062600','071000','072300','080400','081500','100301','102401',$
          '111501','072002','101002']

FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  all_stats_all_waves_stats,DATE=date,/ALL
;-----------------------------------------------------------------------------------------
; => Print out ASCII file stats
;-----------------------------------------------------------------------------------------
gdates = ['102698','111398','121498','040900','050300','052600','061000',$
          '062600','071000','072300','080400','081500','100301','102401',$
          '111501','072002','101002']

FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  all_stats_all_waves,DATE=date[0]
;-----------------------------------------------------------------------------------------
; => Print out orbit stats
;-----------------------------------------------------------------------------------------

t_orbit_all = [['1998-10-26/00:00:00','1998-10-26/23:59:00'],$
               ['1998-11-13/11:00:00','1998-11-14/07:00:00'],$
               ['1998-12-14/03:00:00','1998-12-15/18:00:00'],$
               ['2000-04-09/00:00:00','2000-04-11/00:00:00'],$
               ['2000-05-02/18:00:00','2000-05-03/13:00:00'],$
               ['2000-05-25/15:00:00','2000-05-26/12:00:00'],$
               ['2000-06-09/17:00:00','2000-06-12/01:00:00'],$
               ['2000-06-26/08:00:00','2000-06-27/06:00:00'],$
               ['2000-07-09/15:00:00','2000-07-10/13:00:00'],$
               ['2000-07-23/02:00:00','2000-07-25/01:00:00'],$
               ['2000-08-03/14:00:00','2000-08-05/00:00:00'],$
               ['2000-08-15/11:00:00','2000-08-17/17:00:00'],$
               ['2001-10-02/22:00:00','2001-10-04/16:00:00'],$
               ['2001-10-23/05:00:00','2001-10-25/11:00:00'],$
               ['2001-11-13/22:00:00','2001-11-16/06:00:00'],$
               ['2002-07-19/14:00:00','2002-07-22/11:00:00'],$
               ['2002-10-09/18:00:00','2002-10-10/08:00:00']]

t_outer_mag = [['1998-10-26/03:00:00','1998-10-26/16:00:00'],$
               ['1998-11-13/13:00:00','1998-11-13/22:00:00'],$
               ['1998-12-14/08:56:00','1998-12-15/07:44:00'],$
               ['2000-04-09/18:00:00','2000-04-10/08:00:00'],$
               ['2000-05-02/19:00:00','2000-05-03/09:00:00'],$
               ['2000-05-25/17:18:00','2000-05-26/07:30:00'],$
               ['2000-06-10/07:00:00','2000-06-10/18:00:00'],$
               ['2000-06-26/16:00:00','2000-06-27/05:00:00'],$
               ['2000-07-09/21:00:00','2000-07-10/12:00:00'],$
               ['2000-07-23/05:00:00','2000-07-23/20:00:00'],$
               ['2000-08-03/21:00:00','2000-08-04/12:00:00'],$
               ['2000-08-15/19:05:00','2000-08-16/16:00:00'],$
               ['2001-10-03/08:00:00','2001-10-04/01:45:00'],$
               ['2001-10-23/13:00:00','2001-10-24/18:00:00'],$
               ['2001-11-14/06:00:00','2001-11-15/04:00:00'],$
               ['2002-07-21/02:00:00','2002-07-22/00:24:00'],$
               ['2002-10-09/20:00:00','2002-10-10/06:30:00']]

t_rad_belts = [['1998-10-26/07:40:00','1998-10-26/12:30:00'],$
               ['1998-11-13/15:00:00','1998-11-13/21:06:00'],$
               ['1970-01-01/01:00:00','1970-01-01/02:00:00'],$
               ['2000-04-10/01:33:30','2000-04-10/07:00:00'],$
               ['2000-05-02/23:16:30','2000-05-03/05:12:00'],$
               ['2000-05-25/19:52:30','2000-05-26/01:00:30'],$
               ['2000-06-10/08:48:30','2000-06-10/15:21:30'],$
               ['2000-06-26/18:07:20','2000-06-26/21:00:00'],$
               ['2000-07-10/00:00:00','2000-07-10/05:18:30'],$
               ['2000-07-23/07:30:00','2000-07-23/12:56:30'],$
               ['2000-08-03/21:35:00','2000-08-04/04:44:00'],$
               ['2000-08-15/20:02:00','2000-08-16/04:01:00'],$
               ['1970-01-01/01:00:00','1970-01-01/02:00:00'],$
               ['1970-01-01/01:00:00','1970-01-01/02:00:00'],$
               ['1970-01-01/01:00:00','1970-01-01/02:00:00'],$
               ['2002-07-21/15:24:00','2002-07-21/20:23:00'],$
               ['2002-10-09/22:59:20','2002-10-10/03:11:40']]

;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------
gdates = ['102698','111398','121498','040900','050300','052600','061000',$
          '062600','071000','072300','080400','081500','100301','102401',$
          '111501','072002','101002']

dumb0 = '# of unique SCETs   = '
dumb1 = '# of unique Event # = '

FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  fixfs      = 0                                                                           & $
  fixfile    = 0                                                                           & $
  tws        = tds_whist_ehole_times(DATE=date,FIXFILE=fixfs)                              & $
  wevn       = tws.WHISTLER_EVN                                                            & $
  wunix      = tws.WHISTLER_UNX                                                            & $
  unqen      = UNIQ(wevn,SORT(wevn))                                                       & $
  unqux      = UNIQ(wunix,SORT(wunix))                                                     & $
  PRINT,''                                                                                 & $
  PRINT,date[0]                                                                            & $
  PRINT,dumb0[0]+STRTRIM(N_ELEMENTS(unqux),2L)                                             & $
  PRINT,dumb1[0]+STRTRIM(N_ELEMENTS(unqen),2L)                                             & $
  PRINT,''
  



;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------


gdates = ['102698','111398','121498','040900','050300','052600','061000',$
          '062600','071000','072300','080400','081500','100301','102401',$
          '111501','072002','101002']

FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  fixfs      = 0                                                                           & $
  fixfile    = 0                                                                           & $
  tws        = tds_whist_ehole_times(DATE=date,FIXFILE=fixfs)                              & $
  fixfile    = fixfs                                                                       & $
  my_tdss    = get_wind_tds_data(DATE=date,FIXFILE=fixfile,/TDSS)                          & $
  scet_s     = my_tdss.SCET                                                                & $
  evnum_s    = my_tdss.EVENT_N                                                             & $
  bad        = WHERE(scet_s EQ '',bd,COMPLEMENT=good,NCOMPLEMENT=gd)                       & $
  IF (gd GT 0) THEN evnum_s = evnum_s[good] ELSE evnum_s = -1L                             & $
  PRINT, '# of TDSS samples'                                                               & $
  PRINT, date[0]+'    ',N_ELEMENTS(UNIQ(evnum_s,SORT(evnum_s))), FORMAT='(";",a15,I3.3)'   & $
  my_tdsf    = get_wind_tds_data(DATE=date,FIXFILE=fixfile,/TDSF)                          & $
  scet_f     = my_tdsf.SCET                                                                & $
  evnum_f    = my_tdsf.EVENT_N                                                             & $
  bad        = WHERE(scet_f EQ '',bd,COMPLEMENT=good,NCOMPLEMENT=gd)                       & $
  IF (gd GT 0) THEN evnum_f = evnum_f[good] ELSE evnum_f = -1L                             & $
  PRINT, '# of TDSF samples'                                                               & $
  PRINT, date[0]+'    ',N_ELEMENTS(UNIQ(evnum_f,SORT(evnum_f))), FORMAT='(";",a15,I3.3)'   & $
  JUMP_SKIP:

;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------


gdates = ['102698','111398','121498','040900','050300','052600','061000',$
          '062600','071000','072300','080400','081500','100301','102401',$
          '111501','072002','101002']

FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  nuq        = 0                                                                           & $
  fixfs      = 0                                                                           & $
  fixfile    = 0                                                                           & $
  tws        = tds_whist_ehole_times(DATE=date,FIXFILE=fixfs)                              & $
  fixfile    = fixfs                                                                       & $
  ymdb_solit = tws.SOLITARY_T                                                              & $
  unix_solit = tws.SOLITARY_UNX                                                            & $
  ymdb_nw    = string_replace_char(string_replace_char(ymdb_solit,'/','-'),' ','/')        & $
  ymdb_nw    = STRMID(ymdb_nw[*],0L,23L)                                                   & $
  fixfile    = fixfs                                                                       & $
  my_tdss    = get_wind_tds_data(DATE=date,FIXFILE=fixfile,/TDSS)                          & $
  scet_s     = my_tdss.SCET                                                                & $
  evnum_s    = my_tdss.EVENT_N                                                             & $
  test_s     = -1                                                                          & $
  bad        = WHERE(scet_s EQ '',bd,COMPLEMENT=good,NCOMPLEMENT=gd)                       & $
  IF (gd GT 0) THEN evnum_s = evnum_s[good] ELSE GOTO,JUMP_SKIPS                           & $
  IF (gd GT 0) THEN scet_s  = scet_s[good]  ELSE scet_s  = ''                              & $
  ascets     = string_replace_char(string_replace_char(scet_s,'/','-'),' ','/')            & $
  ascets     = STRMID(ascets[*],0L,23L)                                                    & $
  test_s     = array_where(ascets,ymdb_nw,/N_UNIQ)                                         & $
  JUMP_SKIPS:                                                                              & $
  IF (test_s[0] LT 0) THEN sevnm_s = [-1L] ELSE sevnm_s = evnum_s[test_s[*,0]]             & $
  unqevn     = UNIQ(sevnm_s,SORT(sevnm_s))                                                 & $
  nuq        = N_ELEMENTS(unqevn)                                                          & $
  PRINT, 'Event #s of TDSS solitary waves for '+date[0]                                    & $
  FOR k=0L, nuq - 1L DO BEGIN                                                                $
    PRINT, sevnm_s[unqevn[k]], FORMAT='(I9.9)'                                             & $
  ENDFOR                                                                                   & $
  nuq        = 0                                                                           & $
  my_tdsf    = get_wind_tds_data(DATE=date,FIXFILE=fixfile,/TDSF)                          & $
  scet_f     = my_tdsf.SCET                                                                & $
  evnum_f    = my_tdsf.EVENT_N                                                             & $
  test_f     = -1                                                                          & $
  bad        = WHERE(scet_f EQ '',bd,COMPLEMENT=good,NCOMPLEMENT=gd)                       & $
  IF (gd GT 0) THEN evnum_f = evnum_f[good] ELSE GOTO,JUMP_SKIPF                           & $
  IF (gd GT 0) THEN scet_f  = scet_f[good]  ELSE scet_f  = ''                              & $
  ascetf     = string_replace_char(string_replace_char(scet_f,'/','-'),' ','/')            & $
  ascetf     = STRMID(ascetf[*],0L,23L)                                                    & $
  test_f     = array_where(ascetf,ymdb_nw,/N_UNIQ)                                         & $
  JUMP_SKIPF:                                                                              & $
  IF (test_f[0] LT 0) THEN sevnm_f = [-1L] ELSE sevnm_f = evnum_f[test_f[*,0]]             & $
  unqevn     = UNIQ(sevnm_f,SORT(sevnm_f))                                                 & $
  nuq        = N_ELEMENTS(unqevn)                                                          & $
  PRINT, 'Event #s of TDSF solitary waves for '+date[0]                                    & $
  FOR k=0L, nuq - 1L DO BEGIN                                                                $
    PRINT, sevnm_f[unqevn[k]], FORMAT='(I9.9)'                                             & $
  ENDFOR                                                                                   & $
  JUMP_SKIP:
  


;-----------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------

.compile whistler_insta_read
.compile string_replace_char
.compile tds_whist_ehole_times
.compile array_where

old_stats  = whistler_insta_read()
wscets0    = STRTRIM(old_stats.SCETS,2)
rtype      = STRMID(STRTRIM(old_stats.RECEIVER[*],2),0L,4L)
wscets1    = string_replace_char(string_replace_char(wscets0,'/','-'),' ','/')
wscets1    = STRMID(wscets1[*],0L,23L)
fw_low0    = old_stats.FLOW_PEAK
fw_high0   = old_stats.FHIGH_PEAK

mform  = '(a30,a6,I12.9,2f15.3)'
gdates = ['102698','111398','121498','040900','050300','052600','061000',$
          '062600','071000','072300','080400','081500','100301','102401',$
          '111501','072002','101002']

FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  fixfs      = 0                                                                           & $
  fixfile    = 0                                                                           & $
  PRINT,''                                                                                 & $
  PRINT,'j = '+STRTRIM(j,2L)                                                               & $
  tws        = tds_whist_ehole_times(DATE=date,FIXFILE=fixfs)                              & $
  ymdb_whist = tws.WHISTLER_T                                                              & $
  unix_whist = tws.WHISTLER_UNX                                                            & $
  wevn       = tws.WHISTLER_EVN                                                            & $
  ymdb_nw    = string_replace_char(string_replace_char(ymdb_whist,'/','-'),' ','/')        & $
  ymdb_nw    = STRMID(ymdb_nw[*],0L,23L)                                                   & $
  fixfile    = fixfs                                                                       & $
  my_tdsf    = tdsf_sort_relevant(DATE=date,FIXFILE=fixfile)                               & $
  my_tdss    = tdss_sort_relevant(DATE=date,FIXFILE=fixfile)                               & $
  scet_f     = my_tdsf.SCETS                                                               & $
  scet_s     = my_tdss.SCETS                                                               & $
  evn_f      = my_tdsf.EVENT_N                                                             & $
  evn_s      = my_tdss.EVENT_N                                                             & $
  scet_f1    = scet_f                                                                      & $
  scet_s1    = scet_s                                                                      & $
  all_evn    = [evn_f,evn_s]                                                               & $
  all_scet   = [scet_f1,scet_s1]                                                           & $
  test_f     = array_where(wscets1,all_scet,/N_UNIQ)                                       & $
  IF (test_f[0] LT 0) THEN n_f = 0 ELSE n_f = N_ELEMENTS([test_f[*,0]])                    & $
  IF (test_f[0] LT 0) THEN elf = [-1] ELSE elf = REFORM([test_f[*,0]])                     & $
  IF (test_f[0] LT 0) THEN vlf = [-1] ELSE vlf = REFORM([test_f[*,1]])                     & $
  IF (n_f EQ 0) THEN GOTO,JUMP_SKIP                                                        & $
  gscets     = all_scet[vlf]                                                               & $
  gevns      = all_evn[vlf]                                                                & $
  g_flow     = fw_low0[elf]                                                                & $
  g_fhigh    = fw_high0[elf]                                                               & $
  g_rtype    = rtype[elf]                                                                  & $
  FOR k=0L, n_f - 1L DO BEGIN                                                                $
    PRINT,FORMAT=mform,gscets[k],g_rtype[k],gevns[k],g_flow[k],g_fhigh[k]                  & $
  ENDFOR                                                                                   & $
  JUMP_SKIP:
  


;  gscets     = wscets1[elf]                                                                & $

;  scet_f0    = string_replace_char(string_replace_char(scet_f,'/','-'),' ','/')            & $
;  scet_s0    = string_replace_char(string_replace_char(scet_s,'/','-'),' ','/')            & $
;  scet_f1    = STRMID(scet_f0[*],0L,23L)                                                   & $
;  scet_s1    = STRMID(scet_s0[*],0L,23L)                                                   & $
;  unq        = UNIQ(all_evn,SORT(all_evn))                                                 & $
;  all_evn    = all_evn[unq]                                                                & $
;  all_scet   = all_scet[unq]                                                               & $



;----------------------------------------------------------
; => Date :  1998-10-26
;----------------------------------------------------------
wevnms = 0L
wfrlow = f
wfhigh = f

;----------------------------------------------------------
; => Date :  1998-11-13
;----------------------------------------------------------
wevnms = [005859145L,005860443L,005861680L,005863014L,005879464L,$
          005879470L,005879625L,005880469L,005880558L,005880971L,$
          005881202L,005881254L,005881591L,005881611L,005881612L,$
          005881614L,005881616L,005881617L,005881641L,005881643L,$
          005881644L,005881676L,005883521L,005890067L]
wfrlow = [300.00,400.00,1000.00,1500.00,1800.00,2000.00,1800.00,   $
          1500.00,1500.00,1500.00,1100.00,1000.00,700.00,800.00,   $
          900.00,700.00,700.00,900.00,800.00,600.00,600.00,1000.00,$
          650.00,300.00]
wfhigh = [900.00,1000.00,2000.00,3000.00,3500.00,3500.00,3600.00,  $
          3000.00,3000.00,2800.00,2900.00,2500.00,2100.00,2500.00, $
          2200.00,2100.00,2100.00,2200.00,2200.00,2500.00,2500.00, $
          2200.00,1800.00,800.00]

;----------------------------------------------------------
; => Date :  1998-12-14
;----------------------------------------------------------
wevnms = 0L
wfrlow = f
wfhigh = f

;----------------------------------------------------------
; => Date :  2000-04-09
;----------------------------------------------------------
wevnms = [27517033L,27517509L,27517553L,27517555L,27517702L,$
          27517706L,27517897L,27517935L,27518225L,27518298L,$
          27518330L,27518416L,27518420L,27518438L,27520153L,$
          27520198L,27520199L,27520201L,27520203L,27520205L,$
          27520209L,27520211L,27520215L,27520217L,27520603L,$
          27521445L,27524416L,27524827L,27524872L,27524948L,$
          27526384L,27528193L,27528224L,27530538L,27533667L]
wfrlow = [800.00,600.00,500.00,600.00,600.00,600.00,700.00,600.00,$
          600.00,700.00,600.00,500.00,600.00,500.00,600.00,800.00,$
          900.00,800.00,600.00,700.00,700.00,600.00,750.00,700.00,$
          700.00,900.00,1100.00,1100.00,1000.00,650.00,500.00,    $
          300.00,300.00,280.00,150.00]
wfhigh = [2400.00,1300.00,1300.00,1300.00,1400.00,1400.00,1300.00,$
          1300.00,1600.00,1400.00,1500.00,1300.00,1500.00,1200.00,$
          2100.00,1900.00,1900.00,2000.00,1800.00,1800.00,2000.00,$
          1700.00,1800.00,1800.00,2000.00,2100.00,2200.00,2200.00,$
          2100.00,2000.00,1100.00,700.00,700.00,600.00,390.00]

;----------------------------------------------------------
; => Date :  2000-05-03
;----------------------------------------------------------
wevnms = [321563L,321692L,321956L,325872L,325885L,325886L,325912L,$
          327884L,328348L,328363L,328364L,328435L]
wfrlow = [1000.00,1300.00,1200.00,1600.00,1800.00,1700.00,1900.00,$
          1100.00,600.00,700.00,700.00,600.00]
wfhigh = [3000.00,3000.00,2800.00,3100.00,3100.00,3200.00,3600.00,$
          2000.00,1300.00,1400.00,1600.00,1200.00]

;----------------------------------------------------------
; => Date :  2000-05-26
;----------------------------------------------------------
wevnms = [2326697L,2326699L,2326922L,2326924L,2327566L,2329716L,$
          2334667L,2336427L,2336781L,2338070L,2341573L,2342586L,$
          2345798L,2345846L,2345848L,2346174L,2346361L,2346681L,$
          2346766L,2346793L,2346856L,2346879L,2347042L,2347313L,$
          2347331L,2347341L,2347347L,2350062L,2350400L,2352004L,$
          2355626L,2367223L,2367225L]
wfrlow = [2800.00,2800.00,2500.00,2500.00,2000.00,1400.00,900.00,1500.00,$
          650.00,1400.00,800.00,1700.00,800.00,700.00,800.00,800.00,     $
          900.00,900.00,750.00,900.00,750.00,700.00,800.00,700.00,700.00,$
          700.00,750.00,500.00,500.00,1900.00,2000.00,1300.00,1300.00]
wfhigh = [3600.00,3600.00,3200.00,3200.00,3200.00,2100.00,1700.00,1900.00,$
          1900.00,2400.00,1800.00,2800.00,1800.00,2000.00,1700.00,2000.00,$
          1700.00,1800.00,1700.00,1700.00,1500.00,1800.00,1800.00,1700.00,$
          1800.00,1700.00,1800.00,1200.00,1200.00,2300.00,3000.00,1800.00,$
          1900.00]

;----------------------------------------------------------
; => Date :  2000-06-10
;----------------------------------------------------------
wevnms = [4115359L,4115388L,4115389L,4115408L,4115452L,4119018L,4119043L,$
          4119052L,4119059L,4119061L,4119085L,4119097L,4119131L,4119136L,$
          4119139L,4119160L,4119163L,4119344L,4119739L]
wfrlow = [200.00,220.00,200.00,200.00,200.00,200.00,200.00,200.00,200.00,$
          200.00,200.00,200.00,200.00,200.00,180.00,180.00,200.00,200.00,$
          250.00]
wfhigh = [700.00,600.00,700.00,650.00,700.00,600.00,600.00,600.00,600.00,$
          600.00,600.00,550.00,600.00,600.00,550.00,600.00,600.00,600.00,$
          800.00]

;----------------------------------------------------------
; => Date :  2000-06-26
;----------------------------------------------------------
wevnms = [5984359L,5990424L,5990425L,5990427L,5990499L,5990500L,5990503L,$
          5990519L,5990533L]
wfrlow = [1300.00,600.00,650.00,600.00,600.00,600.00,600.00,600.00,       $
          600.00]
wfhigh = [4000.00,1800.00,1700.00,1800.00,1800.00,1800.00,1800.00,1700.00,$
          1700.00]

;----------------------------------------------------------
; => Date :  2000-07-10
;----------------------------------------------------------
wevnms = [7509407L,7510704L,7510926L,7512459L,7544041L,7544044L,7544045L,$
          7544046L,7544047L,7544049L,7544050L,7544052L,7544053L,7544057L,$
          7544060L]
wfrlow = [500.00,75.00,80.00,200.00,600.00,850.00,1000.00,700.00,550.00,600.00,$
          450.00,580.00,480.00,500.00,430.00]
wfhigh = [780.00,140.00,130.00,600.00,2000.00,2000.00,2000.00,2000.00,2000.00, $
          2000.00,1900.00,2000.00,1800.00,1800.00,1700.00]

;----------------------------------------------------------
; => Date :  2000-07-23
;----------------------------------------------------------
wevnms = [9165187L,9166952L,9168486L,9168495L,9168549L,9168551L,9169329L,$
          9179909L,9187482L,9187488L,9187494L,9187516L,9187521L,9187598L,$
          9187603L,9187610L,9187646L,9187652L,9187653L,9187663L,9187669L,$
          9187728L,9187748L,9187754L,9187804L,9190911L]
wfrlow = [300.00,710.00,600.00,700.00,600.00,700.00,1300.00,1500.00,600.00,     $
          650.00,600.00,450.00,600.00,600.00,600.00,650.00,800.00,800.00,700.00,$
          700.00,750.00,600.00,700.00,600.00,700.00,500.00]
wfhigh = [1200.00,1700.00,1900.00,2000.00,1900.00,2000.00,2000.00,2100.00,$
          2400.00,2300.00,2300.00,2300.00,2400.00,2200.00,2300.00,2300.00,$
          2400.00,2500.00,2300.00,2400.00,2300.00,2300.00,2400.00,2600.00,$
          2600.00,1800.00]

;----------------------------------------------------------
; => Date :  2000-08-04
;----------------------------------------------------------
wevnms = [10769366L,10775642L,10775983L,10781409L,10784536L,10785106L,$
          10785194L,10785335L,10785573L,10785769L,10786025L,10786045L,$
          10786124L,10786281L,10786283L,10786402L,10786462L,10786525L,$
          10819474L]
wfrlow = [300.00,510.00,600.00,900.00,900.00,1000.00,1000.00,1100.00,     $
          1000.00,1000.00,1000.00,1000.00,1000.00,1000.00,1000.00,1000.00,$
          1000.00,1000.00,2000.00]
wfhigh = [750.00,1000.00,1100.00,1500.00,1900.00,1800.00,1800.00,1900.00, $
          1800.00,1800.00,2000.00,1800.00,1800.00,2000.00,2000.00,1800.00,$
          1700.00,1800.00,3100.00]

;----------------------------------------------------------
; => Date :  2000-08-15
;----------------------------------------------------------
wevnms = [12628272L,12632984L,12648230L,12648231L,12649051L,12649052L,$
          12687665L,12687669L]
wfrlow = [200.00,240.00,500.00,500.00,400.00,370.00,350.00,380.00]
wfhigh = [420.00,700.00,1100.00,1000.00,1400.00,1200.00,800.00,800.00]

;----------------------------------------------------------
; => Date :  2001-10-03
;----------------------------------------------------------
wevnms = [2276025L]
wfrlow = [50.00]
wfhigh = [210.00]

;----------------------------------------------------------
; => Date :  2001-10-24
;----------------------------------------------------------
wevnms = [3534932L,3534936L,3534992L,3542760L,3542790L,3542793L,3544727L,$
          3545843L,3546483L,3547585L,3549721L,3549724L,3549799L]
wfrlow = [70.000,80.000,58.000,70.000,60.000,60.000,60.000,80.000,70.000,$
          48.000,49.000,50.000,45.000]
wfhigh = [190.000,190.000,170.000,170.000,160.000,190.000,120.000,200.000,$
          150.000,110.000,100.000,110.000,90.000]

;----------------------------------------------------------
; => Date :  2001-11-15
;----------------------------------------------------------
wevnms = 0L
wfrlow = f
wfhigh = f

;----------------------------------------------------------
; => Date :  2002-07-20
;----------------------------------------------------------
wevnms = 0L
wfrlow = f
wfhigh = f

;----------------------------------------------------------
; => Date :  2002-10-10
;----------------------------------------------------------
wevnms = [9866555L,9877502L,9879903L,9880137L,9880910L,9883409L,9892487L,$
          9900719L,9901464L,9901466L,9901482L,9901502L,9901521L,9901524L,$
          9901527L,9901600L,9901613L,9901665L,9901799L,9901961L,9901974L,$
          9901997L,9902120L,9903793L,9903803L,9904466L,9907949L,9908377L,$
          9908379L,9911619L]
wfrlow = [1300.00,3900.00,6000.00,6000.00,4000.00,4000.00,2500.00,800.00,$
          800.00,600.00,600.00,700.00,750.00,550.00,600.00,500.00,700.00,$
          750.00,750.00,650.00,600.00,700.00,500.00,500.00,700.00,600.00,$
          350.00,350.00,460.00,4500.00]
wfhigh = [4900.00,9000.00,8000.00,9500.00,6000.00,9000.00,4000.00,1700.00,$
          1200.00,1600.00,1500.00,1300.00,1400.00,1300.00,1400.00,1300.00,$
          1500.00,1700.00,1400.00,1700.00,1700.00,1300.00,1300.00,1100.00,$
          1100.00,1100.00,900.00,800.00,800.00,6000.00]
'------------------------------------------------------------------------------------------------------------------'
' =>Orbit Plots w/ whistler locations [separated by region only]'
'------------------------------------------------------------------------------------------------------------------'
gdates = ['102698','111398','121498','040900','050300','052600','061000',$
          '062600','071000','072300','080400','081500','100301','102401',$
          '111501','072002','101002']

FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp_whist_orbit_region_plots,DATE=date[0]


'------------------------------------------------------------------------------------------------------------------'
' => Do not use finite Vph for test'
'------------------------------------------------------------------------------------------------------------------'

;-----------------------------------------------------------------------------------------
; => Determine statistics on wave amplitudes
;-----------------------------------------------------------------------------------------
test_wh  = all_stats_all_waves_read()
wscets   = STRTRIM(test_wh.SCETS,2)
wunix    = time_double(wscets)
wavetype = STRLOWCASE(STRTRIM(test_wh.WAVE_TYPE,2))
rectype  = STRLOWCASE(STRTRIM(test_wh.REC_TYPE,2))
; => Field information
alle_rms = test_wh.E_RMS
allb_rms = test_wh.B_RMS
whe_rms  = test_wh.EMAG_RMS
whb_rms  = test_wh.BMAG_RMS
whe_pk   = test_wh.EMAG_PK
whb_pk   = test_wh.BMAG_PK
; => Wind Location information
w_rad    = test_wh.WIND_RAD_DIST
w_lsh    = test_wh.WIND_L_SHELL
w_mlt    = test_wh.WIND_MLT
wgsm_pos = test_wh.GSM_POS
; => Calculate GSM Latitude
gratio   = wgsm_pos[*,2]/SQRT(wgsm_pos[*,0]^2 + wgsm_pos[*,1]^2)
gsm_lat  = ATAN(gratio)*18d1/!DPI
; => AE-Index information
ae_ind   = test_wh.AE_INDEX

; => Find Only Waves in Magnetosphere
wgood  = STRLOWCASE('Whistlers')
gdates = ['111398','040900','050300','052600','061000','062600','071000',$
          '072300','080400','081500','100301','102401','101002']
FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp       = orbit_region_time_range(DATE=date[0])                                       & $
  tr_m       = time_double(temp.MAGNETOSPHERE)                                             & $
  testm      = (wunix LE tr_m[1] AND wunix GT tr_m[0]) AND (wavetype EQ wgood[0])          & $
  good_m0    = WHERE(testm,gdm0)                                                           & $
  IF (gdm0 GT 0 AND j EQ 0) THEN good_m = good_m0                                          & $
  IF (gdm0 GT 0 AND j GT 0) THEN good_m = [good_m,good_m0]

; => Limit to L < 15
lshell   = 15.
l_string = STRTRIM(STRING(lshell,FORMAT='(f12.1)'),2L)
test_l   = (w_lsh[good_m] LE lshell[0])
good0    = WHERE(test_l,gd0)
PRINT, gd0
; => For L < 15
;         257
good_m   = good_m[good0]

wscets   = wscets[good_m]
wunix    = wunix[good_m]
wavetype = wavetype[good_m]
rectype  = rectype[good_m]

whe_rms  = whe_rms[good_m]
whb_rms  = whb_rms[good_m]
alle_rms = alle_rms[good_m,*]
allb_rms = allb_rms[good_m,*]
whe_pk   = whe_pk[good_m]
whb_pk   = whb_pk[good_m]

w_rad    = w_rad[good_m]
w_lsh    = w_lsh[good_m]
w_mlt    = w_mlt[good_m]
wgsm_pos = wgsm_pos[good_m,*]
gsm_lat  = gsm_lat[good_m]
ae_ind   = ae_ind[good_m]
; => Remove incomplete TDS Samples [i.e. TDS with < 2 components]
exrms    = alle_rms[*,0]
eyrms    = alle_rms[*,1]
ezrms    = alle_rms[*,2]
bxrms    = allb_rms[*,0]
byrms    = allb_rms[*,1]
bzrms    = allb_rms[*,2]

test_f   = (rectype EQ 'tdsf') AND ((exrms GT 0.) AND (eyrms GT 0.))

test_e0  = ((exrms GT 0.) AND (eyrms GT 0.) AND (ezrms GT 0.))
test_b0  = ((bxrms GT 0.) AND (byrms GT 0.) AND (bzrms GT 0.))
test_s   = (rectype EQ 'tdss') AND (test_e0 OR test_b0)

good_f   = WHERE(test_f,gdf)
good_s   = WHERE(test_s,gds)
PRINT, gdf, gds
; => For L < 15
;         185          68
good_all = [good_f,good_s]
sp       = SORT(good_all)
good_all = good_all[sp]

wscets   = wscets[good_all]
wunix    = wunix[good_all]
wavetype = wavetype[good_all]
rectype  = rectype[good_all]

whe_rms  = whe_rms[good_all]
whb_rms  = whb_rms[good_all]
whe_pk   = whe_pk[good_all]
whb_pk   = whb_pk[good_all]

w_rad    = w_rad[good_all]
w_lsh    = w_lsh[good_all]
w_mlt    = w_mlt[good_all]
wgsm_pos = wgsm_pos[good_all,*]
gsm_lat  = gsm_lat[good_all]
ae_ind   = ae_ind[good_all]

good_nt     = WHERE(rectype EQ 'tdss',gdnt,COMPLEMENT=good_mv,NCOMPLEMENT=gdmv)
PRINT, gdnt, gdmv
;          68         185

HELP, ae_ind, WHERE(ae_ind GE 1e2), WHERE(ae_ind GE 2e2), WHERE(ae_ind GE 3e2), $
              WHERE(ae_ind GE 4e2), WHERE(ae_ind GE 5e2), WHERE(ae_ind GE 6e2), $
              WHERE(ae_ind GE 7e2), WHERE(ae_ind GE 8e2), WHERE(ae_ind GE 9e2)
;-----------------------------------------------------------------------------------------
;AE_IND          FLOAT     = Array[253]
;<Expression>    LONG      = Array[202]
;<Expression>    LONG      = Array[162]
;<Expression>    LONG      = Array[156]
;<Expression>    LONG      = Array[123]
;<Expression>    LONG      = Array[95]
;<Expression>    LONG      = Array[58]
;<Expression>    LONG      = Array[46]
;<Expression>    LONG      = Array[40]
;<Expression>    LONG      = Array[5]
;-----------------------------------------------------------------------------------------

HELP, ae_ind, WHERE(ae_ind GE 1e1 AND ae_ind LT 2e2), $
              WHERE(ae_ind GE 2e2 AND ae_ind LT 4e2), $
              WHERE(ae_ind GE 4e2 AND ae_ind LT 6e2), $
              WHERE(ae_ind GE 6e2 AND ae_ind LT 8e2), $
              WHERE(ae_ind GE 8e2 AND ae_ind LT 1e3), $
              WHERE(ae_ind GE 6e2 AND ae_ind LT 1e3)
;-----------------------------------------------------------------------------------------
;AE_IND          FLOAT     = Array[253]
;<Expression>    LONG      = Array[91]
;<Expression>    LONG      = Array[39]
;<Expression>    LONG      = Array[65]
;<Expression>    LONG      = Array[18]
;<Expression>    LONG      = Array[36]
;<Expression>    LONG      = Array[54]
;-----------------------------------------------------------------------------------------

;---------------------------
; => Remove outliers...
;---------------------------
awhe_pk   = whe_pk
awhb_pk   = whb_pk
awhe_min  = 2.0
awhb_min  = 0.1
good_wemv = WHERE(awhe_pk GE awhe_min)
good_wbnt = WHERE(awhb_pk GE awhb_min)
HELP, good_wemv, good_wbnt
;GOOD_WEMV       LONG      = Array[227]
;GOOD_WBNT       LONG      = Array[54]

he_ae_ind = ae_ind[good_wemv]
hb_ae_ind = ae_ind[good_wbnt]

h_awhe_pk = awhe_pk[good_wemv]
h_awhb_pk = awhb_pk[good_wbnt]


els_0nt  = [N_ELEMENTS(WHERE(hb_ae_ind GE 1e2)), N_ELEMENTS(WHERE(hb_ae_ind GE 2e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 3e2)), N_ELEMENTS(WHERE(hb_ae_ind GE 4e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 5e2)), N_ELEMENTS(WHERE(hb_ae_ind GE 6e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 7e2))]

els_1nt  = [N_ELEMENTS(WHERE(hb_ae_ind GE 1e1 AND hb_ae_ind LT 2e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 2e2 AND hb_ae_ind LT 4e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 4e2 AND hb_ae_ind LT 6e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 8e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 8e2 AND hb_ae_ind LT 1e3)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 1e3))  ]

els_0mv  = [N_ELEMENTS(WHERE(he_ae_ind GE 1e2)), N_ELEMENTS(WHERE(he_ae_ind GE 2e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 3e2)), N_ELEMENTS(WHERE(he_ae_ind GE 4e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 5e2)), N_ELEMENTS(WHERE(he_ae_ind GE 6e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 7e2))]

els_1mv  = [N_ELEMENTS(WHERE(he_ae_ind GE 1e1 AND he_ae_ind LT 2e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 2e2 AND he_ae_ind LT 4e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 4e2 AND he_ae_ind LT 6e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 8e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 8e2 AND he_ae_ind LT 1e3)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 1e3))  ]

nums_ae  = STRTRIM(STRING([N_ELEMENTS(hb_ae_ind),N_ELEMENTS(he_ae_ind)],FORMAT='(I3.3)'),2)
suffx    = '     => For AE > '
temp_aes = FINDGEN(7)*100 + 1e2
straes   = STRMID(STRTRIM(STRING(FORMAT='(f10.0)',temp_aes),2),0,3)
strelsnt = STRTRIM(STRING(FORMAT='(I3.3)',els_0nt),2)
strelsmv = STRTRIM(STRING(FORMAT='(I3.3)',els_0mv),2)

suffxsnt = suffx[0]+straes[*]+' nT  ['+strelsnt[*]+'/'+nums_ae[0]+']'
suffxsmv = suffx[0]+straes[*]+' nT  ['+strelsmv[*]+'/'+nums_ae[1]+']'

tempnt0  = DBLARR(7)
tempmv0  = DBLARR(7)
temsnt0  = DBLARR(7)
temsmv0  = DBLARR(7)
temprab0 = DBLARR(7,2)
temprae0 = DBLARR(7,2)
FOR j=0L, 6L DO BEGIN $
  indsb      = WHERE(hb_ae_ind GE temp_aes[j])  & $
  indse      = WHERE(he_ae_ind GE temp_aes[j])  & $
  temprab0[j,*] = minmax(h_awhb_pk[indsb],/POS) & $
  temprae0[j,*] = minmax(h_awhe_pk[indse],/POS) & $
  tempnt0[j] = MEAN(h_awhb_pk[indsb],/NAN)      & $
  tempmv0[j] = MEAN(h_awhe_pk[indse],/NAN)      & $
  temsnt0[j] = STDDEV(h_awhb_pk[indsb],/NAN)    & $
  temsmv0[j] = STDDEV(h_awhe_pk[indse],/NAN)

FOR j=0L, 6L DO BEGIN $
  PRINT,FORMAT='(";",4f16.7,a34)', REFORM(temprab0[j,*]),tempnt0[j],temsnt0[j],suffxsnt[j]


FOR j=0L, 6L DO BEGIN $
  PRINT,FORMAT='(";",4f16.7,a34)', REFORM(temprae0[j,*]),tempmv0[j],temsmv0[j],suffxsmv[j]

;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;        Min (nT)        Max (nT)       Mean (nT)     Std. Dev. (nT)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.1593120       5.5442600       1.0941676       1.2594575     => For AE > 100 nT  [045/054]
;       0.1593120       5.5442600       1.1000233       1.2049966     => For AE > 200 nT  [039/054]
;       0.3670340       5.5442600       1.1743185       1.2467125     => For AE > 300 nT  [035/054]
;       0.4994340       1.7921400       0.9148500       0.3612281     => For AE > 400 nT  [024/054]
;       0.4994340       1.7921400       0.8995415       0.3533774     => For AE > 500 nT  [018/054]
;       0.4994340       1.7921400       0.8565089       0.3626086     => For AE > 600 nT  [015/054]
;       0.4994340       1.0348600       0.7354110       0.1748524     => For AE > 700 nT  [013/054]
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;      Min  (mV/m)     Max  (mV/m)    Mean (mV/m)   Std. Dev. (mV/m)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       2.2608400     329.0130000      69.1638303      66.2532994     => For AE > 100 nT  [188/227]
;       2.4947300     329.0130000      76.3745787      71.3040116     => For AE > 200 nT  [151/227]
;       2.4947300     329.0130000      79.0808719      71.4493690     => For AE > 300 nT  [145/227]
;       2.4947300     329.0130000      70.4736111      64.5750887     => For AE > 400 nT  [113/227]
;       2.4947300     329.0130000      77.5490983      68.0536234     => For AE > 500 nT  [089/227]
;       2.4947300     184.6960000      50.3224985      43.1828157     => For AE > 600 nT  [052/227]
;       2.4947300      95.2627000      37.6129100      27.0371351     => For AE > 700 nT  [042/227]
;-----------------------------------------------------------------------------------------

PRINT,TRANSPOSE(tempnt0)
PRINT,TRANSPOSE(tempmv0)
PRINT,TRANSPOSE(temsnt0)
PRINT,TRANSPOSE(temsmv0)

; => Mean                          :  defines the average of a distribution of data
meannt0  = [ 1.0941676, 1.1000233, 1.1743185,0.91485004,0.89954150,0.85650887,0.73541100]
meanmv0  = [69.163830 ,76.374579 ,79.080872 ,70.473611 ,77.549098 ,50.322498 ,37.612910 ]
; => Standard Deviation            :  defines the variation(dispersion) from the mean
stdvsnt0 = [ 1.2594575, 1.2049966, 1.2467125,0.36122812,0.35337737,0.36260856,0.17485243]
stdvsmv0 = [66.253299,71.304012,71.449369,64.575089,68.053623,43.182816,27.037135]


temp_ael = [1e1,2e2,4e2,6e2,8e2,6e2]
temp_aeh = [2e2,4e2,6e2,8e2,1e3,1e3]
straesl  = STRMID(STRTRIM(STRING(FORMAT='(f10.0)',temp_ael),2),0,3)
straesh  = STRMID(STRTRIM(STRING(FORMAT='(f10.0)',temp_aeh),2),0,3)
strelsnt = STRTRIM(STRING(FORMAT='(I3.3)',els_1nt),2)
strelsmv = STRTRIM(STRING(FORMAT='(I3.3)',els_1mv),2)
suffx    = '     => For '
suffxsnt = suffx[0]+straesl[*]+' nT < AE < '+straesh[*]+' nT  ['+strelsnt[*]+'/'+nums_ae[0]+']'
suffxsmv = suffx[0]+straesl[*]+' nT < AE < '+straesh[*]+' nT  ['+strelsmv[*]+'/'+nums_ae[1]+']'

tempnt1  = DBLARR(6)
tempmv1  = DBLARR(6)
temsnt1  = DBLARR(6)
temsmv1  = DBLARR(6)
temprab1 = DBLARR(6,2)
temprae1 = DBLARR(6,2)
FOR j=0L, 5L DO BEGIN $
  indsb = WHERE(hb_ae_ind GE temp_ael[j] AND hb_ae_ind LT temp_aeh[j])  & $
  indse = WHERE(he_ae_ind GE temp_ael[j] AND he_ae_ind LT temp_aeh[j])  & $
  temprab1[j,*] = minmax(h_awhb_pk[indsb],/POS) & $
  temprae1[j,*] = minmax(h_awhe_pk[indse],/POS) & $
  tempnt1[j] = MEAN(h_awhb_pk[indsb],/NAN)      & $
  tempmv1[j] = MEAN(h_awhe_pk[indse],/NAN)      & $
  temsnt1[j] = STDDEV(h_awhb_pk[indsb],/NAN)    & $
  temsmv1[j] = STDDEV(h_awhe_pk[indse],/NAN)

FOR j=0L, 5L DO BEGIN $
  PRINT,FORMAT='(";",4f16.7,a43)', REFORM(temprab1[j,*]),tempnt1[j],temsnt1[j],suffxsnt[j]


FOR j=0L, 5L DO BEGIN $
  PRINT,FORMAT='(";",4f16.7,a43)', REFORM(temprae1[j,*]),tempmv1[j],temsmv1[j],suffxsmv[j]

;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;        Min (nT)        Max (nT)       Mean (nT)     Std. Dev. (nT)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.1144720       4.5163500       0.5944332       1.0977110     => For 10. nT < AE < 200 nT  [015/054]
;       0.1593120       5.5442600       1.3963005       1.8904993     => For 200 nT < AE < 400 nT  [015/054]
;       0.5502990       1.6872600       1.0120853       0.3578119     => For 400 nT < AE < 600 nT  [009/054]
;       1.4951500       1.7921400       1.6436450       0.2100036     => For 600 nT < AE < 800 nT  [002/054]
;       0.4994340       1.0348600       0.7354110       0.1748524     => For 800 nT < AE < 100 nT  [013/054]
;       0.4994340       1.7921400       0.8565089       0.3626086     => For 600 nT < AE < 100 nT  [015/054]
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;      Min  (mV/m)     Max  (mV/m)    Mean (mV/m)   Std. Dev. (mV/m)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       2.1923500      75.0792000      30.2825425      20.3055508     => For 10. nT < AE < 200 nT  [076/227]
;       2.8530400     294.9790000      93.9221929      86.9871168     => For 200 nT < AE < 400 nT  [038/227]
;       7.8677300     329.0130000      87.6516087      74.4776675     => For 400 nT < AE < 600 nT  [061/227]
;       2.4947300     184.6960000      79.1133340      60.3003369     => For 600 nT < AE < 800 nT  [015/227]
;      12.0275000      95.2627000      39.9441943      27.2767664     => For 800 nT < AE < 100 nT  [035/227]
;       2.4947300     184.6960000      51.6949362      43.4041054     => For 600 nT < AE < 100 nT  [050/227]
;-----------------------------------------------------------------------------------------

PRINT,TRANSPOSE(tempnt1)
PRINT,TRANSPOSE(tempmv1)
PRINT,TRANSPOSE(temsnt1)
PRINT,TRANSPOSE(temsmv1)

; => Mean                          :  defines the average of a distribution of data
meannt1  = [0.59443320, 1.3963005, 1.0120853, 1.6436450,0.73541100,0.85650887]
meanmv1  = [30.282542,93.922193,87.651609,79.113334,39.944194,51.694936]
; => Standard Deviation            :  defines the variation(dispersion) from the mean
stdvsnt1 = [ 1.0977110, 1.8904993,0.35781194,0.21000364,0.17485243,0.36260856]
stdvsmv1 = [20.305551,86.987117,74.477667,60.300337,27.276766,43.404105]

; => Standard Deviation of the Mean:  defines the the accuracy of the mean
stdvsntmn0 = stdvsnt0/SQRT(N_ELEMENTS(hb_ae_ind))
stdvsmvmn0 = stdvsmv0/SQRT(N_ELEMENTS(he_ae_ind))
stdvsntmn1 = stdvsnt1/SQRT(N_ELEMENTS(hb_ae_ind))
stdvsmvmn1 = stdvsmv1/SQRT(N_ELEMENTS(he_ae_ind))

str_nt0    = STRTRIM(STRING(meannt0,FORMAT='(f14.4)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsntmn0,FORMAT='(f14.4,";   ")'),2)
str_nt1    = STRTRIM(STRING(meannt1,FORMAT='(f14.4)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsntmn1,FORMAT='(f14.4,";   ")'),2)
str_mv0    = STRTRIM(STRING(meanmv0,FORMAT='(f14.3)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsmvmn0,FORMAT='(f14.4,";   ")'),2)
str_mv1    = STRTRIM(STRING(meanmv1,FORMAT='(f14.3)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsmvmn1,FORMAT='(f14.4,";   ")'),2)

print, str_nt0, FORMAT='(";",7a19)'
print, str_mv0, FORMAT='(";",7a19)'
;-------------------------------------------------------------------------------------------------------------------------------------
; => For AE >
;        100 nT             200 nT             300 nT             400 nT             500 nT             600 nT             700 nT
;-------------------------------------------------------------------------------------------------------------------------------------
;   1.0942+/-0.1714;   1.1000+/-0.1640;   1.1743+/-0.1697;   0.9149+/-0.0492;   0.8995+/-0.0481;   0.8565+/-0.0493;   0.7354+/-0.0238;
;   ==================================================================================================================================
;   69.164+/-4.3974;   76.375+/-4.7326;   79.081+/-4.7423;   70.474+/-4.2860;   77.549+/-4.5169;   50.322+/-2.8661;   37.613+/-1.7945;
;-------------------------------------------------------------------------------------------------------------------------------------

print, str_nt1, FORMAT='(";",6a19)'
print, str_mv1, FORMAT='(";",6a19)'
;------------------------------------------------------------------------------------------------------------------
; => For AE (nT) between
;       10 & 200           200 & 400         400 & 600         600 & 800           800 & 1000         600 & 1000
;------------------------------------------------------------------------------------------------------------------
;   0.5944+/-0.1494;   1.3963+/-0.2573;   1.0121+/-0.0487;   1.6436+/-0.0286;   0.7354+/-0.0238;   0.8565+/-0.0493;
;   ===============================================================================================================
;   30.283+/-1.3477;   93.922+/-5.7735;   87.652+/-4.9433;   79.113+/-4.0023;   39.944+/-1.8104;   51.695+/-2.8808;
;------------------------------------------------------------------------------------------------------------------


;-----------------------------------------------------------------------------------------
; => Determine statistics on wave amplitudes
;-----------------------------------------------------------------------------------------
R_E      = 6.37814d3         ; => Earth's Equitorial Radius (km)
test_wh  = all_stats_all_waves_read()
wscets   = STRTRIM(test_wh.SCETS,2)
wunix    = time_double(wscets)
wavetype = STRLOWCASE(STRTRIM(test_wh.WAVE_TYPE,2))
rectype  = STRLOWCASE(STRTRIM(test_wh.REC_TYPE,2))
; => Field information
alle_rms = test_wh.E_RMS
allb_rms = test_wh.B_RMS
whe_rms  = test_wh.EMAG_RMS
whb_rms  = test_wh.BMAG_RMS
whe_pk   = test_wh.EMAG_PK
whb_pk   = test_wh.BMAG_PK
; => Wind Location information
w_rad    = test_wh.WIND_RAD_DIST
w_lsh    = test_wh.WIND_L_SHELL
w_mlt    = test_wh.WIND_MLT
wgsm_pos = test_wh.GSM_POS
; => Calculate GSM Latitude
gratio   = wgsm_pos[*,2]/SQRT(wgsm_pos[*,0]^2 + wgsm_pos[*,1]^2)
gsm_lat  = ATAN(gratio)*18d1/!DPI
; => AE-Index information
ae_ind   = test_wh.AE_INDEX

; => Find Only Waves in Magnetosphere
wgood  = STRLOWCASE('Whistlers')
gdates = ['111398','040900','050300','052600','061000','062600','071000',$
          '072300','080400','081500','100301','102401','101002']
FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp       = orbit_region_time_range(DATE=date[0])                                       & $
  tr_m       = time_double(temp.MAGNETOSPHERE)                                             & $
  testm      = (wunix LE tr_m[1] AND wunix GT tr_m[0]) AND (wavetype EQ wgood[0])          & $
  good_m0    = WHERE(testm,gdm0)                                                           & $
  IF (gdm0 GT 0 AND j EQ 0) THEN good_m = good_m0                                          & $
  IF (gdm0 GT 0 AND j GT 0) THEN good_m = [good_m,good_m0]

; => Limit to L < 15
lshell   = 15.
l_string = STRTRIM(STRING(lshell,FORMAT='(f12.1)'),2L)
test_l   = (w_lsh[good_m] LE lshell[0])
good0    = WHERE(test_l,gd0)
PRINT, gd0
; => For L < 15
;         257
good_m   = good_m[good0]

wscets   = wscets[good_m]
wunix    = wunix[good_m]
wavetype = wavetype[good_m]
rectype  = rectype[good_m]

whe_rms  = whe_rms[good_m]
whb_rms  = whb_rms[good_m]
alle_rms = alle_rms[good_m,*]
allb_rms = allb_rms[good_m,*]
whe_pk   = whe_pk[good_m]
whb_pk   = whb_pk[good_m]

w_rad    = w_rad[good_m]
w_lsh    = w_lsh[good_m]
w_mlt    = w_mlt[good_m]
wgsm_pos = wgsm_pos[good_m,*]
gsm_lat  = gsm_lat[good_m]
ae_ind   = ae_ind[good_m]
; => Remove incomplete TDS Samples [i.e. TDS with < 2 components]
exrms    = alle_rms[*,0]
eyrms    = alle_rms[*,1]
ezrms    = alle_rms[*,2]
bxrms    = allb_rms[*,0]
byrms    = allb_rms[*,1]
bzrms    = allb_rms[*,2]

test_f   = (rectype EQ 'tdsf') AND ((exrms GT 0.) AND (eyrms GT 0.))

test_e0  = ((exrms GT 0.) AND (eyrms GT 0.) AND (ezrms GT 0.))
test_b0  = ((bxrms GT 0.) AND (byrms GT 0.) AND (bzrms GT 0.))
test_s   = (rectype EQ 'tdss') AND (test_e0 OR test_b0)

good_f   = WHERE(test_f,gdf)
good_s   = WHERE(test_s,gds)
PRINT, gdf, gds
; => For L < 15
;         185          68
good_all = [good_f,good_s]
sp       = SORT(good_all)
good_all = good_all[sp]

wscets   = wscets[good_all]
wunix    = wunix[good_all]
wavetype = wavetype[good_all]
rectype  = rectype[good_all]

whe_rms  = whe_rms[good_all]
whb_rms  = whb_rms[good_all]
whe_pk   = whe_pk[good_all]
whb_pk   = whb_pk[good_all]

w_rad    = w_rad[good_all]
w_lsh    = w_lsh[good_all]
w_mlt    = w_mlt[good_all]
wgsm_pos = wgsm_pos[good_all,*]
gsm_lat  = gsm_lat[good_all]
ae_ind   = ae_ind[good_all]

a_bpks   = whb_pk
a_epks   = whe_pk

help, where(a_epks GT 0.), where(a_bpks GT 0.)
;<Expression>    LONG      = Array[253]
;<Expression>    LONG      = Array[68]

zgsmpos   = REFORM(wgsm_pos[*,2])/R_e
help, where(ABS(zgsmpos) LE 2.), where(ABS(gsm_lat) LE 10.)
;<Expression>    LONG      = Array[245]
;<Expression>    LONG      = Array[172]
PRINT, (N_ELEMENTS(where(ABS(zgsmpos) LE 2.))*1d0)/(N_ELEMENTS(good_all)*1d0)*1d2,$
       (N_ELEMENTS(where(ABS(gsm_lat) LE 10.))*1d0)/(N_ELEMENTS(good_all)*1d0)*1d2
;       96.837945       67.984190

good_100  = WHERE(a_epks GE 100.,gd100)
good_1    = WHERE(a_bpks GE 1.,gd1)
print, gd100, gd1
; => For L < 15
;          45          13

print, minmax(w_lsh[good_100]), minmax(w_lsh[good_1])
; => For L < 15
;      3.76100      5.78300
;      4.02700      9.58400

good_50   = WHERE(a_epks GE 50.,gd50)
good_05   = WHERE(a_bpks GE 0.5,gd05)
print, gd50, gd05
; => For L < 15
;          94          35
print, minmax(w_lsh[good_50]), minmax(w_lsh[good_05])
; => For L < 15
;      3.76100      6.32600
;      4.02700      9.58400

good_30   = WHERE(a_epks GE 30.,gd30)
good_03   = WHERE(a_bpks GE 0.3,gd03)
print, gd30, gd03
; => For L < 15
;         126          44
print, minmax(w_lsh[good_30]), minmax(w_lsh[good_03])
; => For L < 15
;      3.69600      9.21100
;      4.02700      11.2550

good_40   = WHERE(a_epks GE 40.,gd40)
good_04   = WHERE(a_bpks GE 0.4,gd04)
print, gd40, gd04
; => For L < 15
;         107          39
print, minmax(w_lsh[good_40]), minmax(w_lsh[good_04])
; => For L < 15
;      3.69700      6.43900
;      4.02700      9.58400

badd_30   = WHERE(a_epks LT 30.,bd30)
badd_03   = WHERE(a_bpks LT 0.3 AND a_bpks GT 0.,bd03)
print, bd30, bd03
; => For L < 15
;         127          24
print, minmax(w_lsh[badd_30]), minmax(w_lsh[badd_03])
; => For L < 15
;      3.69300      14.1300
;      5.61600      11.0150

mlt_lon   = w_mlt*36d1/24d0
; => Scale MLTs to make them appropriate for Polar Coordinate outputs
;      => 0 deg is at Midnight

good_nt     = WHERE(rectype EQ 'tdss',gdnt,COMPLEMENT=good_mv,NCOMPLEMENT=gdmv)
PRINT, gdnt, gdmv
; => For L < 15
;          68         185

w_lsh_nt    = w_lsh[good_nt]
w_rad_nt    = w_rad[good_nt]
w_mlt_lnt   = mlt_lon[good_nt]
w_mlt_nt    = w_mlt[good_nt]
a_bpks_nt   = a_bpks[good_nt]
a_epks_nt   = a_epks[good_nt]

w_lsh_mv    = w_lsh[good_mv]
w_rad_mv    = w_rad[good_mv]
w_mlt_lmv   = mlt_lon[good_mv]
w_mlt_mv    = w_mlt[good_mv]
a_epks_mv   = a_epks[good_mv]
a_bpks_mv   = a_bpks[good_mv]


good_100mv  = WHERE(a_epks_mv GE 100.,gd100mv)
good_05nt   = WHERE(a_epks_nt GE 0.5,gd05nt)
good_1nT    = WHERE(a_bpks_nt GE 1.,gd1nT)
print, gd100mv, gd05nt, gd1nT
; => For L < 15
;          42          66          13
print, minmax(w_lsh_mv[good_100mv]), minmax(w_lsh_nt[good_05nt]), minmax(w_lsh_nt[good_1nT])
; => For L < 15
;      3.76100      5.78300
;      4.02700      11.2550
;      4.02700      9.58400


test_mean = [mean(w_mlt_lmv[good_100mv],/nan), mean(w_mlt_lnt[good_05nt],/nan), $
             mean(w_mlt_lnt[good_1nT],/nan)]
test_stde = [stddev(w_mlt_lmv[good_100mv],/nan), stddev(w_mlt_lnt[good_05nt],/nan), $
             stddev(w_mlt_lnt[good_1nT],/nan)]
test_str  = STRTRIM(STRING(test_mean,FORMAT='(f15.2)'),2)+$
            ' +/- '+STRTRIM(STRING(test_stde,FORMAT='(f15.2)'),2)+',  '
print, test_str
; => For L < 15
;  70.14 +/- 109.80,   141.05 +/- 125.11,   98.22 +/- 125.99,  

good_30mv   = WHERE(a_epks_mv GE 30.,gd30mv)
good_50mv   = WHERE(a_epks_mv GE 50.,gd50mv)
good_03nt   = WHERE(a_epks_nt GE 0.3,gd03nt)
good_05nT   = WHERE(a_bpks_nt GE 0.5,gd05nT)
print, gd30mv, gd50mv, gd03nt, gd05nT
; => For L < 15
;         114          86          68          35
print, minmax(w_lsh_mv[good_30mv]), minmax(w_lsh_mv[good_50mv])
; => For L < 15
;      3.69600      9.21100
;      3.76100      6.32600
print, minmax(w_lsh_nt[good_03nt]), minmax(w_lsh_nt[good_05nT])
; => For L < 15
;      4.02700      11.2550
;      4.02700      9.58400




;-----------------------------------------------------------------------------------------
; => Determine statistics on Lambda_GSM and Theta_kB 
;-----------------------------------------------------------------------------------------
test_wh  = all_stats_all_waves_read()

wscets   = STRTRIM(test_wh.SCETS,2)
nall     = N_ELEMENTS(wscets)
wunix    = time_double(wscets)
wavetype = STRLOWCASE(STRTRIM(test_wh.WAVE_TYPE,2))
rectype  = STRLOWCASE(STRTRIM(test_wh.REC_TYPE,2))
w_rad    = test_wh.WIND_RAD_DIST
w_lsh    = test_wh.WIND_L_SHELL
w_mlt    = test_wh.WIND_MLT

alle_rms = test_wh.E_RMS
allb_rms = test_wh.B_RMS
exrms    = alle_rms[*,0]
eyrms    = alle_rms[*,1]
ezrms    = alle_rms[*,2]
bxrms    = allb_rms[*,0]
byrms    = allb_rms[*,1]
bzrms    = allb_rms[*,2]

evalmin  = test_wh.EIG_VALS[*,0]
evalmid  = test_wh.EIG_VALS[*,1]
evalmax  = test_wh.EIG_VALS[*,2]
emidmin  = evalmid/evalmin

pos_xgsm = test_wh.GSM_POS[*,0]
pos_ygsm = test_wh.GSM_POS[*,1]
pos_zgsm = test_wh.GSM_POS[*,2]
pos_wgsm = [[pos_xgsm],[pos_ygsm],[pos_zgsm]]
pos_ugsm = pos_wgsm/(SQRT(TOTAL(pos_wgsm^2,2,/NAN)) # REPLICATE(1d0,nall))
; => Define the GSE DC B-fields
gse_magf = test_wh.WI_B3_GSE
ugsemagf = gse_magf/( SQRT(TOTAL(gse_magf^2,2,/NAN)) # REPLICATE(1d0,nall) )
; => Define k-Vector GSE 
kxgse    = test_wh.MIN_EIG_VEC[*,0]
kygse    = test_wh.MIN_EIG_VEC[*,1]
kzgse    = test_wh.MIN_EIG_VEC[*,2]
kgse     = [[kxgse],[kygse],[kzgse]]

; => Define Theta_kB
kdotb    = my_dot_prod(ugsemagf,kgse,/NOM)
thetakB  = ACOS(kdotb)*18d1/!DPI
thetakB  = thetakB < (18d1 - thetakB)


test_e0  = ((exrms GT 0.) AND (eyrms GT 0.) AND (ezrms GT 0.))
test_b0  = ((bxrms GT 0.) AND (byrms GT 0.) AND (bzrms GT 0.))
test_s   = (rectype EQ 'tdss') AND (test_e0 OR test_b0)

good_s   = WHERE(test_s,gds)
PRINT, gds
;         332

wscets   = wscets[good_s]
nall     = gds
wunix    = wunix[good_s]
wavetype = wavetype[good_s]
rectype  = rectype[good_s]
w_rad    = w_rad[good_s]
w_lsh    = w_lsh[good_s]
w_mlt    = w_mlt[good_s]

alle_rms = alle_rms[good_s,*]
allb_rms = allb_rms[good_s,*]

evalmin  = evalmin[good_s]
evalmid  = evalmid[good_s]
evalmax  = evalmax[good_s]
emidmin  = emidmin[good_s]

pos_wgsm = pos_wgsm[good_s,*]
pos_ugsm = pos_ugsm[good_s,*]
kgse     = kgse[good_s,*]
gse_magf = gse_magf[good_s,*]
thetakB  = thetakB[good_s]

wgood  = STRLOWCASE('Whistlers')
gdates = ['111398','040900','050300','052600','061000','062600','071000',$
          '072300','080400','081500','100301','102401','101002']
FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp       = orbit_region_time_range(DATE=date[0])                                       & $
  tr_m       = time_double(temp.MAGNETOSPHERE)                                             & $
  testm      = (wunix LE tr_m[1] AND wunix GT tr_m[0]) AND (wavetype EQ wgood[0])          & $
  good_m0    = WHERE(testm,gdm0)                                                           & $
  IF (gdm0 GT 0 AND j EQ 0) THEN good_m = good_m0                                          & $
  IF (gdm0 GT 0 AND j GT 0) THEN good_m = [good_m,good_m0]

; => Limit to L < 15
lshell   = 15.
l_string = STRTRIM(STRING(lshell,FORMAT='(f12.1)'),2L)
test_l   = (w_lsh[good_m] LE lshell[0])
good0    = WHERE(test_l,gd0)
PRINT, gd0
;          68
good_m   = good_m[good0]

wscets   = wscets[good_m]
wunix    = wunix[good_m]
wavetype = wavetype[good_m]
rectype  = rectype[good_m]

w_rad    = w_rad[good_m]
w_lsh    = w_lsh[good_m]
w_mlt    = w_mlt[good_m]

alle_rms = alle_rms[good_m,*]
allb_rms = allb_rms[good_m,*]
bxrms    = allb_rms[*,0]
byrms    = allb_rms[*,1]
bzrms    = allb_rms[*,2]
exrms    = alle_rms[*,0]
eyrms    = alle_rms[*,1]
ezrms    = alle_rms[*,2]

evalmin  = evalmin[good_m]
evalmid  = evalmid[good_m]
evalmax  = evalmax[good_m]
emidmin  = emidmin[good_m]
emidmin0 = emidmin

pos_wgsm = pos_wgsm[good_m,*]
pos_ugsm = pos_ugsm[good_m,*]
kgse     = kgse[good_m,*]
gse_magf = gse_magf[good_m,*]
thetakB  = thetakB[good_m]
thetakB0 = thetakB

test_e2  = ((exrms GT 0.) AND (eyrms GT 0.) AND (ezrms GT 0.))
test_b2  = ((bxrms GT 0.) AND (byrms GT 0.) AND (bzrms GT 0.))
test_s2  = (rectype EQ 'tdss') AND test_b2 AND (emidmin GE 5d0)
test_s3  = (rectype EQ 'tdss') AND (test_b2 OR test_e2) AND (emidmin GE 5d0)
test_s4  = (rectype EQ 'tdss') AND (test_b2 OR test_e2) AND (emidmin GE 3d0)

good_s2  = WHERE(test_s2,gds2)
good_s3  = WHERE(test_s3,gds3)
good_s4  = WHERE(test_s4,gds4)
PRINT, gds2, gds3, gds4
;          50          54          60

wscets   = wscets[good_s2]
nall     = gds2
wunix    = wunix[good_s2]
wavetype = wavetype[good_s2]
rectype  = rectype[good_s2]
w_rad    = w_rad[good_s2]
w_lsh    = w_lsh[good_s2]
w_mlt    = w_mlt[good_s2]

alle_rms = alle_rms[good_s2,*]
allb_rms = allb_rms[good_s2,*]

evalmin  = evalmin[good_s2]
evalmid  = evalmid[good_s2]
evalmax  = evalmax[good_s2]
emidmin  = emidmin[good_s2]

pos_wgsm = pos_wgsm[good_s2,*]
pos_ugsm = pos_ugsm[good_s2,*]
kgse     = kgse[good_s2,*]
gse_magf = gse_magf[good_s2,*]
thetakB  = thetakB[good_s2]

; => Define GSM Latitudes
gsm_lat0 = ATAN(pos_ugsm[*,2]/SQRT(pos_ugsm[*,0]^2 + pos_ugsm[*,1]^2))*18d1/!DPI

gdates = ['111398','040900','050300','052600','061000','062600','071000',$
          '072300','080400','081500','100301','102401','101002']
FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp       = orbit_region_time_range(DATE=date[0])                                       & $
  tr_r       = time_double(temp.RADIATION_BELTS)                                           & $
  testr      = (wunix LE tr_r[1] AND wunix GT tr_r[0])                                     & $
  good_r0    = WHERE(testr,gdr0)                                                           & $
  IF (j EQ 0)               THEN good_r = good_r0                                          & $
  IF (gdr0 GT 0 AND j GT 0) THEN good_r = [good_r,good_r0]

badr     = WHERE(good_r LT 0,bdr,COMPLEMENT=ggoodr,NCOMPLEMENT=ggdr)
IF (ggdr GT 0) THEN good_r = good_r[ggoodr]
unq      = UNIQ(good_r,SORT(good_r))
good_r   = good_r[unq]
help, good_s2, good_r
;GOOD_S2         LONG      = Array[50]
;GOOD_R          LONG      = Array[33]

inds     = LINDGEN(nall)
bads     = array_where(inds,good_r,/N_UNIQ,NCOMP1=ncomp1,NCOMP2=ncomp2)
help, ncomp1,ncomp2
;NCOMP1          LONG      = Array[17]
;NCOMP2          LONG      =           -1

els_mg    = ncomp1
els_rd    = good_r
help, els_mg,els_rd
;ELS_MG          LONG      = Array[17]
;ELS_RD          LONG      = Array[33]

; => Define Magnetospheric Parameters
wscets_mg   = wscets[els_mg]
wunix_mg    = wunix[els_mg]
wavetype_mg = wavetype[els_mg]
rectype_mg  = rectype[els_mg]
w_rad_mg    = w_rad[els_mg]
w_lsh_mg    = w_lsh[els_mg]
w_mlt_mg    = w_mlt[els_mg]

alle_rms_mg = alle_rms[els_mg,*]
allb_rms_mg = allb_rms[els_mg,*]
bxrms_mg    = allb_rms_mg[*,0]
byrms_mg    = allb_rms_mg[*,1]
bzrms_mg    = allb_rms_mg[*,2]

evalmin_mg  = evalmin[els_mg]
evalmid_mg  = evalmid[els_mg]
evalmax_mg  = evalmax[els_mg]
emidmin_mg  = emidmin[els_mg]

pos_wgsm_mg = pos_wgsm[els_mg,*]
pos_ugsm_mg = pos_ugsm[els_mg,*]
kgse_mg     = kgse[els_mg,*]
gse_magf_mg = gse_magf[els_mg,*]
thetakB_mg  = thetakB[els_mg]
gsm_lat_mg  = gsm_lat0[els_mg]

; => Define Radiation Belt Parameters
wscets_rd   = wscets[els_rd]
wunix_rd    = wunix[els_rd]
wavetype_rd = wavetype[els_rd]
rectype_rd  = rectype[els_rd]
w_rad_rd    = w_rad[els_rd]
w_lsh_rd    = w_lsh[els_rd]
w_mlt_rd    = w_mlt[els_rd]

alle_rms_rd = alle_rms[els_rd,*]
allb_rms_rd = allb_rms[els_rd,*]
bxrms_rd    = allb_rms_rd[*,0]
byrms_rd    = allb_rms_rd[*,1]
bzrms_rd    = allb_rms_rd[*,2]

evalmin_rd  = evalmin[els_rd]
evalmid_rd  = evalmid[els_rd]
evalmax_rd  = evalmax[els_rd]
emidmin_rd  = emidmin[els_rd]

pos_wgsm_rd = pos_wgsm[els_rd,*]
pos_ugsm_rd = pos_ugsm[els_rd,*]
kgse_rd     = kgse[els_rd,*]
gse_magf_rd = gse_magf[els_rd,*]
thetakB_rd  = thetakB[els_rd]
gsm_lat_rd  = gsm_lat0[els_rd]

; => Test different limits of eigenvalue ratios
test_b_mg   = ((bxrms_mg GT 0.) AND (byrms_mg GT 0.) AND (bzrms_mg GT 0.))
test_b_rd   = ((bxrms_rd GT 0.) AND (byrms_rd GT 0.) AND (bzrms_rd GT 0.))

test_s_mg   = (rectype_mg EQ 'tdss') AND test_b_mg AND (emidmin_mg GE 5d0)
test_s_rd   = (rectype_rd EQ 'tdss') AND test_b_rd AND (emidmin_rd GE 5d0)

test_s_mg1  = (rectype_mg EQ 'tdss') AND test_b_mg AND (emidmin_mg GE 7.5d0)
test_s_rd1  = (rectype_rd EQ 'tdss') AND test_b_rd AND (emidmin_rd GE 7.5d0)

test_s_mg2  = (rectype_mg EQ 'tdss') AND test_b_mg AND (emidmin_mg GE 1d1)
test_s_rd2  = (rectype_rd EQ 'tdss') AND test_b_rd AND (emidmin_rd GE 1d1)

good_s_mg   = WHERE(test_s_mg,gdsmg)
good_s_rd   = WHERE(test_s_rd,gdsrd)
good_s_mg1  = WHERE(test_s_mg2,gdsmg1)
good_s_rd1  = WHERE(test_s_rd2,gdsrd1)
good_s_mg2  = WHERE(test_s_mg2,gdsmg2)
good_s_rd2  = WHERE(test_s_rd2,gdsrd2)
PRINT, gdsmg, gdsrd, gdsmg1, gdsrd1, gdsmg2, gdsrd2
;          17          33          13          27          13          27


; => rotate into GSM
;coord_trans_wrapper,wunix,kgse,kgsm,/TO_GSM,/GSE

pref       = 'Whistler_TDSS-nT_L'+l_string[0]+'_'
suffxmg    = '_Magnetosphere_histogram_Emid-min-5'
suffxrd    = '_Radiation-Belts_histogram_Emid-min-5'
ttl_mg     = 'Magnetosphere ONLY'
ttl_rd     = 'Radiation Belts'

ttlmg      = 'TDSS ['+ttl_mg[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'
ttlrd      = 'TDSS ['+ttl_rd[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'

; => Theta-kB histograms
xttl       = '!7h!3'+'!DkB!N (deg)'
midstr     = 'Theta-kB_'
xdat       = thetakb_mg
dra0       = [0e0,9e1]
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=10
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=10
pclose

xdat       = thetakb_rd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=10
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=10
pclose

pref       = 'Whistler_TDSS-nT_L'+l_string[0]+'_'
suffxmg    = '_Magnetosphere_histogram_Emid-min-10'
suffxrd    = '_Radiation-Belts_histogram_Emid-min-10'
ttl_mg     = 'Magnetosphere ONLY'
ttl_rd     = 'Radiation Belts'

ttlmg      = 'TDSS ['+ttl_mg[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'
ttlrd      = 'TDSS ['+ttl_rd[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'

; => Theta-kB histograms
xttl       = '!7h!3'+'!DkB!N (deg)'
midstr     = 'Theta-kB_'
xdat       = thetakb_mg[good_s_mg2]
dra0       = [0e0,9e1]
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=10
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=10
pclose

xdat       = thetakb_rd[good_s_rd2]
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=10
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=10
pclose

PRINT, gdsmg2, gdsrd2
;          13          27
HELP, WHERE(thetakb_mg[good_s_mg2] LE 2d1), WHERE(thetakb_rd[good_s_rd2] LE 2d1)
;<Expression>    LONG      = Array[13]
;<Expression>    LONG      = Array[21]
HELP, WHERE(thetakb_mg[good_s_mg2] GT 2d1), WHERE(thetakb_rd[good_s_rd2] GT 2d1)
;<Expression>    LONG      =           -1
;<Expression>    LONG      = Array[6]

; => 13/13 (100%) were within 20 deg [Magnetosphere]
; => 21/27 (93%)  were within 20 deg [Radiation Belts]


PRINT, gdsmg, gdsrd
;          17          33
HELP, WHERE(thetakb_mg[good_s_mg] LE 2d1), WHERE(thetakb_rd[good_s_rd] LE 2d1)
;<Expression>    LONG      = Array[15]
;<Expression>    LONG      = Array[25]
HELP, WHERE(thetakb_mg[good_s_mg] GT 2d1), WHERE(thetakb_rd[good_s_rd] GT 2d1)
;<Expression>    LONG      = Array[2]
;<Expression>    LONG      = Array[8]

; => 15/17 (88%) were within 20 deg [Magnetosphere]
; => 25/33 (76%) were within 20 deg [Radiation Belts]
; => 08/33 (24%) were > 20 deg [Radiation Belts]


; => Correlation between theta_kB and lambda_GSM? [TDSS]
xttl       = '!7h!3'+'!DkB!N (deg)'
yttl       = '!7k!3'+'!DGSM!N (deg) [GSM-Latitude]'
ttepref    = 'TDSS !7k!3'+'!DGSM!N vs. !7h!3'+'!DkB!N ['
ttlemg     = ttepref[0]+ttl_mg[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'
ttlerd     = ttepref[0]+ttl_rd[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'
xra        = [0e0,9e1]
yra        = [-7e1,7e1]
pstrmg     = {XMINOR:10,YMINOR:10,XSTYLE:1,YSTYLE:1,XRANGE:xra,YRANGE:yra,$
              XTITLE:xttl,YTITLE:yttl,NODATA:1,TITLE:ttlemg}
pstrrd     = {XMINOR:10,YMINOR:10,XSTYLE:1,YSTYLE:1,XRANGE:xra,YRANGE:yra,$
              XTITLE:xttl,YTITLE:yttl,NODATA:1,TITLE:ttlerd}

suffxmg    = '_Magnetosphere_Emid-min-5'
suffxrd    = '_Radiation-Belts_Emid-min-5'
pref       = 'Wind-GSM-Latitude_Theta-kB_TDSS'

!P.MULTI   = 0
PLOT,thetakb_mg,gsm_lat_mg,_EXTRA=pstrmg
  OPLOT,thetakb_mg,gsm_lat_mg,PSYM=2,COLOR=250L
popen,pref[0]+suffxmg[0],/LAND
  PLOT,thetakb_mg,gsm_lat_mg,_EXTRA=pstrmg
    OPLOT,thetakb_mg,gsm_lat_mg,PSYM=2,COLOR=250L
pclose

!P.MULTI   = 0
PLOT,thetakb_rd,gsm_lat_rd,_EXTRA=pstrrd
  OPLOT,thetakb_rd,gsm_lat_rd,PSYM=2,COLOR=250L
popen,pref[0]+suffxrd[0],/LAND
  PLOT,thetakb_rd,gsm_lat_rd,_EXTRA=pstrrd
    OPLOT,thetakb_rd,gsm_lat_rd,PSYM=2,COLOR=250L
pclose


; => Look at ALL whistlers
pref       = 'Whistler_TDSS-ALL-nT_L'+l_string[0]+'_'
suffxmg    = '_Magnetosphere_histogram_Emid-min-5'
ttl_mg     = 'ALL Magnetosphere'
ttl        = 'TDSS ['+ttl_mg[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'

xttl       = '!7h!3'+'!DkB!N (deg)'
wset,0
  my_histogram_plot,thetakb,drange=[0e0,9e1],xttl=xttl,ttle=ttl,nbins=10
fname = pref[0]+'Theta-kB'+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,thetakb,drange=[0e0,9e1],xttl=xttl,ttle=ttl,nbins=10
pclose



goodth = WHERE(emidmin0 GE 5d0,gdth)
PRINT,gdth
;          54
thkb0  = thetakB0[goodth]

pref       = 'Whistler_TDSS-ALL_L'+l_string[0]+'_'
suffxmg    = '_Magnetosphere_histogram_Emid-min-5'
ttl_mg     = 'ALL Magnetosphere'
ttl        = 'TDSS ['+ttl_mg[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'

xttl       = '!7h!3'+'!DkB!N (deg)'
  my_histogram_plot,thkb0,drange=[0e0,9e1],xttl=xttl,ttle=ttl,nbins=10
fname = pref[0]+'Theta-kB'+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,thkb0,drange=[0e0,9e1],xttl=xttl,ttle=ttl,nbins=10
pclose

goodth = WHERE(emidmin0 GE 1d1,gdth)
PRINT,gdth
;          44
thkb0  = thetakB0[goodth]

pref       = 'Whistler_TDSS-ALL_L'+l_string[0]+'_'
suffxmg    = '_Magnetosphere_histogram_Emid-min-10'
ttl_mg     = 'ALL Magnetosphere'
ttl        = 'TDSS ['+ttl_mg[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'

xttl       = '!7h!3'+'!DkB!N (deg)'
  my_histogram_plot,thkb0,drange=[0e0,9e1],xttl=xttl,ttle=ttl,nbins=10
fname = pref[0]+'Theta-kB'+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,thkb0,drange=[0e0,9e1],xttl=xttl,ttle=ttl,nbins=10
pclose


goodth = WHERE(emidmin0 GE 0d0,gdth)
PRINT,gdth
;          68
thkb0  = thetakB0

pref       = 'Whistler_TDSS-ALL_L'+l_string[0]+'_'
suffxmg    = '_Magnetosphere_histogram_Emid-min-0'
ttl_mg     = 'ALL Magnetosphere'
ttl        = 'TDSS ['+ttl_mg[0]+'] (nT) Whistler Statistics (L < '+l_string[0]+')'

xttl       = '!7h!3'+'!DkB!N (deg)'
  my_histogram_plot,thkb0,drange=[0e0,9e1],xttl=xttl,ttle=ttl,nbins=10
fname = pref[0]+'Theta-kB'+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,thkb0,drange=[0e0,9e1],xttl=xttl,ttle=ttl,nbins=10
pclose

;-----------------------------------------------------------------------------------------
; => Separate by region
;-----------------------------------------------------------------------------------------

; => Define dummy variables and constants
me         = 9.1093897d-31     ; -Electron mass (kg)
mp         = 1.6726231d-27     ; -Proton mass (kg)
qq         = 1.60217733d-19    ; -Fundamental charge (C)
epo        = 8.854187817d-12   ; -Permittivity of free space (F/m)
muo        = 4d0*!DPI*1d-7     ; -Permeability of free space (N/A^2 or H/m)
fcefac     = qq/me/(2d0*!DPI)
fpefac     = SQRT(qq^2/(me*epo))/(2d0*!DPI)
R_E        = 6.37814d3         ; => Earth's Equitorial Radius (km)


test_wh  = all_stats_all_waves_read()
wscets   = STRTRIM(test_wh.SCETS,2)
wunix    = time_double(wscets)
wavetype = STRLOWCASE(STRTRIM(test_wh.WAVE_TYPE,2))
rectype  = STRLOWCASE(STRTRIM(test_wh.REC_TYPE,2))

fp_low   = test_wh.FREQ_LOW
fp_high  = test_wh.FREQ_HIGH
; => Field information
alle_rms = test_wh.E_RMS
allb_rms = test_wh.B_RMS
alle_pk  = test_wh.E_PK
allb_pk  = test_wh.B_PK
whe_rms  = test_wh.EMAG_RMS
whb_rms  = test_wh.BMAG_RMS
;whe_pk   = test_wh.EMAG_PK
;whb_pk   = test_wh.BMAG_PK
whe_pk   = SQRT(TOTAL(alle_pk^2,2,/NAN))
whb_pk   = SQRT(TOTAL(allb_pk^2,2,/NAN))

bmago    = test_wh.B_MAG
; => Wind Location information
w_rad    = test_wh.WIND_RAD_DIST
w_lsh    = test_wh.WIND_L_SHELL
w_mlt    = test_wh.WIND_MLT
wgsm_pos = test_wh.GSM_POS
; => Calculate GSM Latitude
gratio   = wgsm_pos[*,2]/SQRT(wgsm_pos[*,0]^2 + wgsm_pos[*,1]^2)
gsm_lat  = ATAN(gratio)*18d1/!DPI
; => AE-Index information
ae_ind   = test_wh.AE_INDEX
; => 3DP information
n_ph     = test_wh.N_PH
tavgel   = test_wh.TAVG_EL
tparel   = test_wh.TPAR_EL
tperel   = test_wh.TPER_EL
tavgeh   = test_wh.TAVG_EH
tpareh   = test_wh.TPAR_EH
tpereh   = test_wh.TPER_EH


; => Find Only Waves in Magnetosphere
wgood  = STRLOWCASE('Whistlers')
gdates = ['111398','040900','050300','052600','061000','062600','071000',$
          '072300','080400','081500','100301','102401','101002']
FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp       = orbit_region_time_range(DATE=date[0])                                       & $
  tr_m       = time_double(temp.MAGNETOSPHERE)                                             & $
  testm      = (wunix LE tr_m[1] AND wunix GT tr_m[0]) AND (wavetype EQ wgood[0])          & $
  good_m0    = WHERE(testm,gdm0)                                                           & $
  IF (gdm0 GT 0 AND j EQ 0) THEN good_ma = good_m0                                         & $
  IF (gdm0 GT 0 AND j GT 0) THEN good_ma = [good_ma,good_m0]

; => Limit to L < 15
lshell   = 15.
l_string = STRTRIM(STRING(lshell,FORMAT='(f12.1)'),2L)
test_l   = (w_lsh[good_ma] LE lshell[0])
good0    = WHERE(test_l,gd0)
PRINT, gd0, N_ELEMENTS(good_ma)
; => For L < 15
;         257         258
good_m   = good_ma[good0]

fp_low   = fp_low[good_m]
fp_high  = fp_high[good_m]

wscets   = wscets[good_m]
wunix    = wunix[good_m]
wavetype = wavetype[good_m]
rectype  = rectype[good_m]

whe_rms  = whe_rms[good_m]
whb_rms  = whb_rms[good_m]
alle_rms = alle_rms[good_m,*]
allb_rms = allb_rms[good_m,*]
alle_pk  = alle_pk[good_m,*]
allb_pk  = allb_pk[good_m,*]
whe_pk   = whe_pk[good_m]
whb_pk   = whb_pk[good_m]
bmago    = bmago[good_m]

w_rad    = w_rad[good_m]
w_lsh    = w_lsh[good_m]
w_mlt    = w_mlt[good_m]
wgsm_pos = wgsm_pos[good_m,*]
gsm_lat  = gsm_lat[good_m]
ae_ind   = ae_ind[good_m]

n_ph     = n_ph[good_m]
tavgel   = tavgel[good_m]
tparel   = tparel[good_m]
tperel   = tperel[good_m]
tavgeh   = tavgeh[good_m]
tpareh   = tpareh[good_m]
tpereh   = tpereh[good_m]

; => Remove incomplete TDS Samples [i.e. TDS with < 2 components]
exrms    = alle_rms[*,0]
eyrms    = alle_rms[*,1]
ezrms    = alle_rms[*,2]
bxrms    = allb_rms[*,0]
byrms    = allb_rms[*,1]
bzrms    = allb_rms[*,2]

test_f   = (rectype EQ 'tdsf') AND ((exrms GT 0.) AND (eyrms GT 0.))

test_e0  = ((exrms GT 0.) AND (eyrms GT 0.) AND (ezrms GT 0.))
test_b0  = ((bxrms GT 0.) AND (byrms GT 0.) AND (bzrms GT 0.))
test_s   = (rectype EQ 'tdss') AND (test_e0 OR test_b0)

good_f   = WHERE(test_f,gdf)
good_s   = WHERE(test_s,gds)
PRINT, gdf, gds
; => For L < 15
;         185          68
good_all = [good_f,good_s]
sp       = SORT(good_all)
good_all = good_all[sp]

fp_low   = fp_low[good_all]
fp_high  = fp_high[good_all]

wscets   = wscets[good_all]
wunix    = wunix[good_all]
wavetype = wavetype[good_all]
rectype  = rectype[good_all]

alle_pk  = alle_pk[good_all,*]
allb_pk  = allb_pk[good_all,*]
whe_rms  = whe_rms[good_all]
whb_rms  = whb_rms[good_all]
whe_pk   = whe_pk[good_all]
whb_pk   = whb_pk[good_all]
bmago    = bmago[good_all]

w_rad    = w_rad[good_all]
w_lsh    = w_lsh[good_all]
w_mlt    = w_mlt[good_all]
wgsm_pos = wgsm_pos[good_all,*]
gsm_lat  = gsm_lat[good_all]
ae_ind   = ae_ind[good_all]

n_ph     = n_ph[good_all]
tavgel   = tavgel[good_all]
tparel   = tparel[good_all]
tperel   = tperel[good_all]
tavgeh   = tavgeh[good_all]
tpareh   = tpareh[good_all]
tpereh   = tpereh[good_all]
; => Calculate cyclotron and plasma frequencies
fce      = fcefac[0]*bmago*1d-9
fpe      = fpefac[0]*SQRT(1d6*n_ph)


gdates = ['111398','040900','050300','052600','061000','062600','071000',$
          '072300','080400','081500','100301','102401','101002']
FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp       = orbit_region_time_range(DATE=date[0])                                       & $
  tr_r       = time_double(temp.RADIATION_BELTS)                                           & $
  testr      = (wunix LE tr_r[1] AND wunix GT tr_r[0]) AND (wavetype EQ wgood[0])          & $
  good_r0    = WHERE(testr,gdr0)                                                           & $
  IF (gdr0 GT 0 AND j EQ 0) THEN good_r = good_r0                                          & $
  IF (gdr0 GT 0 AND j GT 0) THEN good_r = [good_r,good_r0]

inds       = LINDGEN(N_ELEMENTS(good_all))
unq        = UNIQ(good_r,SORT(good_r))
good_r     = good_r[unq]

bads       = array_where(inds,good_r,/N_UNIQ,NCOMP1=ncomp1,NCOMP2=ncomp2)
help, ncomp1,ncomp2
;NCOMP1          LONG      = Array[30]
;NCOMP2          LONG      =           -1

els_mg     = inds[ncomp1]
els_rd     = good_r
help, els_mg, els_rd
;ELS_MG          LONG      = Array[30]
;ELS_RD          LONG      = Array[223]

bmagomg   = bmago[els_mg]
bmagord   = bmago[els_rd]
; => Define L-Shell, Radial Distance, and MLT
w_lshmg   = w_lsh[els_mg]
w_radmg   = w_rad[els_mg]
w_mltmg   = w_mlt[els_mg]

w_lshrd   = w_lsh[els_rd]
w_radrd   = w_rad[els_rd]
w_mltrd   = w_mlt[els_rd]
; => Define Lambda_GSM and GSM position
gsm_latmg = gsm_lat[els_mg]
gsm_latrd = gsm_lat[els_rd]

gsm_posmg = wgsm_pos[els_mg,*]
gsm_posrd = wgsm_pos[els_rd,*]

ae_indmg  = ae_ind[els_mg]
ae_indrd  = ae_ind[els_rd]

n_phmg    = n_ph[els_mg]
tavgelmg  = tavgel[els_mg]
tparelmg  = tparel[els_mg]
tperelmg  = tperel[els_mg]
tavgehmg  = tavgeh[els_mg]
tparehmg  = tpareh[els_mg]
tperehmg  = tpereh[els_mg]

n_phrd    = n_ph[els_rd]
tavgelrd  = tavgel[els_rd]
tparelrd  = tparel[els_rd]
tperelrd  = tperel[els_rd]
tavgehrd  = tavgeh[els_rd]
tparehrd  = tpareh[els_rd]
tperehrd  = tpereh[els_rd]

; => Stats on location and other parameters
testrd = (w_mltrd GE 18. AND w_mltrd LT 24.) OR (w_mltrd GE 0. AND w_mltrd LE 6.)
testmg = (w_mltmg GE 18. AND w_mltmg LT 24.) OR (w_mltmg GE 0. AND w_mltmg LE 6.)
goodrd = WHERE(testrd,gdrd)
goodmg = WHERE(testmg,gdmg)
PRINT, gdrd, gdmg
;         191          17

testrd = (w_mltrd GE 0. AND w_mltrd LE 6.)
testmg = (w_mltmg GE 0. AND w_mltmg LE 6.)
goodrd = WHERE(testrd,gdrd)
goodmg = WHERE(testmg,gdmg)
PRINT, gdrd, gdmg
;         103           3

testrd = (w_mltrd GE 18. AND w_mltrd LT 24.)
testmg = (w_mltmg GE 18. AND w_mltmg LT 24.)
goodrd = WHERE(testrd,gdrd)
goodmg = WHERE(testmg,gdmg)
PRINT, gdrd, gdmg
;          88          14

testa0 = (ABS(wgsm_pos[*,2])/R_E LE 2.)
testa1 = (ABS(gsm_lat) LE 10.)
goodrd = WHERE(testa0,gdrd)
goodmg = WHERE(testa1,gdmg)
PRINT, gdrd, gdmg
;         245         172

testa0 = (tavgehrd/tavgelrd LE 7.)
testa1 = (tavgehmg/tavgelmg LE 7.)
goodrd = WHERE(testa0,gdrd)
goodmg = WHERE(testa1,gdmg)
PRINT, gdrd, gdmg
;           5          16


good_nt     = WHERE(rectype EQ 'tdss',gdnt,COMPLEMENT=good_mv,NCOMPLEMENT=gdmv)
PRINT, gdnt, gdmv
; => For L < 15
;          68         185

alle_pk_mv  = whe_pk[good_mv]
allb_pk_nt  = whb_pk[good_nt]
good_mvlg   = WHERE(alle_pk_mv GE 2.0,gdmv)
good_ntlg   = WHERE(allb_pk_nt GE 0.1,gdnt)
PRINT, gdmv, gdnt
;         172          54

PRINT, minmax(alle_pk_mv[good_mvlg]), minmax(allb_pk_nt[good_ntlg])
;       2.7705891       343.03196
;      0.16054874       5.5442600











; => Plot hodograms

pref       = 'Whistler_TDS-ALL_L'+l_string[0]+'_'
suffxmg    = '_Magnetosphere_histogram'
suffxrd    = '_Radiation-Belts_histogram'
ttl_mg     = 'Magnetosphere ONLY'
ttl_rd     = 'Radiation Belts'

ttlmg      = 'TDS ['+ttl_mg[0]+'] (ALL) Whistler Statistics (L < '+l_string[0]+')'
ttlrd      = 'TDS ['+ttl_rd[0]+'] (ALL) Whistler Statistics (L < '+l_string[0]+')'

; => GSM Latitude histograms
xttl       = '!7k!3'+'!DGSM!N (deg)'
midstr     = 'GSM-Latitude_'
dra0       = [-9e1,9e1]
nbins      = 10L
xdat       = gsm_latmg
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = gsm_latrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

midstr     = 'GSM-Latitude-2nd_'
dra0       = [-5e1,5e1]
nbins      = 9L
xdat       = gsm_latmg
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = gsm_latrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

midstr     = 'GSM-Latitude-3rd_'
dra0       = [-3e1,3e1]
nbins      = 7L
xdat       = gsm_latmg
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = gsm_latrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => Radial Distance histograms
xttl       = 'Radial Distance (R!DE!N)'
midstr     = 'Radial-Dist_'
xdat       = w_radmg
dra0       = [0e0,lshell]
nbins      = 11L
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = w_radrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => L-Shell histograms
xttl       = 'L-Shell (R!DE!N)'
midstr     = 'LShell_'
dra0       = [0e0,lshell]
xdat       = w_lshmg
nbins      = 11L
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = w_lshrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => MLT histograms
xttl       = 'MLT (hours)'
midstr     = 'MLT_'
dra0       = [0e0,24d0]
xdat       = w_mltmg
nbins      = 9L
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = w_mltrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => <Teh>/<Tec> [EH/EL] histograms
xttl       = 'T!Deh!N'+'/T!Dec!N [EH/EL]'
midstr     = 'Te-EH_Te-EL_'
dra0       = [1e0,22d0]
nbins      = 8L
xdat       = tavgehmg/tavgelmg
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = tavgehrd/tavgelrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => Te_perp/Te_para [EH] histograms
xttl       = 'T!D!9x!3'+'!N/T!D!9#!3'+'!N [EH]'
midstr     = 'Tani-EH_'
dra0       = [1e-1,2d0]
nbins      = 10L
xdat       = tperehmg/tparehmg
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = tperehrd/tparehrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => Te_perp/Te_para [EL] histograms
xttl       = 'T!D!9x!3'+'!N/T!D!9#!3'+'!N [EL]'
midstr     = 'Tani-EL_'
dra0       = [1e-1,2d0]
nbins      = 10L
xdat       = tperelmg/tparelmg
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = tperelrd/tparelrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose


; => wpe^2/(w (wce costheta - w) ) [whistler index of refraction] histograms
; => approximate to wpe^2/(w (wce - w) )
fp_peak    = (fp_high + fp_low)/2d0
windex     = fpe^2/(fp_peak*(fce - fp_peak))


; => Look at ∆f/f, ∆f, and ∆f/fce
fp_lowmg   = fp_low[els_mg]
fp_highmg  = fp_high[els_mg]

fp_lowrd   = fp_low[els_rd]
fp_highrd  = fp_high[els_rd]
; => Define width of frequency peak and frequency peak (Hz)
deltafmg   = fp_highmg - fp_lowmg
deltafrd   = fp_highrd - fp_lowrd

fp_peakmg  = fp_peak[els_mg]
fp_peakrd  = fp_peak[els_rd]
; => Define electron cyclotron and plasma frequencies (Hz)
fcemg      = fce[els_mg]
fcerd      = fce[els_rd]
fpemg      = fpe[els_mg]
fperd      = fpe[els_rd]
; => whistler index of refraction
windexmg   = windex[els_mg]
windexrd   = windex[els_rd]


lshell   = 15.
l_string = STRTRIM(STRING(lshell,FORMAT='(f12.1)'),2L)
test_lmg = (deltafmg GT 0.)
test_lrd = (deltafrd GT 0.)
good0mg  = WHERE(test_lmg,gd0mg)
good0rd  = WHERE(test_lrd,gd0rd)
PRINT, gd0mg, gd0rd
; => For L < 15
;          21         222

fp_lowmg   = fp_lowmg[good0mg]
fp_highmg  = fp_highmg[good0mg]
fp_lowrd   = fp_lowrd[good0rd]
fp_highrd  = fp_highrd[good0rd]
deltafmg   = deltafmg[good0mg]
deltafrd   = deltafrd[good0rd]
fp_peakmg  = fp_peakmg[good0mg]
fp_peakrd  = fp_peakrd[good0rd]
fcemg      = fcemg[good0mg]
fcerd      = fcerd[good0rd]
fpemg      = fpemg[els_mg]
fperd      = fperd[els_rd]
windexmg   = windexmg[els_mg]
windexrd   = windexrd[els_rd]


; => ∆f histograms
xttl       = '!7D!3'+'f (Hz)'
xdat       = deltafmg
nbins      = 11L
dra0       = [0e0,2d3]
midstr     = 'delta-f_'
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = deltafrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => ∆f/f histograms
xttl       = '!7D!3'+'f/f'
xdat       = deltafmg/fp_peakmg
nbins      = 11L
dra0       = [0e0,2d0]
midstr     = 'deltaf-f_'
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = deltafrd/fp_peakrd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => ∆f/fce [fce = local cyclotron frequency] histograms
xttl       = '!7D!3'+'f/f!Dce!N [f!Dce!N = local]'
dra0       = [0e0,1d0]
xdat       = deltafmg/fcemg
nbins      = 11L
midstr     = 'delta-f-fce-local_'
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = deltafrd/fcerd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => f/fce [fce = local cyclotron frequency] histograms
xttl       = 'f/f!Dce!N [f!Dce!N = local]'
dra0       = [0e0,1d0]
xdat       = fp_peakmg/fcemg
nbins      = 11L
midstr     = 'f-fce-local_'
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = fp_peakrd/fcerd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => f/fpe [fpe = local plasma frequency] histograms
xttl       = 'f/f!Dpe!N [f!Dce!N = local]'
dra0       = [0e0,3d-1]
nbins      = 8L
midstr     = 'f-fpe-local_'
xdat       = fp_peakmg/fpemg
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = fp_peakrd/fperd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

xttl       = 'f/f!Dpe!N [f!Dce!N = local]'
dra0       = [0e0,1d-1]
nbins      = 8L
midstr     = 'f-fpe-local-2nd_'
xdat       = fp_peakmg/fpemg
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = fp_peakrd/fperd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose

; => fpe/fce [fpe = local plasma frequency, fce = local cyclotron frequency] histograms
xttl       = 'f!Dpe!N'+'/f!Dce!N [Local Plasma Freq., Local Cyclo. Freq.]'
dra0       = [0e0,20d0]
nbins      = 11L
midstr     = 'fpe-fce-local_'
xdat       = fpemg/fcemg
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
fname = pref[0]+midstr[0]+suffxmg[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlmg,nbins=nbins
pclose

xdat       = fperd/fcerd
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
fname = pref[0]+midstr[0]+suffxrd[0]
popen,fname,/LAND
  my_histogram_plot,xdat,drange=dra0,xttl=xttl,ttle=ttlrd,nbins=nbins
pclose


; => NEED
;     1)  Stats for table in manuscript
;     2)  Lambda_GSM vs. Theta_kB
;     3)  |E| and |B| vs. AE-Index
;     4)  New orbit plots separating only by region
;     5)  New histograms for Lambda_GSM and Theta_kB for ALL events


















'------------------------------------------------------------------------------------------------------------------'
' => Do not use finite Vph for test'
'------------------------------------------------------------------------------------------------------------------'

test_wh  = all_stats_all_waves_read()

wscets   = STRTRIM(test_wh.SCETS,2)
wunix    = time_double(wscets)
wavetype = STRLOWCASE(STRTRIM(test_wh.WAVE_TYPE,2))
rectype  = STRLOWCASE(STRTRIM(test_wh.REC_TYPE,2))
; => Field information
alle_rms = test_wh.E_RMS
allb_rms = test_wh.B_RMS

whe_rms  = test_wh.EMAG_RMS
whb_rms  = test_wh.BMAG_RMS
whe_pk   = test_wh.EMAG_PK
whb_pk   = test_wh.BMAG_PK
; => Wind Location information
w_rad    = test_wh.WIND_RAD_DIST
w_lsh    = test_wh.WIND_L_SHELL
w_mlt    = test_wh.WIND_MLT
wgsm_pos = test_wh.GSM_POS
; => Calculate GSM Latitude
gratio   = wgsm_pos[*,2]/SQRT(wgsm_pos[*,0]^2 + wgsm_pos[*,1]^2)
gsm_lat  = ATAN(gratio)*18d1/!DPI
; => AE-Index information
ae_ind   = test_wh.AE_INDEX


; => Find Only Waves in Magnetosphere
wgood  = STRLOWCASE('Whistlers')
gdates = ['111398','040900','050300','052600','061000','062600','071000',$
          '072300','080400','081500','100301','102401','101002']
FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp       = orbit_region_time_range(DATE=date[0])                                       & $
  tr_m       = time_double(temp.MAGNETOSPHERE)                                             & $
  testm      = (wunix LE tr_m[1] AND wunix GT tr_m[0]) AND (wavetype EQ wgood[0])          & $
  good_m0    = WHERE(testm,gdm0)                                                           & $
  IF (gdm0 GT 0 AND j EQ 0) THEN good_m = good_m0                                          & $
  IF (gdm0 GT 0 AND j GT 0) THEN good_m = [good_m,good_m0]

gdates = ['111398','040900','050300','052600','061000','062600','071000',$
          '072300','080400','081500','100301','102401','101002']
FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp       = orbit_region_time_range(DATE=date[0])                                       & $
  tr_r       = time_double(temp.RADIATION_BELTS)                                           & $
  testr      = (wunix LE tr_r[1] AND wunix GT tr_r[0]) AND (wavetype EQ wgood[0])          & $
  good_r0    = WHERE(testr,gdr0)                                                           & $
  IF (gdr0 GT 0 AND j EQ 0) THEN good_r = good_r0                                          & $
  IF (gdr0 GT 0 AND j GT 0) THEN good_r = [good_r,good_r0]

unq      = UNIQ(good_m,SORT(good_m))
good_m   = good_m[unq]
unq      = UNIQ(good_r,SORT(good_r))
good_r   = good_r[unq]
help, good_m,good_r
;GOOD_M          LONG      = Array[258]
;GOOD_R          LONG      = Array[227]

wscets   = wscets[good_m]
wunix    = wunix[good_m]
wavetype = wavetype[good_m]
whe_rms  = whe_rms[good_m]
whb_rms  = whb_rms[good_m]
alle_rms = alle_rms[good_m,*]
allb_rms = allb_rms[good_m,*]
whe_pk   = whe_pk[good_m]
whb_pk   = whb_pk[good_m]
w_rad    = w_rad[good_m]
w_lsh    = w_lsh[good_m]
w_mlt    = w_mlt[good_m]
wgsm_pos = wgsm_pos[good_m,*]
gsm_lat  = gsm_lat[good_m]
ae_ind   = ae_ind[good_m]

;----------------------------------------------------------------
; => Define separation test
;----------------------------------------------------------------
lshell   = 15.
wgood    = STRLOWCASE('Whistlers')
;test_lw  = (wavetype EQ wgood[0]) AND (w_lsh LT lshell[0])
test_lw  = (w_lsh LT lshell[0])
good     = WHERE(test_lw,gd)

wscets   = wscets[good]
wunix    = wunix[good]
wavetype = wavetype[good]
whe_rms  = whe_rms[good]
whb_rms  = whb_rms[good]
alle_rms = alle_rms[good,*]
allb_rms = allb_rms[good,*]
whe_pk   = whe_pk[good]
whb_pk   = whb_pk[good]
w_rad    = w_rad[good]
w_lsh    = w_lsh[good]
w_mlt    = w_mlt[good]
wgsm_pos = wgsm_pos[good,*]
gsm_lat  = gsm_lat[good]
ae_ind   = ae_ind[good]



yra  = [1e-1,3.5e2]
xra  = [1e1,1.2e3]
xttl = 'AE-Index [1min, nT]'
yttl = 'Peak Whistler Amplitude (mV/m)'
ttle = 'Peak Whistler Amplitude vs. AE-Index [1min Avg.]'
pstr = {XRANGE:xra,YRANGE:yra,XTITLE:xttl,YTITLE:yttl,YSTYLE:1,XSTYLE:1,YLOG:1,NODATA:1,$
        TITLE:ttle}
PLOT,ae_ind,whe_pk,_EXTRA=pstr
  OPLOT,ae_ind,whe_pk,PSYM=2
popen,'TDS-ALL-mVm_whistler_amp_vs_AE-Index-1min_2',/LAND
  PLOT,ae_ind,whe_pk,_EXTRA=pstr
    OPLOT,ae_ind,whe_pk,PSYM=2
pclose

yttl = 'Peak Whistler Amplitude (nT)'
yra  = [1e-2,6e0]
pstr = {XRANGE:xra,YRANGE:yra,XTITLE:xttl,YTITLE:yttl,YSTYLE:1,XSTYLE:1,YLOG:1,NODATA:1,$
        TITLE:ttle}
PLOT,ae_ind,whb_pk,_EXTRA=pstr
  OPLOT,ae_ind,whb_pk,PSYM=2
popen,'TDS-ALL-nT_whistler_amp_vs_AE-Index-1min_2',/LAND
  PLOT,ae_ind,whb_pk,_EXTRA=pstr
    OPLOT,ae_ind,whb_pk,PSYM=2
pclose


HELP, ae_ind, WHERE(ae_ind GE 1e2), WHERE(ae_ind GE 2e2), WHERE(ae_ind GE 3e2), $
              WHERE(ae_ind GE 4e2), WHERE(ae_ind GE 5e2), WHERE(ae_ind GE 6e2), $
              WHERE(ae_ind GE 7e2), WHERE(ae_ind GE 8e2), WHERE(ae_ind GE 9e2)
;-----------------------------------------------------------------------------------------
;AE_IND          FLOAT     = Array[257]
;<Expression>    LONG      = Array[205]
;<Expression>    LONG      = Array[165]
;<Expression>    LONG      = Array[159]
;<Expression>    LONG      = Array[124]
;<Expression>    LONG      = Array[96]
;<Expression>    LONG      = Array[58]
;<Expression>    LONG      = Array[46]
;<Expression>    LONG      = Array[40]
;<Expression>    LONG      = Array[5]
;-----------------------------------------------------------------------------------------

HELP, ae_ind, WHERE(ae_ind GE 1e1 AND ae_ind LT 2e2), $
              WHERE(ae_ind GE 2e2 AND ae_ind LT 4e2), $
              WHERE(ae_ind GE 4e2 AND ae_ind LT 6e2), $
              WHERE(ae_ind GE 6e2 AND ae_ind LT 8e2), $
              WHERE(ae_ind GE 8e2 AND ae_ind LT 1e3), $
              WHERE(ae_ind GE 6e2 AND ae_ind LT 1e3)
;-----------------------------------------------------------------------------------------
;AE_IND          FLOAT     = Array[257]
;<Expression>    LONG      = Array[92]
;<Expression>    LONG      = Array[41]
;<Expression>    LONG      = Array[66]
;<Expression>    LONG      = Array[18]
;<Expression>    LONG      = Array[36]
;<Expression>    LONG      = Array[54]
;-----------------------------------------------------------------------------------------

;---------------------------
; => Remove outliers...
;---------------------------
awhe_pk   = whe_pk
awhb_pk   = whb_pk
awhe_min  = 2.0
awhb_min  = 0.1
good_wemv = WHERE(awhe_pk GE awhe_min)
good_wbnt = WHERE(awhb_pk GE awhb_min)
HELP, good_wemv, good_wbnt
;GOOD_WEMV       LONG      = Array[229]
;GOOD_WBNT       LONG      = Array[58]

he_ae_ind = ae_ind[good_wemv]
hb_ae_ind = ae_ind[good_wbnt]

h_awhe_pk = awhe_pk[good_wemv]
h_awhb_pk = awhb_pk[good_wbnt]


els_0nt  = [N_ELEMENTS(WHERE(hb_ae_ind GE 1e2)), N_ELEMENTS(WHERE(hb_ae_ind GE 2e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 3e2)), N_ELEMENTS(WHERE(hb_ae_ind GE 4e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 5e2)), N_ELEMENTS(WHERE(hb_ae_ind GE 6e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 7e2))]

els_1nt  = [N_ELEMENTS(WHERE(hb_ae_ind GE 1e1 AND hb_ae_ind LT 2e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 2e2 AND hb_ae_ind LT 4e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 4e2 AND hb_ae_ind LT 6e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 8e2)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 8e2 AND hb_ae_ind LT 1e3)), $
            N_ELEMENTS(WHERE(hb_ae_ind GE 6e2 AND hb_ae_ind LT 1e3))  ]

els_0mv  = [N_ELEMENTS(WHERE(he_ae_ind GE 1e2)), N_ELEMENTS(WHERE(he_ae_ind GE 2e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 3e2)), N_ELEMENTS(WHERE(he_ae_ind GE 4e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 5e2)), N_ELEMENTS(WHERE(he_ae_ind GE 6e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 7e2))]

els_1mv  = [N_ELEMENTS(WHERE(he_ae_ind GE 1e1 AND he_ae_ind LT 2e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 2e2 AND he_ae_ind LT 4e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 4e2 AND he_ae_ind LT 6e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 8e2)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 8e2 AND he_ae_ind LT 1e3)), $
            N_ELEMENTS(WHERE(he_ae_ind GE 6e2 AND he_ae_ind LT 1e3))  ]

nums_ae  = STRTRIM(STRING([N_ELEMENTS(hb_ae_ind),N_ELEMENTS(he_ae_ind)],FORMAT='(I3.3)'),2)
suffx    = '     => For AE > '
temp_aes = FINDGEN(7)*100 + 1e2
straes   = STRMID(STRTRIM(STRING(FORMAT='(f10.0)',temp_aes),2),0,3)
strelsnt = STRTRIM(STRING(FORMAT='(I3.3)',els_0nt),2)
strelsmv = STRTRIM(STRING(FORMAT='(I3.3)',els_0mv),2)

suffxsnt = suffx[0]+straes[*]+' nT  ['+strelsnt[*]+'/'+nums_ae[0]+']'
suffxsmv = suffx[0]+straes[*]+' nT  ['+strelsmv[*]+'/'+nums_ae[1]+']'

FOR j=0L, 6L DO BEGIN $
  indsb = WHERE(hb_ae_ind GE temp_aes[j])  & $
  PRINT, minmax(h_awhb_pk[indsb],/POS),MEAN(h_awhb_pk[indsb],/NAN),$
         STDDEV(h_awhb_pk[indsb],/NAN),suffxsnt[j],FORMAT='(";",4f16.7,a34)'

FOR j=0L, 6L DO BEGIN $
  indse = WHERE(he_ae_ind GE temp_aes[j])  & $
  PRINT, minmax(h_awhe_pk[indse],/POS),MEAN(h_awhe_pk[indse],/NAN),$
         STDDEV(h_awhe_pk[indse],/NAN),suffxsmv[j],FORMAT='(";",4f16.7,a34)'

;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;        Min (nT)        Max (nT)       Mean (nT)     Std. Dev. (nT)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.1593120       6.3117000       1.1942435       1.4376143     => For AE > 100 nT  [048/058]
;       0.1593120       6.3117000       1.2139775       1.4176424     => For AE > 200 nT  [042/058]
;       0.3670340       6.3117000       1.2944024       1.4646301     => For AE > 300 nT  [038/058]
;       0.4994340       1.7921400       0.9340372       0.3664049     => For AE > 400 nT  [025/058]
;       0.4994340       1.7921400       0.9255935       0.3617091     => For AE > 500 nT  [019/058]
;       0.4994340       1.7921400       0.8565089       0.3626086     => For AE > 600 nT  [015/058]
;       0.4994340       1.0348600       0.7354110       0.1748524     => For AE > 700 nT  [013/058]
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;      Min  (mV/m)     Max  (mV/m)    Mean (mV/m)   Std. Dev. (mV/m)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       2.2608400     329.0130000      70.2716317      67.0933708     => For AE > 100 nT  [189/229]
;       2.4947300     329.0130000      77.7046032      72.1057112     => For AE > 200 nT  [152/229]
;       2.4947300     329.0130000      80.4470187      72.2293391     => For AE > 300 nT  [146/229]
;       2.4947300     329.0130000      70.8341004      64.3757311     => For AE > 400 nT  [113/229]
;       2.4947300     329.0130000      77.3061183      67.7094688     => For AE > 500 nT  [090/229]
;       2.4947300     184.6960000      50.3224985      43.1828157     => For AE > 600 nT  [052/229]
;       2.4947300      95.2627000      37.6129100      27.0371351     => For AE > 700 nT  [042/229]
;-----------------------------------------------------------------------------------------

temp_ael = [1e1,2e2,4e2,6e2,8e2,6e2]
temp_aeh = [2e2,4e2,6e2,8e2,1e3,1e3]
straesl  = STRMID(STRTRIM(STRING(FORMAT='(f10.0)',temp_ael),2),0,3)
straesh  = STRMID(STRTRIM(STRING(FORMAT='(f10.0)',temp_aeh),2),0,3)
strelsnt = STRTRIM(STRING(FORMAT='(I3.3)',els_1nt),2)
strelsmv = STRTRIM(STRING(FORMAT='(I3.3)',els_1mv),2)
suffx    = '     => For '
suffxsnt = suffx[0]+straesl[*]+' nT < AE < '+straesh[*]+' nT  ['+strelsnt[*]+'/'+nums_ae[0]+']'
suffxsmv = suffx[0]+straesl[*]+' nT < AE < '+straesh[*]+' nT  ['+strelsmv[*]+'/'+nums_ae[1]+']'

FOR j=0L, 5L DO BEGIN $
  indsb = WHERE(hb_ae_ind GE temp_ael[j] AND hb_ae_ind LT temp_aeh[j])  & $
  PRINT, minmax(h_awhb_pk[indsb],/POS),MEAN(h_awhb_pk[indsb],/NAN),$
         STDDEV(h_awhb_pk[indsb],/NAN),suffxsnt[j],FORMAT='(";",4f16.7,a43)'

FOR j=0L, 5L DO BEGIN $
  indse = WHERE(he_ae_ind GE temp_ael[j] AND he_ae_ind LT temp_aeh[j])  & $
  PRINT, minmax(h_awhe_pk[indse],/POS),MEAN(h_awhe_pk[indse],/NAN),$
         STDDEV(h_awhe_pk[indse],/NAN),suffxsmv[j],FORMAT='(";",4f16.7,a43)'
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;        Min (nT)        Max (nT)       Mean (nT)     Std. Dev. (nT)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       0.1144720       4.5163500       0.5893744       1.0606826     => For 10. nT < AE < 200 nT  [016/058]
;       0.1593120       6.3117000       1.6256542       2.1554548     => For 200 nT < AE < 400 nT  [017/058]
;       0.5502990       1.6872600       1.0503298       0.3583717     => For 400 nT < AE < 600 nT  [010/058]
;       1.4951500       1.7921400       1.6436450       0.2100036     => For 600 nT < AE < 800 nT  [002/058]
;       0.4994340       1.0348600       0.7354110       0.1748524     => For 800 nT < AE < 100 nT  [013/058]
;       0.4994340       1.7921400       0.8565089       0.3626086     => For 600 nT < AE < 100 nT  [015/058]
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;      Min  (mV/m)     Max  (mV/m)    Mean (mV/m)   Std. Dev. (mV/m)
;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;       2.1923500      75.0792000      30.0850017      20.2458616     => For 10. nT < AE < 200 nT  [077/229]
;       2.8530400     294.9790000      97.6114444      88.8732004     => For 200 nT < AE < 400 nT  [039/229]
;       7.8677300     329.0130000      88.3194005      73.9959613     => For 400 nT < AE < 600 nT  [061/229]
;       2.4947300     184.6960000      79.1133340      60.3003369     => For 600 nT < AE < 800 nT  [015/229]
;      12.0275000      95.2627000      39.9441943      27.2767664     => For 800 nT < AE < 100 nT  [035/229]
;       2.4947300     184.6960000      51.6949362      43.4041054     => For 600 nT < AE < 100 nT  [050/229]
;-----------------------------------------------------------------------------------------

tempnt0  = DBLARR(7)
tempmv0  = DBLARR(7)
tempnt1  = DBLARR(6)
tempmv1  = DBLARR(6)

temsnt0  = DBLARR(7)
temsmv0  = DBLARR(7)
temsnt1  = DBLARR(6)
temsmv1  = DBLARR(6)

FOR j=0L, 6L DO BEGIN $
  indsb      = WHERE(hb_ae_ind GE temp_aes[j])  & $
  indse      = WHERE(he_ae_ind GE temp_aes[j])  & $
  tempnt0[j] = MEAN(h_awhb_pk[indsb],/NAN)      & $
  tempmv0[j] = MEAN(h_awhe_pk[indse],/NAN)      & $
  temsnt0[j] = STDDEV(h_awhb_pk[indsb],/NAN)    & $
  temsmv0[j] = STDDEV(h_awhe_pk[indse],/NAN)


FOR j=0L, 5L DO BEGIN $
  indsb = WHERE(hb_ae_ind GE temp_ael[j] AND hb_ae_ind LT temp_aeh[j])  & $
  indse = WHERE(he_ae_ind GE temp_ael[j] AND he_ae_ind LT temp_aeh[j])  & $
  tempnt1[j] = MEAN(h_awhb_pk[indsb],/NAN)      & $
  tempmv1[j] = MEAN(h_awhe_pk[indse],/NAN)      & $
  temsnt1[j] = STDDEV(h_awhb_pk[indsb],/NAN)    & $
  temsmv1[j] = STDDEV(h_awhe_pk[indse],/NAN)

PRINT,TRANSPOSE(tempnt0)
PRINT,TRANSPOSE(tempmv0)
PRINT,TRANSPOSE(temsnt0)
PRINT,TRANSPOSE(temsmv0)

PRINT,TRANSPOSE(tempnt1)
PRINT,TRANSPOSE(tempmv1)
PRINT,TRANSPOSE(temsnt1)
PRINT,TRANSPOSE(temsmv1)

; => Mean                          :  defines the average of a distribution of data
meannt0  = [ 1.1942435, 1.2139775, 1.2944024,0.93403724,0.92559353,0.85650887,0.73541100]
meanmv0  = [70.271632,77.704603,80.447019,70.834100,77.306118,50.322498,37.612910]
meannt1  = [0.58937438, 1.6256542, 1.0503298, 1.6436450,0.73541100,0.85650887]
meanmv1  = [30.085002,97.611444,88.319400,79.113334,39.944194,51.694936]
; => Standard Deviation            :  defines the variation(dispersion) from the mean
stdvsnt0 = [ 1.4376143, 1.4176424, 1.4646301,0.36640492,0.36170912,0.36260856,0.17485243]
stdvsmv0 = [67.093371,72.105711,72.229339,64.375731,67.709469,43.182816,27.037135]
stdvsnt1 = [ 1.0606826, 2.1554548,0.35837172,0.21000364,0.17485243,0.36260856]
stdvsmv1 = [20.245862,88.873200,73.995961,60.300337,27.276766,43.404105]

; => Standard Deviation of the Mean:  defines the the accuracy of the mean
stdvsntmn0 = stdvsnt0/SQRT(N_ELEMENTS(hb_ae_ind))
stdvsmvmn0 = stdvsmv0/SQRT(N_ELEMENTS(he_ae_ind))
stdvsntmn1 = stdvsnt1/SQRT(N_ELEMENTS(hb_ae_ind))
stdvsmvmn1 = stdvsmv1/SQRT(N_ELEMENTS(he_ae_ind))

str_nt0    = STRTRIM(STRING(meannt0,FORMAT='(f14.4)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsntmn0,FORMAT='(f14.4,";   ")'),2)
str_nt1    = STRTRIM(STRING(meannt1,FORMAT='(f14.4)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsntmn1,FORMAT='(f14.4,";   ")'),2)
str_mv0    = STRTRIM(STRING(meanmv0,FORMAT='(f14.3)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsmvmn0,FORMAT='(f14.4,";   ")'),2)
str_mv1    = STRTRIM(STRING(meanmv1,FORMAT='(f14.3)'),2)+'+/-'+$
             STRTRIM(STRING(stdvsmvmn1,FORMAT='(f14.4,";   ")'),2)

print, str_nt0, FORMAT='(";",7a19)'
print, str_mv0, FORMAT='(";",7a19)'
;-------------------------------------------------------------------------------------------------------------------------------------
; => For AE >
;        100 nT             200 nT             300 nT             400 nT             500 nT             600 nT             700 nT
;-------------------------------------------------------------------------------------------------------------------------------------
;   1.1942+/-0.1956;   1.2140+/-0.1929;   1.2944+/-0.1993;   0.9340+/-0.0499;   0.9256+/-0.0492;   0.8565+/-0.0493;   0.7354+/-0.0238;
;   ==================================================================================================================================
;   70.272+/-4.4630;   77.705+/-4.7964;   80.447+/-4.8046;   70.834+/-4.2822;   77.306+/-4.5040;   50.322+/-2.8725;   37.613+/-1.7985;
;-------------------------------------------------------------------------------------------------------------------------------------

print, str_nt1, FORMAT='(";",6a19)'
print, str_mv1, FORMAT='(";",6a19)'
;------------------------------------------------------------------------------------------------------------------
; => For AE (nT) between
;       10 & 200           200 & 400         400 & 600         600 & 800           800 & 1000         600 & 1000
;------------------------------------------------------------------------------------------------------------------
;   0.5894+/-0.1443;   1.6257+/-0.2933;   1.0503+/-0.0488;   1.6436+/-0.0286;   0.7354+/-0.0238;   0.8565+/-0.0493;
;   ===============================================================================================================
;   30.085+/-1.3467;   97.611+/-5.9118;   88.319+/-4.9221;   79.113+/-4.0111;   39.944+/-1.8144;   51.695+/-2.8872;
;------------------------------------------------------------------------------------------------------------------


;-----------------------------------------------------------------------------------------
; => Determine statistics on wave amplitudes
;-----------------------------------------------------------------------------------------
test_wh  = all_stats_all_waves_read()

wscets   = STRTRIM(test_wh.SCETS,2)
wunix    = time_double(wscets)
wavetype = STRLOWCASE(STRTRIM(test_wh.WAVE_TYPE,2))
rectype  = STRLOWCASE(STRTRIM(test_wh.REC_TYPE,2))
; => Field information
alle_rms = test_wh.E_RMS
allb_rms = test_wh.B_RMS
whe_rms  = test_wh.EMAG_RMS
whb_rms  = test_wh.BMAG_RMS
whe_pk   = test_wh.EMAG_PK
whb_pk   = test_wh.BMAG_PK
; => Wind Location information
w_rad    = test_wh.WIND_RAD_DIST
w_lsh    = test_wh.WIND_L_SHELL
w_mlt    = test_wh.WIND_MLT
wgsm_pos = test_wh.GSM_POS
; => Calculate GSM Latitude
gratio   = wgsm_pos[*,2]/SQRT(wgsm_pos[*,0]^2 + wgsm_pos[*,1]^2)
gsm_lat  = ATAN(gratio)*18d1/!DPI
; => AE-Index information
ae_ind   = test_wh.AE_INDEX
; => Find Only Waves in Magnetosphere
wgood  = STRLOWCASE('Whistlers')
gdates = ['111398','040900','050300','052600','061000','062600','071000',$
          '072300','080400','081500','100301','102401','101002']
FOR j=0L, N_ELEMENTS(gdates) - 1L DO BEGIN                                                   $
  date       = gdates[j]                                                                   & $
  temp       = orbit_region_time_range(DATE=date[0])                                       & $
  tr_m       = time_double(temp.MAGNETOSPHERE)                                             & $
  testm      = (wunix LE tr_m[1] AND wunix GT tr_m[0]) AND (wavetype EQ wgood[0])          & $
  good_m0    = WHERE(testm,gdm0)                                                           & $
  IF (gdm0 GT 0 AND j EQ 0) THEN good_m = good_m0                                          & $
  IF (gdm0 GT 0 AND j GT 0) THEN good_m = [good_m,good_m0]

unq      = UNIQ(good_m,SORT(good_m))
good_m   = good_m[unq]

wscets   = wscets[good_m]
wunix    = wunix[good_m]
wavetype = wavetype[good_m]
rectype  = rectype[good_m]
whe_rms  = whe_rms[good_m]
whb_rms  = whb_rms[good_m]
alle_rms = alle_rms[good_m,*]
allb_rms = allb_rms[good_m,*]
whe_pk   = whe_pk[good_m]
whb_pk   = whb_pk[good_m]
w_rad    = w_rad[good_m]
w_lsh    = w_lsh[good_m]
w_mlt    = w_mlt[good_m]
wgsm_pos = wgsm_pos[good_m,*]
gsm_lat  = gsm_lat[good_m]
ae_ind   = ae_ind[good_m]
;----------------------------------------------------------------
; => Define separation test
;----------------------------------------------------------------
lshell   = 15.
test_lw  = (w_lsh LT lshell[0])
good     = WHERE(test_lw,gd)
print, gd
; => For L < 15
;         257

wscets   = wscets[good]
wunix    = wunix[good]
wavetype = wavetype[good]
rectype  = rectype[good]
whe_rms  = whe_rms[good]
whb_rms  = whb_rms[good]
alle_rms = alle_rms[good,*]
allb_rms = allb_rms[good,*]
whe_pk   = whe_pk[good]
whb_pk   = whb_pk[good]
w_rad    = w_rad[good]
w_lsh    = w_lsh[good]
w_mlt    = w_mlt[good]
wgsm_pos = wgsm_pos[good,*]
gsm_lat  = gsm_lat[good]
ae_ind   = ae_ind[good]

a_bpks   = whb_pk
a_epks   = whe_pk

help, where(a_epks GT 0.), where(a_bpks GT 0.)
;<Expression>    LONG      = Array[256]
;<Expression>    LONG      = Array[72]

good_100  = WHERE(a_epks GE 100.,gd100)
good_1    = WHERE(a_bpks GE 1.,gd1)
print, gd100, gd1
; => For L < 15
;          46          15

print, minmax(w_lsh[good_100]), minmax(w_lsh[good_1])
; => For L < 15
;      3.76100      5.78300
;      4.02400      9.58400

good_50   = WHERE(a_epks GE 50.,gd50)
good_05   = WHERE(a_bpks GE 0.5,gd05)
print, gd50, gd05
; => For L < 15
;          96          38
print, minmax(w_lsh[good_50]), minmax(w_lsh[good_05])
; => For L < 15
;      3.76100      6.32600
;      4.02400      9.58400

good_30   = WHERE(a_epks GE 30.,gd30)
good_03   = WHERE(a_bpks GE 0.3,gd03)
print, gd30, gd03
; => For L < 15
;         128          48
print, minmax(w_lsh[good_30]), minmax(w_lsh[good_03])
; => For L < 15
;      3.69600      9.21100
;      4.02400      11.2550

badd_30   = WHERE(a_epks LT 30.,bd30)
badd_03   = WHERE(a_bpks LT 0.3 AND a_bpks GT 0.,bd03)
print, bd30, bd03
; => For L < 15
;         129          24
print, minmax(w_lsh[badd_30]), minmax(w_lsh[badd_03])
; => For L < 15
;      3.69300      14.1300
;      5.61600      11.0150

mlt_lon   = w_mlt*36d1/24d0
; => Scale MLTs to make them appropriate for Polar Coordinate outputs
;      => 0 deg is at Midnight

good_nt     = WHERE(rectype EQ 'tdss',gdnt,COMPLEMENT=good_mv,NCOMPLEMENT=gdmv)
PRINT, gdnt, gdmv
; => For L < 15
;          72         185

w_lsh_nt    = w_lsh[good_nt]
w_rad_nt    = w_rad[good_nt]
w_mlt_lnt   = mlt_lon[good_nt]
w_mlt_nt    = w_mlt[good_nt]
a_bpks_nt   = a_bpks[good_nt]
a_epks_nt   = a_epks[good_nt]

w_lsh_mv    = w_lsh[good_mv]
w_rad_mv    = w_rad[good_mv]
w_mlt_lmv   = mlt_lon[good_mv]
w_mlt_mv    = w_mlt[good_mv]
a_epks_mv   = a_epks[good_mv]
a_bpks_mv   = a_bpks[good_mv]


good_100mv  = WHERE(a_epks_mv GE 100.,gd100mv)
good_05nt   = WHERE(a_epks_nt GE 0.5,gd05nt)
good_1nT    = WHERE(a_bpks_nt GE 1.,gd1nT)
print, gd100mv, gd05nt, gd1nT
; => For L < 15
;          42          69          15
print, minmax(w_lsh_mv[good_100mv]), minmax(w_lsh_nt[good_05nt]), minmax(w_lsh_nt[good_1nT])
; => For L < 15
;      3.76100      5.78300
;      4.02400      11.2550
;      4.02400      9.58400


test_mean = [mean(w_mlt_lmv[good_100mv],/nan), mean(w_mlt_lnt[good_05nt],/nan), $
             mean(w_mlt_lnt[good_1nT],/nan)]
test_stde = [stddev(w_mlt_lmv[good_100mv],/nan), stddev(w_mlt_lnt[good_05nt],/nan), $
             stddev(w_mlt_lnt[good_1nT],/nan)]
test_str  = STRTRIM(STRING(test_mean,FORMAT='(f15.2)'),2)+$
            ' +/- '+STRTRIM(STRING(test_stde,FORMAT='(f15.2)'),2)+',  '
print, test_str
; => For L < 15
;  70.14 +/- 109.80,   137.99 +/- 124.03,   88.09 +/- 119.79,  

good_30mv   = WHERE(a_epks_mv GE 30.,gd30mv)
good_50mv   = WHERE(a_epks_mv GE 50.,gd50mv)
good_03nt   = WHERE(a_epks_nt GE 0.3,gd03nt)
good_05nT   = WHERE(a_bpks_nt GE 0.5,gd05nT)
print, gd30mv, gd50mv, gd03nt, gd05nT
; => For L < 15
;         114          86          71          38
print, minmax(w_lsh_mv[good_30mv]), minmax(w_lsh_mv[good_50mv])
; => For L < 15
;      3.69600      9.21100
;      3.76100      6.32600
print, minmax(w_lsh_nt[good_03nt]), minmax(w_lsh_nt[good_05nT])
; => For L < 15
;      4.02400      11.2550
;      4.02400      9.58400
