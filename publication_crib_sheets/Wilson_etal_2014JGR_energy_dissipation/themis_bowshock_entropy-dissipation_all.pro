;;----------------------------------------------------------------------------------------
;; => Define some constants and dummy variables
;;----------------------------------------------------------------------------------------
f              = !VALUES.F_NAN
d              = !VALUES.D_NAN
me             = 9.1093829100d-31     ;; => Electron mass [kg]
mp             = 1.6726217770d-27     ;; => Proton mass [kg]
ma             = 6.6446567500d-27     ;; => Alpha-Particle mass [kg]
c              = 2.9979245800d+08     ;; => Speed of light in vacuum [m/s]
epo            = 8.8541878170d-12     ;; => Permittivity of free space [F/m]
muo            = !DPI*4.00000d-07     ;; => Permeability of free space [N/A^2 or H/m]
qq             = 1.6021765650d-19     ;; => Fundamental charge [C]
kB             = 1.3806488000d-23     ;; => Boltzmann Constant [J/K]
hh             = 6.6260695700d-34     ;; => Planck Constant [J s]
GG             = 6.6738400000d-11     ;; => Newtonian Constant [m^(3) kg^(-1) s^(-1)]

f_1eV          = qq[0]/hh[0]          ;; => Freq. associated with 1 eV of energy [Hz]
J_1eV          = hh[0]*f_1eV[0]       ;; => Energy associated with 1 eV of energy [J]
;; => Temp. associated with 1 eV of energy [K]
K_eV           = qq[0]/kB[0]          ;; ~ 11,604.519 K
R_E            = 6.37814d3            ;; => Earth's Equitorial Radius [km]

wpefac         = SQRT(1d6*qq[0]^2/(epo[0]*me[0]))
wpifac         = SQRT(1d6*qq[0]^2/(epo[0]*mp[0]))
ckm            = c[0]*1d-3            ;;  m --> km
;;  Setup margins
!X.MARGIN      = [15,5]
!Y.MARGIN      = [8,4]
;;----------------------------------------------------------------------------------------
;; => Compile necessary routines
;;----------------------------------------------------------------------------------------
@comp_lynn_pros
thm_init

.compile shock_enthalpy_rate
.compile read_thm_j_E_S_corr
.compile thm_load_bowshock_rhsolns
.compile thm_load_bowshock_ascii
.compile find_j2_eta_k_from_h
.compile temp_calc_j2_eta_k_S_from_h

.compile get_thm_entropy_diss_data
.compile temp_thm_entropy_diss_plots

;;  Compile critical Mach number routines
.compile /Users/lbwilson/Desktop/swidl-0.1/IDL_stuff/cribs/marcs_cr-Mach_number/genarr.pro
.compile /Users/lbwilson/Desktop/swidl-0.1/IDL_stuff/cribs/marcs_cr-Mach_number/zbrent.pro
.compile /Users/lbwilson/Desktop/swidl-0.1/IDL_stuff/cribs/marcs_cr-Mach_number/crit_mf.pro
;;----------------------------------------------------------------------------------------
;;  Get ASCII data
;;----------------------------------------------------------------------------------------
thm_load_bowshock_ascii,R_STRUCT=Jo_dE_DS_corr

thm_load_bowshock_ascii,R_STRUCT=Jo_dE_US_corr,/UPSAMPLE

dummy          = get_thm_entropy_diss_data(/UPSAMPLE,JES_STR=Jo_dE_US_corr)
;;----------------------------------------------------------------------------------------
;;  Plot relevant data
;;----------------------------------------------------------------------------------------
.compile temp_thm_entropy_diss_plots
thm_init
loadct2,43
temp_thm_entropy_diss_plots,/UPSAMPLE,JES_STR=Jo_dE_US_corr[0],ENT_STR=dummy[0]
loadct2,43
thm_init
WDELETE,1

;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;  Print wave properties statistics
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
.compile thm_j_E_S_properties_print
thm_j_E_S_properties_print,/UPSAMPLE,JES_STR=Jo_dE_US_corr[0],ENT_STR=dummy[0]

;;----------------------------------------------------------------------------------------
;;  There are 940734 total data points
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂B| [nT, in SCF and NCB basis]  For 940732 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     9.7204328e-05       10.011547      0.20225258      0.41053026   0.00042326486
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂E| [mV/m, in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;       0.014981170       298.93043       12.032875       17.465911     0.018338656
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |S| [µW m^(-2), in NIF and GSE basis]  For 907146 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     3.2018204e-05       2082.0740       2.5385679       13.873594     0.014566338
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |S(w,k)| [µW m^(-2), in NIF and GSE basis]  For 903153 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;      0.0028939700       2892.7800       15.826868       69.074281     0.072683479
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |-(Jo . ∂E)| [µW m^(-3), in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     2.0976900e-09       10.794400     0.023394245      0.11329677   0.00011895804
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  *nu* [W-P collision frequency, IAWs, rad/s, in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     2.3154800e-06       2483.9400       5.1515971       30.565184     0.032092479
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  *eta* [W-P resistivity, IAWs, Ω m, in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     3.1188700e-05       9378.0300       15.858082       107.23452      0.11259286
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  (*eta* |j|^2) [W-P resistivity, IAWs, µW m^(-3), in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     3.5426600e-14       3.4634200   0.00086139013     0.020265178   2.1277797e-05
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂B|/<Bo>_{up}  [unitless, SCM in SCF and NCB basis]  For 940732 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     4.7442600e-05       1.4458600     0.026534206     0.037718770   3.8888802e-05
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |Bo|/<Bo>_{up}  [unitless, FGM in SCF and NCB basis]  For 940734 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;        0.19216211       22.180263       4.5655264       3.5379154    0.0036476572
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂B|^2/(2 µ_o)  [µW m^(-3), SCM in SCF and NCB basis]  For 940732 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     3.7595109e-15   3.9880680e-05   8.3333935e-08   5.9998913e-07   6.1860072e-10
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂E|/(c <Bo>_{up})  [unitless, EFI in NIF and NCB basis]  For 907119 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     3.6605300e-05       1.0934600    0.0091960853     0.018478075   1.9401022e-05
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  ∑_o |∂E|^2/2 [µW m^(-3), EFI in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     9.9359678e-16   3.9560247e-07   1.9915185e-09   9.3485439e-09   9.8156761e-12
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |k| = ∆¥/|S(w,k)| [km^(-1)]  For 903153 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     2.9598561e-05       109.17325       1.4052027       3.2378543    0.0034070353
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |k| = ∆∑/|S(w,k)| [km^(-1)]  For 903153 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     8.9505614e-06       23.501608     0.093324723      0.34471644   0.00036272821
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  § = (*eta* |j|^2)/∆¥  [unitless (from enthalpy), EFI in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     6.6782486e-12       62177.338       9.8863478       208.43874      0.21885410
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  £ = (*eta* |j|^2)/∆∑  [unitless (from entropy), EFI in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     9.0564973e-11       398307.75       57.056062       1311.8504       1.3774015
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  ø = (*eta* |j|^2)/(∆K/∆t)  [unitless (from KE), EFI in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     6.0510406e-12       29607.525       4.8239385       98.920354      0.10386325
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  ‡ = |(Jo . ∂E)|/∆¥  [unitless (from enthalpy), EFI in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     3.9543437e-07       104396.43       334.32926       1449.5929       1.5220268
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  € = |(Jo . ∂E)|/∆∑  [unitless (from entropy), EFI in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     5.3625591e-06       668763.06       1540.1956       6021.2059       6.3220762
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  Ω = |Jo . ∂E|/(∆K/∆t)  [unitless (from KE), EFI in NIF and NCB basis]  For 907084 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     3.5829595e-07       49711.357       150.26440       680.01423      0.71399349
;;----------------------------------------------------------------------------------------


thresh         = 1d0
lab0           = STRTRIM(STRING(thresh[0],FORMAT='(f15.1)'),2)
;;  £ = (*eta* |j|^2)/∆∑
x              = dummy.MICRO_PARAMS.RAT_ETAJSQ_DSDT[*,0]
lab            = ';;  £ = (*eta* |j|^2)/∆∑  > '+lab0[0]

;;  ø = (*eta* |j|^2)/(∆K/∆t)
x              = dummy.MICRO_PARAMS.RAT_ETAJSQ_DKDT[*,0]
lab            = ';;  ø = (*eta* |j|^2)/(∆K/∆t)  > '+lab0[0]

;;  € = |(Jo . ∂E)|/∆∑
x              = dummy.MICRO_PARAMS.RAT_EDOTJ_DSDT
lab            = ';;  € = |(Jo . ∂E)|/∆∑  > '+lab0[0]

;;  Ω = |Jo . ∂E|/(∆K/∆t)
x              = dummy.MICRO_PARAMS.RAT_EDOTJ_DKDT
lab            = ';;  Ω = |Jo . ∂E|/(∆K/∆t)  > '+lab0[0]

good           = WHERE(FINITE(x),gd)
x              = x[good]
nx             = N_ELEMENTS(x)
good_1         = WHERE(x GE thresh[0],gd1)
FOR j=0L, 0L DO BEGIN $
  PRINT, ';;'    & $
  PRINT, lab[0]  & $
  PRINT, ';;  ', gd1, nx, (1d0*gd1[0]/(1d0*nx[0]))*1d2

;;
;;  £ = (*eta* |j|^2)/∆∑  > 1.0
;;        203100      907147       22.388874
;;
;;  ø = (*eta* |j|^2)/(∆K/∆t)  > 1.0
;;         91682      907147       10.106631
;;
;;  € = |(Jo . ∂E)|/∆∑  > 1.0
;;        856456      940734       91.041251
;;
;;  Ω = |Jo . ∂E|/(∆K/∆t)  > 1.0
;;        647793      940734       68.860379


thresh         = 1d1
thresh         = 1d2
thresh         = 1d3
lab0           = STRTRIM(STRING(thresh[0],FORMAT='(f15.1)'),2)
;;  € = |(Jo . ∂E)|/∆∑
x              = dummy.MICRO_PARAMS.RAT_EDOTJ_DSDT
lab            = ';;  € = |(Jo . ∂E)|/∆∑  > '+lab0[0]

;;  Ω = |Jo . ∂E|/(∆K/∆t)
x              = dummy.MICRO_PARAMS.RAT_EDOTJ_DKDT
lab            = ';;  Ω = |Jo . ∂E|/(∆K/∆t)  > '+lab0[0]

good           = WHERE(FINITE(x),gd)
x              = x[good]
nx             = N_ELEMENTS(x)
good_1         = WHERE(x GE thresh[0],gd1)
FOR j=0L, 0L DO BEGIN $
  PRINT, ';;'    & $
  PRINT, lab[0]  & $
  PRINT, ';;  ', gd1, nx, (1d0*gd1[0]/(1d0*nx[0]))*1d2

;;
;;  € = |(Jo . ∂E)|/∆∑  > 10.0
;;        686970      940734       73.024893
;;
;;  Ω = |Jo . ∂E|/(∆K/∆t)  > 10.0
;;        422060      940734       44.864967
;;
;;
;;  € = |(Jo . ∂E)|/∆∑  > 100.0
;;        479137      940734       50.932251
;;
;;  Ω = |Jo . ∂E|/(∆K/∆t)  > 100.0
;;        175092      940734       18.612275
;;
;;
;;  € = |(Jo . ∂E)|/∆∑  > 1000.0
;;        205227      940734       21.815625
;;
;;  Ω = |Jo . ∂E|/(∆K/∆t)  > 1000.0
;;         28893      940734       3.0713252


;;  Define ∑ -(Jo . ∂E)  {cumulative sum of -(Jo . ∂E)}
EdJoCS_nif_ncb = dummy.MICRO_PARAMS.EDJ_CS_NIF_NCB_JES    ;;  [µW m^(-3), in NIF and NCB basis]
;;  Define shock ramp durations, ∆Tsh [s]
all_dt_sh      = dummy.MACRO_PARAMS.ALL_DT_SH
;;  Define dissipation rate estimates:  kinetic energy density change ∆K [µJ m^(-3)]
avg_dKE_obs    = dummy.MACRO_PARAMS.AVG_DKE_OBS
;;  Calculate (∆K/∆t) [µW m^(-3)]
dKE_dt_sh      = REFORM(avg_dKE_obs[*,0])/REFORM(all_dt_sh[*,0])
tempx          = (avg_dKE_obs[*,1]/avg_dKE_obs[*,0])^2 + (all_dt_sh[*,1]/all_dt_sh[*,0])^2
d_dKE_dt_sh    = ABS(dKE_dt_sh)*SQRT(tempx)


ind_struc      = dummy.ALL_IND
date_tags      = TAG_NAMES(ind_struc)
ncross         = N_TAGS(ind_struc)
stats_EdJCS    = REPLICATE(d,ncross,5L)
statsEdJCSdKdt = REPLICATE(d,ncross,5L)
FL_EdJCS       = REPLICATE(d,ncross,2L)
Max_D_EdJCS    = REPLICATE(d,ncross)
MaxDEdJCSdKdt  = REPLICATE(d,ncross)
stats_gels     = REPLICATE(0L,ncross)
FOR j=0L, ncross - 1L DO BEGIN                                                                          $
  gind = ind_struc.(j)                                                                                & $
  EdJoCS_0 = EdJoCS_nif_ncb[gind]                                                                     & $
  test     = FINITE(EdJoCS_0)                                                                         & $
  good     = WHERE(test,gd)                                                                           & $
  stats_gels[j] = gd[0]                                                                               & $
  nx       = 1d0*gd[0]                                                                                & $
  EdJoCS_1 = EdJoCS_0[good]                                                                           & $
  Max_D_EdJCS[j]   = MAX(EdJoCS_1,/NAN) - MIN(EdJoCS_1,/NAN)                                          & $
  MaxDEdJCSdKdt[j] = Max_D_EdJCS[j]/dKE_dt_sh[j]                                                      & $
  FL_EdJCS[j,*]    = [EdJoCS_1[0],EdJoCS_1[gd - 1L]]                                                  & $
  rat_0    = EdJoCS_1/dKE_dt_sh[j]                                                                    & $
  std0     = STDDEV(EdJoCS_1,/NAN)                                                                    & $
  std1     = STDDEV(rat_0,/NAN)                                                                       & $
  stat0    = [MIN(EdJoCS_1,/NAN),MAX(EdJoCS_1,/NAN),MEAN(EdJoCS_1,/NAN),std0[0],std0[0]/SQRT(nx[0])]  & $
  stat1    = [MIN(rat_0,/NAN),MAX(rat_0,/NAN),MEAN(rat_0,/NAN),std1[0],std1[0]/SQRT(nx[0])]           & $
  stats_EdJCS[j,*]    = stat0                                                                         & $
  statsEdJCSdKdt[j,*] = stat1


x              = stats_EdJCS
lab            = ';;  ∑ -(Jo . ∂E)  {cumulative sum of -(Jo . ∂E)} [µW m^(-3), in NIF and NCB basis]'

x              = statsEdJCSdKdt
lab            = ';;  ∑ -(Jo . ∂E)/(∆K/∆t)  {normalized cumulative sum of -(Jo . ∂E)} [unitless, in NIF and NCB basis]'

line0          = ';;            Date          # pts         Min            Max            Mean        Std. Dev.      Std. Dev.'
line1          = ';;                                                                                                  of Mean'
line2          = ';;============================================================================================================='
line3          = ';;-------------------------------------------------------------------------------------------------------------'
slen_str       = STRING(STRLEN(date_tags[0]) + 3L,FORMAT='(I2.2)')
mform          = '(";; ",a'+slen_str[0]+',"  ",I8.8,5e15.5)'
FOR j=0L, ncross - 1L DO BEGIN                                                  $
  IF (j EQ 0) THEN PRINT,line3[0]                                             & $
  IF (j EQ 0) THEN PRINT,lab[0]                                               & $
  IF (j EQ 0) THEN PRINT,line3[0]                                             & $
  IF (j EQ 0) THEN PRINT,line0[0]                                             & $
  IF (j EQ 0) THEN PRINT,line1[0]                                             & $
  IF (j EQ 0) THEN PRINT,line2[0]                                             & $
  PRINT,date_tags[j],stats_gels[j],REFORM(x[j,*]),FORMAT=mform[0]             & $
  IF (j EQ ncross - 1L) THEN PRINT,line3[0]

;;-------------------------------------------------------------------------------------------------------------
;;  ∑ -(Jo . ∂E)  {cumulative sum of -(Jo . ∂E)} [µW m^(-3), in NIF and NCB basis]
;;-------------------------------------------------------------------------------------------------------------
;;            Date          # pts         Min            Max            Mean        Std. Dev.      Std. Dev.
;;                                                                                                  of Mean
;;=============================================================================================================
;;    THB_2009_07_13_1ST  00104448   -3.17760e+00    1.07679e+01    6.75936e+00    3.23452e+00    1.00083e-02
;;    THC_2009_07_21_1ST  00051388   -8.17981e-01    1.90181e+01    9.19556e+00    5.97150e+00    2.63422e-02
;;    THC_2009_07_23_1ST  00052225    2.10993e-03    1.67595e+02    8.62206e+01    5.70508e+01    2.49645e-01
;;    THC_2009_07_23_2ND  00051712   -1.22624e+03    3.00485e+01   -9.15122e+02    3.09053e+02    1.35905e+00
;;    THC_2009_07_23_3RD  00104448   -3.65444e+01    3.93620e+01    2.10140e+00    2.11514e+01    6.54468e-02
;;    THC_2009_09_05_1ST  00104960   -2.27308e+00    1.47833e+00   -3.95686e-01    8.84011e-01    2.72864e-03
;;    THC_2009_09_05_2ND  00052225   -5.08195e-01    1.61430e+00    8.23952e-01    3.31246e-01    1.44948e-03
;;    THC_2009_09_05_3RD  00052736   -9.34504e+01    2.86023e+01   -2.52040e+01    2.01109e+01    8.75743e-02
;;    THA_2009_09_26_1ST  00104448   -1.82958e+02    1.09211e+01   -6.32888e+01    7.74828e+01    2.39748e-01
;;    THE_2011_10_24_1ST  00131072    2.37314e-03    3.21673e+01    1.05645e+01    7.21213e+00    1.99209e-02
;;    THE_2011_10_24_2ND  00131072   -8.44738e+00    4.20646e+03    3.08513e+03    1.20647e+03    3.33244e+00
;;-------------------------------------------------------------------------------------------------------------

;;-------------------------------------------------------------------------------------------------------------
;;  ∑ -(Jo . ∂E)/(∆K/∆t)  {normalized cumulative sum of -(Jo . ∂E)} [unitless, in NIF and NCB basis]
;;-------------------------------------------------------------------------------------------------------------
;;            Date          # pts         Min            Max            Mean        Std. Dev.      Std. Dev.
;;                                                                                                  of Mean
;;=============================================================================================================
;;    THB_2009_07_13_1ST  00104448   -2.33904e+04    7.92631e+04    4.97560e+04    2.38095e+04    7.36715e+01
;;    THC_2009_07_21_1ST  00051388   -1.83523e+04    4.26692e+05    2.06312e+05    1.33977e+05    5.91016e+02
;;    THC_2009_07_23_1ST  00052225    5.87144e+01    4.66377e+06    2.39932e+06    1.58759e+06    6.94703e+03
;;    THC_2009_07_23_2ND  00051712   -1.62066e+06    3.97139e+04   -1.20948e+06    4.08462e+05    1.79620e+03
;;    THC_2009_07_23_3RD  00104448   -2.52880e+06    2.72377e+06    1.45413e+05    1.46363e+06    4.52879e+03
;;    THC_2009_09_05_1ST  00104960   -1.93386e+04    1.25771e+04   -3.36637e+03    7.52087e+03    2.32143e+01
;;    THC_2009_09_05_2ND  00052225   -4.31822e+03    1.37170e+04    7.00125e+03    2.81465e+03    1.23164e+01
;;    THC_2009_09_05_3RD  00052736   -7.98874e+05    2.44510e+05   -2.15460e+05    1.71920e+05    7.48641e+02
;;    THA_2009_09_26_1ST  00104448   -8.99371e+04    5.36850e+03   -3.11110e+04    3.80884e+04    1.17854e+02
;;    THE_2011_10_24_1ST  00131072    4.05344e-01    5.49433e+03    1.80447e+03    1.23187e+03    3.40259e+00
;;    THE_2011_10_24_2ND  00131072   -6.99111e+03    3.48129e+06    2.55327e+06    9.98483e+05    2.75794e+03
;;-------------------------------------------------------------------------------------------------------------


mform          = '(";; ",a'+slen_str[0]+',"  ",I8.8,5e15.5)'
FOR j=0L, ncross - 1L DO BEGIN                                                  $
  val_23   = REFORM(FL_EdJCS[j,*])                                            & $
  val_4    = Max_D_EdJCS[j]                                                   & $
  rat_0    = MaxDEdJCSdKdt[j]                                                 & $
  PRINT,date_tags[j],stats_gels[j],val_23,val_23[1] - val_23[0],val_4[0],rat_0[0],FORMAT=mform[0]

;;-------------------------------------------------------------------------------------------------------------
;;  Columns:
;;    0) Date and Probe
;;    1) Number of finite measurements
;;    2) First value of ∑ -(Jo . ∂E)      [µW m^(-3), in NIF and NCB basis]
;;    3) Last  value of ∑ -(Jo . ∂E)      [µW m^(-3), in NIF and NCB basis]
;;    4) (Last - First)
;;    5) Max{ ∆[ ∑ -(Jo . ∂E) ] }         [µW m^(-3), in NIF and NCB basis]
;;    6) Max{ ∆[ ∑ -(Jo . ∂E) ] }/(∆K/∆t) [unitless, in NIF and NCB basis]
;;-------------------------------------------------------------------------------------------------------------
;;    THB_2009_07_13_1ST  00104448   -4.27658e-03    9.92665e+00    9.93092e+00    1.39455e+01    1.02654e+05
;;    THC_2009_07_21_1ST  00051388    1.06104e-02    1.39238e+01    1.39132e+01    1.98361e+01    4.45044e+05
;;    THC_2009_07_23_1ST  00052225    2.10993e-03    1.67469e+02    1.67467e+02    1.67593e+02    4.66372e+06
;;    THC_2009_07_23_2ND  00051712   -5.81947e-02   -1.22410e+03   -1.22404e+03    1.25628e+03    1.66038e+06
;;    THC_2009_07_23_3RD  00104448    3.03525e-03   -2.11941e+00   -2.12244e+00    7.59064e+01    5.25257e+06
;;    THC_2009_09_05_1ST  00104960    1.56312e-04   -8.37470e-01   -8.37627e-01    3.75141e+00    3.19157e+04
;;    THC_2009_09_05_2ND  00052225    3.29795e-04    1.17079e+00    1.17046e+00    2.12250e+00    1.80352e+04
;;    THC_2009_09_05_3RD  00052736   -0.00000e+00   -3.26459e+01   -3.26459e+01    1.22053e+02    1.04338e+06
;;    THA_2009_09_26_1ST  00104448    6.38274e-04   -1.40244e+02   -1.40245e+02    1.93879e+02    9.53056e+04
;;    THE_2011_10_24_1ST  00131072    2.37314e-03    3.02659e+01    3.02636e+01    3.21649e+01    5.49392e+03
;;    THE_2011_10_24_2ND  00131072   -5.75186e-03    4.20412e+03    4.20413e+03    4.21491e+03    3.48828e+06
;;-------------------------------------------------------------------------------------------------------------


;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;  Print LaTeX tables
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
.compile temp_thm_print_latex_tables_1_2
temp_thm_print_latex_tables_1_2,/UPSAMPLE,JES_STR=Jo_dE_US_corr[0],ENT_STR=dummy[0]


;;  Table 1
{\small 2009-07-13 [1st Crossing]} & B &  53 $\pm$  2 & 275 $\pm$ 2 & 43$^{\circ}$ $\pm$ 5$^{\circ}$ & 3.07 $\pm$ 0.10 & 6.7 $\pm$ 0.6   \\
{\small 2009-07-21 [1st Crossing]} & C &  24 $\pm$  7 & 200 $\pm$ 2 & 51$^{\circ}$ $\pm$ 6$^{\circ}$ & 2.06 $\pm$ 0.12 & 3.6 $\pm$ 0.5   \\
{\small 2009-07-23 [1st Crossing]} & C &  65 $\pm$  7 & 425 $\pm$ 2 & 83$^{\circ}$ $\pm$ 3$^{\circ}$ & 3.04 $\pm$ 0.04 & 4.1 $\pm$ 0.3   \\
{\small 2009-07-23 [2nd Crossing]} & C &  13 $\pm$  7 & 504 $\pm$ 2 & 88$^{\circ}$ $\pm$ 2$^{\circ}$ & 3.62 $\pm$ 0.05 & 3.7 $\pm$ 0.2   \\
{\small 2009-07-23 [3rd Crossing]} & C &  38 $\pm$ 10 & 417 $\pm$ 1 & 54$^{\circ}$ $\pm$ 4$^{\circ}$ & 3.11 $\pm$ 0.06 & 2.8 $\pm$ 0.4   \\
{\small 2009-09-05 [1st Crossing]} & C &  78 $\pm$  5 & 270 $\pm$ 1 & 73$^{\circ}$ $\pm$ 3$^{\circ}$ & 4.42 $\pm$ 0.06 & 6.9 $\pm$ 0.9   \\
{\small 2009-09-05 [2nd Crossing]} & C & 120 $\pm$ 18 & 220 $\pm$ 1 & 35$^{\circ}$ $\pm$ 2$^{\circ}$ & 3.54 $\pm$ 0.04 & 5.4 $\pm$ 1.4   \\
{\small 2009-09-05 [3rd Crossing]} & C &   1 $\pm$ 16 & 357 $\pm$ 1 & 56$^{\circ}$ $\pm$ 3$^{\circ}$ & 5.33 $\pm$ 0.06 & 6.2 $\pm$ 2.4   \\
{\small 2009-09-26 [1st Crossing]} & A &  29 $\pm$  8 & 339 $\pm$ 1 & 60$^{\circ}$ $\pm$ 9$^{\circ}$ & 4.83 $\pm$ 0.26 & 4.2 $\pm$ 0.8   \\
{\small 2011-10-24 [1st Crossing]} & E &  44 $\pm$  9 & 361 $\pm$ 2 & 84$^{\circ}$ $\pm$ 5$^{\circ}$ & 2.22 $\pm$ 0.04 & 3.0 $\pm$ 0.3   \\
{\small 2011-10-24 [2nd Crossing]} & E &  32 $\pm$  5 & 365 $\pm$ 2 & 88$^{\circ}$ $\pm$ 2$^{\circ}$ & 2.33 $\pm$ 0.01 & 4.8 $\pm$ 0.3   \\

;;  Table 2
{\small 2009-07-13 [1st Crossing]} & 2.97 $\pm$ 0.10 & 0.20 $\pm$ 0.02 & 0.15 $\pm$ 0.01 & 0.14 $\pm$ 0.01   \\
{\small 2009-07-21 [1st Crossing]} & 1.45 $\pm$ 0.13 & 0.15 $\pm$ 0.02 & 0.12 $\pm$ 0.01 & 0.11 $\pm$ 0.01   \\
{\small 2009-07-23 [1st Crossing]} & 2.50 $\pm$ 0.06 & 1.24 $\pm$ 0.48 & 0.95 $\pm$ 0.37 & 0.88 $\pm$ 0.34   \\
{\small 2009-07-23 [2nd Crossing]} & 2.98 $\pm$ 0.07 & 5.24 $\pm$ 5.19 & 4.04 $\pm$ 4.00 & 3.71 $\pm$ 3.67   \\
{\small 2009-07-23 [3rd Crossing]} & 2.61 $\pm$ 0.07 & 0.25 $\pm$ 0.02 & 0.19 $\pm$ 0.02 & 0.18 $\pm$ 0.02   \\
{\small 2009-09-05 [1st Crossing]} & 4.33 $\pm$ 0.06 & 0.71 $\pm$ 0.09 & 0.55 $\pm$ 0.07 & 0.50 $\pm$ 0.06   \\
{\small 2009-09-05 [2nd Crossing]} & 3.44 $\pm$ 0.04 & 0.20 $\pm$ 0.00 & 0.16 $\pm$ 0.00 & 0.14 $\pm$ 0.00   \\
{\small 2009-09-05 [3rd Crossing]} & 5.16 $\pm$ 0.06 & 0.44 $\pm$ 0.03 & 0.34 $\pm$ 0.02 & 0.31 $\pm$ 0.02   \\
{\small 2009-09-26 [1st Crossing]} & 4.61 $\pm$ 0.26 & 0.45 $\pm$ 0.13 & 0.35 $\pm$ 0.10 & 0.32 $\pm$ 0.09   \\
{\small 2011-10-24 [1st Crossing]} & 2.02 $\pm$ 0.04 & 1.00 $\pm$ 0.75 & 0.77 $\pm$ 0.58 & 0.71 $\pm$ 0.53   \\
{\small 2011-10-24 [2nd Crossing]} & 1.75 $\pm$ 0.01 & 2.58 $\pm$ 1.48 & 1.99 $\pm$ 1.14 & 1.83 $\pm$ 1.05   \\

;;  Table 3
$\mid$$\delta$\textbf{E}$\mid$ [mV m$^{-1}$]               & 1.50$\times$10$^{-02}$ & 2.99$\times$10$^{+02}$ & 1.20$\times$10$^{+01}$ & 1.75$\times$10$^{+01}$ & 1.83$\times$10$^{-02}$ & 907084  \\
$\mid$$\delta$\textbf{B}$\mid$ [nT]                        & 9.72$\times$10$^{-05}$ & 1.00$\times$10$^{+01}$ & 2.02$\times$10$^{-01}$ & 4.11$\times$10$^{-01}$ & 4.23$\times$10$^{-04}$ & 940732  \\
$\mid$$\delta$\textbf{S}$\mid$ [$\mu$W m$^{-2}$]           & 3.20$\times$10$^{-05}$ & 2.08$\times$10$^{+03}$ & 2.54$\times$10$^{+00}$ & 1.39$\times$10$^{+01}$ & 1.46$\times$10$^{-02}$ & 907146  \\
$\mid$$\delta \tilde{\textbf{S}}$$\mid$ [$\mu$W m$^{-2}$]  & 2.89$\times$10$^{-03}$ & 2.89$\times$10$^{+03}$ & 1.58$\times$10$^{+01}$ & 6.91$\times$10$^{+01}$ & 7.27$\times$10$^{-02}$ & 903153  \\
\hline
$\mathfrak{B}$ [unitless]                                  & 4.74$\times$10$^{-05}$ & 1.45$\times$10$^{+00}$ & 2.65$\times$10$^{-02}$ & 3.77$\times$10$^{-02}$ & 3.89$\times$10$^{-05}$ & 940732  \\
$\mathfrak{b}$ [unitless]                                  & 1.92$\times$10$^{-01}$ & 2.22$\times$10$^{+01}$ & 4.57$\times$10$^{+00}$ & 3.54$\times$10$^{+00}$ & 3.65$\times$10$^{-03}$ & 940734  \\
$\mathfrak{E}$ [unitless]                                  & 3.66$\times$10$^{-05}$ & 1.09$\times$10$^{+00}$ & 9.20$\times$10$^{-03}$ & 1.85$\times$10$^{-02}$ & 1.94$\times$10$^{-05}$ & 907119  \\
\hline
$\mathcal{W}{\scriptstyle_{B}}$ [$\mu$W m$^{-3}$]          & 3.76$\times$10$^{-15}$ & 3.99$\times$10$^{-05}$ & 8.33$\times$10$^{-08}$ & 6.00$\times$10$^{-07}$ & 6.19$\times$10$^{-10}$ & 940732  \\
$\mathcal{W}{\scriptstyle_{E}}$ [$\mu$W m$^{-3}$]          & 9.94$\times$10$^{-16}$ & 3.96$\times$10$^{-07}$ & 1.99$\times$10$^{-09}$ & 9.35$\times$10$^{-09}$ & 9.82$\times$10$^{-12}$ & 907084  \\
\hline
$\nu{\scriptstyle_{iaw}}$ [coll. s$^{-1}$]                 & 2.32$\times$10$^{-06}$ & 2.48$\times$10$^{+03}$ & 5.15$\times$10$^{+00}$ & 3.06$\times$10$^{+01}$ & 3.21$\times$10$^{-02}$ & 907084  \\
$\eta{\scriptstyle_{iaw}}$ [$\Omega$ m]                    & 3.12$\times$10$^{-05}$ & 9.38$\times$10$^{+03}$ & 1.59$\times$10$^{+01}$ & 1.07$\times$10$^{+02}$ & 1.13$\times$10$^{-01}$ & 907084  \\
\hline
$\mathfrak{R}{\scriptstyle_{\eta}}$ [$\mu$W m$^{-3}$]      & 2.10$\times$10$^{-09}$ & 1.08$\times$10$^{+01}$ & 2.34$\times$10$^{-02}$ & 1.13$\times$10$^{-01}$ & 1.19$\times$10$^{-04}$ & 907084  \\
$\mathcal{S}{\scriptstyle_{\eta}}$ [$\mu$W m$^{-3}$]       & 3.54$\times$10$^{-14}$ & 3.46$\times$10$^{+00}$ & 8.61$\times$10$^{-04}$ & 2.03$\times$10$^{-02}$ & 2.13$\times$10$^{-05}$ & 907084  \\
\hline
$\mathcal{Y}{\scriptstyle_{\Psi}}$ [unitless]              & 9.06$\times$10$^{-11}$ & 3.98$\times$10$^{+05}$ & 5.71$\times$10$^{+01}$ & 1.31$\times$10$^{+03}$ & 1.38$\times$10$^{+00}$ & 907084  \\
$\mathcal{R}{\scriptstyle_{\Psi}}$ [unitless]              & 5.36$\times$10$^{-06}$ & 6.69$\times$10$^{+05}$ & 1.54$\times$10$^{+03}$ & 6.02$\times$10$^{+03}$ & 6.32$\times$10$^{+00}$ & 907084  \\


;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;  Print RH solutions
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
.compile temp_thm_print_rh_soln
temp_thm_print_rh_soln,/UPSAMPLE,JES_STR=Jo_dE_US_corr[0],ENT_STR=dummy[0]

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  All Dates [YYYY-MM-DD]
;;=======================================================================================================================================
;;  2009-07-13  2009-07-21  2009-07-23  2009-07-23  2009-07-23  2009-09-05  2009-09-05  2009-09-05  2009-09-26  2011-10-24  2011-10-24
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Bx>_up [SCF, GSE, Upstream, nT]
;;=======================================================================================================================================
;;     -3.04437     3.66873     0.18061    -0.38117     3.60688     0.61279    -1.07333    -0.27134     2.23681     6.31291     4.22466
;;      0.15507     0.94958     0.26427     0.26692     0.28193     0.02951     0.05070     0.08229     0.68943     1.94275     0.24412
;;      0.02880     0.20245     0.06823     0.07403     0.06152     0.00890     0.01309     0.02199     0.10056     0.34893     0.04613
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <By>_up [SCF, GSE, Upstream, nT]
;;=======================================================================================================================================
;;      1.33835     7.62505     0.28358    -0.03737    -5.25425    -0.57619    -1.06252    -1.27554     0.21692    -2.30938    15.18630
;;      0.45210     0.67515     0.17130     0.17273     0.30040     0.02716     0.09215     0.02816     0.40203     4.36331     0.54536
;;      0.08395     0.14394     0.04423     0.04791     0.06555     0.00819     0.02379     0.00753     0.05864     0.78367     0.10306
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Bz>_up [SCF, GSE, Upstream, nT]
;;=======================================================================================================================================
;;     -1.48370     0.87879    -5.72394    -6.40433     0.84648    -0.29178    -0.23282    -0.27750    -2.02624    -9.69085    -9.22152
;;      0.10394     1.63304     0.31831     0.33449     0.27612     0.06954     0.04637     0.08383     0.63323     3.26641     0.74283
;;      0.01930     0.34817     0.08219     0.09277     0.06025     0.02097     0.01197     0.02240     0.09237     0.58666     0.14038
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <|Bo|>_up [SCF, Upstream, nT]
;;=======================================================================================================================================
;;      3.69800     7.70803     6.05171     6.08037     6.41334     0.91616     1.63636     1.40276     3.13416    16.21770    18.17584
;;      0.11755     0.85116     0.31433     0.32930     0.16820     0.03778     0.09981     0.03405     0.84228     0.96542     0.07544
;;      0.02183     0.18147     0.08116     0.09133     0.03671     0.01139     0.02577     0.00910     0.12286     0.17340     0.01426
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Vx>_up [SCF, GSE, Upstream, km/s]
;;=======================================================================================================================================
;;     -328.746    -250.544    -488.290    -488.163    -456.419    -378.828    -356.562    -380.332    -307.345    -435.801    -477.028
;;        6.319       9.287       4.572       4.849       3.079       2.163       2.479       2.025       1.082       9.994       2.508
;;        1.173       1.980       1.180       1.345       0.672       0.652       0.640       0.541       0.158       1.795       0.474
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Vy>_up [SCF, GSE, Upstream, km/s]
;;=======================================================================================================================================
;;       10.869      37.200      82.899      82.926      57.813       5.583     -31.572      -7.419      65.093     -14.166     104.805
;;       16.702      11.448       0.739       0.794       2.438       2.104       1.352       1.455       0.483      35.209       4.750
;;        3.101       2.441       0.191       0.220       0.532       0.634       0.349       0.389       0.070       6.324       0.898
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Vz>_up [SCF, GSE, Upstream, km/s]
;;=======================================================================================================================================
;;       16.801       6.473     -92.330     -92.519       7.732      -6.798      -3.109      -0.418      30.378      -7.566       9.886
;;        2.529      24.195       2.247       2.341       3.444       2.065       1.916       3.209       0.436      18.384      18.555
;;        0.470       5.158       0.580       0.649       0.752       0.623       0.495       0.858       0.064       3.302       3.507
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <|V|>_up [SCF, Upstream, km/s]
;;=======================================================================================================================================
;;      329.770     254.665     503.816     503.733     460.150     378.940     357.978     380.419     315.628     437.881     488.863
;;        6.426      10.724       4.429       4.692       2.935       2.174       2.402       2.009       1.077       8.100       3.317
;;        1.193       2.286       1.143       1.301       0.641       0.655       0.620       0.537       0.157       1.455       0.627
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Ni>_up [Upstream, cm^(-3)]
;;=======================================================================================================================================
;;      7.21921     7.36031     3.73654     3.71973     3.88664     2.61508     2.65507     2.56415     9.66698    33.55473    20.44722
;;      0.60208     0.79248     0.09663     0.07550     0.13496     0.09517     0.19349     0.09981     0.48493     1.17835     0.18888
;;      0.11180     0.16896     0.02495     0.02094     0.02945     0.02870     0.04996     0.02668     0.07073     0.21164     0.03569
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Te>_up [Upstream, eV]
;;=======================================================================================================================================
;;     11.23725     9.29213     9.42997     9.48648    14.07636    13.63830    11.88435    17.05616     7.87657    31.24348    18.66565
;;      1.07062     0.67836     0.70508     0.74435     0.88914     0.74777     0.25906     0.59175     0.41691     0.67284     0.62781
;;      0.19881     0.14463     0.18205     0.20644     0.19403     0.22546     0.06689     0.15815     0.06081     0.12085     0.11864
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Ti>_up [Upstream, eV]
;;=======================================================================================================================================
;;     30.15536    16.11729    65.32558    65.21508    53.45133     8.18439     7.46431     7.80712    17.52811    91.38626    64.23226
;;      2.62020     3.97285     1.15368     1.18863     1.72039     0.18363     0.27050     0.20062     0.89242     4.13350     1.42695
;;      0.48656     0.84701     0.29788     0.32967     0.37542     0.05537     0.06984     0.05362     0.13017     0.74240     0.26967
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <ße>_up [Electron Beta, Upstream, unitless]
;;=======================================================================================================================================
;;      2.38177     0.46835     0.38988     0.38708     0.53608    17.19753     4.75785     8.95703     5.40184     1.62036     0.46511
;;      0.20122     0.05340     0.04795     0.05062     0.04110     1.83928     0.31007     0.51416     9.41425     0.19978     0.01293
;;      0.03737     0.01138     0.01238     0.01404     0.00897     0.55456     0.08006     0.13741     1.37321     0.03588     0.00244
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <ßi>_up [Ion Beta, Upstream, unitless]
;;=======================================================================================================================================
;;      6.41909     0.80972     2.70244     2.66079     2.03740    10.30313     2.99148     4.09790    12.31639     4.74205     1.60103
;;      0.76346     0.20185     0.27120     0.26393     0.13751     0.78195     0.25672     0.16879    22.27127     0.64013     0.04478
;;      0.14177     0.04304     0.07002     0.07320     0.03001     0.23577     0.06628     0.04511     3.24860     0.11497     0.00846
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <ß>_up [Total Beta, Upstream, unitless]
;;=======================================================================================================================================
;;      8.80086     1.27807     3.09232     3.04787     2.57348    27.50066     7.74933    13.05493    17.71823     6.36241     2.06614
;;      0.77675     0.21615     0.30680     0.30160     0.16109     2.51364     0.54652     0.62291    31.68199     0.83159     0.03707
;;      0.14424     0.04608     0.07921     0.08365     0.03515     0.75789     0.14111     0.16648     4.62129     0.14936     0.00701
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Bx>_dn [SCF, GSE, Downstream, nT]
;;=======================================================================================================================================
;;     -6.20272    -2.24987    -2.82384     2.50128     4.13227     2.96029    -2.95334     0.40841     5.41578     8.26306    -3.32526
;;      2.34598     3.91304     1.65017     1.01459     1.74997     0.04727     2.21807     1.16064     7.11051     3.64282     4.38643
;;      0.43564     0.83426     0.42607     0.28140     0.38187     0.01425     0.57270     0.31020     1.03718     0.65427     0.82896
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <By>_dn [SCF, GSE, Downstream, nT]
;;=======================================================================================================================================
;;      9.76620     4.77507     0.79020   -15.99832   -15.54344    -8.57990    -5.69773    -6.53712    -7.90257   -15.34452    46.57583
;;      1.05178     7.21832     1.37491     1.62797     1.23118     0.78387     3.09736     2.05798     6.30133     7.47853     5.14169
;;      0.19531     1.53895     0.35500     0.45152     0.26867     0.23635     0.79974     0.55002     0.91914     1.34318     0.97169
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Bz>_dn [SCF, GSE, Downstream, nT]
;;=======================================================================================================================================
;;    -12.12638   -23.56150   -20.79328   -13.30333     2.96303     1.29102    -6.91488    -1.06390    13.88977   -44.04471   -29.27885
;;      3.39877     6.29739     1.54356     2.08872     0.97885     3.35114     2.04601     2.38739    12.62948     8.14351     9.55407
;;      0.63114     1.34261     0.39855     0.57931     0.21360     1.01041     0.52828     0.63806     1.84220     1.46262     1.80555
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <|Bo|>_dn [SCF, Downstream, nT]
;;=======================================================================================================================================
;;     14.88511    23.35707    19.51287    23.56574    16.45582     9.90253     6.67185     7.13973    20.17890    39.32419    56.52613
;;      2.04630     1.17187     1.60169     1.43138     1.42449     0.58254     2.05667     1.95058     6.66514     8.93577     1.35009
;;      0.37999     0.24984     0.41355     0.39699     0.31085     0.17564     0.53103     0.52131     0.97221     1.60491     0.25514
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Vx>_dn [SCF, GSE, Downstream, km/s]
;;=======================================================================================================================================
;;      -97.033    -105.441    -167.447    -118.835    -191.874    -165.168    -198.972     -85.831     -54.954    -205.980    -186.710
;;        8.217      20.120      22.657      15.091      25.681       5.322      62.860      40.633      26.687      27.205      17.086
;;        1.526       4.290       5.850       4.186       5.604       1.605      16.230      10.860       3.893       4.886       3.229
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Vy>_dn [SCF, GSE, Downstream, km/s]
;;=======================================================================================================================================
;;       23.619      56.273     102.874      76.180      80.586      90.335      29.279      42.240      43.479      40.259     109.106
;;       11.716      24.543      21.182      11.907      18.917       6.761      79.199      56.973      18.693      19.956      13.793
;;        2.176       5.233       5.469       3.302       4.128       2.038      20.449      15.227       2.727       3.584       2.607
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Vz>_dn [SCF, GSE, Downstream, km/s]
;;=======================================================================================================================================
;;       -9.120       2.444     -72.441     -62.060      -7.710      28.692     -60.912      21.670     -18.379      39.529      83.798
;;       12.377      23.353      11.067      17.774      23.645      19.599      46.399      63.821      28.557      25.341      16.002
;;        2.298       4.979       2.858       4.930       5.160       5.909      11.980      17.057       4.165       4.551       3.024
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <|V|>_dn [SCF, Downstream, km/s]
;;=======================================================================================================================================
;;      101.660     123.453     210.642     155.188     210.282     191.517     227.924     130.954      82.388     216.033     232.755
;;        8.361      23.602      23.406      18.796      26.159       1.497      63.465      29.374      17.436      26.188      18.319
;;        1.553       5.032       6.043       5.213       5.708       0.451      16.387       7.850       2.543       4.703       3.462
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Ni>_dn [Downstream, cm^(-3)]
;;=======================================================================================================================================
;;     47.84027    26.49955    15.39115    13.67811    10.91257    18.00377    14.16235    15.87126    40.56429   101.27653    97.38197
;;      2.59123     2.17383     1.27546     0.61581     1.47530     2.32466     2.76619     6.44789     6.55724    12.17235     4.85462
;;      0.48118     0.46346     0.32932     0.17080     0.32194     0.70091     0.71423     1.72327     0.95647     2.18622     0.91744
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Te>_dn [Downstream, eV]
;;=======================================================================================================================================
;;     30.50068    32.57889    51.72051    66.64914    56.78897    40.28530    30.82709    36.24389    31.03419    66.09673    81.46423
;;      1.83097     1.55633     2.41169     1.34425     2.85963     1.40854     4.36183     2.38618     3.17635     3.07805     2.17044
;;      0.34000     0.33181     0.62270     0.37283     0.62402     0.42469     1.12622     0.63773     0.46332     0.55283     0.41018
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <Ti>_dn [Downstream, eV]
;;=======================================================================================================================================
;;    158.59720    80.01989   279.71979   281.17624   311.04953    63.56187   148.32730   203.45995   145.31645   179.58180   176.66451
;;     12.01369    13.20358    17.62160     8.08957    41.34367     5.31940    49.00068    49.34665    28.73932    27.46961    13.39540
;;      2.23089     2.81501     4.54988     2.24364     9.02193     1.60386    12.65192    13.18845     4.19206     4.93369     2.53149
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <ße>_dn [Electron Beta, Downstream, unitless]
;;=======================================================================================================================================
;;      2.82298     0.63995     0.85782     0.66961     0.94652     3.00025     4.85969     5.96718     1.90760     2.36711     1.00199
;;      0.89200     0.07257     0.16224     0.10094     0.23267     0.45823     2.93137     4.90365     2.14178     2.15045     0.08297
;;      0.16564     0.01547     0.04189     0.02800     0.05077     0.13816     0.75688     1.31055     0.31241     0.38623     0.01568
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <ßi>_dn [Ion Beta, Downstream, unitless]
;;=======================================================================================================================================
;;     14.70551     1.56604     4.64873     2.82700     5.15167     4.75069    26.39039    30.26200     9.26493     6.55038     2.16802
;;      5.09054     0.27358     0.95786     0.45324     1.28479     0.86570    23.20304    19.75468    11.00484     6.18497     0.18422
;;      0.94529     0.05833     0.24732     0.12571     0.28036     0.26102     5.99100     5.27966     1.60522     1.11085     0.03482
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  <ß>_dn [Total Beta, Downstream, unitless]
;;=======================================================================================================================================
;;     17.52849     2.20600     5.50654     3.49660     6.09819     7.75093    31.25008    36.22918    11.17252     8.91748     3.17001
;;      5.93381     0.30940     1.10795     0.55250     1.47387     1.31913    25.93371    24.07505    13.09797     8.32237     0.23896
;;      1.10188     0.06596     0.28607     0.15323     0.32163     0.39773     6.69606     6.43433     1.91053     1.49474     0.04516
;;---------------------------------------------------------------------------------------------------------------------------------------




;;---------------------------------------------------------------------------------------------------------------------------------------
;;  All Dates [YYYY-MM-DD]
;;=======================================================================================================================================
;;  2009-07-13  2009-07-21  2009-07-23  2009-07-23  2009-07-23  2009-09-05  2009-09-05  2009-09-05  2009-09-26  2011-10-24  2011-10-24
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Vshn [SHF, Upstream, km/s]
;;=======================================================================================================================================
;;      -53.496     -24.402     -65.323      13.175     -37.769     -77.719    -120.422       0.983      29.308     -43.669     -31.612
;;        8.951      31.765      25.307      23.176      45.049      15.935      66.264      56.436      51.774      46.024      21.933
;;        1.662       6.772       6.534       6.428       9.830       4.805      17.109      15.083       7.552       8.266       4.145
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  ∆Xn = |Vshn| ∆t [SHF, Upstream, km/s]
;;=======================================================================================================================================
;;        0.418       0.191       0.510       0.103       0.295       0.607       0.941       0.008       0.229       0.341       0.247
;;        0.070       0.248       0.198       0.181       0.352       0.124       0.518       0.441       0.404       0.360       0.171
;;        0.013       0.053       0.051       0.050       0.077       0.038       0.134       0.118       0.059       0.065       0.032
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Ushn [SHF, Upstream, km/s]
;;=======================================================================================================================================
;;     -275.052    -199.610    -425.464    -504.394    -416.945    -269.648    -219.909    -357.437    -339.456    -360.920    -365.262
;;        6.591       6.938       4.445       4.920       3.330       2.988       2.147       1.940       1.090       6.180       7.867
;;        1.224       1.479       1.148       1.365       0.727       0.901       0.554       0.518       0.159       1.110       1.487
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Ushn [SHF, Downstream, km/s]
;;=======================================================================================================================================
;;      -41.704     -56.596    -103.692    -137.543    -151.848     -60.112     -42.810     -63.817     -84.808    -121.730     -76.857
;;        8.870      18.386      22.863      14.980      26.011      29.482      54.308      46.663      27.244      28.840      17.939
;;        1.647       3.920       5.903       4.155       5.676       8.889      14.022      12.471       3.974       5.180       3.390
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  ∆K [NIF, µJ m^(-3)]
;;=======================================================================================================================================
;;    3.872e-04   1.743e-04   4.273e-04   5.750e-04   3.546e-04   1.046e-04   8.568e-05   2.199e-04   6.876e-04   2.400e-03   1.800e-03
;;    5.311e-05   5.612e-05   6.489e-05   5.304e-05   8.046e-05   5.425e-05   5.583e-05   8.279e-05   1.684e-04   6.392e-04   2.472e-04
;;    9.862e-06   1.196e-05   1.675e-05   1.471e-05   1.756e-05   1.636e-05   1.441e-05   2.213e-05   2.456e-05   1.148e-04   4.672e-05
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  ∆K/∆t [NIF, µW m^(-3)]
;;=======================================================================================================================================
;;    1.359e-04   4.457e-05   3.594e-05   7.566e-04   1.445e-05   1.175e-04   1.177e-04   1.170e-04   2.034e-03   5.855e-03   1.208e-03
;;    1.864e-05   1.435e-05   5.457e-06   7.022e-05   3.279e-06   6.097e-05   7.670e-05   4.404e-05   5.004e-04   1.563e-03   1.660e-04
;;    3.461e-06   3.060e-06   1.409e-06   1.948e-05   7.154e-07   1.838e-05   1.980e-05   1.177e-05   7.299e-05   2.807e-04   3.138e-05
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Lsh [SHF, shock normal thickness, km]
;;=======================================================================================================================================
;;       84.939      84.273     117.828     118.084     115.553     140.877     140.018     142.279      73.303      39.328      50.359
;;        3.190       4.426       1.494       1.189       1.991       2.609       5.283       2.765       1.768       0.708       0.231
;;        0.592       0.944       0.386       0.330       0.435       0.787       1.364       0.739       0.258       0.127       0.044
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Ms (sound) [SHF, Upstream, unitless]
;;=======================================================================================================================================
;;      3.34915     3.06936     3.87374     4.63932     4.00420     4.59150     3.87692     5.70530     5.28116     2.56142     3.19743
;;      0.09893     0.22646     0.02591     0.03257     0.05631     0.07440     0.03504     0.06588     0.11873     0.04732     0.02106
;;      0.01837     0.04828     0.00669     0.00903     0.01229     0.02243     0.00905     0.01761     0.01732     0.00850     0.00398
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Ma (Alfvén) [SHF, Upstream, unitless]
;;=======================================================================================================================================
;;      9.05862     3.14581     6.20836     7.38176     5.85967    21.94119     9.84427    18.80578    17.75310     5.88312     4.19408
;;      0.48843     0.23774     0.29409     0.34432     0.20426     0.80246     0.37377     0.40096    10.76183     0.35090     0.02621
;;      0.09070     0.05069     0.07593     0.09550     0.04457     0.24195     0.09651     0.10716     1.56977     0.06302     0.00495
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Mf (fast mode) [SHF, Upstream, unitless]
;;=======================================================================================================================================
;;      3.06956     2.06091     3.03650     3.62478     3.11345     4.41547     3.54058     5.32749     4.82927     2.21942     2.32679
;;      0.09975     0.12430     0.04449     0.05302     0.06057     0.05968     0.04372     0.05763     0.25717     0.04015     0.01109
;;      0.01852     0.02650     0.01149     0.01470     0.01322     0.01799     0.01129     0.01540     0.03751     0.00721     0.00210
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Ni2/Ni1 [Compression Ratio, unitless]
;;=======================================================================================================================================
;;      6.66809     3.63953     4.11729     3.67866     2.80750     6.89144     5.41958     6.18841     4.21468     3.01937     4.76381
;;      0.62246     0.49533     0.29526     0.18133     0.36561     0.90404     1.40831     2.43528     0.75469     0.34977     0.25790
;;      0.11559     0.10560     0.07624     0.05029     0.07978     0.27258     0.36362     0.65086     0.11008     0.06282     0.04874
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  theta_Bn [Shock Normal Angles, deg]
;;=======================================================================================================================================
;;     42.60506    50.54816    83.42930    88.14958    54.38386    73.15319    35.32636    55.67061    59.74908    84.02091    87.59098
;;      4.95018     5.15860     2.54887     1.83275     3.66730     2.10326     1.66650     2.68811     8.78657     4.52956     1.38473
;;      0.91923     1.09982     0.65811     0.50831     0.80027     0.63416     0.43029     0.71843     1.28165     0.81353     0.26169
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Mcr [Edmiston&Kennel, 1984]
;;=======================================================================================================================================
;;      1.03492     1.41684     1.21262     1.21815     1.19111     1.02042     1.02945     1.03278     1.04777     1.09888     1.32901
;;      0.00943     0.09712     0.02398     0.02492     0.02290     0.00223     0.00435     0.00242     0.01895     0.01186     0.00618
;;      0.00175     0.02071     0.00619     0.00691     0.00500     0.00067     0.00112     0.00065     0.00276     0.00213     0.00117
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Mw  [Krasnoselskikh et al., 2002]
;;=======================================================================================================================================
;;     15.71368    13.56178     2.44951     0.69140    12.45243     6.20542    17.47329    12.07017    10.67850     2.22317     0.90031
;;      1.27842     1.49044     0.94702     0.68439     1.10505     0.74997     0.35903     0.81972     2.91758     1.67196     0.51724
;;      0.23740     0.31776     0.24452     0.18982     0.24114     0.22612     0.09270     0.21908     0.42557     0.30029     0.09775
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Mgr  [Krasnoselskikh et al., 2002]
;;=======================================================================================================================================
;;     20.41267    17.61727     3.18201     0.89816    16.17618     8.06108    22.69846    15.67961    13.87178     2.88798     1.16954
;;      1.66071     1.93613     1.23021     0.88905     1.43550     0.97424     0.46640     1.06485     3.79005     2.17194     0.67191
;;      0.30839     0.41279     0.31764     0.24658     0.31325     0.29374     0.12042     0.28459     0.55284     0.39009     0.12698
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Mnw  [Krasnoselskikh et al., 2002]
;;=======================================================================================================================================
;;     22.22250    19.17925     3.46413     0.97779    17.61039     8.77579    24.71096    17.06980    15.10168     3.14403     1.27323
;;      1.80795     2.10780     1.33929     0.96787     1.56277     1.06062     0.50775     1.15926     4.12608     2.36450     0.73149
;;      0.33573     0.44938     0.34580     0.26844     0.34102     0.31979     0.13110     0.30983     0.60185     0.42468     0.13824
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Mf/Mcr [SHF, Upstream, unitless]
;;=======================================================================================================================================
;;      2.96599     1.45458     2.50409     2.97564     2.61391     4.32711     3.43928     5.15838     4.60908     2.01972     1.75077
;;      0.10010     0.13281     0.06163     0.07484     0.07150     0.05924     0.04489     0.05709     0.25922     0.04254     0.01165
;;      0.01859     0.02832     0.01591     0.02076     0.01560     0.01786     0.01159     0.01526     0.03781     0.00764     0.00220
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Mf/Mw [SHF, Upstream, unitless]
;;=======================================================================================================================================
;;      0.19534     0.15196     1.23963     5.24266     0.25003     0.71155     0.20263     0.44138     0.45224     0.99831     2.58444
;;      0.01711     0.01905     0.47961     5.19006     0.02271     0.08653     0.00486     0.03035     0.12589     0.75101     1.48485
;;      0.00318     0.00406     0.12383     1.43946     0.00496     0.02609     0.00125     0.00811     0.01836     0.13489     0.28061
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Mf/Mgr [SHF, Upstream, unitless]
;;=======================================================================================================================================
;;      0.15038     0.11698     0.95427     4.03580     0.19247     0.54775     0.15598     0.33977     0.34814     0.76850     1.98950
;;      0.01317     0.01467     0.36920     3.99531     0.01749     0.06661     0.00374     0.02337     0.09691     0.57813     1.14304
;;      0.00245     0.00313     0.09533     1.10810     0.00382     0.02008     0.00097     0.00624     0.01414     0.10383     0.21601
;;---------------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------------
;;  Mf/Mnw [SHF, Upstream, unitless]
;;=======================================================================================================================================
;;      0.13813     0.10745     0.87655     3.70712     0.17680     0.50314     0.14328     0.31210     0.31978     0.70592     1.82747
;;      0.01210     0.01347     0.33913     3.66993     0.01606     0.06119     0.00343     0.02146     0.08902     0.53104     1.04995
;;      0.00225     0.00287     0.08756     1.01786     0.00350     0.01845     0.00089     0.00574     0.01298     0.09538     0.19842
;;---------------------------------------------------------------------------------------------------------------------------------------

































;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;  Structure formats
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
.compile thm_load_bowshock_rhsolns
thm_load_bowshock_rhsolns,R_STRUCT=diss_rates

HELP, diss_rates, /STRUC
;;** Structure <1a20e08>, 6 tags, length=170960, data length=170940, refs=1:
;;   THB_2009_07_13_0
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_21_0
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_0
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_1
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_2
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THA_2009_09_26_0
;;                   STRUCT    -> <Anonymous> Array[1]
;;

HELP, diss_rates.THB_2009_07_13_0, /STRUC
;;** Structure <155fc38>, 4 tags, length=33552, data length=33548, refs=2:
;;   UP              STRUCT    -> <Anonymous> Array[1]
;;   DOWN            STRUCT    -> <Anonymous> Array[1]
;;   SHOCK           STRUCT    -> <Anonymous> Array[1]
;;   DISS_RATE       STRUCT    -> <Anonymous> Array[1]


HELP, diss_rates.THB_2009_07_13_0.UP, /STRUC
HELP, diss_rates.THB_2009_07_13_0.DOWN, /STRUC
;;** Structure <19f7e08>, 6 tags, length=1160, data length=1160, refs=2:
;;   NI              FLOAT     Array[29]
;;   TI              FLOAT     Array[29]
;;   TE              FLOAT     Array[29]
;;   PI              FLOAT     Array[29]
;;   VSW             FLOAT     Array[29, 3]
;;   BO              FLOAT     Array[29, 3]

HELP, diss_rates.THB_2009_07_13_0.SHOCK, /STRUC
;;** Structure <154f428>, 5 tags, length=112, data length=112, refs=2:
;;   VSHN            DOUBLE    Array[2]
;;   USHN_UP         DOUBLE    Array[2]
;;   USHN_DOWN       DOUBLE    Array[2]
;;   NVEC            DOUBLE    Array[3, 2]
;;   TRAMP           DOUBLE    Array[2]

HELP, diss_rates.THB_2009_07_13_0.DISS_RATE, /STRUC
;;** Structure <15620d8>, 3 tags, length=31120, data length=31116, refs=2:
;;   SH_PARAM        STRUCT    -> <Anonymous> Array[1]
;;   OBSERVED        STRUCT    -> <Anonymous> Array[1]
;;   THEORIES        STRUCT    -> <Anonymous> Array[1]

HELP, diss_rates.THB_2009_07_13_0.DISS_RATE.SH_PARAM, /STRUC
;;** Structure <1562388>, 3 tags, length=792, data length=792, refs=2:
;;   NVEC            DOUBLE    Array[3, 3]
;;   USHN            DOUBLE    Array[3]
;;   THETA_BN        DOUBLE    Array[29, 3]

HELP, diss_rates.THB_2009_07_13_0.DISS_RATE.OBSERVED, /STRUC
;;** Structure <1a1fe08>, 14 tags, length=4624, data length=4620, refs=2:
;;   DELTA_RHO       DOUBLE    Array[29]
;;   RHO_RATIO       FLOAT     Array[29]
;;   PRESS_T_UP      DOUBLE    Array[29]
;;   PRESS_T_DN      DOUBLE    Array[29]
;;   PRESS_RATIO     DOUBLE    Array[29]
;;   CS_UP           DOUBLE    Array[29, 3]
;;   WORK_RATE       DOUBLE    Array[29, 3]
;;   DELTA_ENTROPY   DOUBLE    Array[29, 3]
;;   DISS_RATE       DOUBLE    Array[29, 3]
;;   DELTA_ENTHALPY  DOUBLE    Array[29, 3]
;;   AVG_WORK_RATE   DOUBLE    Array[3]
;;   AVG_D_ENTROPY   DOUBLE    Array[3]
;;   AVG_DISS_RATE   DOUBLE    Array[3]
;;   AVG_D_ENTHALPY  DOUBLE    Array[3]

HELP, diss_rates.THB_2009_07_13_0.DISS_RATE.THEORIES, /STRUC
;;** Structure <1a20808>, 7 tags, length=25704, data length=25704, refs=2:
;;   PRESS_RATIO     DOUBLE    Array[29, 3, 3, 3]
;;   DELTA_ENTROPY   DOUBLE    Array[29, 3, 3, 3]
;;   DISS_RATE       DOUBLE    Array[29, 3, 3, 3]
;;   DELTA_ENTHALPY  DOUBLE    Array[29, 3, 3, 3]
;;   AVG_D_ENTROPY   DOUBLE    Array[3, 3, 3]
;;   AVG_DISS_RATE   DOUBLE    Array[3, 3, 3]
;;   AVG_D_ENTHALPY  DOUBLE    Array[3, 3, 3]





.compile thm_load_bowshock_ascii
thm_load_bowshock_ascii,R_STRUCT=j_E_S_corr

HELP, j_E_S_corr.DATA, /STRUC
;;** Structure <1a61c08>, 6 tags, length=2547712, data length=2547712, refs=2:
;;   THB_2009_07_13_1ST
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_21_1ST
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_1ST
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_2ND
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_3RD
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THA_2009_09_26_1ST
;;                   STRUCT    -> <Anonymous> Array[1]
;;

HELP, j_E_S_corr.DATA.THB_2009_07_13_1ST, /STRUC
;;** Structure <1a62408>, 13 tags, length=421888, data length=421888, refs=2:
;;   SCETS           STRING    Array[1648]
;;   UNIX            DOUBLE    Array[1648]
;;   J_MAG_SM        DOUBLE    Array[1648]
;;   J_VEC_NIF_NCB_SM
;;                   DOUBLE    Array[1648, 3]
;;   E_VEC_NIF_GSE_JT
;;                   DOUBLE    Array[1648, 3]
;;   B_VEC_SCF_GSE_JT
;;                   DOUBLE    Array[1648, 3]
;;   S_VEC_NIF_GSE_JT
;;                   DOUBLE    Array[1648, 3]
;;   S_POW_NIF_GSE_JT
;;                   DOUBLE    Array[1648]
;;   S_DOT_N_N_NIF_GSE
;;                   DOUBLE    Array[1648, 3]
;;   N_X_S_X_N_NIF_GSE
;;                   DOUBLE    Array[1648, 3]
;;   NEG_E_DOT_J_SM  DOUBLE    Array[1648]
;;   ETA_JSQ_GSE     DOUBLE    Array[1648, 4]
;;   ETA_JSQ_NIF     DOUBLE    Array[1648, 4]






WINDOW,1,RETAIN=2,XSIZE=1700,YSIZE=1100,TITLE='Energy Dissipation 1'



all_data       = j_E_S_corr.DATA
all_ns         = j_E_S_corr.NUM
n_cross        = N_TAGS(all_ns)
FOR j=0L, n_cross - 1L DO PRINT,';; ', all_ns.(j)
;;         1648
;;         3376
;;          816
;;          816
;;         1648
;;         1648

n_pts          = 0L
FOR j=0L, n_cross - 1L DO n_pts += all_ns.(j)
PRINT,';; ', n_cross, n_pts
;;            6        9952






























