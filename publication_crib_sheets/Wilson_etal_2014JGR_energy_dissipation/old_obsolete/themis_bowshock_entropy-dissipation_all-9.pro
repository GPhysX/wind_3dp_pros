;;----------------------------------------------------------------------------------------
;; => Define some constants and dummy variables
;;----------------------------------------------------------------------------------------
f              = !VALUES.F_NAN
d              = !VALUES.D_NAN
me             = 9.1093829100d-31     ;; => Electron mass [kg]
mp             = 1.6726217770d-27     ;; => Proton mass [kg]
ma             = 6.6446567500d-27     ;; => Alpha-Particle mass [kg]
c              = 2.9979245800d+08     ;; => Speed of light in vacuum [m/s]
epo            = 8.8541878170d-12     ;; => Permittivity of free space [F/m]
muo            = !DPI*4.00000d-07     ;; => Permeability of free space [N/A^2 or H/m]
qq             = 1.6021765650d-19     ;; => Fundamental charge [C]
kB             = 1.3806488000d-23     ;; => Boltzmann Constant [J/K]
hh             = 6.6260695700d-34     ;; => Planck Constant [J s]
GG             = 6.6738400000d-11     ;; => Newtonian Constant [m^(3) kg^(-1) s^(-1)]

f_1eV          = qq[0]/hh[0]          ;; => Freq. associated with 1 eV of energy [Hz]
J_1eV          = hh[0]*f_1eV[0]       ;; => Energy associated with 1 eV of energy [J]
;; => Temp. associated with 1 eV of energy [K]
K_eV           = qq[0]/kB[0]          ;; ~ 11,604.519 K
R_E            = 6.37814d3            ;; => Earth's Equitorial Radius [km]

wpefac         = SQRT(1d6*qq[0]^2/(epo[0]*me[0]))
wpifac         = SQRT(1d6*qq[0]^2/(epo[0]*mp[0]))
ckm            = c[0]*1d-3            ;;  m --> km
;;  Setup margins
!X.MARGIN      = [15,5]
!Y.MARGIN      = [8,4]
;;----------------------------------------------------------------------------------------
;; => Compile necessary routines
;;----------------------------------------------------------------------------------------
@comp_lynn_pros
thm_init

.compile shock_enthalpy_rate
.compile read_thm_j_E_S_corr
.compile thm_load_bowshock_rhsolns
.compile thm_load_bowshock_ascii
.compile find_j2_eta_k_from_h
.compile temp_calc_j2_eta_k_S_from_h

.compile get_thm_entropy_diss_data
.compile temp_thm_entropy_diss_plots

;;  Compile critical Mach number routines
.compile /Users/lbwilson/Desktop/swidl-0.1/IDL_stuff/cribs/marcs_cr-Mach_number/genarr.pro
.compile /Users/lbwilson/Desktop/swidl-0.1/IDL_stuff/cribs/marcs_cr-Mach_number/zbrent.pro
.compile /Users/lbwilson/Desktop/swidl-0.1/IDL_stuff/cribs/marcs_cr-Mach_number/crit_mf.pro

;;----------------------------------------------------------------------------------------
;;  Plot relevant data
;;----------------------------------------------------------------------------------------
temp_thm_entropy_diss_plots

;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;  Print wave properties statistics
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
.compile thm_j_E_S_properties_print
thm_j_E_S_properties_print

;;----------------------------------------------------------------------------------------
;;  There are 11421 total data points
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂B| [nT, in SCF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     0.00071641070       7.8939901      0.22948878      0.40647561    0.0038038243
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂E| [mV/m, in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;        0.13365907       260.84285       11.433067       14.888009      0.13932293
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |S| [µW m^(-2), in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     0.00023433595       463.08859       2.9153610       13.201175      0.12353743
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |S(w,k)| [µW m^(-2), in NIF and GSE basis]  For 11376 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;       0.012327300       2154.8900       19.355994       76.247733      0.71487835
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |-(∂E . j)| [µW m^(-3), in NIF and NCB basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     1.1039200e-07       3.7542300     0.031302188      0.12176694    0.0011395027
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  *nu* [W-P collision frequency, IAWs, rad/s, in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     0.00040196100       850.56000       4.3842901       23.245822      0.21753587
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  *eta* [W-P resistivity, IAWs, Ω m, in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     0.00049903500       5096.3600       12.272801       79.311312      0.74220025
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  (*eta* |j|^2) [W-P resistivity, IAWs, µW m^(-3), in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     6.9685600e-12      0.39853100   0.00020684203    0.0049609796   4.6425159e-05
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂B|/<Bo>_{up}  [unitless, SCM in SCF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     0.00035121200      0.46833900     0.024097350     0.030649226   0.00028681739
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |Bo|/<Bo>_{up}  [unitless, FGM in SCF and GSE basis]  For 11421 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;         1.0741830       17.119777       5.6149959       4.8549169     0.045428640
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂B|^2/(2 µ_o)  [µW m^(-3), SCM in SCF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     2.0421342e-13   2.4794382e-05   8.6688932e-08   5.3649508e-07   5.0205548e-09
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |∂E|/(c <Bo>_{up})  [unitless, EFI in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     0.00014386000      0.23738000    0.0063530415     0.011348811   0.00010620289
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  ∑_o |∂E|^2/2 [µW m^(-3), EFI in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     7.9088915e-14   3.0121502e-07   1.5598796e-09   6.9032573e-09   6.4601117e-11
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |k| = ∆¥/|S(w,k)| [km^(-1)]  For 11376 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     4.5181811e-05       127.31661       1.6341922       4.2406560     0.039759256
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  |k| = ∆∑/|S(w,k)| [km^(-1)]  For 11376 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     9.4423098e-06       13.714888     0.091922117      0.33487985    0.0031397439
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  § = (*eta* |j|^2)/∆¥  [unitless (from enthalpy), EFI in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     1.3136394e-09       1244.3619       1.4402257       18.424019      0.17241313
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  £ = (*eta* |j|^2)/∆∑  [unitless (from entropy), EFI in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     6.6611655e-08       6766.2053       6.4580053       89.869017      0.84099992
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  ‡ = |(∂E . j)|/∆¥  [unitless (from enthalpy), EFI in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;     0.00067228911       25125.624       200.09691       809.14086       7.5719911
;;----------------------------------------------------------------------------------------

;;----------------------------------------------------------------------------------------
;;  € = |(∂E . j)|/∆∑  [unitless (from entropy), EFI in NIF and GSE basis]  For 11419 points
;;----------------------------------------------------------------------------------------
;;            Min             Max            Mean          Std. Dev.       Std. Dev.
;;                                                                          of Mean
;;========================================================================================
;;       0.014143473       93069.270       1557.5318       4675.9966       43.758271
;;----------------------------------------------------------------------------------------










;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
;;  Print RH solutions
;;----------------------------------------------------------------------------------------
;;----------------------------------------------------------------------------------------
.compile temp_thm_print_rh_soln
temp_thm_print_rh_soln



;;---------------------------------------------------------------------------------------------------------------------------------
;;  All Dates [YYYY-MM-DD]
;;=================================================================================================================================
;;  2009-07-13  2009-07-21  2009-07-23  2009-07-23  2009-07-23  2009-09-26  2011-10-24  2011-10-24
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Bx>_up [SCF, GSE, Upstream, nT]
;;=================================================================================================================================
;;     -2.88930     2.71915    -0.08366    -0.11425     3.88880     1.54738     4.37016     3.98054
;;      0.15507     0.94958     0.26427     0.26692     0.28193     0.68943     1.94275     0.24412
;;      0.02880     0.20245     0.06823     0.07403     0.06152     0.10056     0.34893     0.04613
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <By>_up [SCF, GSE, Upstream, nT]
;;=================================================================================================================================
;;      1.79045     6.94990     0.11228     0.13536    -4.95385    -0.18511    -6.67269    14.64094
;;      0.45210     0.67515     0.17130     0.17273     0.30040     0.40203     4.36331     0.54536
;;      0.08395     0.14394     0.04423     0.04791     0.06555     0.05864     0.78367     0.10306
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Bz>_up [SCF, GSE, Upstream, nT]
;;=================================================================================================================================
;;     -1.37976    -0.75425    -6.04225    -6.06984     1.12260    -2.65947   -12.95726    -9.96436
;;      0.10394     1.63304     0.31831     0.33449     0.27612     0.63323     3.26641     0.74283
;;      0.01930     0.34817     0.08219     0.09277     0.06025     0.09237     0.58666     0.14038
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <|Bo|>_up [SCF, Upstream, nT]
;;=================================================================================================================================
;;      3.69800     7.70803     6.05171     6.08037     6.41334     3.13416    16.21770    18.17584
;;      0.11755     0.85116     0.31433     0.32930     0.16820     0.84228     0.96542     0.07544
;;      0.02183     0.18147     0.08116     0.09133     0.03671     0.12286     0.17340     0.01426
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Vx>_up [SCF, GSE, Upstream, km/s]
;;=================================================================================================================================
;;     -328.746    -250.544    -488.290    -488.163    -456.419    -307.345    -435.801    -477.028
;;        6.319       9.287       4.572       4.849       3.079       1.082       9.994       2.508
;;        1.173       1.980       1.180       1.345       0.672       0.158       1.795       0.474
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Vy>_up [SCF, GSE, Upstream, km/s]
;;=================================================================================================================================
;;       10.869      37.200      82.899      82.926      57.813      65.093     -14.166     104.805
;;       16.702      11.448       0.739       0.794       2.438       0.483      35.209       4.750
;;        3.101       2.441       0.191       0.220       0.532       0.070       6.324       0.898
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Vz>_up [SCF, GSE, Upstream, km/s]
;;=================================================================================================================================
;;       16.801       6.473     -92.330     -92.519       7.732      30.378      -7.566       9.886
;;        2.529      24.195       2.247       2.341       3.444       0.436      18.384      18.555
;;        0.470       5.158       0.580       0.649       0.752       0.064       3.302       3.507
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <|V|>_up [SCF, Upstream, km/s]
;;=================================================================================================================================
;;      329.770     254.665     503.816     503.733     460.150     315.628     437.881     488.863
;;        6.426      10.724       4.429       4.692       2.935       1.077       8.100       3.317
;;        1.193       2.286       1.143       1.301       0.641       0.157       1.455       0.627
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Ni>_up [Upstream, cm^(-3)]
;;=================================================================================================================================
;;      7.21921     7.36031     3.73654     3.71973     3.88664     9.66698    33.55473    20.44722
;;      0.60208     0.79248     0.09663     0.07550     0.13496     0.48493     1.17835     0.18888
;;      0.11180     0.16896     0.02495     0.02094     0.02945     0.07073     0.21164     0.03569
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Te>_up [Upstream, eV]
;;=================================================================================================================================
;;     11.23725     9.29213     9.42997     9.48648    14.07636     7.87657    31.24348    18.66565
;;      1.07062     0.67836     0.70508     0.74435     0.88914     0.41691     0.67284     0.62781
;;      0.19881     0.14463     0.18205     0.20644     0.19403     0.06081     0.12085     0.11864
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Ti>_up [Upstream, eV]
;;=================================================================================================================================
;;     30.15536    16.11729    65.32558    65.21508    53.45133    17.52811    91.38626    64.23226
;;      2.62020     3.97285     1.15368     1.18863     1.72039     0.89242     4.13350     1.42695
;;      0.48656     0.84701     0.29788     0.32967     0.37542     0.13017     0.74240     0.26967
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <ße>_up [Electron Beta, Upstream, unitless]
;;=================================================================================================================================
;;      2.38177     0.46835     0.38988     0.38708     0.53608     5.40184     1.62036     0.46511
;;      0.20122     0.05340     0.04795     0.05062     0.04110     9.41425     0.19978     0.01293
;;      0.03737     0.01138     0.01238     0.01404     0.00897     1.37321     0.03588     0.00244
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <ßi>_up [Ion Beta, Upstream, unitless]
;;=================================================================================================================================
;;      6.41909     0.80972     2.70244     2.66079     2.03740    12.31639     4.74205     1.60103
;;      0.76346     0.20185     0.27120     0.26393     0.13751    22.27127     0.64013     0.04478
;;      0.14177     0.04304     0.07002     0.07320     0.03001     3.24860     0.11497     0.00846
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <ß>_up [Total Beta, Upstream, unitless]
;;=================================================================================================================================
;;      8.80086     1.27807     3.09232     3.04787     2.57348    17.71823     6.36241     2.06614
;;      0.77675     0.21615     0.30680     0.30160     0.16109    31.68199     0.83159     0.03707
;;      0.14424     0.04608     0.07921     0.08365     0.03515     4.62129     0.14936     0.00701
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Bx>_dn [SCF, GSE, Downstream, nT]
;;=================================================================================================================================
;;     -3.85673     1.66317    -1.17367     1.48669     4.13227    -1.69473    11.90587     1.06117
;;      2.34598     3.91304     1.65017     1.01459     1.74997     7.11051     3.64282     4.38643
;;      0.43564     0.83426     0.42607     0.28140     0.38187     1.03718     0.65427     0.82896
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <By>_dn [SCF, GSE, Downstream, nT]
;;=================================================================================================================================
;;     10.81798    11.99339     2.16511   -17.62629   -15.54344   -14.20390    -7.86599    51.71753
;;      1.05178     7.21832     1.37491     1.62797     1.23118     6.30133     7.47853     5.14169
;;      0.19531     1.53895     0.35500     0.45152     0.26867     0.91914     1.34318     0.97169
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Bz>_dn [SCF, GSE, Downstream, nT]
;;=================================================================================================================================
;;     -8.72761   -17.26411   -19.24972   -15.39205     2.96303     1.26029   -35.90120   -19.72478
;;      3.39877     6.29739     1.54356     2.08872     0.97885    12.62948     8.14351     9.55407
;;      0.63114     1.34261     0.39855     0.57931     0.21360     1.84220     1.46262     1.80555
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <|Bo|>_dn [SCF, Downstream, nT]
;;=================================================================================================================================
;;     14.88511    23.35707    19.51287    23.56574    16.45582    20.17890    39.32419    56.52613
;;      2.04630     1.17187     1.60169     1.43138     1.42449     6.66514     8.93577     1.35009
;;      0.37999     0.24984     0.41355     0.39699     0.31085     0.97221     1.60491     0.25514
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Vx>_dn [SCF, GSE, Downstream, km/s]
;;=================================================================================================================================
;;      -97.033    -105.441    -167.447    -118.835    -191.874     -54.954    -205.980    -186.710
;;        8.217      20.120      22.657      15.091      25.681      26.687      27.205      17.086
;;        1.526       4.290       5.850       4.186       5.604       3.893       4.886       3.229
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Vy>_dn [SCF, GSE, Downstream, km/s]
;;=================================================================================================================================
;;       23.619      56.273     102.874      76.180      80.586      43.479      40.259     109.106
;;       11.716      24.543      21.182      11.907      18.917      18.693      19.956      13.793
;;        2.176       5.233       5.469       3.302       4.128       2.727       3.584       2.607
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Vz>_dn [SCF, GSE, Downstream, km/s]
;;=================================================================================================================================
;;       -9.120       2.444     -72.441     -62.060      -7.710     -18.379      39.529      83.798
;;       12.377      23.353      11.067      17.774      23.645      28.557      25.341      16.002
;;        2.298       4.979       2.858       4.930       5.160       4.165       4.551       3.024
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <|V|>_dn [SCF, Downstream, km/s]
;;=================================================================================================================================
;;      101.660     123.453     210.642     155.188     210.282      82.388     216.033     232.755
;;        8.361      23.602      23.406      18.796      26.159      17.436      26.188      18.319
;;        1.553       5.032       6.043       5.213       5.708       2.543       4.703       3.462
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Ni>_dn [Downstream, cm^(-3)]
;;=================================================================================================================================
;;     47.84027    26.49955    15.39115    13.67811    10.91257    40.56429   101.27653    97.38197
;;      2.59123     2.17383     1.27546     0.61581     1.47530     6.55724    12.17235     4.85462
;;      0.48118     0.46346     0.32932     0.17080     0.32194     0.95647     2.18622     0.91744
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Te>_dn [Downstream, eV]
;;=================================================================================================================================
;;     30.50068    32.57889    51.72051    66.64914    56.78897    31.03419    66.09673    81.46423
;;      1.83097     1.55633     2.41169     1.34425     2.85963     3.17635     3.07805     2.17044
;;      0.34000     0.33181     0.62270     0.37283     0.62402     0.46332     0.55283     0.41018
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <Ti>_dn [Downstream, eV]
;;=================================================================================================================================
;;    158.59720    80.01989   279.71979   281.17624   311.04953   145.31645   179.58180   176.66451
;;     12.01369    13.20358    17.62160     8.08957    41.34367    28.73932    27.46961    13.39540
;;      2.23089     2.81501     4.54988     2.24364     9.02193     4.19206     4.93369     2.53149
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <ße>_dn [Electron Beta, Downstream, unitless]
;;=================================================================================================================================
;;      2.82298     0.63995     0.85782     0.66961     0.94652     1.90760     2.36711     1.00199
;;      0.89200     0.07257     0.16224     0.10094     0.23267     2.14178     2.15045     0.08297
;;      0.16564     0.01547     0.04189     0.02800     0.05077     0.31241     0.38623     0.01568
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <ßi>_dn [Ion Beta, Downstream, unitless]
;;=================================================================================================================================
;;     14.70551     1.56604     4.64873     2.82700     5.15167     9.26493     6.55038     2.16802
;;      5.09054     0.27358     0.95786     0.45324     1.28479    11.00484     6.18497     0.18422
;;      0.94529     0.05833     0.24732     0.12571     0.28036     1.60522     1.11085     0.03482
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  <ß>_dn [Total Beta, Downstream, unitless]
;;=================================================================================================================================
;;     17.52849     2.20600     5.50654     3.49660     6.09819    11.17252     8.91748     3.17001
;;      5.93381     0.30940     1.10795     0.55250     1.47387    13.09797     8.32237     0.23896
;;      1.10188     0.06596     0.28607     0.15323     0.32163     1.91053     1.49474     0.04516
;;---------------------------------------------------------------------------------------------------------------------------------




;;---------------------------------------------------------------------------------------------------------------------------------
;;  All Dates [YYYY-MM-DD]
;;=================================================================================================================================
;;  2009-07-13  2009-07-21  2009-07-23  2009-07-23  2009-07-23  2009-09-26  2011-10-24  2011-10-24
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Vshn [SCF, Upstream, km/s]
;;=================================================================================================================================
;;      -52.770     -31.374     -62.207      13.871     -33.930      26.235     -58.924     -37.142
;;        8.731      34.183      24.454      22.547      44.366      52.313      47.055      22.200
;;        1.621       7.288       6.314       6.253       9.681       7.631       8.451       4.195
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  ∆Xn = |Vshn| ∆t [SHF, Upstream, km/s]
;;=================================================================================================================================
;;        0.412       0.245       0.486       0.108       0.265       0.205       0.460       0.290
;;        0.068       0.267       0.191       0.176       0.347       0.409       0.368       0.173
;;        0.013       0.057       0.049       0.049       0.076       0.060       0.066       0.033
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Ushn [SHF, Upstream, km/s]
;;=================================================================================================================================
;;     -271.853    -193.823    -423.046    -506.468    -415.525    -335.993    -358.124    -367.712
;;       10.936      37.862      25.720      21.842      42.830      52.654      53.587      26.191
;;        2.031       8.072       6.641       6.058       9.346       7.680       9.625       4.950
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Ushn [SHF, Downstream, km/s]
;;=================================================================================================================================
;;      -41.226     -54.940    -103.101    -138.108    -151.381     -83.999    -120.805     -77.372
;;        5.205      15.591       7.697      10.703      30.255      27.801      27.525       6.538
;;        0.966       3.324       1.987       2.968       6.602       4.055       4.944       1.236
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Lsh [SHF, shock normal thickness, km]
;;=================================================================================================================================
;;      150.393     122.670     739.647      10.542     832.640       8.867      24.159      55.341
;;       24.888     133.654     290.757      17.136    1088.746      17.683      19.298      33.080
;;        4.622      28.495      75.073       4.753     237.584       2.579       3.466       6.251
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Ms (sound) [SHF, Upstream, unitless]
;;=================================================================================================================================
;;      3.34915     3.06936     3.87374     4.63932     4.00420     5.28116     2.56142     3.19743
;;      0.09893     0.22646     0.02591     0.03257     0.05631     0.11873     0.04732     0.02106
;;      0.01837     0.04828     0.00669     0.00903     0.01229     0.01732     0.00850     0.00398
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Ma (Alfvén) [SHF, Upstream, unitless]
;;=================================================================================================================================
;;      9.05862     3.14581     6.20836     7.38176     5.85967    17.75310     5.88312     4.19408
;;      0.48843     0.23774     0.29409     0.34432     0.20426    10.76183     0.35090     0.02621
;;      0.09070     0.05069     0.07593     0.09550     0.04457     1.56977     0.06302     0.00495
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Mf (fast mode) [SHF, Upstream, unitless]
;;=================================================================================================================================
;;      3.07032     2.04378     3.03406     3.62483     3.10646     4.84872     2.21871     2.32677
;;      0.10052     0.12810     0.04522     0.05278     0.06025     0.24779     0.04101     0.01108
;;      0.01867     0.02731     0.01168     0.01464     0.01315     0.03614     0.00737     0.00209
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Ni2/Ni1 [Compression Ratio, unitless]
;;=================================================================================================================================
;;      6.66809     3.63953     4.11729     3.67866     2.80750     4.21468     3.01937     4.76381
;;      0.62246     0.49533     0.29526     0.18133     0.36561     0.75469     0.34977     0.25790
;;      0.11559     0.10560     0.07624     0.05029     0.07978     0.11008     0.06282     0.04874
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  theta_Bn [Shock Normal Angles, deg]
;;=================================================================================================================================
;;     42.27223    56.64812    87.54214    87.74427    56.18872    53.93460    85.01427    87.64858
;;      5.68806     5.39487     1.45156     1.50778     3.52866    10.15629     2.91617     1.32218
;;      1.05625     1.15019     0.37479     0.41818     0.77002     1.48145     0.52376     0.24987
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Mcr [Edmiston&Kennel, 1984]
;;=================================================================================================================================
;;      1.03458     1.45464     1.21473     1.21811     1.19754     1.04106     1.09948     1.32904
;;      0.01035     0.10382     0.02465     0.02480     0.02257     0.01563     0.01196     0.00619
;;      0.00192     0.02213     0.00637     0.00688     0.00492     0.00228     0.00215     0.00117
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Mw  [Krasnoselskikh et al., 2002]
;;=================================================================================================================================
;;     15.77948    11.72916     0.91850     0.84299    11.90051    12.43196     1.85936     0.87882
;;      1.46444     1.67580     0.54192     0.56311     1.08817     3.19082     1.08363     0.49390
;;      0.27194     0.35728     0.13992     0.15618     0.23746     0.46543     0.19463     0.09334
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Mgr [Krasnoselskikh et al., 2002]
;;=================================================================================================================================
;;     20.49815    15.23663     1.19316     1.09508    15.45921    16.14959     2.41538     1.14161
;;      1.90236     2.17692     0.70398     0.73150     1.41357     4.14499     1.40767     0.64160
;;      0.35326     0.46412     0.18177     0.20288     0.30847     0.60461     0.25283     0.12125
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Mnw [Krasnoselskikh et al., 2002]
;;=================================================================================================================================
;;     22.31556    16.58754     1.29895     1.19217    16.82986    17.58145     2.62953     1.24283
;;      2.07103     2.36993     0.76640     0.79635     1.53890     4.51250     1.53248     0.69848
;;      0.38458     0.50527     0.19788     0.22087     0.33582     0.65822     0.27524     0.13200
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Mf/Mcr [SHF, Upstream, unitless]
;;=================================================================================================================================
;;      2.96770     1.40501     2.49772     2.97579     2.59404     4.65747     2.01796     1.75072
;;      0.10159     0.13345     0.06289     0.07448     0.07015     0.24807     0.04328     0.01166
;;      0.01887     0.02845     0.01624     0.02066     0.01531     0.03618     0.00777     0.00220
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Mf/Mw  [SHF, Upstream, unitless]
;;=================================================================================================================================
;;      0.19458     0.17425     3.30329     4.29996     0.26104     0.39002     1.19326     2.64762
;;      0.01915     0.02719     1.94961     2.87300     0.02440     0.10207     0.69578     1.48804
;;      0.00356     0.00580     0.50339     0.79683     0.00532     0.01489     0.12497     0.28121
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Mf/Mgr [SHF, Upstream, unitless]
;;=================================================================================================================================
;;      0.14979     0.13414     2.54287     3.31011     0.20095     0.30024     0.91857     2.03814
;;      0.01474     0.02093     1.50081     2.21164     0.01878     0.07857     0.53561     1.14550
;;      0.00274     0.00446     0.38751     0.61340     0.00410     0.01146     0.09620     0.21648
;;---------------------------------------------------------------------------------------------------------------------------------

;;---------------------------------------------------------------------------------------------------------------------------------
;;  Mf/Mnw [SHF, Upstream, unitless]
;;=================================================================================================================================
;;      0.13759     0.12321     2.33578     3.04053     0.18458     0.27579     0.84376     1.87215
;;      0.01354     0.01922     1.37858     2.03152     0.01725     0.07217     0.49199     1.05221
;;      0.00251     0.00410     0.35595     0.56344     0.00376     0.01053     0.08836     0.19885
;;---------------------------------------------------------------------------------------------------------------------------------





























;;----------------------------------------------------------------------------------------
;;  Get relevant data
;;----------------------------------------------------------------------------------------
thm_load_bowshock_rhsolns,R_STRUCT=diss_rates
thm_load_bowshock_ascii,R_STRUCT=j_E_S_corr
j_E_S_data     = j_E_S_corr.DATA

out_diss_all   = temp_calc_j2_eta_k_S_from_h()

WINDOW,1,RETAIN=2,XSIZE=1700,YSIZE=1100,TITLE='Energy Dissipation 1'



all_ns         = j_E_S_corr.NUM
n_cross        = N_TAGS(all_ns)
nind           = LINDGEN(n_cross)
xyout_cols     = nind*(250L - 30L)/(n_cross - 1L) + 30L   ;; colors for XYOUTS

FOR j=0L, n_cross - 1L DO PRINT,';; ', all_ns.(j)
;;         1648
;;         3376
;;          816
;;          816
;;         1648
;;         1648

n_pts          = 0L
FOR j=0L, n_cross - 1L DO n_pts += all_ns.(j)
PRINT,';; ', n_cross, n_pts
;;            6        9952


;;----------------------------------------------------------------------------------------
;;  Define Rankine-Hugoniot relation solutions
;;----------------------------------------------------------------------------------------
shockRH_0713_0 = diss_rates.(0).SHOCK
shockRH_0721_0 = diss_rates.(1).SHOCK
shockRH_0723_0 = diss_rates.(2).SHOCK
shockRH_0723_1 = diss_rates.(3).SHOCK
shockRH_0723_2 = diss_rates.(4).SHOCK
shockRH_0926_0 = diss_rates.(5).SHOCK
;;  Define shock normal speed, Vshn [SCF, km/s]
vshn____0713_0 = shockRH_0713_0.VSHN[0]
vshn____0721_0 = shockRH_0721_0.VSHN[0]
vshn____0723_0 = shockRH_0723_0.VSHN[0]
vshn____0723_1 = shockRH_0723_1.VSHN[0]
vshn____0723_2 = shockRH_0723_2.VSHN[0]
vshn____0926_0 = shockRH_0926_0.VSHN[0]
;;  Define upstream average number density, <Ni>_{up} [SCF, cm^(-3)]
ni_up___0713_0 = MEAN(diss_rates.(0).UP.NI,/NAN)
ni_up___0721_0 = MEAN(diss_rates.(1).UP.NI,/NAN)
ni_up___0723_0 = MEAN(diss_rates.(2).UP.NI,/NAN)
ni_up___0723_1 = MEAN(diss_rates.(3).UP.NI,/NAN)
ni_up___0723_2 = MEAN(diss_rates.(4).UP.NI,/NAN)
ni_up___0926_0 = MEAN(diss_rates.(5).UP.NI,/NAN)
;;  Define upstream average ion inertial length, <Li>_{up} [SCF, km]
Li_up___0713_0 = ckm[0]/(wpifac[0]*SQRT(ni_up___0713_0[0]))
Li_up___0721_0 = ckm[0]/(wpifac[0]*SQRT(ni_up___0721_0[0]))
Li_up___0723_0 = ckm[0]/(wpifac[0]*SQRT(ni_up___0723_0[0]))
Li_up___0723_1 = ckm[0]/(wpifac[0]*SQRT(ni_up___0723_1[0]))
Li_up___0723_2 = ckm[0]/(wpifac[0]*SQRT(ni_up___0723_2[0]))
Li_up___0926_0 = ckm[0]/(wpifac[0]*SQRT(ni_up___0926_0[0]))
;;  Define ramp time center, t_o (Unix)
trampcn_0713_0 = MEAN(shockRH_0713_0.TRAMP,/NAN)
trampcn_0721_0 = MEAN(shockRH_0721_0.TRAMP,/NAN)
trampcn_0723_0 = MEAN(shockRH_0723_0.TRAMP,/NAN)
trampcn_0723_1 = MEAN(shockRH_0723_1.TRAMP,/NAN)
trampcn_0723_2 = MEAN(shockRH_0723_2.TRAMP,/NAN)
trampcn_0926_0 = MEAN(shockRH_0926_0.TRAMP,/NAN)
;;  Define timestamps, t_j, for |j|^2, |S(w,k)|, etc. (Unix)
unix____0713_0 = j_E_S_data.(0).UNIX
unix____0721_0 = j_E_S_data.(1).UNIX
unix____0723_0 = j_E_S_data.(2).UNIX
unix____0723_1 = j_E_S_data.(3).UNIX
unix____0723_2 = j_E_S_data.(4).UNIX
unix____0926_0 = j_E_S_data.(5).UNIX
;;  Define ∆t_j = t_j - t_o [s]
delta_t_0713_0 = unix____0713_0 - trampcn_0713_0[0]
delta_t_0721_0 = unix____0721_0 - trampcn_0721_0[0]
delta_t_0723_0 = unix____0723_0 - trampcn_0723_0[0]
delta_t_0723_1 = unix____0723_1 - trampcn_0723_1[0]
delta_t_0723_2 = unix____0723_2 - trampcn_0723_2[0]
delta_t_0926_0 = unix____0926_0 - trampcn_0926_0[0]
;;  Define ∆xn_j = |Vshn| * ∆t_j [km]
del_xn_0713_0  = delta_t_0713_0*ABS(vshn____0713_0[0])
del_xn_0721_0  = delta_t_0721_0*ABS(vshn____0721_0[0])
del_xn_0723_0  = delta_t_0723_0*ABS(vshn____0723_0[0])
del_xn_0723_1  = delta_t_0723_1*ABS(vshn____0723_1[0])
del_xn_0723_2  = delta_t_0723_2*ABS(vshn____0723_2[0])
del_xn_0926_0  = delta_t_0926_0*ABS(vshn____0926_0[0])
;;  Define j  [µA m^(-2)]
jnifncb_0713_0 = j_E_S_data.(0).J_VEC_NIF_NCB_SM
jnifncb_0721_0 = j_E_S_data.(1).J_VEC_NIF_NCB_SM
jnifncb_0723_0 = j_E_S_data.(2).J_VEC_NIF_NCB_SM
jnifncb_0723_1 = j_E_S_data.(3).J_VEC_NIF_NCB_SM
jnifncb_0723_2 = j_E_S_data.(4).J_VEC_NIF_NCB_SM
jnifncb_0926_0 = j_E_S_data.(5).J_VEC_NIF_NCB_SM
;;  Define (*eta* |j|^2)  [IAWs, µW m^(-3)]
etajsqn_0713_0 = j_E_S_data.(0).ETA_JSQ_NIF[*,0]
etajsqn_0721_0 = j_E_S_data.(1).ETA_JSQ_NIF[*,0]
etajsqn_0723_0 = j_E_S_data.(2).ETA_JSQ_NIF[*,0]
etajsqn_0723_1 = j_E_S_data.(3).ETA_JSQ_NIF[*,0]
etajsqn_0723_2 = j_E_S_data.(4).ETA_JSQ_NIF[*,0]
etajsqn_0926_0 = j_E_S_data.(5).ETA_JSQ_NIF[*,0]
;;  Define |S(w,k)|  [µW m^(-2)]
Spow_0713_0    = j_E_S_data.(0).S_POW_NIF_GSE_JT
Spow_0721_0    = j_E_S_data.(1).S_POW_NIF_GSE_JT
Spow_0723_0    = j_E_S_data.(2).S_POW_NIF_GSE_JT
Spow_0723_1    = j_E_S_data.(3).S_POW_NIF_GSE_JT
Spow_0723_2    = j_E_S_data.(4).S_POW_NIF_GSE_JT
Spow_0926_0    = j_E_S_data.(5).S_POW_NIF_GSE_JT
;;  Define Sn  [µW m^(-2)]
Sn___0713_0    = j_E_S_data.(0).S_DOT_N_N_NIF_GSE  ;;  [N,3]-Element array
Sn___0721_0    = j_E_S_data.(1).S_DOT_N_N_NIF_GSE  ;;  [N,3]-Element array
Sn___0723_0    = j_E_S_data.(2).S_DOT_N_N_NIF_GSE  ;;  [N,3]-Element array
Sn___0723_1    = j_E_S_data.(3).S_DOT_N_N_NIF_GSE  ;;  [N,3]-Element array
Sn___0723_2    = j_E_S_data.(4).S_DOT_N_N_NIF_GSE  ;;  [N,3]-Element array
Sn___0926_0    = j_E_S_data.(5).S_DOT_N_N_NIF_GSE  ;;  [N,3]-Element array
;;  Define St  [µW m^(-2)]
St___0713_0    = j_E_S_data.(0).N_X_S_X_N_NIF_GSE  ;;  [N,3]-Element array
St___0721_0    = j_E_S_data.(1).N_X_S_X_N_NIF_GSE  ;;  [N,3]-Element array
St___0723_0    = j_E_S_data.(2).N_X_S_X_N_NIF_GSE  ;;  [N,3]-Element array
St___0723_1    = j_E_S_data.(3).N_X_S_X_N_NIF_GSE  ;;  [N,3]-Element array
St___0723_2    = j_E_S_data.(4).N_X_S_X_N_NIF_GSE  ;;  [N,3]-Element array
St___0926_0    = j_E_S_data.(5).N_X_S_X_N_NIF_GSE  ;;  [N,3]-Element array
;;  Define ∂B  [SCF in GSE basis, nT]
Bscfgse_0713_0 = j_E_S_data.(0).B_VEC_SCF_GSE_JT
Bscfgse_0721_0 = j_E_S_data.(1).B_VEC_SCF_GSE_JT
Bscfgse_0723_0 = j_E_S_data.(2).B_VEC_SCF_GSE_JT
Bscfgse_0723_1 = j_E_S_data.(3).B_VEC_SCF_GSE_JT
Bscfgse_0723_2 = j_E_S_data.(4).B_VEC_SCF_GSE_JT
Bscfgse_0926_0 = j_E_S_data.(5).B_VEC_SCF_GSE_JT
;;  Define ∂E  [NIF in GSE basis, mV/m]
Enifgse_0713_0 = j_E_S_data.(0).E_VEC_NIF_GSE_JT
Enifgse_0721_0 = j_E_S_data.(1).E_VEC_NIF_GSE_JT
Enifgse_0723_0 = j_E_S_data.(2).E_VEC_NIF_GSE_JT
Enifgse_0723_1 = j_E_S_data.(3).E_VEC_NIF_GSE_JT
Enifgse_0723_2 = j_E_S_data.(4).E_VEC_NIF_GSE_JT
Enifgse_0926_0 = j_E_S_data.(5).E_VEC_NIF_GSE_JT
;;----------------------------------------------------------------------------------------
;;  Calculate parameters from definitions
;;----------------------------------------------------------------------------------------
;;  Calculate |j|^2  [A^(2) m^(-4)]
jsqrnif_0713_0 = TOTAL((jnifncb_0713_0*1d-6)^2,2L,/NAN)
jsqrnif_0721_0 = TOTAL((jnifncb_0721_0*1d-6)^2,2L,/NAN)
jsqrnif_0723_0 = TOTAL((jnifncb_0723_0*1d-6)^2,2L,/NAN)
jsqrnif_0723_1 = TOTAL((jnifncb_0723_1*1d-6)^2,2L,/NAN)
jsqrnif_0723_2 = TOTAL((jnifncb_0723_2*1d-6)^2,2L,/NAN)
jsqrnif_0926_0 = TOTAL((jnifncb_0926_0*1d-6)^2,2L,/NAN)
;;  Define *eta*  [IAWs, Ω m]
etanif__0713_0 = (etajsqn_0713_0*1d-6)/jsqrnif_0713_0
etanif__0721_0 = (etajsqn_0721_0*1d-6)/jsqrnif_0721_0
etanif__0723_0 = (etajsqn_0723_0*1d-6)/jsqrnif_0723_0
etanif__0723_1 = (etajsqn_0723_1*1d-6)/jsqrnif_0723_1
etanif__0723_2 = (etajsqn_0723_2*1d-6)/jsqrnif_0723_2
etanif__0926_0 = (etajsqn_0926_0*1d-6)/jsqrnif_0926_0
;;  Calculate |Sn|  [µW m^(-2)]
Sn_mag_0713_0  = SQRT(TOTAL(Sn___0713_0^2,2L,/NAN))
Sn_mag_0721_0  = SQRT(TOTAL(Sn___0721_0^2,2L,/NAN))
Sn_mag_0723_0  = SQRT(TOTAL(Sn___0723_0^2,2L,/NAN))
Sn_mag_0723_1  = SQRT(TOTAL(Sn___0723_1^2,2L,/NAN))
Sn_mag_0723_2  = SQRT(TOTAL(Sn___0723_2^2,2L,/NAN))
Sn_mag_0926_0  = SQRT(TOTAL(Sn___0926_0^2,2L,/NAN))
;;  Calculate |St|  [µW m^(-2)]
St_mag_0713_0  = SQRT(TOTAL(St___0713_0^2,2L,/NAN))
St_mag_0721_0  = SQRT(TOTAL(St___0721_0^2,2L,/NAN))
St_mag_0723_0  = SQRT(TOTAL(St___0723_0^2,2L,/NAN))
St_mag_0723_1  = SQRT(TOTAL(St___0723_1^2,2L,/NAN))
St_mag_0723_2  = SQRT(TOTAL(St___0723_2^2,2L,/NAN))
St_mag_0926_0  = SQRT(TOTAL(St___0926_0^2,2L,/NAN))
;;  Calculate |∂B|^2/(2 µ_o)  [µW m^(-3)]
B_E_fac        = (1d-9)^2*1d6/(2d0*muo[0])
B_E_gse_0713_0 = TOTAL(Bscfgse_0713_0^2,2L,/NAN)*B_E_fac[0]
B_E_gse_0721_0 = TOTAL(Bscfgse_0721_0^2,2L,/NAN)*B_E_fac[0]
B_E_gse_0723_0 = TOTAL(Bscfgse_0723_0^2,2L,/NAN)*B_E_fac[0]
B_E_gse_0723_1 = TOTAL(Bscfgse_0723_1^2,2L,/NAN)*B_E_fac[0]
B_E_gse_0723_2 = TOTAL(Bscfgse_0723_2^2,2L,/NAN)*B_E_fac[0]
B_E_gse_0926_0 = TOTAL(Bscfgse_0926_0^2,2L,/NAN)*B_E_fac[0]
;;  Calculate ∑_o |∂E|^2/2    [µW m^(-3)]
E_E_fac        = (1d-3)^2*1d6*epo[0]/2d0
E_E_gse_0713_0 = TOTAL(Enifgse_0713_0^2,2L,/NAN)*E_E_fac[0]
E_E_gse_0721_0 = TOTAL(Enifgse_0721_0^2,2L,/NAN)*E_E_fac[0]
E_E_gse_0723_0 = TOTAL(Enifgse_0723_0^2,2L,/NAN)*E_E_fac[0]
E_E_gse_0723_1 = TOTAL(Enifgse_0723_1^2,2L,/NAN)*E_E_fac[0]
E_E_gse_0723_2 = TOTAL(Enifgse_0723_2^2,2L,/NAN)*E_E_fac[0]
E_E_gse_0926_0 = TOTAL(Enifgse_0926_0^2,2L,/NAN)*E_E_fac[0]
;;----------------------------------------------------------------------------------------
;;  Look at ratio R = ∆¥/(*eta* |j|^2)
;;    = ratio of enthalpy change to ohmic dissipation rate estimate
;;    If R < 1 => waves provide more energy dissipation than necessary to maintain shock
;;----------------------------------------------------------------------------------------
outdiss_0713_0 = out_diss_all.(0)
outdiss_0721_0 = out_diss_all.(1)
outdiss_0723_0 = out_diss_all.(2)
outdiss_0723_1 = out_diss_all.(3)
outdiss_0723_2 = out_diss_all.(4)
outdiss_0926_0 = out_diss_all.(5)
;;  use specific enthalpy density change
dhdtstr_0713_0 = outdiss_0713_0.DH_DT
dhdtstr_0721_0 = outdiss_0721_0.DH_DT
dhdtstr_0723_0 = outdiss_0723_0.DH_DT
dhdtstr_0723_1 = outdiss_0723_1.DH_DT
dhdtstr_0723_2 = outdiss_0723_2.DH_DT
dhdtstr_0926_0 = outdiss_0926_0.DH_DT
;;  Define |j|^2 = ∆¥/*eta*  [A^(2) m^(-4)]
;;    => Compare to measured/estimated value
jsq_eta_0713_0 = dhdtstr_0713_0.J_SQR_FROM_ETA
jsq_eta_0721_0 = dhdtstr_0721_0.J_SQR_FROM_ETA
jsq_eta_0723_0 = dhdtstr_0723_0.J_SQR_FROM_ETA
jsq_eta_0723_1 = dhdtstr_0723_1.J_SQR_FROM_ETA
jsq_eta_0723_2 = dhdtstr_0723_2.J_SQR_FROM_ETA
jsq_eta_0926_0 = dhdtstr_0926_0.J_SQR_FROM_ETA
;;  Define *eta* = ∆¥/|j|^2  [Ω m]
;;    => Compare to measured/estimated value
etafjsq_0713_0 = dhdtstr_0713_0.ETA_FROM_JSQR
etafjsq_0721_0 = dhdtstr_0721_0.ETA_FROM_JSQR
etafjsq_0723_0 = dhdtstr_0723_0.ETA_FROM_JSQR
etafjsq_0723_1 = dhdtstr_0723_1.ETA_FROM_JSQR
etafjsq_0723_2 = dhdtstr_0723_2.ETA_FROM_JSQR
etafjsq_0926_0 = dhdtstr_0926_0.ETA_FROM_JSQR
;;  Define |k| = ∆¥/|S(w,k)|  [km]
kmag_S__0713_0 = dhdtstr_0713_0.KMAG_FROM_SPOW
kmag_S__0721_0 = dhdtstr_0721_0.KMAG_FROM_SPOW
kmag_S__0723_0 = dhdtstr_0723_0.KMAG_FROM_SPOW
kmag_S__0723_1 = dhdtstr_0723_1.KMAG_FROM_SPOW
kmag_S__0723_2 = dhdtstr_0723_2.KMAG_FROM_SPOW
kmag_S__0926_0 = dhdtstr_0926_0.KMAG_FROM_SPOW
;;  Define R = ∆¥/(*eta* |j|^2)
;;    [use IAW *eta* from E-field in NIF in GSE basis]
r_dhdt_0713_0  = dhdtstr_0713_0.RATIO_DISS_ETAJSQR_NIF[*,0]
r_dhdt_0721_0  = dhdtstr_0721_0.RATIO_DISS_ETAJSQR_NIF[*,0]
r_dhdt_0723_0  = dhdtstr_0723_0.RATIO_DISS_ETAJSQR_NIF[*,0]
r_dhdt_0723_1  = dhdtstr_0723_1.RATIO_DISS_ETAJSQR_NIF[*,0]
r_dhdt_0723_2  = dhdtstr_0723_2.RATIO_DISS_ETAJSQR_NIF[*,0]
r_dhdt_0926_0  = dhdtstr_0926_0.RATIO_DISS_ETAJSQR_NIF[*,0]

good_r_0713_0  = WHERE(r_dhdt_0713_0 LE 1.,gd_0713_0)
good_r_0721_0  = WHERE(r_dhdt_0721_0 LE 1.,gd_0721_0)
good_r_0723_0  = WHERE(r_dhdt_0723_0 LE 1.,gd_0723_0)
good_r_0723_1  = WHERE(r_dhdt_0723_1 LE 1.,gd_0723_1)
good_r_0723_2  = WHERE(r_dhdt_0723_2 LE 1.,gd_0723_2)
good_r_0926_0  = WHERE(r_dhdt_0926_0 LE 1.,gd_0926_0)
PRINT,';; ', gd_0713_0, gd_0721_0, gd_0723_0, gd_0723_1, gd_0723_2, gd_0926_0
;;            8          80          42         146         541          73

FOR j=0L, n_cross - 1L DO PRINT,';; ', all_ns.(j)
;;         1648
;;         3376
;;          816
;;          816
;;         1648
;;         1648


x              = Spow_0713_0[good_r_0713_0]
PRINT,';;', MIN(x,/NAN), MAX(x,/NAN), MEAN(x,/NAN), STDDEV(x,/NAN)
;;       1.8384000       37.217200       14.576880       13.291306

x              = Spow_0721_0[good_r_0721_0]
PRINT,';;', MIN(x,/NAN), MAX(x,/NAN), MEAN(x,/NAN), STDDEV(x,/NAN)
;;      0.17365900       22.635300       4.1946081       4.4876218

x              = Spow_0723_0[good_r_0723_0]
PRINT,';;', MIN(x,/NAN), MAX(x,/NAN), MEAN(x,/NAN), STDDEV(x,/NAN)
;;       7.8375400       326.30100       45.988773       57.144630

x              = Spow_0723_1[good_r_0723_1]
PRINT,';;', MIN(x,/NAN), MAX(x,/NAN), MEAN(x,/NAN), STDDEV(x,/NAN)
;;      0.25462600       420.57400       24.835506       45.736230

x              = Spow_0723_2[good_r_0723_2]
PRINT,';;', MIN(x,/NAN), MAX(x,/NAN), MEAN(x,/NAN), STDDEV(x,/NAN)
;;      0.19213200       171.48200       13.749901       16.488098

x              = Spow_0926_0[good_r_0926_0]
PRINT,';;', MIN(x,/NAN), MAX(x,/NAN), MEAN(x,/NAN), STDDEV(x,/NAN)
;;      0.78519900       887.83300       48.272860       119.60731



x              = [[Sn_mag_0713_0[good_r_0713_0]],[St_mag_0713_0[good_r_0713_0]]]
FOR j=0L, 1L DO PRINT,';;', MIN(x[*,j],/NAN), MAX(x[*,j],/NAN), MEAN(x[*,j],/NAN), STDDEV(x[*,j],/NAN)
;;      0.47476429       6.8730081       3.8484649       2.2499117
;;      0.27803585       1.4398339      0.81112723      0.44010281

x              = [[Sn_mag_0721_0[good_r_0721_0]],[St_mag_0721_0[good_r_0721_0]]]
FOR j=0L, 1L DO PRINT,';;', MIN(x[*,j],/NAN), MAX(x[*,j],/NAN), MEAN(x[*,j],/NAN), STDDEV(x[*,j],/NAN)
;;    0.0034490459       5.1912228      0.82691985       1.0094012
;;    0.0088233856       5.5518464       1.3162114       1.3562368

x              = [[Sn_mag_0723_0[good_r_0723_0]],[St_mag_0723_0[good_r_0723_0]]]
FOR j=0L, 1L DO PRINT,';;', MIN(x[*,j],/NAN), MAX(x[*,j],/NAN), MEAN(x[*,j],/NAN), STDDEV(x[*,j],/NAN)
;;     0.024724756       33.677547       3.7108085       6.5070028
;;      0.75457358       20.802675       4.7075766       4.2254099

x              = [[Sn_mag_0723_1[good_r_0723_1]],[St_mag_0723_1[good_r_0723_1]]]
FOR j=0L, 1L DO PRINT,';;', MIN(x[*,j],/NAN), MAX(x[*,j],/NAN), MEAN(x[*,j],/NAN), STDDEV(x[*,j],/NAN)
;;   0.00022308106       47.315784       2.4915736       4.9160181
;;     0.033320525       46.429484       3.0401131       5.0504686

x              = [[Sn_mag_0723_2[good_r_0723_2]],[St_mag_0723_2[good_r_0723_2]]]
FOR j=0L, 1L DO PRINT,';;', MIN(x[*,j],/NAN), MAX(x[*,j],/NAN), MEAN(x[*,j],/NAN), STDDEV(x[*,j],/NAN)
;;       0.0000000       17.891678       1.6004603       2.4718314
;;       0.0000000       26.672159       2.2733474       2.9843906

x              = [[Sn_mag_0926_0[good_r_0926_0]],[St_mag_0926_0[good_r_0926_0]]]
FOR j=0L, 1L DO PRINT,';;', MIN(x[*,j],/NAN), MAX(x[*,j],/NAN), MEAN(x[*,j],/NAN), STDDEV(x[*,j],/NAN)
;;     0.082221476       70.530051       6.0790059       11.861068
;;      0.26379067       100.04371       6.8314372       14.595701



;;----------------------------------------------------------------------------------------
;;  Use all data where ∆xn ≤ 1 [c/wpi]
;;----------------------------------------------------------------------------------------
Delta_str      = STRUPCASE(get_greek_letter('delta'))
mu__str        = get_greek_letter('mu')
muo_str        = mu__str[0]+'!Do!N'
eta_str        = get_greek_letter('eta')
epsilon_str    = get_greek_letter('epsilon')
omega_str      = get_greek_letter('omega')
dhdt_ypref     = '('+Delta_str[0]+'h/'+Delta_str[0]+'t)'
Li_ypref       = omega_str[0]+'!Dpi!N'

xmax           = 1d0
good_r_0713_0  = WHERE(ABS(del_xn_0713_0)/Li_up___0713_0[0] LE xmax[0],gd_0713_0)
good_r_0721_0  = WHERE(ABS(del_xn_0721_0)/Li_up___0721_0[0] LE xmax[0],gd_0721_0)
good_r_0723_0  = WHERE(ABS(del_xn_0723_0)/Li_up___0723_0[0] LE xmax[0],gd_0723_0)
good_r_0723_1  = WHERE(ABS(del_xn_0723_1)/Li_up___0723_1[0] LE xmax[0],gd_0723_1)
good_r_0723_2  = WHERE(ABS(del_xn_0723_2)/Li_up___0723_2[0] LE xmax[0],gd_0723_2)
good_r_0926_0  = WHERE(ABS(del_xn_0926_0)/Li_up___0926_0[0] LE xmax[0],gd_0926_0)
PRINT,';; ', gd_0713_0, gd_0721_0, gd_0723_0, gd_0723_1, gd_0723_2, gd_0926_0
;;          412         685         485         816         234         715


WINDOW,1,RETAIN=2,XSIZE=1700,YSIZE=1100,TITLE='Energy Dissipation 1'
WINDOW,2,RETAIN=2,XSIZE=1700,YSIZE=1100,TITLE='Energy Dissipation 2'
WINDOW,3,RETAIN=2,XSIZE=1700,YSIZE=1100,TITLE='Energy Dissipation 3'
WINDOW,4,RETAIN=2,XSIZE=1700,YSIZE=1100,TITLE='Energy Dissipation 4'
;;----------------------------------------------------------------------------------------
;;  Plot |j|^2 (from ∆¥/*eta*) vs. |j|^2 (measured)
;;----------------------------------------------------------------------------------------
x0             = jsqrnif_0713_0[good_r_0713_0]*1d6
x1             = jsqrnif_0721_0[good_r_0721_0]*1d6
x2             = jsqrnif_0723_0[good_r_0723_0]*1d6
x3             = jsqrnif_0723_1[good_r_0723_1]*1d6
x4             = jsqrnif_0723_2[good_r_0723_2]*1d6
x5             = jsqrnif_0926_0[good_r_0926_0]*1d6

y0             = jsq_eta_0713_0[good_r_0713_0]*1d6
y1             = jsq_eta_0721_0[good_r_0721_0]*1d6
y2             = jsq_eta_0723_0[good_r_0723_0]*1d6
y3             = jsq_eta_0723_1[good_r_0723_1]*1d6
y4             = jsq_eta_0723_2[good_r_0723_2]*1d6
y5             = jsq_eta_0926_0[good_r_0926_0]*1d6

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
PRINT, ';;', MIN([y0,y1,y2,y3,y4,y5],/NAN), MAX([y0,y1,y2,y3,y4,y5],/NAN)
;;   1.4460842e-11    0.0027556463
;;   1.3643109e-08      0.61859695


ttle_pref      = '|j|!U2!N ['
xttle          = ttle_pref[0]+'Observed, '+mu__str[0]+'A!U2!N m!U-4!N'+']'
yttle          = ttle_pref[0]+dhdt_ypref[0]+'/'+eta_str[0]+', '+mu__str[0]+'A!U2!N m!U-4!N'+']'
pttle          = '|j|^2 [from (dh/dt)/*eta*] vs. |j|^2 [Observed]'
xra            = [1d-8,1d-1]
yra            = xra
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,1
WSHOW,1
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = x line
    OPLOT,xra,xra,LINESTYLE=2,THICK=2

;;----------------------------------------------------------------------------------------
;;  Plot *eta* (from ∆¥/|j|^2) vs. *eta* (measured)
;;----------------------------------------------------------------------------------------
x0             = etanif__0713_0[good_r_0713_0]
x1             = etanif__0721_0[good_r_0721_0]
x2             = etanif__0723_0[good_r_0723_0]
x3             = etanif__0723_1[good_r_0723_1]
x4             = etanif__0723_2[good_r_0723_2]
x5             = etanif__0926_0[good_r_0926_0]

y0             = etafjsq_0713_0[good_r_0713_0]
y1             = etafjsq_0721_0[good_r_0721_0]
y2             = etafjsq_0723_0[good_r_0723_0]
y3             = etafjsq_0723_1[good_r_0723_1]
y4             = etafjsq_0723_2[good_r_0723_2]
y5             = etafjsq_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
PRINT, ';;', MIN([y0,y1,y2,y3,y4,y5],/NAN), MAX([y0,y1,y2,y3,y4,y5],/NAN)
;;    0.0012805913       1319.4727
;;      0.11622296       2772751.0


ttle_pref      = eta_str[0]+' ['
xttle          = ttle_pref[0]+'Observed, '+STRUPCASE(omega_str[0])+' m]'
yttle          = ttle_pref[0]+dhdt_ypref[0]+'/|j|!U2!N'+', '+STRUPCASE(omega_str[0])+' m]'
pttle          = '*eta* [from (dh/dt)/|j|^2] vs. *eta* [Observed]'
xra            = [1d-2,1d4]
yra            = xra
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,2
WSHOW,2
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = x line
    OPLOT,xra,xra,LINESTYLE=2,THICK=2


;;----------------------------------------------------------------------------------------
;;  Find ∆t ranges where R ≤ 1
;;----------------------------------------------------------------------------------------
ymax           = 1d0
good_r_0713_0  = WHERE(r_dhdt_0713_0 LE ymax[0],gd_0713_0)
good_r_0721_0  = WHERE(r_dhdt_0721_0 LE ymax[0],gd_0721_0)
good_r_0723_0  = WHERE(r_dhdt_0723_0 LE ymax[0],gd_0723_0)
good_r_0723_1  = WHERE(r_dhdt_0723_1 LE ymax[0],gd_0723_1)
good_r_0723_2  = WHERE(r_dhdt_0723_2 LE ymax[0],gd_0723_2)
good_r_0926_0  = WHERE(r_dhdt_0926_0 LE ymax[0],gd_0926_0)
PRINT,';; ', gd_0713_0, gd_0721_0, gd_0723_0, gd_0723_1, gd_0723_2, gd_0926_0
;;            8          80          42         146         541          73


dt0            = ABS(delta_t_0713_0[good_r_0713_0])
dt1            = ABS(delta_t_0721_0[good_r_0721_0])
dt2            = ABS(delta_t_0723_0[good_r_0723_0])
dt3            = ABS(delta_t_0723_1[good_r_0723_1])
dt4            = ABS(delta_t_0723_2[good_r_0723_2])
dt5            = ABS(delta_t_0926_0[good_r_0926_0])
PRINT, ';;', MIN([dt0,dt1,dt2,dt3,dt4,dt5],/NAN), MAX([dt0,dt1,dt2,dt3,dt4,dt5],/NAN)
;;  ∆t [s] range
;;    0.0019998550       14.445000

tags           = 'T'+STRING(LINDGEN(6),FORMAT='(I2.2)')
x              = CREATE_STRUCT(tags,dt0,dt1,dt2,dt3,dt4,dt5)
FOR j=0L, 5L DO PRINT,';;', MIN(x.(j),/NAN), MAX(x.(j),/NAN), MEAN(x.(j),/NAN), STDDEV(x.(j),/NAN)
;;---------------------------------------------------------------------
;;  ∆t [s] stats
;;---------------------------------------------------------------------
;;          Min             Max             Avg           Std Dev
;;=====================================================================
;;      0.29999995       1.3169999      0.70774999      0.48633608
;;       1.3130002       4.1330001       2.7094626      0.53395889
;;     0.036999941       3.3690002       1.4065952       1.0952833
;;     0.061000109       2.8999999       1.6254246      0.89876112
;;       1.6719999       14.445000       6.9981127       3.5403586
;;    0.0019998550       7.2279999       1.9890274       2.1233713
;;---------------------------------------------------------------------


dx0            = ABS(del_xn_0713_0[good_r_0713_0])/Li_up___0713_0[0]
dx1            = ABS(del_xn_0721_0[good_r_0721_0])/Li_up___0721_0[0]
dx2            = ABS(del_xn_0723_0[good_r_0723_0])/Li_up___0723_0[0]
dx3            = ABS(del_xn_0723_1[good_r_0723_1])/Li_up___0723_1[0]
dx4            = ABS(del_xn_0723_2[good_r_0723_2])/Li_up___0723_2[0]
dx5            = ABS(del_xn_0926_0[good_r_0926_0])/Li_up___0926_0[0]
PRINT, ';;', MIN([dx0,dx1,dx2,dx3,dx4,dx5],/NAN), MAX([dx0,dx1,dx2,dx3,dx4,dx5],/NAN)
;;  ∆xn [c/wpi] range
;;   0.00071636542       4.2433050

tags           = 'T'+STRING(LINDGEN(6),FORMAT='(I2.2)')
x              = CREATE_STRUCT(tags,dx0,dx1,dx2,dx3,dx4,dx5)
FOR j=0L, 5L DO PRINT,';;', MIN(x.(j),/NAN), MAX(x.(j),/NAN), MEAN(x.(j),/NAN), STDDEV(x.(j),/NAN)
;;---------------------------------------------------------------------
;;  ∆xn [c/wpi] stats
;;---------------------------------------------------------------------
;;          Min             Max             Avg           Std Dev
;;=====================================================================
;;      0.18679543      0.82003203      0.44068163      0.30281791
;;      0.49078608       1.5448733       1.0127695      0.19958838
;;     0.019538660       1.7790771      0.74278460      0.57838927
;;    0.0071664016      0.34069716      0.19095778      0.10558806
;;      0.49115997       4.2433050       2.0557374       1.0400015
;;   0.00071636542       2.5891322      0.71248687      0.76061001
;;---------------------------------------------------------------------


;;----------------------------------------------------------------------------------------
;;  Use only data where R ≤ 1 and ∆xn ≤ 1 [c/wpi]
;;----------------------------------------------------------------------------------------
xmax           = 1d0
ymax           = 1d0
good_r_0713_0  = WHERE(r_dhdt_0713_0 LE ymax[0] AND ABS(del_xn_0713_0)/Li_up___0713_0[0] LE xmax[0],gd_0713_0)
good_r_0721_0  = WHERE(r_dhdt_0721_0 LE ymax[0] AND ABS(del_xn_0721_0)/Li_up___0721_0[0] LE xmax[0],gd_0721_0)
good_r_0723_0  = WHERE(r_dhdt_0723_0 LE ymax[0] AND ABS(del_xn_0723_0)/Li_up___0723_0[0] LE xmax[0],gd_0723_0)
good_r_0723_1  = WHERE(r_dhdt_0723_1 LE ymax[0] AND ABS(del_xn_0723_1)/Li_up___0723_1[0] LE xmax[0],gd_0723_1)
good_r_0723_2  = WHERE(r_dhdt_0723_2 LE ymax[0] AND ABS(del_xn_0723_2)/Li_up___0723_2[0] LE xmax[0],gd_0723_2)
good_r_0926_0  = WHERE(r_dhdt_0926_0 LE ymax[0] AND ABS(del_xn_0926_0)/Li_up___0926_0[0] LE xmax[0],gd_0926_0)
PRINT,';; ', gd_0713_0, gd_0721_0, gd_0723_0, gd_0723_1, gd_0723_2, gd_0926_0
;;            8          43          28         146         107          55

;;----------------------------------------------------------------------------------------
;;  Plot |k| (from ∆¥/|S(w,k)|) vs. |St| (measured)
;;----------------------------------------------------------------------------------------
x0             = St_mag_0713_0[good_r_0713_0]
x1             = St_mag_0721_0[good_r_0721_0]
x2             = St_mag_0723_0[good_r_0723_0]
x3             = St_mag_0723_1[good_r_0723_1]
x4             = St_mag_0723_2[good_r_0723_2]
x5             = St_mag_0926_0[good_r_0926_0]

y0             = kmag_S__0713_0[good_r_0713_0]
y1             = kmag_S__0721_0[good_r_0721_0]
y2             = kmag_S__0723_0[good_r_0723_0]
y3             = kmag_S__0723_1[good_r_0723_1]
y4             = kmag_S__0723_2[good_r_0723_2]
y5             = kmag_S__0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
PRINT, ';;', MIN([y0,y1,y2,y3,y4,y5],/NAN), MAX([y0,y1,y2,y3,y4,y5],/NAN)
;;     0.028303543       100.04371
;;   6.2719516e-05       1.2578031

xttle          = '|n x (S x n)| ['+mu__str[0]+'W m!U-2!N'+']'
yttle          = '|k| [from '+dhdt_ypref[0]+'/|S('+omega_str[0]+',k)|, km!U-1!N'+']'
pttle          = '|j|^2 [from (dh/dt)/*eta*] vs. |j|^2 [Observed]'
xra            = [1d-2,1d2]
yra            = [1d-5,1d1]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,3
WSHOW,3
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = x line
    OPLOT,xra,xra,LINESTYLE=2,THICK=2


;;----------------------------------------------------------------------------------------
;;  Plot R vs. ∆xn
;;    = ratio of enthalpy change to ohmic dissipation rate estimate
;;    If R < 1 => waves provide more energy dissipation than necessary to maintain shock
;;----------------------------------------------------------------------------------------
x0             = ABS(del_xn_0713_0[good_r_0713_0])/Li_up___0713_0[0]
x1             = ABS(del_xn_0721_0[good_r_0721_0])/Li_up___0721_0[0]
x2             = ABS(del_xn_0723_0[good_r_0723_0])/Li_up___0723_0[0]
x3             = ABS(del_xn_0723_1[good_r_0723_1])/Li_up___0723_1[0]
x4             = ABS(del_xn_0723_2[good_r_0723_2])/Li_up___0723_2[0]
x5             = ABS(del_xn_0926_0[good_r_0926_0])/Li_up___0926_0[0]

y0             = r_dhdt_0713_0[good_r_0713_0]
y1             = r_dhdt_0721_0[good_r_0721_0]
y2             = r_dhdt_0723_0[good_r_0723_0]
y3             = r_dhdt_0723_1[good_r_0723_1]
y4             = r_dhdt_0723_2[good_r_0723_2]
y5             = r_dhdt_0926_0[good_r_0926_0]


yttle          = dhdt_ypref[0]+'/('+eta_str[0]+'|j|!U2!N'+') [Dissipation Ratio]'
xttle          = Delta_str[0]+'X!Dn!N [<c/'+Li_ypref[0]+'>!Dup!N'+']'
pttle          = 'Ratio of (dh/dt)/(*eta* |j|^2) vs. Shock Normal Displacement'
xra            = [1d-4,xmax[0]]
yra            = [1d-4,ymax[0]*2d0]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,1
WSHOW,1
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]

;;----------------------------------------------------------------------------------------
;;  Plot R vs. |Sn| and R vs. |St|
;;----------------------------------------------------------------------------------------
;;  R vs. |St|
x0             = St_mag_0713_0[good_r_0713_0]
x1             = St_mag_0721_0[good_r_0721_0]
x2             = St_mag_0723_0[good_r_0723_0]
x3             = St_mag_0723_1[good_r_0723_1]
x4             = St_mag_0723_2[good_r_0723_2]
x5             = St_mag_0926_0[good_r_0926_0]

y0             = r_dhdt_0713_0[good_r_0713_0]
y1             = r_dhdt_0721_0[good_r_0721_0]
y2             = r_dhdt_0723_0[good_r_0723_0]
y3             = r_dhdt_0723_1[good_r_0723_1]
y4             = r_dhdt_0723_2[good_r_0723_2]
y5             = r_dhdt_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
PRINT, ';;', MIN([y0,y1,y2,y3,y4,y5],/NAN), MAX([y0,y1,y2,y3,y4,y5],/NAN)
;;     0.028303543       100.04371
;;   0.00080362476      0.99765243

dhdt_ypref     = '('+Delta_str[0]+'h/'+Delta_str[0]+'t)'
yttle          = dhdt_ypref[0]+'/('+eta_str[0]+'|j|!U2!N'+') [Dissipation Ratio]'
xttle          = '|n x (S x n)| ['+mu__str[0]+'W m!U-2!N'+']'
pttle          = 'Ratio of (dh/dt)/(*eta* |j|^2) vs. |St|'
xra            = [1d-3,2d2]
yra            = [1d-4,2d0]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,1
WSHOW,1
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]


;;  R vs. |Sn|
x0             = Sn_mag_0713_0[good_r_0713_0]
x1             = Sn_mag_0721_0[good_r_0721_0]
x2             = Sn_mag_0723_0[good_r_0723_0]
x3             = Sn_mag_0723_1[good_r_0723_1]
x4             = Sn_mag_0723_2[good_r_0723_2]
x5             = Sn_mag_0926_0[good_r_0926_0]

y0             = r_dhdt_0713_0[good_r_0713_0]
y1             = r_dhdt_0721_0[good_r_0721_0]
y2             = r_dhdt_0723_0[good_r_0723_0]
y3             = r_dhdt_0723_1[good_r_0723_1]
y4             = r_dhdt_0723_2[good_r_0723_2]
y5             = r_dhdt_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
PRINT, ';;', MIN([y0,y1,y2,y3,y4,y5],/NAN), MAX([y0,y1,y2,y3,y4,y5],/NAN)
;;   1.9577290e-05       70.530051
;;   0.00080362476      0.99765243

dhdt_ypref     = '('+Delta_str[0]+'h/'+Delta_str[0]+'t)'
yttle          = dhdt_ypref[0]+'/('+eta_str[0]+'|j|!U2!N'+') [Dissipation Ratio]'
xttle          = '|(n . S) n| ['+mu__str[0]+'W m!U-2!N'+']'
pttle          = 'Ratio of (dh/dt)/(*eta* |j|^2) vs. |Sn|'
xra            = [1d-3,2d2]
yra            = [1d-4,2d0]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,2
WSHOW,2
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]


;;  R vs. |S(w,k)|
x0             = Spow_0713_0[good_r_0713_0]
x1             = Spow_0721_0[good_r_0721_0]
x2             = Spow_0723_0[good_r_0723_0]
x3             = Spow_0723_1[good_r_0723_1]
x4             = Spow_0723_2[good_r_0723_2]
x5             = Spow_0926_0[good_r_0926_0]

y0             = r_dhdt_0713_0[good_r_0713_0]
y1             = r_dhdt_0721_0[good_r_0721_0]
y2             = r_dhdt_0723_0[good_r_0723_0]
y3             = r_dhdt_0723_1[good_r_0723_1]
y4             = r_dhdt_0723_2[good_r_0723_2]
y5             = r_dhdt_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
PRINT, ';;', MIN([y0,y1,y2,y3,y4,y5],/NAN), MAX([y0,y1,y2,y3,y4,y5],/NAN)
;;      0.17365900       887.83300
;;   0.00080362476      0.99765243

xttle          = '|S| [FFT Power, '+mu__str[0]+'W m!U-2!N'+']'
dhdt_ypref     = '('+Delta_str[0]+'h/'+Delta_str[0]+'t)'
yttle          = dhdt_ypref[0]+'/('+eta_str[0]+'|j|!U2!N'+') [Dissipation Ratio]'
pttle          = 'Ratio of (dh/dt)/(*eta* |j|^2) vs. Integrated FFT Poynting Flux'
xra            = [1d-1,1d3]
yra            = [1d-4,2d0]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,3
WSHOW,3
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
;;----------------------------------------------------------------------------------------
;;  Use all data
;;----------------------------------------------------------------------------------------
good_r_0713_0  = WHERE(FINITE(r_dhdt_0713_0) AND r_dhdt_0713_0 GT 0d0,gd_0713_0)
good_r_0721_0  = WHERE(FINITE(r_dhdt_0721_0) AND r_dhdt_0721_0 GT 0d0,gd_0721_0)
good_r_0723_0  = WHERE(FINITE(r_dhdt_0723_0) AND r_dhdt_0723_0 GT 0d0,gd_0723_0)
good_r_0723_1  = WHERE(FINITE(r_dhdt_0723_1) AND r_dhdt_0723_1 GT 0d0,gd_0723_1)
good_r_0723_2  = WHERE(FINITE(r_dhdt_0723_2) AND r_dhdt_0723_2 GT 0d0,gd_0723_2)
good_r_0926_0  = WHERE(FINITE(r_dhdt_0926_0) AND r_dhdt_0926_0 GT 0d0,gd_0926_0)
PRINT,';; ', gd_0713_0, gd_0721_0, gd_0723_0, gd_0723_1, gd_0723_2, gd_0926_0
;;         1648         811         816         816        1648        1648


;;--------------------------------------------------
;;  Plot R vs. |Sn| and R vs. |St|
;;--------------------------------------------------
dhdt_ypref     = '('+Delta_str[0]+'h/'+Delta_str[0]+'t)'
yttle          = '('+eta_str[0]+'|j|!U2!N'+')/'+dhdt_ypref[0]+' [Dissipation Ratio]'
y0             = 1d0/r_dhdt_0713_0[good_r_0713_0]
y1             = 1d0/r_dhdt_0721_0[good_r_0721_0]
y2             = 1d0/r_dhdt_0723_0[good_r_0723_0]
y3             = 1d0/r_dhdt_0723_1[good_r_0723_1]
y4             = 1d0/r_dhdt_0723_2[good_r_0723_2]
y5             = 1d0/r_dhdt_0926_0[good_r_0926_0]
PRINT, ';;', MIN([y0,y1,y2,y3,y4,y5],/NAN), MAX([y0,y1,y2,y3,y4,y5],/NAN)
;;   5.2675050e-08       1244.3619
yra            = [1d-8,2d3]


;;  1/R vs. |St|
x0             = St_mag_0713_0[good_r_0713_0]
x1             = St_mag_0721_0[good_r_0721_0]
x2             = St_mag_0723_0[good_r_0723_0]
x3             = St_mag_0723_1[good_r_0723_1]
x4             = St_mag_0723_2[good_r_0723_2]
x5             = St_mag_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
;;       0.0000000       100.04371

xttle          = '|n x (S x n)| ['+mu__str[0]+'W m!U-2!N'+']'
pttle          = 'Ratio of (*eta* |j|^2)/(dh/dt) vs. |St|'
xra            = [1d-4,2d2]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,1
WSHOW,1
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = 1.0 line
    OPLOT,xra,[1d0,1d0],LINESTYLE=2,THICK=2


;;  1/R vs. |Sn|
x0             = Sn_mag_0713_0[good_r_0713_0]
x1             = Sn_mag_0721_0[good_r_0721_0]
x2             = Sn_mag_0723_0[good_r_0723_0]
x3             = Sn_mag_0723_1[good_r_0723_1]
x4             = Sn_mag_0723_2[good_r_0723_2]
x5             = Sn_mag_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
;;       0.0000000       70.530051

xttle          = '|(n . S) n| ['+mu__str[0]+'W m!U-2!N'+']'
pttle          = 'Ratio of (*eta* |j|^2)/(dh/dt) vs. |Sn|'
xra            = [1d-4,2d2]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,2
WSHOW,2
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = 1.0 line
    OPLOT,xra,[1d0,1d0],LINESTYLE=2,THICK=2


;;  1/R vs. |S(w,k)|
x0             = Spow_0713_0[good_r_0713_0]
x1             = Spow_0721_0[good_r_0721_0]
x2             = Spow_0723_0[good_r_0723_0]
x3             = Spow_0723_1[good_r_0723_1]
x4             = Spow_0723_2[good_r_0723_2]
x5             = Spow_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
;;     0.012327300       887.83300

xttle          = '|S| [FFT Power, '+mu__str[0]+'W m!U-2!N'+']'
pttle          = 'Ratio of (*eta* |j|^2)/(dh/dt) vs. Integrated FFT Poynting Flux'
xra            = [1d-4,2d2]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

n_sum          = 1L
symb           = 2
WSET,3
WSHOW,3
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = 1.0 line
    OPLOT,xra,[1d0,1d0],LINESTYLE=2,THICK=2



;;----------------------------------------------------------------------------------------
;;  Plot R vs. W_B and R vs. W_E
;;----------------------------------------------------------------------------------------
n_sum          = 2L
symb           = 6

dhdt_ypref     = '('+Delta_str[0]+'h/'+Delta_str[0]+'t)'
yttle          = '('+eta_str[0]+'|j|!U2!N'+')/'+dhdt_ypref[0]+' [Dissipation Ratio]'
y0             = 1d0/r_dhdt_0713_0[good_r_0713_0]
y1             = 1d0/r_dhdt_0721_0[good_r_0721_0]
y2             = 1d0/r_dhdt_0723_0[good_r_0723_0]
y3             = 1d0/r_dhdt_0723_1[good_r_0723_1]
y4             = 1d0/r_dhdt_0723_2[good_r_0723_2]
y5             = 1d0/r_dhdt_0926_0[good_r_0926_0]
PRINT, ';;', MIN([y0,y1,y2,y3,y4,y5],/NAN), MAX([y0,y1,y2,y3,y4,y5],/NAN)
;;   5.2675050e-08       1244.3619
yra            = [1d-8,2d3]


;;  1/R vs. W_B
x0             = B_E_gse_0713_0[good_r_0713_0]
x1             = B_E_gse_0721_0[good_r_0721_0]
x2             = B_E_gse_0723_0[good_r_0723_0]
x3             = B_E_gse_0723_1[good_r_0723_1]
x4             = B_E_gse_0723_2[good_r_0723_2]
x5             = B_E_gse_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
;;       0.0000000   1.9229424e-06

low_delta      = STRLOWCASE(Delta_str[0])
xttle          = '|'+low_delta[0]+'B|!U2!N'+'/2'+mu__str[0]+'!Do!N ['+mu__str[0]+'W m!U-3!N'+']'
pttle          = 'Ratio of (*eta* |j|^2)/(dh/dt) vs. W!DB!N'
xra            = [1d-13,1d-6]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

WSET,1
WSHOW,1
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = 1.0 line
    OPLOT,xra,[1d0,1d0],LINESTYLE=2,THICK=2


;;  1/R vs. W_E
x0             = E_E_gse_0713_0[good_r_0713_0]
x1             = E_E_gse_0721_0[good_r_0721_0]
x2             = E_E_gse_0723_0[good_r_0723_0]
x3             = E_E_gse_0723_1[good_r_0723_1]
x4             = E_E_gse_0723_2[good_r_0723_2]
x5             = E_E_gse_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
;;   7.9088915e-14   3.0121502e-07

low_delta      = STRLOWCASE(Delta_str[0])
xttle          = epsilon_str[0]+'!Do!N |'+low_delta[0]+'E|!U2!N'+'/2 ['+mu__str[0]+'W m!U-3!N'+']'
pttle          = 'Ratio of (*eta* |j|^2)/(dh/dt) vs. W!DE!N'
xra            = [1d-13,1d-6]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

WSET,2
WSHOW,2
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = 1.0 line
    OPLOT,xra,[1d0,1d0],LINESTYLE=2,THICK=2


;;  1/R vs. (W_E + W_B)
x0             = E_E_gse_0713_0[good_r_0713_0] + B_E_gse_0713_0[good_r_0713_0]
x1             = E_E_gse_0721_0[good_r_0721_0] + B_E_gse_0721_0[good_r_0721_0]
x2             = E_E_gse_0723_0[good_r_0723_0] + B_E_gse_0723_0[good_r_0723_0]
x3             = E_E_gse_0723_1[good_r_0723_1] + B_E_gse_0723_1[good_r_0723_1]
x4             = E_E_gse_0723_2[good_r_0723_2] + B_E_gse_0723_2[good_r_0723_2]
x5             = E_E_gse_0926_0[good_r_0926_0] + B_E_gse_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
;;   2.1922414e-12   1.9230959e-06

low_delta      = STRLOWCASE(Delta_str[0])
x_epref        = '('+epsilon_str[0]+'!Do!N |'+low_delta[0]+'E|!U2!N'+'/2 + '
x_bpref        = '|'+low_delta[0]+'B|!U2!N'+'/2'+mu__str[0]+'!Do!N'+') '
xttle          = x_epref[0]+x_bpref[0]+'['+mu__str[0]+'W m!U-3!N'+']'
pttle          = 'Ratio of (*eta* |j|^2)/(dh/dt) vs. (W!DE!N + W!DB!N'+')'
xra            = [1d-13,1d-6]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

WSET,3
WSHOW,3
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = 1.0 line
    OPLOT,xra,[1d0,1d0],LINESTYLE=2,THICK=2


;;  1/R vs. (W_E/W_B)
x0             = E_E_gse_0713_0[good_r_0713_0]/B_E_gse_0713_0[good_r_0713_0]
x1             = E_E_gse_0721_0[good_r_0721_0]/B_E_gse_0721_0[good_r_0721_0]
x2             = E_E_gse_0723_0[good_r_0723_0]/B_E_gse_0723_0[good_r_0723_0]
x3             = E_E_gse_0723_1[good_r_0723_1]/B_E_gse_0723_1[good_r_0723_1]
x4             = E_E_gse_0723_2[good_r_0723_2]/B_E_gse_0723_2[good_r_0723_2]
x5             = E_E_gse_0926_0[good_r_0926_0]/B_E_gse_0926_0[good_r_0926_0]

PRINT, ';;', MIN([x0,x1,x2,x3,x4,x5],/NAN), MAX([x0,x1,x2,x3,x4,x5],/NAN)
;;   1.9075353e-05       1317.9706

low_delta      = STRLOWCASE(Delta_str[0])
x_epref        = '('+epsilon_str[0]+'!Do!N |'+low_delta[0]+'E|!U2!N'+'/2)/('
x_bpref        = '|'+low_delta[0]+'B|!U2!N'+'/2'+mu__str[0]+'!Do!N'+') '
xttle          = x_epref[0]+x_bpref[0]+'[unitless]'
pttle          = 'Ratio of (*eta* |j|^2)/(dh/dt) vs. W!DE!N'
xra            = [1d-8,2d3]
pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}

WSET,4
WSHOW,4
  PLOT,x0,y0,_EXTRA=pstr
    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
    ;;  Overplot y = 1.0 line
    OPLOT,xra,[1d0,1d0],LINESTYLE=2,THICK=2
    ;;  Overplot x = 1.0 line
    OPLOT,[1d0,1d0],yra,LINESTYLE=2,THICK=2



;;  W_E vs. W_B
;x0             = B_E_gse_0713_0[good_r_0713_0]
;x1             = B_E_gse_0721_0[good_r_0721_0]
;x2             = B_E_gse_0723_0[good_r_0723_0]
;x3             = B_E_gse_0723_1[good_r_0723_1]
;x4             = B_E_gse_0723_2[good_r_0723_2]
;x5             = B_E_gse_0926_0[good_r_0926_0]
;
;y0             = E_E_gse_0713_0[good_r_0713_0]
;y1             = E_E_gse_0721_0[good_r_0721_0]
;y2             = E_E_gse_0723_0[good_r_0723_0]
;y3             = E_E_gse_0723_1[good_r_0723_1]
;y4             = E_E_gse_0723_2[good_r_0723_2]
;y5             = E_E_gse_0926_0[good_r_0926_0]
;
;low_delta      = STRLOWCASE(Delta_str[0])
;xttle          = '|'+low_delta[0]+'B|!U2!N'+'/2'+mu__str[0]+'!Do!N ['+mu__str[0]+'W m!U-3!N'+']'
;yttle          = epsilon_str[0]+'!Do!N |'+low_delta[0]+'E|!U2!N'+'/2 ['+mu__str[0]+'W m!U-3!N'+']'
;pttle          = 'W!DE!N vs. W!DB!N'
;xra            = [1d-13,1d-6]
;yra            = xra
;pstr           = {TITLE:pttle,XTITLE:xttle,YTITLE:yttle,YLOG:1,XLOG:1,NODATA:1,$
;                  YMINOR:9L,XMINOR:10L,XRANGE:xra,YRANGE:yra,YSTYLE:1,XSTYLE:1}
;
;symb           = 2
;WSET,3
;WSHOW,3
;  PLOT,x0,y0,_EXTRA=pstr
;    OPLOT,x0,y0,PSYM=symb[0],COLOR=xyout_cols[0],NSUM=n_sum[0]
;    OPLOT,x1,y1,PSYM=symb[0],COLOR=xyout_cols[1],NSUM=n_sum[0]
;    OPLOT,x2,y2,PSYM=symb[0],COLOR=xyout_cols[2],NSUM=n_sum[0]
;    OPLOT,x3,y3,PSYM=symb[0],COLOR=xyout_cols[3],NSUM=n_sum[0]
;    OPLOT,x4,y4,PSYM=symb[0],COLOR=xyout_cols[4],NSUM=n_sum[0]
;    OPLOT,x5,y5,PSYM=symb[0],COLOR=xyout_cols[5],NSUM=n_sum[0]
;    ;;  Overplot y = x line
;    OPLOT,xra,xra,LINESTYLE=2,THICK=2


















































.compile thm_load_bowshock_rhsolns
thm_load_bowshock_rhsolns,R_STRUCT=diss_rates

HELP, diss_rates, /STRUC
;;** Structure <1a20e08>, 6 tags, length=170960, data length=170940, refs=1:
;;   THB_2009_07_13_0
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_21_0
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_0
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_1
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_2
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THA_2009_09_26_0
;;                   STRUCT    -> <Anonymous> Array[1]
;;

HELP, diss_rates.THB_2009_07_13_0, /STRUC
;;** Structure <155fc38>, 4 tags, length=33552, data length=33548, refs=2:
;;   UP              STRUCT    -> <Anonymous> Array[1]
;;   DOWN            STRUCT    -> <Anonymous> Array[1]
;;   SHOCK           STRUCT    -> <Anonymous> Array[1]
;;   DISS_RATE       STRUCT    -> <Anonymous> Array[1]


HELP, diss_rates.THB_2009_07_13_0.UP, /STRUC
HELP, diss_rates.THB_2009_07_13_0.DOWN, /STRUC
;;** Structure <19f7e08>, 6 tags, length=1160, data length=1160, refs=2:
;;   NI              FLOAT     Array[29]
;;   TI              FLOAT     Array[29]
;;   TE              FLOAT     Array[29]
;;   PI              FLOAT     Array[29]
;;   VSW             FLOAT     Array[29, 3]
;;   BO              FLOAT     Array[29, 3]

HELP, diss_rates.THB_2009_07_13_0.SHOCK, /STRUC
;;** Structure <154f428>, 5 tags, length=112, data length=112, refs=2:
;;   VSHN            DOUBLE    Array[2]
;;   USHN_UP         DOUBLE    Array[2]
;;   USHN_DOWN       DOUBLE    Array[2]
;;   NVEC            DOUBLE    Array[3, 2]
;;   TRAMP           DOUBLE    Array[2]

HELP, diss_rates.THB_2009_07_13_0.DISS_RATE, /STRUC
;;** Structure <15620d8>, 3 tags, length=31120, data length=31116, refs=2:
;;   SH_PARAM        STRUCT    -> <Anonymous> Array[1]
;;   OBSERVED        STRUCT    -> <Anonymous> Array[1]
;;   THEORIES        STRUCT    -> <Anonymous> Array[1]

HELP, diss_rates.THB_2009_07_13_0.DISS_RATE.SH_PARAM, /STRUC
;;** Structure <1562388>, 3 tags, length=792, data length=792, refs=2:
;;   NVEC            DOUBLE    Array[3, 3]
;;   USHN            DOUBLE    Array[3]
;;   THETA_BN        DOUBLE    Array[29, 3]

HELP, diss_rates.THB_2009_07_13_0.DISS_RATE.OBSERVED, /STRUC
;;** Structure <1a1fe08>, 14 tags, length=4624, data length=4620, refs=2:
;;   DELTA_RHO       DOUBLE    Array[29]
;;   RHO_RATIO       FLOAT     Array[29]
;;   PRESS_T_UP      DOUBLE    Array[29]
;;   PRESS_T_DN      DOUBLE    Array[29]
;;   PRESS_RATIO     DOUBLE    Array[29]
;;   CS_UP           DOUBLE    Array[29, 3]
;;   WORK_RATE       DOUBLE    Array[29, 3]
;;   DELTA_ENTROPY   DOUBLE    Array[29, 3]
;;   DISS_RATE       DOUBLE    Array[29, 3]
;;   DELTA_ENTHALPY  DOUBLE    Array[29, 3]
;;   AVG_WORK_RATE   DOUBLE    Array[3]
;;   AVG_D_ENTROPY   DOUBLE    Array[3]
;;   AVG_DISS_RATE   DOUBLE    Array[3]
;;   AVG_D_ENTHALPY  DOUBLE    Array[3]

HELP, diss_rates.THB_2009_07_13_0.DISS_RATE.THEORIES, /STRUC
;;** Structure <1a20808>, 7 tags, length=25704, data length=25704, refs=2:
;;   PRESS_RATIO     DOUBLE    Array[29, 3, 3, 3]
;;   DELTA_ENTROPY   DOUBLE    Array[29, 3, 3, 3]
;;   DISS_RATE       DOUBLE    Array[29, 3, 3, 3]
;;   DELTA_ENTHALPY  DOUBLE    Array[29, 3, 3, 3]
;;   AVG_D_ENTROPY   DOUBLE    Array[3, 3, 3]
;;   AVG_DISS_RATE   DOUBLE    Array[3, 3, 3]
;;   AVG_D_ENTHALPY  DOUBLE    Array[3, 3, 3]





.compile thm_load_bowshock_ascii
thm_load_bowshock_ascii,R_STRUCT=j_E_S_corr

HELP, j_E_S_corr.DATA, /STRUC
;;** Structure <1a61c08>, 6 tags, length=2547712, data length=2547712, refs=2:
;;   THB_2009_07_13_1ST
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_21_1ST
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_1ST
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_2ND
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THC_2009_07_23_3RD
;;                   STRUCT    -> <Anonymous> Array[1]
;;   THA_2009_09_26_1ST
;;                   STRUCT    -> <Anonymous> Array[1]
;;

HELP, j_E_S_corr.DATA.THB_2009_07_13_1ST, /STRUC
;;** Structure <1a62408>, 13 tags, length=421888, data length=421888, refs=2:
;;   SCETS           STRING    Array[1648]
;;   UNIX            DOUBLE    Array[1648]
;;   J_MAG_SM        DOUBLE    Array[1648]
;;   J_VEC_NIF_NCB_SM
;;                   DOUBLE    Array[1648, 3]
;;   E_VEC_NIF_GSE_JT
;;                   DOUBLE    Array[1648, 3]
;;   B_VEC_SCF_GSE_JT
;;                   DOUBLE    Array[1648, 3]
;;   S_VEC_NIF_GSE_JT
;;                   DOUBLE    Array[1648, 3]
;;   S_POW_NIF_GSE_JT
;;                   DOUBLE    Array[1648]
;;   S_DOT_N_N_NIF_GSE
;;                   DOUBLE    Array[1648, 3]
;;   N_X_S_X_N_NIF_GSE
;;                   DOUBLE    Array[1648, 3]
;;   NEG_E_DOT_J_SM  DOUBLE    Array[1648]
;;   ETA_JSQ_GSE     DOUBLE    Array[1648, 4]
;;   ETA_JSQ_NIF     DOUBLE    Array[1648, 4]






WINDOW,1,RETAIN=2,XSIZE=1700,YSIZE=1100,TITLE='Energy Dissipation 1'



all_data       = j_E_S_corr.DATA
all_ns         = j_E_S_corr.NUM
n_cross        = N_TAGS(all_ns)
FOR j=0L, n_cross - 1L DO PRINT,';; ', all_ns.(j)
;;         1648
;;         3376
;;          816
;;          816
;;         1648
;;         1648

n_pts          = 0L
FOR j=0L, n_cross - 1L DO n_pts += all_ns.(j)
PRINT,';; ', n_cross, n_pts
;;            6        9952






























